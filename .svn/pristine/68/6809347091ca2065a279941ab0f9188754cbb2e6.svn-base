function EtherpadWebSocket(U,u){var B=this;var N=this;var w=2;var J={};this.connectLite=false;this.onopen=function(){};
this.onclosed=function(){};this.onmessage=function(){};this.onhiccup=function(){};this.onlogmessage=function(){};
this.CONNECTING=0;this.OPEN=1;this.CLOSED=2;this.readyState=-1;this.getLastReceivedSeqNumber=function(){return E;
};var O="";if(u){O="&tag="+u;}var G=window.location.host;if((G.split(":").length>1&&G.split(":")[0].split(".").length==2)||(G.split(".").length==2)){G="."+G;
}G="comet"+G;var f=0;var AG=setInterval(function(){f=0;if(B.readyState==B.CLOSED){clearInterval(AG);}},60*1000);
var L=false;function C(AR){if(AR!=D&&AR!=B){return;}if(L){return;}A("hiccup: "+AR.name);if(f++>10){F({reconnect:true,reason:"Too many hiccups!"});
return;}m();var AQ;function AT(){if(AQ){AQ.onreadystatechange=function(){};AQ.abort();AQ=null;}}I(J,"hiccup",30000,function(){L=false;
J.singleHiccup();AT();F({reconnect:false,reason:"Couldn't contact server to hiccup.",reconnectLite:true});
});L=true;function AS(){if(B.readyState==B.CLOSED){return;}if(!L){return;}B.onhiccup({connected:false});
A("trying hiccup");I(J,"singleHiccup",5000,function(){AS();});AT();AQ=V("post",d(),true,[{key:"oob",value:"hiccup"}],function(AV,AU){if(!L||!AQ){return;
}AQ=null;J.singleHiccup();if(AU.substring(0,"restart-fail".length)=="restart-fail"){J.hiccup();F({reconnect:true,reason:"Server restarted or socket timed out on server."});
}else{if(AV!=200||AU.substring(0,2)!="ok"){A("Failed to hiccup with error: "+AV+" / "+AU);setTimeout(AS,1000);
}else{L=false;J.hiccup();q();}}});}AS();}function m(){for(var AQ in K){if(K.hasOwnProperty(AQ)){K[AQ].disconnect();
}}D=undefined;}function F(AQ,AR,AS){A("disconnected: "+AQ.reason+" / "+(AQ.data!==undefined?"data: "+AQ.data:""));
AM();m();if(M&&M.div){M.div.innerHTML="";}if(B.readyState!=B.CLOSED){B.readyState=B.CLOSED;if(!AR){b(true,"kill:"+AQ.reason,AS,true);
}B.onclosed(AQ);}}this.disconnect=function(AQ){F({reason:"Closed by client."},false,AQ);};function AC(){var AQ=AP();
A("basic connect on type: "+AQ);var AR=K[AQ]=new x[AQ]();AR.connect(B.connectLite);}function AN(){var AS=AK();
var AT;var AQ;for(var AR=0;AR<AS.length;++AR){AQ=AS[AR];A("other connect on type: "+AQ);AT=K[AQ]=new x[AQ]();
AT.connect();}}function q(){A("doing connect!");I(J,"connect",30000,function(){F({reconnect:false,reason:"Timeout connecting to server: no channel type was able to connect.",reconnectLite:true});
});AC();}this.connect=function(){A("socket connecting: "+U);q();};function a(){return Math.floor((new Date()).valueOf()/100)%10000000;
}function A(AQ){B.onlogmessage("(comet @t: "+a()+") "+AQ);}function AM(){A(B.describe());}this.describe=function(){function AQ(){out=[];
for(var AR in K){if(K.hasOwnProperty(AR)){out.push(AR+": "+K[AR].describe());}}return"[ "+out.join(", ")+" ]";
}return("socket state: { id: "+U+", readyState: "+B.readyState+", isHiccuping: "+L+", timeouts: "+R(J)+", officialChannel: "+(D?D.name:"none")+", channels: "+AQ()+", isPosting: "+S+", lastReceivedSeqNumber: "+E+", lastPost: "+o+", postTimeouts: "+R(Y)+", channelSeq: "+l+" }");
};function AH(AQ,AR){return function(){var AT=[];for(var AS=0;AS<arguments.length;AS++){AT.push(arguments[AS]);
}AR.apply(AQ,AT);};}var H=AH;function V(AZ,Aa,AU,AS,AV,Ab){var AQ=(Ab||h)();AQ.open(AZ,Aa,AU);if(AU){AQ.onreadystatechange=function(){if(AQ.readyState!=4){return;
}var Ac;var Ad;try{Ac=AQ.status;Ad=AQ.responseText;}catch(Ae){}AV(Ac,Ad,AQ);};}var AR=null;if(AS){AR=[];
for(var AT=0;AT<AS.length;++AT){AR.push(encodeURIComponent(AS[AT].key)+"="+encodeURIComponent(AS[AT].value));
}AR=AR.join("&");AQ.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=utf-8");
}try{AQ.send(AR);}catch(AX){AQ.abort();AV(500,"Error sending data!",AQ);}if(!AU){var AW;var AY;try{AW=AQ.status;
AY=AQ.responseText;}catch(AX){}AV(AW,AY,AQ);}return AQ;}var s=function(){};function I(AR,AQ,AV,AU){function AT(AY,AX){if(AY[AX]){AY[AX]();
AY[AX]=s;}}var AW=setTimeout(function(){AT(AR,AQ);AU();},AV);var AS=function(){clearTimeout(AW);};AT(AR,AQ);
AR[AQ]=AS;return AS;}var E=0;function AE(AQ){if(AQ.seqNumber>E+1){A("bad sequence number. expecting: "+(E+1)+", got: "+AQ.seqNumber);
C(B);return false;}if(AQ.seqNumber<E+1){return true;}E=AQ.seqNumber;if(!AQ.isControl){B.onmessage({data:AQ.content});
return true;}else{if(AQ.content=="kill"){F({reconnect:false,reason:"Killed by server."});return false;
}}}var d=function(){return"/comet/post?r="+P()+"&v="+w+"&id="+U+"&seq="+E+O;};function AI(){var AQ=[];
var AR=0;var AS=0;this.offer=function(AT){AQ[AS++]=AT;};this.poll=function(){if(this.length()>0){var AT=AQ[AR];
delete AQ[AR++];return AT;}};this.clear=function(){AR=0;AS=0;var AT=AQ;AQ=[];return AT;};this.length=function(){return AS-AR;
};}var v=new AI();var S=false;var Y={};var o;function b(AR,AU,AS,AT,AQ){n([{oob:AR,data:AU,cb:AQ}],AS,AT);
}function n(AQ,AX,AV,AT){if(!AV&&B.readyState==B.CLOSED){return;}if(AQ.length==0){if(AT){AT();}return;
}var AU=[];var AS=[];for(var AR=0;AR<AQ.length;++AR){AU.push({key:(AQ[AR].oob?"oob":"m"),value:AQ[AR].data});
if(AQ[AR].cb){AS.push(AQ[AR].cb);}}function AY(Af,Ae,Ab,Ad){var Aa="";try{Aa=Af+": "+Ab.statusText+" - "+Ae+" ("+Ad+")";
}catch(Ac){}F({reconnect:true,reason:"Posting message failed.",data:Aa});for(var AZ=0;AZ<AS.length;++AZ){AS[AZ](false,Aa);
}}function AW(Ab,Aa,Ac){Y.post();if(Ab!=200||Aa.substring(0,2)!="ok"){AY(Ab,Aa,Ac,"1");}else{for(var AZ=0;
AZ<AS.length;++AZ){AS[AZ](true);}if(AT){AT();}}}I(Y,"post",30000,function(){F({reconnect:true,reason:"Posting message timed out."});
});V("post",d(),!AX,AU,AW);}function j(){if(S==true){return;}if(L){return;}var AQ=v.clear();if(AQ.length==0){return;
}S=true;n(AQ,false,false,function(){S=false;setTimeout(j,0);});o=a();}this.postMessage=function(AR,AQ){if(B.readyState!=B.OPEN){return;
}v.offer({data:AR,cb:AQ});setTimeout(function(){j();},0);};function y(){var AS=[];for(var AR=0;AR<Z.length;
++AR){var AQ=Z[AR];var AV=($&&$.browser.msie&&parseInt($.browser.version)<9);var AT=($&&$.browser.msie&&parseInt($.browser.version)<10);
if((AV&&AQ=="longpolling")||(AT&&AQ=="streaming")||($&&$.browser.opera&&AQ!="shortpolling"&&AQ!="streaming")){continue;
}var AU=navigator.userAgent.match(/iPad/i)!=null;var AW=navigator.userAgent.match(/iPhone/i)!=null;if((AW||AU)&&AQ!="streaming"){continue;
}AS.push(AQ);}return AS;}function AP(){return y()[0];}function AK(){return y().slice(1);}var D;this.getTransportType=function(){return(D?D.name:"none");
};var Z=["shortpolling","longpolling","streaming"];var g=true;var K={};var x={shortpolling:c,longpolling:AD,streaming:AO};
function R(AQ){var AS=[];for(var AR in AQ){if(AQ.hasOwnProperty(AR)){AS.push(AR+": "+(AQ[AR]==s?"unset":"set"));
}}return"{ "+AS.join(", ")+" }";}var l=1;function p(AQ){J.connect();if(!D||AQ.weight>D.weight){A("switching to use channel: "+AQ.name);
var AR=D;D=AQ;setTimeout(function(){b(true,"useChannel:"+(l++)+":"+AQ.name,false,false,function(AT,AS){if(D!=AQ){A("ignoring useChannel response as officialChannel has changed from "+AQ.name);
return;}if(AT){if(AR){AR.disconnect();}if(B.readyState!=B.OPEN){B.readyState=B.OPEN;B.onopen({});}else{B.onhiccup({connected:true});
}if(!AR){AN();}}else{F({reconnect:true,reason:"Failed to select channel on server.",data:AS});}});},0);
return true;}else{return false;}}function P(){return String(Math.round(Math.random()*1000000000000));
}function T(){return"/comet/channel?v="+w+"&r="+P()+"&id="+U;}function h(){var AQ=false;var AS=false;
if($.browser.msie&&parseInt($.browser.version)>=9){AS=true;}if(!AS){try{AQ=(window.ActiveXObject&&new ActiveXObject("Msxml2.XMLHTTP"));
}catch(AR){try{AQ=(window.ActiveXObject&&new ActiveXObject("Microsoft.XMLHTTP"));}catch(AT){AQ=false;
}}}if(!AQ&&typeof XMLHttpRequest!="undefined"){try{AQ=new XMLHttpRequest();}catch(AR){AQ=false;}}if(!AQ&&window.createRequest){try{AQ=window.createRequest();
}catch(AR){AQ=false;}}return AQ;}function Q(AQ){this.message=AQ;}function W(AR,AS){if(!AS){AS=0;}var AQ=AR.indexOf(":",AS);
if(AQ<0){return;}var AT=Number(AR.substring(AS,AQ));if(isNaN(AT)){throw new Q("Bad length: "+AR.substring(AS,AQ));
}if(AR.length<AQ+1+AT){return;}var AU=AR.substr(AQ+1,AT);return{message:AU,lastConsumedChar:AQ+1+AT};
}function AL(AQ,AR){if(AR==0){return{message:AQ,lastConsumedChar:AQ.length};}}function AA(AZ,AU,Aa){if(!AU){AU=0;
}var AT=[];var AS=AU;while(true){var AR=(Aa||W)(AZ,AS);if(!AR){break;}AS=AR.lastConsumedChar;var AX=AR.message;
var AQ=AX.split(":");if(AQ[0]=="oob"){AT.push({oob:AQ.slice(1).join(":")});continue;}var AW=Number(AQ[0]);
if(isNaN(AW)){throw new Q("Bad sequence number: "+AQ[0]);}var AV=Number(AQ[1]);if(isNaN(AV)){throw new Q("Bad control: "+AQ[1]);
}var AY=AQ.slice(2).join(":");AT.push({seqNumber:AW,isControl:(AV==1),content:AY});}return{messages:AT,lastConsumedChar:AS};
}function X(AV,AW,AU,AT){try{messages=AA(AV,AW,AT);}catch(AQ){if(AQ instanceof Q){A("Data format error: "+AQ.message);
C(AU);return;}else{A(AQ.toString()+" on line: "+AQ.lineNumber);}}for(var AR=0;AR<messages.messages.length;
AR++){var AS=messages.messages[AR].oob;if(AS){if(AS=="restart-fail"){F({reconnect:true,reason:"Server restarted or socket timed out on server."});
return;}}else{if(!AE(messages.messages[AR])){break;}}}return messages.lastConsumedChar;}function c(){this.weight=0;
this.name="shortpolling";this.isConnected=false;this.isClosed=false;this.request;this.clearRequest=function(){if(this.request){this.request.onreadystatechange=function(){};
this.request.abort();this.request=null;}};this.connectLite=false;this.timeouts={};this.describe=function(){return"{ isConnected: "+this.isConnected+", isClosed: "+this.isClosed+", timeouts: "+R(this.timeouts)+", request: "+(this.request?"set":"not set")+" }";
};this.pollDataHandler=function(AR,AQ,AS){if(AS.readyState!=4){return;}if(this.timeouts.poll){this.timeouts.poll();
}var AV;if(!this.isConnected){this.timeouts.connectAttempt();if(AR!=200){if(this.connectLite){this.disconnect();
return;}A(this.name+" connect failed: "+AR+" / "+AQ);setTimeout(H(this,this.attemptConnect),1000);return;
}this.connectLite=false;var AT=(AQ?W(AQ):undefined);if(AT&&AT.message=="oob:ok"){this.timeouts.initialConnect();
this.isConnected=true;A(this.name+" transport connected!");if(!p(this)){A(this.name+" transport not chosen for activation.");
this.disconnect();return;}this.doPoll();return;}else{A(this.name+" connect didn't get ok: "+AR+" / "+AQ);
setTimeout(H(this,this.attemptConnect),1000);return;}}var AU=X(AS.responseText,0,this);if(AR!=200||((!AU)&&this.emptyResponseBad)){C(this);
}setTimeout(H(this,this.doPoll),this.pollDelay);this.clearRequest();};this.keepRetryingConnection=true;
this.cancelConnect=function(){this.clearRequest();this.keepRetryingConnection=false;};this.cancelPoll=function(){this.clearRequest();
A("poll timed out.");C(this);};this.doPoll=function(){if(this.isClosed){return;}I(this.timeouts,"poll",this.pollTimeout,H(this,this.cancelPoll));
this.request=V("GET",T()+"&channel="+this.name+"&seq="+E+this.pollParams()+O,true,undefined,H(this,this.pollDataHandler),this.xhrGenerator);
};this.pollParams=function(){return"";};this.pollTimeout=5000;this.pollDelay=1000;this.attemptConnect=function(){if(!this.keepRetryingConnection){return;
}A(this.name+" attempting connect");this.clearRequest();I(this.timeouts,"connectAttempt",30000,H(this,this.attemptConnect));
this.request=V("GET",T()+"&channel="+this.name+"&new=yes&create="+(N.readyState==N.OPEN?"no":"yes")+"&seq="+E+O,true,undefined,H(this,this.pollDataHandler),this.xhrGenerator);
};this.connect=function(AQ){this.connectLite=AQ;this.attemptConnect();I(this.timeouts,"initialConnect",30000,H(this,this.cancelConnect));
};this.disconnect=function(){A(this.name+" disconnected");this.isClosed=true;this.clearRequest();};}function AO(){this.weight=2;
this.name="streaming";var AS=this;var AV=false;var AQ;function Aa(){if(AQ){AQ.onreadystatechange=function(){};
AQ.abort();AQ=null;if(AU.data){AU.data();}if(AR){AR=null;}if(AT){AT.innerHTML="";AT=null;}}}var AW=false;
var AU={};var AX=0;this.describe=function(){return"{ isConnected: "+AV+", isClosed: "+AW+", timeouts: "+R(AU)+", request: "+(AQ?"set":"not set")+", cursor: "+AX+" }";
};function Ac(){AV=true;AU.initialConnect();if(!p(AS)){A("streaming transport not chosen for activation");
AS.disconnect();return;}}function Ad(){if(AW){return;}try{if(!AQ.responseText){if(AQ.readyState==4){AS.disconnect();
if(AV){A("stream connection unexpectedly closed.");C(AS);}}return;}}catch(Ag){return;}if(!AV){var Af=W(AQ.responseText,AX);
if(!Af){return;}AX=Af.lastReceivedSeqNumber;if(Af.message=="oob:ok"){Ac();}else{A("stream: incorrect channel connect message:"+Af.message);
AS.disconnect();return;}}else{AX=X(AQ.responseText,AX,AS);}if(!AQ||AQ.readyState==4){Aa();if(AV){A("stream connection unexpectedly closed.");
C(AS);}}else{I(AU,"data",60*1000,function(){C(AS);});}}function Ab(Af){if(AW){return;}if(!AV){if(Af=="oob:ok"){Ac();
}else{A("iframe stream: unexpected data on connect - "+Af);}}else{X(Af,0,AS,AL);}}function Ae(){AW=true;
Aa();A("stream: failed to connect.");}var AR;var AT;var AY=0;function AZ(){var Af;try{Af=AT.firstChild.readyState;
}catch(Ag){C(AS);return;}if(Af=="interactive"||AY>10){try{var Ah=AT.firstChild.contentWindow.document.getElementById("thebody");
}catch(Ag){C(AS);}}else{AY++;setTimeout(AZ,500);}}this.connect=function(){I(AU,"initialConnect",30000,Ae);
if(g){var Af="//"+P()+G+T()+"&channel=streaming&type=iframe&new=yes&create="+(N.readyState==N.OPEN?"no":"yes")+"&seq="+E+O;
A("stream to: "+Af);if($&&$.browser.opera){AT=$('<div style="display: none;"></div>').get(0);$("body").append(AT);
window.comet={pass_data:Ab,disconnect:function(){C(AS);}};$(AT).append($("<iframe src='"+Af+"'></iframe>"));
AY=0;setTimeout(AZ,2000);A("stream connect sent!");return;}try{var Ah=$.browser.msie&&parseInt($.browser.version)>=9;
if(!Ah){AR=(window.ActiveXObject&&new ActiveXObject("htmlfile"));}if(AR){AR.open();AR.write("<html><head><title>f</title></head><body>");
AR.write("\x3cscript>document.domain='"+document.domain+"';\x3c/script>");AR.write("</body></html>");
AR.close();AT=AR.createElement("div");AR.body.appendChild(AT);AR.parentWindow.comet={pass_data:Ab,disconnect:function(){C(AS);
}};AT.innerHTML="<iframe src='"+Af+"'></iframe>";AY=0;setTimeout(AZ,2000);}}catch(Ag){AR=false;}}else{if($&&$.browser.opera){A("opera - not trying xhr");
return;}}if(!AR){AQ=h();var Ai=g&&"withCredentials" in AQ?"//"+P()+G:"";AQ.open("get",Ai+T()+"&channel=streaming&new=yes&create="+(N.readyState==N.OPEN?"no":"yes")+"&seq="+E+O);
if("withCredentials" in AQ){AQ.withCredentials=true;}AQ.onreadystatechange=Ad;try{AQ.send(null);}catch(Ag){}}A("stream connect sent!");
};this.disconnect=function(){A("stream disconnected");AW=true;Aa();};A("new streamchannel");}function r(AQ){return"//"+AQ+G+"/comet/xhrXdFrame";
}function AB(){if(!document.getElementById("newcomethidden")){var AQ=document.createElement("div");AQ.setAttribute("id","newcomethidden");
AQ.style.display="none";document.body.appendChild(AQ);}return document.getElementById("newcomethidden");
}function AJ(AQ){this.open=function(AU,AT,AS){this.method=AU;this.uri=AT;this.async=AS;};var AR={};this.setRequestHeader=function(AS,AT){AR[AS]=AT;
};this.send=function(AT){var AS=this;this.xhr=AQ.iframe.contentWindow.doAction(this.method,this.uri,this.async,AR,AT||null,function(AU,AV){AS.readyState=4;
AS.status=AU;AS.responseText=AV;AS.onreadystatechange();});};this.abort=function(){if(this.xhr){AQ.contentWindow.doAbort(this.xhr);
}};}function z(AU){var AS=P();try{var AQ=(window.ActiveXObject&&new ActiveXObject("htmlfile"));var AR;
if(AQ){AQ.open();AQ.write("<html><head><title>f</title></head><body>");AQ.write("\x3cscript>document.domain='"+document.domain+"';\x3c/script>");
AQ.write("</body></html>");AQ.close();AR=AQ.createElement("div");AQ.body.appendChild(AR);AQ.parentWindow["done_"+AS]=AU;
AR.innerHTML="<iframe src='"+r(AS)+"'></iframe>";return{iframe:AR.firstChild,axc:AQ,div:AR};}}catch(AV){AQ=false;
}A("Not using IE setup.");var AT=document.createElement("iframe");AB().appendChild(AT);window["done_"+AS]=function(){try{delete window["done_"+AS];
}catch(AW){}AU();};AT.src=r(AS);return{iframe:AT};}function AF(){if(!M){throw Error("WebSocket isn't properly set up!");
}return new AJ(M);}var M;function AD(){c.apply(this);this.weight=1;this.name="longpolling";this.pollDelay=0;
this.pollTimeout=15000;this.pollParams=function(){return"&timeout="+(this.pollTimeout-5000);};var AQ=this.connect;
this.connect=function(){if(!M){M=z(H(this,AQ));}else{AQ.apply(this);}};this.xhrGenerator=AF;this.emptyResponseBad=true;
}}$("html").removeClass("no-js");$.ajaxPrefilter(function(A,F,E){if(A.type.toLowerCase()=="get"||!A.contentType){return;
}var B;var C=$.grep(document.cookie.split(/;\s+/),function(G){return G.split("=")[0]=="TOK";})[0];if(C){B=C.split("=")[1];
}if(A.contentType.indexOf("json")!=-1){A.data=A.data||"{}";A.data=JSON.stringify($.extend(JSON.parse(A.data),{xsrf:B}));
}else{if(A.contentType.indexOf("application/x-www-form-urlencoded")!=-1){A.data=A.data||"";if(A.data.indexOf("xsrf=")==-1){A.data+=(A.data?"&":"")+"xsrf="+B;
}}}var D=0;});function throttle(G,I,C){var D,E,F;var B=null;var A=0;C||(C={});var H=function(){A=C.leading===false?0:new Date;
B=null;F=G.apply(D,E);};return function(){var J=new Date;if(!A&&C.leading===false){A=J;}var K=I-(J-A);
D=this;E=arguments;if(K<=0){clearTimeout(B);B=null;A=J;F=G.apply(D,E);}else{if(!B&&C.trailing!==false){B=setTimeout(H,K);
}}return F;};}function showGlobalMsg(B){var A=$(".global-msg");if(!A.length){A=$("<div>").addClass("global-msg").hide().appendTo($("body"));
}window.clearTimeout(A.data("fadeOutTimer"));A.fadeIn().text(B).data("fadeOutTimer",window.setTimeout(function(){A.fadeOut();
},3000));}var caps={};caps.hasLocalStorage=false;try{var mod="tencentdocx";localStorage.setItem(mod,mod);
localStorage.removeItem(mod);caps.hasLocalStorage=true;}catch(e){caps.hasLocalStorage=false;}caps.hidden="";
caps.visibilityChange="";if(typeof document.hidden!=="undefined"){caps.hidden="hidden";caps.visibilityChange="visibilitychange";
}else{if(typeof document.mozHidden!=="undefined"){caps.hidden="mozHidden";caps.visibilityChange="mozvisibilitychange";
}else{if(typeof document.msHidden!=="undefined"){caps.hidden="msHidden";caps.visibilityChange="msvisibilitychange";
}else{if(typeof document.webkitHidden!=="undefined"){caps.hidden="webkitHidden";caps.visibilityChange="webkitvisibilitychange";
}}}}function escapeRegExp(A){return A.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1");}$(".hp-ui-button-menu-wrapper a").on("click",function(){if($(this).hasClass("hp-ui-button-menu-disabled")){return;
}var A=$(this).closest(".hp-ui-button");A.find(".hp-ui-button-menuitem-selected").removeClass("hp-ui-button-menuitem-selected");
buttonCloseMenu(A);});var buttonCloseMenu=function(A){$("body").off(".hp-ui-button-menu");A.find(".hp-ui-button-menu-wrapper").hide();
A.removeClass("hp-ui-button-active");A.find(".hp-ui-button-menuitem-selected").removeClass("hp-ui-button-menuitem-selected");
A.trigger("menu-closed");};$(".hp-ui-button-menu").on("click",function(){var A=$(this);if(A.attr("disabled")){return;
}$("#tooltip").remove();var G=A.hasClass("hp-ui-button-menu-reverse");var D=A.find(".hp-ui-button-menu-wrapper");
var B=A.find(".hp-ui-button-list-ul");var E=A.find(".hp-ui-button-list-ul li");var C=-1;A.data("close",buttonCloseMenu);
if(D.is(":visible")){buttonCloseMenu(A);}else{B.css("min-width",A.outerWidth()+"px");D.show();A.addClass("hp-ui-button-active");
var F=Math.max(200,Math.min($("body").height()-B.offset().top-50,435));B.css("max-height",F+"px");G&&B.css("top","-"+(B.outerHeight()+A.outerHeight()+10)+"px");
window.setTimeout(function(){$("body").on("keydown.hp-ui-button-menu",function(H){if(D.is(":hidden")){return true;
}var I=C;switch(H.keyCode){case 13:B.find("li.hp-ui-button-menuitem-selected > a").trigger("click");return false;
case 27:buttonCloseMenu(A);return false;case 38:C=C-1<0?E.length-1:C-1;break;case 40:C=(C+1)%E.length;
break;default:return true;}B.find("li:nth-child("+(I+1)+")").removeClass("hp-ui-button-menuitem-selected");
B.find("li:nth-child("+(C+1)+")").addClass("hp-ui-button-menuitem-selected");return false;}).on("click.hp-ui-button-menu",function(){buttonCloseMenu(A);
});},0);}});var allCookies={getItem:function(A){if(!A||!this.hasItem(A)){return null;}return unescape(document.cookie.replace(new RegExp("(?:^|.*;\\s*)"+escape(A).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*((?:[^;](?!;))*[^;]?).*"),"$1"));
},setItem:function(C,G,A,E,D,F){if(!C||/^(?:expires|max\-age|path|domain|secure)$/i.test(C)){return;}var B="";
if(A){switch(A.constructor){case Number:B=A===Infinity?"; expires=Tue, 19 Jan 2038 03:14:07 GMT":"; max-age="+A;
break;case String:B="; expires="+A;break;case Date:B="; expires="+A.toGMTString();break;}}document.cookie=escape(C)+"="+escape(G)+B+(D?"; domain="+D:"")+(E?"; path="+E:"")+(F?"; secure":"");
},removeItem:function(A,B){if(!A||!this.hasItem(A)){return;}document.cookie=escape(A)+"=; expires=Thu, 01 Jan 1970 00:00:00 GMT"+(B?"; path="+B:"");
},hasItem:function(A){return(new RegExp("(?:^|;\\s*)"+escape(A).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=")).test(document.cookie);
},keys:function(){var A=document.cookie.replace(/((?:^|\s*;)[^\=]+)(?=;|$)|^\s*|\s*(?:\=[^;]*)?(?:\1|$)/g,"").split(/\s*(?:\=[^;]*)?;\s*/);
for(var B=0;B<A.length;B++){A[B]=unescape(A[B]);}return A;}};if(typeof(clientVars)!="undefined"&&clientVars.padId){jQuery.ajaxPrefilter(function(A,C,B){if(A.url.indexOf("docx.qq.com")>-1||A.url.indexOf("docs.qq.com")>-1){A.url+=A.url.indexOf("?")>-1?"&tag="+clientVars.padId:"?tag="+clientVars.padId;
}});}var padtopbar=(function(){$(function(){var J=$("#createpadlink");var K=$("#createsheetlink");var B=$("#createpadentry");
if(B.autocomplete&&!B.hasClass("live")){var H=navigator.userAgent.toLowerCase().indexOf("iphone")!=-1;
if(window.location.pathname=="/"&&!H){B.focus();}function E(M){var L=padutils.escapeHtml(B.val());return[{data:["<span class='ac-results-see-all-prepended'>"+(M?Math.min(M,4)+" of "+M:"See all")+" results</span>","ep/search/search?q="+encodeURIComponent(L)],value:L,result:L}];
}function C(O,N){var M=padutils.escapeHtml(B.val());var L=[];if(M){if(!O){L=L.concat(E());}L.push({data:["<span class='ac-results-see-all ac-results-extra'>See all "+(N?N:"")+" results <i class='icon-forward'></i></span>","ep/search/search?q="+encodeURIComponent(M)],value:M,result:M});
}return L;}var D=4;function G(M){trackPageview("/virtual/search-results?q="+B.val());var Q="";var R=0;
if(M.success){Q=M.data;R=M.numFound;}else{modals.showHTMLModal(M.html);$("input").blur();return[];}var L=[];
L=L.concat(E(M.numFound));var P=Q.split("\n");for(var O=0;O<P.length&&O<D;O++){var N=$.trim(P[O]);if(N){N=N.split("|");
L.push({data:N,value:N[0],result:N[0]});}}logSearchPerformed(B.val(),R,"From pad");L=L.concat(C(true,M.numFound));
return L;}function I(L){return'<div class="ac-search-result">'+(L[2]?L[0]+'<div class="snippet">'+L[2]+"</div>":L[0])+"</div>";
}var F=B.length?Math.max($(window).width()-2*B.offset().left-27,B.width()+27):0;B.autocomplete("/ep/search/autocomplete",{max:D+4,scroll:false,parse:G,preparse:C,alwaysPreparse:true,delay:0,noCache:true,selectFirst:true,minCountForSelect:2,width:F+"px",formatItem:I}).result(function(P,L,Q,N,O){if(L[1].indexOf("ep/pad/newpad")!=-1){window.open("/"+L[1]+"&r="+(N-1),"_blank");
}else{var M;if(L[1].indexOf("?")==-1){M="/"+L[1]+"?r="+(N-1);}else{M="/"+L[1]+"&r="+(N-1);}if(O&&(O.metaKey||O.ctrlKey)){window.open(M,"_blank");
B.val("");}else{location.href=M;}}});B.on("input",function(){if($.trim(B.val())==""){logSearchPerformed("");
}});if(B.val()){B.trigger(($.browser.opera?"keypress":"keydown")+".autocomplete");}}B.on("focus",function(){B.parent().addClass("search-focused");
});B.on("blur",function(){B.parent().removeClass("search-focused");});});$(document).ready(function(){$(".banner-close").on("click",function(){$("body").removeClass($(this).parent().attr("id"));
$(this).remove();});$("#guest-banner-msg a").on("click",function(){modals.showModal("#page-login-box",0);
return false;});var G=new Date();var E=new Date();G.setTime(G.valueOf()+7*24*60*60*1000);E.setTime(E.valueOf()+30*24*60*60*1000);
if(!padutils.getIsMobile()){padutils.tooltip("body > header [data-tooltip], #site-toggle");padutils.tooltip("#toolbar [data-tooltip]",{timeOut:500});
}trackLinks("#createpadlink","toolbarClick",{command:"newpad"});trackLinks("#createsheetlink","toolbarClick",{command:"newsheet"});
var B=176;if($("body").hasClass("hasBanner")){var F=$(window);var D=$("#site-banner");var C=$("#padbar").outerHeight();
F.scroll(throttle(function(J){var I=F.scrollTop();var H=I/(B-C);if(H<1){D.css({height:B-I,opacity:1});
}else{D.css({height:C,opacity:Math.max(0,2-H)});}},33/2));if($("body").hasClass("propad")){setTimeout(function(){$(document).scrollTop(B/2);
},0);}}});var A={};return A;}());
/*
 * Copyright 2009 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS-IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var padutils={validUrlRe:new RegExp("^(?:https?|sftp|ftps?|ssh|ircs?|file|gopher|telnet|nntp|worldwind|chrome|chrome-extension|svn|git|mms|smb|afp|nfs|(x-)?man|gopher|txmt)://|^mailto:|^xmpp:|^sips?:|^tel:|^sms:|^news:|^bitcoin:|^magnet:|^urn:|^geo:|^/","i"),escapeHtml:function(B){var A=/[&<>'"]/g;
/']/;if(!A.MAP){A.MAP={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;","'":"&#39;"};}return B.replace(A,function(C){return A.MAP[C];
});},uniqueId:function(){function A(C,B){return(Array(B+1).join("0")+Number(C).toString(35)).slice(-B);
}return[pad.getClientIp(),A(+new Date,7),A(Math.floor(Math.random()*1000000000),4)].join(".");},getLength:function(C){var B=0;
for(var A=0;A<C.length;A++){var D=C.charCodeAt(A);if(D<=255){B+=1;}else{B+=2;}}return B;},splitString:function(A,E){var B="";
var H=padutils.getLength(A);var D=0;if(H<=E){B=A;}else{for(var C=0;C<A.length;C++){var F=A.charAt(C);
var G=A.charCodeAt(C);if(G<=255){D+=1;}else{D+=2;}if(D>(E)){B+="...";break;}else{B+=F;}}}return B;},getIsMobile:function(){return navigator.userAgent.toLowerCase().indexOf("iphone")!=-1||navigator.userAgent.toLowerCase().indexOf("ipad")!=-1||navigator.userAgent.toLowerCase().indexOf("android")!=-1||navigator.userAgent.toLowerCase().indexOf("ipod")!=-1;
},uaDisplay:function(B){var A;function D(G){var H=16;G=G.replace(/[^a-zA-Z0-9\.]/g,"");if(G.length>H){G=G.substr(0,H);
}return G;}function C(H){var G=B.match(RegExp(H+"\\/([\\d\\.]+)"));if(G&&G.length>1){return D(H+G[1]);
}return null;}if(C("Firefox")){return C("Firefox");}A=B.match(/compatible; ([^;]+);/);if(A&&A.length>1){return D(A[1]);
}if(B.match(/\(iPhone;/)){return"iPhone";}if(C("Chrome")){return C("Chrome");}A=B.match(/Safari\/[\d\.]+/);
if(A){var E="?";A=B.match(/Version\/([\d\.]+)/);if(A&&A.length>1){E=A[1];}return D("Safari"+E);}var F=B.split(" ")[0];
return D(F);},binarySearch:function(A,E){if(A<1){return 0;}if(E(0)){return 0;}if(!E(A-1)){return A;}var D=0;
var B=A-1;while((B-D)>1){var C=Math.floor((D+B)/2);if(E(C)){B=C;}else{D=C;}}return B;},simpleDateTime:function(C){var A=new Date(+C);
var B=(["Sun","Mon","Tue","Wed","Thu","Fri","Sat"])[A.getDay()];var F=(["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"])[A.getMonth()];
var E=A.getDate();var D=A.getFullYear();var G=A.getHours()+":"+("0"+A.getMinutes()).slice(-2);return B+" "+F+" "+E+" "+D+" "+G;
},findURLs:function(E){var D=/[\u0030-\u0039\u0041-\u005A\u0061-\u007A\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u00FF\u0100-\u1FFF\u3040-\u9FFF\uF900-\uFDFF\uFE70-\uFEFE\uFF10-\uFF19\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFDC]/;
var A=new RegExp("("+/[-:@a-zA-Z0-9_.,~%+\/?=&#;()$]/.source+"|"+D.source+")");var B=new RegExp(/(?:(?:https?|sftp|ftps?|ssh|ircs?|file|gopher|telnet|nntp|worldwind|chrome|chrome-extension|svn|git|mms|smb|afp|nfs|(x-)?man|gopher|txmt):\/\/|mailto:|xmpp:|sips?:|tel:|sms:|news:|bitcoin:|magnet:|urn:|geo:)/.source+A.source+"*(?![:.,;])"+A.source,"g");
function C(J){B.lastIndex=0;var F=null;var G;while((G=B.exec(J))){F=(F||[]);var I=G.index;var H=G[0];
F.push([I,H]);}return F;}return C(E);},isWhitelistUrlScheme:function(A){return padutils.validUrlRe.test(A);
},escapeHtmlWithClickableLinks:function(F,H){var E=0;var A=[];var C=padutils.findURLs(F);function D(J){if(J>E){A.push(padutils.escapeHtml(F.substring(E,J)));
E=J;}}if(C){for(var B=0;B<C.length;B++){var I=C[B][0];var G=C[B][1];D(I);A.push("<a ",(H?'target="'+H+'" ':""),'href="',G.replace(/\"/g,"&quot;"),'">');
D(I+G.length);A.push("</a>");}}D(F.length);return A.join("");},bindEnterAndEscape:function(B,A,C){if(A){B.keypress(function(D){if(D.which==13){A(D);
}});}if(C){B.keydown(function(D){if(D.which==27){C(D);}});}},timediff:function(A){function B(C,D){C=Math.round(C);
return(""+C+" "+D+(C!=1?"s":"")+" ago");}A=Math.max(0,(+(new Date)-(+A)-pad.clientTimeOffset)/1000);if(A<60){return B(A,"second");
}A/=60;if(A<60){return B(A,"minute");}A/=60;if(A<24){return B(A,"hour");}A/=24;return B(A,"day");},makeAnimationScheduler:function(E,D,A){if(A===undefined){A=1;
}var B=null;function C(){if(!B){B=window.setTimeout(function(){B=null;var G=A;var F=true;while(F&&G>0){F=E();
G--;}if(F){C();}},D*A);}}return{scheduleAnimation:C};},makeShowHideAnimator:function(B,F,H,J){var A=(F?0:-2);
var D=1000/H;var E=D/J;var C=padutils.makeAnimationScheduler(I,D).scheduleAnimation;function G(){A=-1;
B(A);C();}function K(){if(A<-1){A=-1;}else{if(A<=0){A=A;}else{A=Math.max(-1,Math.min(0,-A));}}B(A);C();
}function L(){if(A>=-1&&A<=0){A=0.000001;C();}}function I(){if(A<-1||A==0){return false;}else{if(A<0){A+=E;
if(A>=0){A=0;B(A);return false;}else{B(A);return true;}}else{if(A>0){A+=E;if(A>=1){A=1;B(A);A=-2;return false;
}else{B(A);return true;}}}}}return{show:G,hide:L,quickShow:K};},_nextActionId:1,uncanceledActions:{},getCancellableAction:function(B,D){var A=padutils.uncanceledActions[B];
if(!A){A={};padutils.uncanceledActions[B]=A;}var C=(padutils._nextActionId++);A[C]=true;return function(){var E=padutils.uncanceledActions[B];
if(E&&E[C]){D();}};},cancelActions:function(A){var B=padutils.uncanceledActions[A];if(B){delete padutils.uncanceledActions[A];
}},makeFieldLabeledWhenEmpty:function(A,C){A=$(A);function B(){A.addClass("editempty");A.val(C);}A.focus(function(){if(A.hasClass("editempty")){A.val("");
}A.removeClass("editempty");});A.blur(function(){if(!A.val()){B();}});return{clear:B};},getCheckbox:function(A){return $(A).is(":checked");
},setCheckbox:function(A,B){if(B){$(A).attr("checked","checked");}else{$(A).removeAttr("checked");}},bindCheckboxChange:function(B,A){$(B).bind("click change",A);
},encodeUserId:function(A){return A.replace(/[^a-y0-9]/g,function(B){if(B=="."){return"-";}return"z"+B.charCodeAt(0)+"z";
});},decodeUserId:function(A){return A.replace(/[a-y0-9]+|-|z.+?z/g,function(B){if(B=="-"){return".";
}else{if(B.charAt(0)=="z"){return String.fromCharCode(Number(B.slice(1,-1)));}else{return B;}}});},hideToolToast:function(B,A){if(!A){A=$("#toolToast:last");
}$(A).show().fadeOut(200);setTimeout(function(){A.remove();if($("#toolToast:last").filter(":visible").length==0){$("#toolToast:last").show();
}if(B){B();}},200);},toolToast:function(I,C,A,H){if(padutils.getIsMobile()){return;}$("#toolToast").hide();
var F=H?H:$("body");var B=$("<div id='toolToast'>").html(I).prependTo(F);if(A&&A.isNeedClose){var G=$("<div class='toast-colse'>");
B.append(G);G.hover(function(){$(this).addClass("toast-colse-hover");},function(){$(this).removeClass("toast-colse-hover");
});B.css("padding-right",30);G.click(function(){padutils.hideToolToast(A&&A.toolToastRemoveCallBack?A.toolToastRemoveCallBack:undefined);
});}if(A&&A.isNeedReflush){$(window).resize(function(){if(!C||!("left" in C)){D=F.outerWidth()/2-B.outerWidth()/2;
B.css({left:(D>0?D:0)});}if(!C||!("top" in C)){E=F.outerHeight()/2-B.outerHeight()/2;B.css({top:(E>0?E:0)});
}});}if(C){$.each(C,function(J,K){B.css(J,K);});}var E=F.outerHeight()/2-B.outerHeight()/2;var D=F.outerWidth()/2-B.outerWidth()/2;
B.css({zIndex:100000,left:(D>0?D:0),top:(E>0?E:0),});if(C){$.each(C,function(J,K){B.css(J,K);});}B.hide().fadeIn(200);
if(A&&A.toolToastCloseTime&&parseFloat(A.toolToastCloseTime)){setTimeout(function(){padutils.hideToolToast(A&&A.toolToastRemoveCallBack?A.toolToastRemoveCallBack:undefined,B);
},parseFloat(A.toolToastCloseTime));}},baseTooltip:function(selector,drawViewCallback,extendParam){if(padutils.getIsMobile()){return;
}$(selector).each(function(){$(this).off("mouseenter");$(this).off("mouseleave");});$(selector).mouseenter(function(e){if(padutils.setTimeoutId){clearTimeout(padutils.setTimeoutId);
padutils.setTimeoutId=0;}$("#tooltip").remove();var vtimeOut=0;if(extendParam&&extendParam.timeOut){vtimeOut=extendParam.timeOut;
}if(extendParam&&extendParam.showTtpInNeedScroll){if($(this)[0].scrollWidth<=$(this).outerWidth()){return;
}}handleElement=$(this);var setTimeoutId=setTimeout(function(){$("#tooltip").remove();var tooltipData=handleElement.data("tooltip")?handleElement.data("tooltip"):handleElement.attr("data-tooltip");
if((typeof tooltipData!="undefined")&&(typeof tooltipData!="string")){tooltipData=handleElement[0].getAttribute("data-tooltip");
}if(!tooltipData||handleElement.hasClass("hp-ui-button-active")){return;}if(extendParam&&extendParam.mouseenterCallBack){extendParam.mouseenterCallBack();
}if(tooltipData&&tooltipData.indexOf("()")&&tooltipData.indexOf("'")==0){var tempTooltipData=tooltipData;
try{tooltipData=eval(tooltipData);}catch(e){tooltipData=tempTooltipData;}}var tooltip=$("<div id='tooltip'>").text(tooltipData).prependTo($("body"));
var tooltip_taper_angle_Class="tooltip-before";if(extendParam){if(extendParam.tooltipArrowClass){tooltip_taper_angle_Class=extendParam.tooltipArrowClass;
}if(extendParam.tooltipClass&&!tooltip.hasClass(extendParam.tooltipClass)){tooltip.addClass(extendParam.tooltipClass);
}}var tooltip_taper_angle=$("<div id='"+tooltip_taper_angle_Class+"'>").prependTo(tooltip);drawViewCallback(tooltip,tooltip_taper_angle,handleElement);
},vtimeOut);if(vtimeOut>0){padutils.setTimeoutId=setTimeoutId;}});$(selector).mouseleave(function(){$("#tooltip").remove();
if(padutils.setTimeoutId){clearTimeout(padutils.setTimeoutId);padutils.setTimeoutId=0;}if(extendParam&&extendParam.mouseleaveCallBack){extendParam.mouseleaveCallBack();
}});},tooltip:function(A,B){return padutils.baseTooltip(A,function(E,G,C){if(C.siblings(".dropdown-wrapper.open").length>0||C.siblings(".toolbar-border-palette.open").length>0||(C.attr("id")=="toolbar-colorPicker-picker-wrapper"&&($.fn.colorPicker.isColorPaletteShow(1)))||(C.attr("id")=="toolbar-colorPicker-picker-paint-wrapper"&&($.fn.colorPicker.isColorPaletteShow(2)))){$("#tooltip").remove();
return;}var F=C.offset().top+C.outerHeight()+10;var D=C.offset().left+C.outerWidth()/2-E.outerWidth()/2;
if(D<0){G.css({left:E.outerWidth()/2+D});}E.css({top:F,left:(D>0?D:0),zIndex:100000}).hide().fadeIn();
},B);},horizontalTooltip:function(C,A,B){if(!A){A={};}if(!A.tooltipArrowClass){A.tooltipArrowClass="tooltip-right";
}return padutils.baseTooltip(C,function(D,H,E){if(B&&B.height){D.css("height",B.height);}else{D.css("height",(E.outerHeight()-6));
}D.css("line-height",D.css("height"));if(A&&A["min-width"]){D.css("min-width",A["min-width"]-16);}var G=E.offset().top;
var F;if($(H).get(0).id=="tooltip-right"){F=E.offset().left+E.outerWidth();}else{F=E.offset().left-D.outerWidth()-9;
}if(A&&A.left){F+=A.left;}if(G<0){H.css({top:D.outerHeight()/2+G});}D.css({top:(G>0?G:0),left:(F>0?F:0),zIndex:100000}).hide().fadeIn();
},A);},btnState:function(A,B,C){A.mousedown(function(D){$(this).addClass(C);$(this).removeClass(B);});
A.mouseup(function(D){$(this).removeClass(C);$(this).addClass(B);});A.mouseenter(function(D){$(this).addClass(B);
});A.mouseleave(function(D){$(this).removeClass(B+" "+C);});}};function showSpaces(E){var I=$(".domain-item-overflow .hp-ui-button-list-ul");
var F=$("#domain-list");var D=$(".domain-item-overflow");for(var G in E){var A=E[G];var B=$("<li>").addClass("domain-item").attr({"data-domainid":A.id,"data-orgname":A.orgName,"data-subdomain":A.subDomain,"data-lastlogindate":A.lastLoginDate});
var H=$("<a/>").attr("href",A.url).text(A.id==1?location.hostname:A.subDomain);if(location.href.indexOf(A.url)==0){B.addClass("selected");
}B.append(H);var C=$(".domain-item[data-domainid="+A.id+"]");if(C.length){$(C).replaceWith(B);}else{D.before(B);
}}F.prepend($("#domain-list .domain-item.selected").detach());F.prepend($("#domain-list .domain-item[data-domainid=1]").detach());
D.hide();}$(function(){$("#tencent-docx").html("在线文档");if(!$("#domain-list").length){return;}showSpaces(clientVars.initialSpaces||[]);
var B=$("#sitebar").height();$("body").removeClass("sitebar");$("input[name=name]").keyup(function(C){if(C.keyCode==13){return;
}if($(this).val()){$("input[name=shortname]").val($(this).val().replace(/\W/g,"").toLowerCase()).change().unplaceholder();
}});function A(){if($(this).val().indexOf(" ")>-1){$(this).val($(this).val().replace(" ",""));return false;
}if($(this).val()){$("#shortname").text($(this).val()).show();$("#shortname").parent().find("label.error").remove();
$("#shortname").removeClass().addClass("busy").show();$.get("/ep/api/subdomain-check",{subdomain:$(this).val()},function(C){if(C){$("#shortname").removeClass().addClass(C.exists?"taken":"available").show();
}});}else{}}$("input[name=shortname]").keyup(A).change(A);if(document.location.protocol=="https:"){$.getScript("https://ui.ptlogin2.qq.com/js/ptloginout.js");
}else{$.getScript("http://imgcache.qq.com/ptlogin/ac/v9/js/ptloginout.js");}$(".qq-logout").click(function(){pt_logout.logout(function(C){if(C=="2"){location.href="/ep/account/sign-out";
}});});});var modals=(function(){var A=false;var B={showModal:function(C,E,D){if(C=="#page-login-box"){console.log("showModal:page-login-box");
return;}if(navigator.userAgent.toLowerCase().indexOf("iphone")!=-1||navigator.userAgent.toLowerCase().indexOf("ipad")!=-1||navigator.userAgent.toLowerCase().indexOf("android")!=-1){$(window).scrollTop(0);
}$(C+" input[placeholder]").unplaceholder();$(".modaldialog").hide();$(C).css("display","block");setTimeout(function(){$(C).addClass("modal-ready");
},0);$(C+" input[placeholder]").placeholder();if(!$("#modaloverlay").length){$('<div id="modaloverlay"><div id="modaloverlay-inner"><!-- --></div></div>').appendTo("body");
}$("#modaloverlay").unbind("click");if(!D){$("#modaloverlay").click(function(){modals.hideModal(200);
});}A=(document.activeElement!=null&&document.activeElement.parentNode.id=="padeditor");$("#modaloverlay").stop(true,true).show().css({opacity:0}).animate({opacity:1},E);
document.activeElement&&document.activeElement.blur();$("input").blur();if($(C).find("input:visible").length){if(C!="#page-login-box"){$(C).find("input:visible")[0].focus();
}else{$(C).focus();}}else{$(C).focus();}trackEvent("showModal",C,null,{modalId:C,isPad:clientVars.padId?true:false,isEmbed:clientVars.isEmbed||false});
cspfixes.init();},showHTMLModal:function(D,F,E){if(D.selector=="#page-login-box"){console.log("showHTMLModal:page-login-box");
return;}var C=$(D);if(!$("#"+C.attr("id")).length){C.appendTo("body");C.addClass("disposeUponHide");}else{C=$($("#"+C.attr("id"))[0]);
}modals.showModal("#"+C.attr("id"),F,E);},hideModal:function(C){var D=$(".modaldialog:visible").attr("id");
$(".modaldialog").removeClass("modal-ready");setTimeout(function(){$(".modaldialog").css("display","none");
if($(this).hasClass("disposeUponHide")){$(this).remove();}},250);$("#modaloverlay").animate({opacity:0},C,function(){$("#modaloverlay").hide();
});if(A){padeditor.ace.focus();}},submitModal:function(C){if(!$(C).is(":visible")){return false;}var D=$(C).serialize();
$(C).parents().filter(".modaldialog").find(".error-message").remove();$("<div>").addClass("loading-indicator").css({position:"absolute",top:"10px",left:"10px"}).appendTo($(C).parents().filter(".modaldialog"));
$.post($(C).attr("action"),D,function(E){if(E.html){var F=$(E.html).appendTo("body");F.addClass("disposeUponHide");
$(C).trigger("closed");modals.showModal("#"+F.attr("id"),0);trackEvent("submitModalHtml",$(C).attr("action"));
}else{if(E.moreInfo){$(C).trigger("more-info");}else{if(E.error){showGlobalMsg(E.error);if(E.reset){$(C).trigger("reset");
C.reset();}trackEvent("submitModalError",$(C).attr("action"),E.error,{error:E.error});}else{if(E.success&&E.cont){trackEvent("submitModalSuccessCont",$(C).attr("action"),null,{cont:E.cont});
if(document.location.href==E.cont){document.location.reload();}else{document.location.href=E.cont;}}else{if(E.success){$(C).trigger("closed");
modals.hideModal(0);trackEvent("submitModalSuccess",$(C).attr("action"));}}}}}}).fail(function(E){$("<div/>").text("An error has occurred. We're looking into it.").addClass("error-message").appendTo($(C).parents().filter(".modaldialog"));
}).always(function(){$(C).parents().filter(".modaldialog").find(".loading-indicator").remove();});trackEvent("submitModal",$(C).attr("action"));
return false;}};return B;}());$(document).ready(function(){if($(".google-signin-button").length){trackLinks(".google-signin-button","google-signin");
}$(document).keydown(function(E){if(E.keyCode==27){modals.hideModal(0);}});$("#login-email").on("focus",function(){if(!$("#login-form").hasClass("active")){$("#login-email-go").fadeIn();
}});var C=function(){$("#login-form").find(".modal-more-info").show();$("#login-form").addClass("more-info-requested");
A();$("#login-forgot-password").hide();$("#login-form").attr("action","/ep/account/signup");$("#login-submit").text("Sign me up!");
};var D=function(){$("#login-form").find(".modal-more-info").hide();$("#login-form").removeClass("more-info-requested");
A();$("#login-forgot-password").show();$("#login-form").attr("action","/ep/account/signin");$("#login-submit").text("Start using Tencent Docs");
};$("#login-email").on("keypress",function(E){if(E.keyCode==13){$("#login-email-go").click();}});$("#login-email-go").on("click",function(){if(!$("#login-email").val()){return false;
}$("#login-email-go").fadeOut();$("<div>").addClass("loading-indicator").css({position:"absolute",top:"10px",left:"10px"}).appendTo($("#login-form").filter(".modaldialog"));
var E=function(G){if(!$("#login-form").hasClass("active")){var F=$("#login-email-wrapper").position().top;
$("#login-email-wrapper").css({position:"absolute",width:$("#login-email-wrapper").outerWidth(),top:$("#login-email-wrapper").position().top});
$("#login-email-wrapper").data("originalPositionTop",F);$("#login-google, #login-facebook, #login-or").fadeOut(400,function(){$("#login-email-wrapper").removeClass("no-transition").css("top","40px");
setTimeout(function(){$("#login-email-wrapper").addClass("no-transition").css({position:"relative",width:"100%",top:0});
$("#login-form").addClass("active");$("#login-email-secondary").fadeIn();$("#login-email-secondary .icon-back").fadeIn();
setTimeout(function(){$("#login-password").focus();},0);if(G){C();}else{D();}},200);});}};$.ajax({type:"post",url:"/ep/account/login-or-signup",data:{email:$("#login-email").val()},success:function(F){E(F.signup);
}}).always(function(){$("#login-form").filter(".modaldialog").find(".loading-indicator").remove();});
return false;});var B=function(){$("#login-email-secondary .icon-back").fadeOut();$("#login-email-secondary").fadeOut(400,function(){$("#login-form").removeClass("active");
$("#login-email-wrapper").css({position:"absolute",width:$("#login-email-wrapper").outerWidth(),top:"40px"});
setTimeout(function(){$("#login-email-wrapper").removeClass("no-transition").css("top",$("#login-email-wrapper").data("originalPositionTop"));
setTimeout(function(){$("#login-email-wrapper").addClass("no-transition").css({position:"relative",width:"100%",top:0});
$("#login-google, #login-facebook, #login-or").fadeIn();if($("#login-email").val()){$("#login-email-go").fadeIn();
}},200);},0);});};$("#login-email-secondary .icon-back").on("click",function(){B();});var A=function(){$("#login-submit").prop("disabled",!$("#login-email").val()||!$("#login-password").val()||($("#login-form").hasClass("more-info-requested")&&!$("#login-fullname").val()));
};$("#login-form").on("closed",function(E){B();});$("#login-form").on("reset",function(E){B();});$("#login-form").on("more-info",function(){C();
});$("#login-email, #login-password, #login-fullname").on("input",function(){A();});$("#login-form").validate({rules:{email:{required:true,email:true},password:{required:true}},errorPlacement:function(E,F){E.prependTo(F.parent().parent());
},submitHandler:function(E){modals.submitModal(E);}});});
/* TinySort 1.4.29
* Copyright (c) 2008-2012 Ron Valstar http://www.sjeiti.com/
*
* Dual licensed under the MIT and GPL licenses:
*   http://www.opensource.org/licenses/mit-license.php
*   http://www.gnu.org/licenses/gpl.html
*/
(function(A){var B=!1,C=null,H=parseFloat,J=Math.min,G=/(-?\d+\.?\d*)$/g,F=[],E=[];
A.tinysort={id:"TinySort",version:"1.4.29",copyright:"Copyright (c) 2008-2012 Ron Valstar",uri:"http://tinysort.sjeiti.com/",licensed:{MIT:"http://www.opensource.org/licenses/mit-license.php",GPL:"http://www.gnu.org/licenses/gpl.html"},plugin:function(K,L){F.push(K);
E.push(L);},defaults:{order:"asc",attr:C,data:C,useVal:B,place:"start",returns:B,cases:B,forceStrings:B,sortFunction:C}};
A.fn.extend({tinysort:function(L,V){if(L&&typeof(L)!="string"){V=L;L=C;}var K=A.extend({},A.tinysort.defaults,V),S,P=this,a=A(this).length,M={},Y=!(!L||L==""),d=!(K.attr===C||K.attr==""),g=K.data!==C,W=Y&&L[0]==":",c=W?P.filter(L):P,T=K.sortFunction,f=K.order=="asc"?1:-1,X=[];
A.each(F,function(j,h){h.call(h,K);});if(!T){T=K.order=="rand"?function(){return Math.random()<0.5?1:-1;
}:function(q,o){var p=B,j=!K.cases?D(q.s):q.s,h=!K.cases?D(o.s):o.s;if(!K.forceStrings){var m=j&&j.match(G),n=h&&h.match(G);
if(m&&n){var s=j.substr(0,j.length-m[0].length),r=h.substr(0,h.length-n[0].length);if(s==r){p=!B;j=H(m[0]);
h=H(n[0]);}}}var l=f*(j<h?-1:(j>h?1:0));A.each(E,function(v,u){l=u.call(u,p,j,h,l);});return l;};}P.each(function(m,n){var j=A(n),h=Y?(W?c.filter(n):j.find(L)):j,o=g?""+h.data(K.data):(d?h.attr(K.attr):(K.useVal?h.val():h.text())),l=j.parent();
if(!M[l]){M[l]={s:[],n:[]};}if(h.length>0){M[l].s.push({s:o,e:j,n:m});}else{M[l].n.push({e:j,n:m});}});
for(S in M){M[S].s.sort(T);}for(S in M){var N=M[S],b=[],Q=a,Z=[0,0],O;switch(K.place){case"first":A.each(N.s,function(j,h){Q=J(Q,h.n);
});break;case"org":A.each(N.s,function(j,h){b.push(h.n);});break;case"end":Q=N.n.length;break;default:Q=0;
}for(O=0;O<a;O++){var R=I(b,O)?!B:O>=Q&&O<Q+N.s.length,U=(R?N.s:N.n)[Z[R?0:1]].e;U.parent().append(U);
if(R||!K.returns){X.push(U.get(0));}Z[R?0:1]++;}}P.length=0;Array.prototype.push.apply(P,X);return P;
}});function D(K){return K&&K.toLowerCase?K.toLowerCase():K;}function I(L,N){for(var K=0,M=L.length;K<M;
K++){if(L[K]==N){return !B;}}return B;}A.fn.TinySort=A.fn.Tinysort=A.fn.tsort=A.fn.tinysort;})(jQuery);
/* Array.prototype.indexOf for IE (issue #26) */
if(!Array.prototype.indexOf){Array.prototype.indexOf=function(C){var B=this.length,A=Number(arguments[1])||0;
A=A<0?Math.ceil(A):Math.floor(A);if(A<0){A+=B;}for(;A<B;A++){if(A in this&&this[A]===C){return A;}}return -1;
};}function hideIphoneToolbar(){if(window.pageYOffset==0){window.scrollTo(window.pageXOffset,1);window.setTimeout(hideIphoneToolbar,1000);
}}var lastPageXOffset=0;$(function(){$("#friend-picker").attr("placeholder","name / email");if((navigator.userAgent.toLowerCase().indexOf("iphone")!=-1||navigator.userAgent.toLowerCase().indexOf("ipad")!=-1)&&!$("body").hasClass("mobile-app")){$(".title a").bind("click",function(){if(this.href){location.href=this.href;
return false;}});if(window.screen.height==568){document.querySelector("meta[name=viewport]").content="width=320.1";
}}});var cspfixes=(function(){function A(){$("*[data-click]").off("click.csp").on("click.csp",function(B){console.log("data-click handler:",this,B);
var G=$(this).attr("data-click");switch(G){case"connect-dropbox":document.location="/ep/dropbox/get-dropbox-auth-url";
return false;case"disconnect-dropbox":document.location="/ep/dropbox/disconnect";return false;case"showmodal":modals.showModal($(this).attr("data-modal"),500);
return false;case"hidemodal":modals.hideModal(0);return false;case"submitmodal":var F=$(this).attr("data-modal");
modals.submitModal(F);return false;case"highlight-pad-picker":$("#pad-picker").effect("pulsate",{times:1},300).focus();
return false;case"toggle-group-follow":toggleGroupFollow(this);return false;case"signin-account":var D=$(this).attr("data-id");
var C=$(this).attr("data-cont");var E="/ep/account/as?id="+D+"&cont="+C;$("<form/>").attr("action",E).attr("method","POST").appendTo(document.body).submit();
return false;case"highlight-input":$(this).find("input").select();return false;case"sitebar-open":$("body").toggleClass("sitebar-open");
return;case"preventdefault":B.preventDefault();return false;case"downloadpads":onDownloadPadsClick(B);
return false;case"cancelclick":if(!B.metaKey&&!B.ctrlKey&&B.button!=2){B.preventDefault();return false;
}break;case"pagereload":window.location.reload();return false;case"showembeddialog":pad.showEmbedDialog();
return false;case"deletepad":pad.deletePad();return false;case"deletegroup":deleteGroup();return false;
case"hideservermessage":pad.hideServerMessage();return false;}});$("*[data-submit]").off("submit.csp").on("submit.csp",function(C){var B=$(this).attr("data-submit");
if(B=="submitmodal"){return modals.submitModal(this);}});$("*[data-keyup]").off("keyup.csp").on("keyup.csp",function(C){var B=$(this).attr("data-keyup");
if(B=="maybecheckusedomain"){maybeCheckUseDomain();}});}return{init:A};})();$(document).ready(function(){cspfixes.init();
});
/*
 * jQuery Validation Plugin 1.8.0
 *
 * http://bassistance.de/jquery-plugins/jquery-plugin-validation/
 * http://docs.jquery.com/Plugins/Validation
 *
 * Copyright (c) 2006 - 2011 Jörn Zaefferer
 *
 * Dual licensed under the MIT and GPL licenses:
 *   http://www.opensource.org/licenses/mit-license.php
 *   http://www.gnu.org/licenses/gpl.html
 */
(function(A){A.extend(A.fn,{validate:function(C){if(!this.length){C&&C.debug&&window.console&&console.warn("nothing selected, can't validate, returning nothing");
return;}var B=A.data(this[0],"validator");if(B){return B;}B=new A.validator(C,this[0]);A.data(this[0],"validator",B);
if(B.settings.onsubmit){this.find("input, button").filter(".cancel").click(function(){B.cancelSubmit=true;
});if(B.settings.submitHandler){this.find("input, button").filter(":submit").click(function(){B.submitButton=this;
});}this.submit(function(E){if(B.settings.debug){E.preventDefault();}function D(){if(B.settings.submitHandler){if(B.submitButton){var F=A("<input type='hidden'/>").attr("name",B.submitButton.name).val(B.submitButton.value).appendTo(B.currentForm);
}B.settings.submitHandler.call(B,B.currentForm);if(B.submitButton){F.remove();}return false;}return true;
}if(B.cancelSubmit){B.cancelSubmit=false;return D();}if(B.form()){if(B.pendingRequest){B.formSubmitted=true;
return false;}return D();}else{B.focusInvalid();return false;}});}return B;},valid:function(){if(A(this[0]).is("form")){return this.validate().form();
}else{var B=true;var C=A(this[0].form).validate();this.each(function(){B&=C.element(this);});return B;
}},removeAttrs:function(D){var B={},C=this;A.each(D.split(/\s/),function(F,E){B[E]=C.attr(E);C.removeAttr(E);
});return B;},rules:function(G,D){var B=this[0];if(G){var F=A.data(B.form,"validator").settings;var I=F.rules;
var E=A.validator.staticRules(B);switch(G){case"add":A.extend(E,A.validator.normalizeRule(D));I[B.name]=E;
if(D.messages){F.messages[B.name]=A.extend(F.messages[B.name],D.messages);}break;case"remove":if(!D){delete I[B.name];
return E;}var H={};A.each(D.split(/\s/),function(L,K){H[K]=E[K];delete E[K];});return H;}}var C=A.validator.normalizeRules(A.extend({},A.validator.metadataRules(B),A.validator.classRules(B),A.validator.attributeRules(B),A.validator.staticRules(B)),B);
if(C.required){var J=C.required;delete C.required;C=A.extend({required:J},C);}return C;}});A.extend(A.expr[":"],{blank:function(B){return !A.trim(""+B.value);
},filled:function(B){return !!A.trim(""+B.value);},unchecked:function(B){return !B.checked;}});A.validator=function(B,C){this.settings=A.extend(true,{},A.validator.defaults,B);
this.currentForm=C;this.init();};A.validator.format=function(C,B){if(arguments.length==1){return function(){var D=A.makeArray(arguments);
D.unshift(C);return A.validator.format.apply(this,D);};}if(arguments.length>2&&B.constructor!=Array){B=A.makeArray(arguments).slice(1);
}if(B.constructor!=Array){B=[B];}A.each(B,function(D,E){C=C.replace(new RegExp("\\{"+D+"\\}","g"),E);
});return C;};A.extend(A.validator,{defaults:{messages:{},groups:{},rules:{},errorClass:"error",validClass:"valid",errorElement:"label",focusInvalid:true,errorContainer:A([]),errorLabelContainer:A([]),onsubmit:true,ignore:[],ignoreTitle:false,onfocusin:function(B){this.lastActive=B;
if(this.settings.focusCleanup&&!this.blockFocusCleanup){this.settings.unhighlight&&this.settings.unhighlight.call(this,B,this.settings.errorClass,this.settings.validClass);
this.addWrapper(this.errorsFor(B)).hide();}},onfocusout:function(B){if(!this.checkable(B)&&(B.name in this.submitted||!this.optional(B))){this.element(B);
}},onkeyup:function(B){if(B.name in this.submitted||B==this.lastElement){this.element(B);}},onclick:function(B){if(B.name in this.submitted){this.element(B);
}else{if(B.parentNode.name in this.submitted){this.element(B.parentNode);}}},highlight:function(D,B,C){A(D).addClass(B).removeClass(C);
},unhighlight:function(D,B,C){A(D).removeClass(B).addClass(C);}},setDefaults:function(B){A.extend(A.validator.defaults,B);
},messages:{required:"This field is required.",remote:"Please fix this field.",email:"Please enter a valid email address.",url:"Please enter a valid URL.",date:"Please enter a valid date.",dateISO:"Please enter a valid date (ISO).",number:"Please enter a valid number.",digits:"Please enter only digits.",creditcard:"Please enter a valid credit card number.",equalTo:"Please enter the same value again.",accept:"Please enter a value with a valid extension.",maxlength:A.validator.format("Please enter no more than {0} characters."),minlength:A.validator.format("Please enter at least {0} characters."),rangelength:A.validator.format("Please enter a value between {0} and {1} characters long."),range:A.validator.format("Please enter a value between {0} and {1}."),max:A.validator.format("Please enter a value less than or equal to {0}."),min:A.validator.format("Please enter a value greater than or equal to {0}.")},autoCreateRanges:false,prototype:{init:function(){this.labelContainer=A(this.settings.errorLabelContainer);
this.errorContext=this.labelContainer.length&&this.labelContainer||A(this.currentForm);this.containers=A(this.settings.errorContainer).add(this.settings.errorLabelContainer);
this.submitted={};this.valueCache={};this.pendingRequest=0;this.pending={};this.invalid={};this.reset();
var D=(this.groups={});A.each(this.settings.groups,function(E,F){A.each(F.split(/\s/),function(H,G){D[G]=E;
});});var C=this.settings.rules;A.each(C,function(E,F){C[E]=A.validator.normalizeRule(F);});function B(G){var E=A.data(this[0].form,"validator"),F="on"+G.type.replace(/^validate/,"");
E.settings[F]&&E.settings[F].call(E,this[0]);}A(this.currentForm).validateDelegate(":text, :password, :file, select, textarea","focusin focusout keyup",B).validateDelegate(":radio, :checkbox, select, option","click",B);
if(this.settings.invalidHandler){A(this.currentForm).bind("invalid-form.validate",this.settings.invalidHandler);
}},form:function(){this.checkForm();A.extend(this.submitted,this.errorMap);this.invalid=A.extend({},this.errorMap);
if(!this.valid()){A(this.currentForm).triggerHandler("invalid-form",[this]);}this.showErrors();return this.valid();
},checkForm:function(){this.prepareForm();for(var B=0,C=(this.currentElements=this.elements());C[B];B++){this.check(C[B]);
}return this.valid();},element:function(B){B=this.clean(B);this.lastElement=B;this.prepareElement(B);
this.currentElements=A(B);var C=this.check(B);if(C){delete this.invalid[B.name];}else{this.invalid[B.name]=true;
}if(!this.numberOfInvalids()){this.toHide=this.toHide.add(this.containers);}this.showErrors();return C;
},showErrors:function(B){if(B){A.extend(this.errorMap,B);this.errorList=[];for(var C in B){this.errorList.push({message:B[C],element:this.findByName(C)[0]});
}this.successList=A.grep(this.successList,function(D){return !(D.name in B);});}this.settings.showErrors?this.settings.showErrors.call(this,this.errorMap,this.errorList):this.defaultShowErrors();
},resetForm:function(){if(A.fn.resetForm){A(this.currentForm).resetForm();}this.submitted={};this.prepareForm();
this.hideErrors();this.elements().removeClass(this.settings.errorClass);},numberOfInvalids:function(){return this.objectLength(this.invalid);
},objectLength:function(C){var B=0;for(var D in C){B++;}return B;},hideErrors:function(){this.addWrapper(this.toHide).hide();
},valid:function(){return this.size()==0;},size:function(){return this.errorList.length;},focusInvalid:function(){if(this.settings.focusInvalid){try{A(this.findLastActive()||this.errorList.length&&this.errorList[0].element||[]).filter(":visible").focus().trigger("focusin");
}catch(B){}}},findLastActive:function(){var B=this.lastActive;return B&&A.grep(this.errorList,function(C){return C.element.name==B.name;
}).length==1&&B;},elements:function(){var C=this,B={};return A([]).add(this.currentForm.elements).filter(":input").not(":submit, :reset, :image, [disabled]").not(this.settings.ignore).filter(function(){!this.name&&C.settings.debug&&window.console&&console.error("%o has no name assigned",this);
if(this.name in B||!C.objectLength(A(this).rules())){return false;}B[this.name]=true;return true;});},clean:function(B){return A(B)[0];
},errors:function(){return A(this.settings.errorElement+"."+this.settings.errorClass,this.errorContext);
},reset:function(){this.successList=[];this.errorList=[];this.errorMap={};this.toShow=A([]);this.toHide=A([]);
this.currentElements=A([]);},prepareForm:function(){this.reset();this.toHide=this.errors().add(this.containers);
},prepareElement:function(B){this.reset();this.toHide=this.errorsFor(B);},check:function(B){B=this.clean(B);
if(this.checkable(B)){B=this.findByName(B.name).not(this.settings.ignore)[0];}var G=A(B).rules();var D=false;
for(var H in G){var F={method:H,parameters:G[H]};try{var C=A.validator.methods[H].call(this,B.value.replace(/\r/g,""),B,F.parameters);
if(C=="dependency-mismatch"){D=true;continue;}D=false;if(C=="pending"){this.toHide=this.toHide.not(this.errorsFor(B));
return;}if(!C){this.formatAndAdd(B,F);return false;}}catch(E){this.settings.debug&&window.console&&console.log("exception occured when checking element "+B.id+", check the '"+F.method+"' method",E);
throw E;}}if(D){return;}if(this.objectLength(G)){this.successList.push(B);}return true;},customMetaMessage:function(C,D){if(!A.metadata){return;
}var B=this.settings.meta?A(C).metadata()[this.settings.meta]:A(C).metadata();return B&&B.messages&&B.messages[D];
},customMessage:function(C,D){var B=this.settings.messages[C];return B&&(B.constructor==String?B:B[D]);
},findDefined:function(){for(var B=0;B<arguments.length;B++){if(arguments[B]!==undefined){return arguments[B];
}}return undefined;},defaultMessage:function(B,C){return this.findDefined(this.customMessage(B.name,C),this.customMetaMessage(B,C),!this.settings.ignoreTitle&&B.title||undefined,A.validator.messages[C],"<strong>Warning: No message defined for "+B.name+"</strong>");
},formatAndAdd:function(C,D){var B=this.defaultMessage(C,D.method),E=/\$?\{(\d+)\}/g;if(typeof B=="function"){B=B.call(this,D.parameters,C);
}else{if(E.test(B)){B=jQuery.format(B.replace(E,"{$1}"),D.parameters);}}this.errorList.push({message:B,element:C});
this.errorMap[C.name]=B;this.submitted[C.name]=B;},addWrapper:function(B){if(this.settings.wrapper){B=B.add(B.parent(this.settings.wrapper));
}return B;},defaultShowErrors:function(){for(var B=0;this.errorList[B];B++){var C=this.errorList[B];this.settings.highlight&&this.settings.highlight.call(this,C.element,this.settings.errorClass,this.settings.validClass);
this.showLabel(C.element,C.message);}if(this.errorList.length){this.toShow=this.toShow.add(this.containers);
}if(this.settings.success){for(var B=0;this.successList[B];B++){this.showLabel(this.successList[B]);}}if(this.settings.unhighlight){for(var B=0,D=this.validElements();
D[B];B++){this.settings.unhighlight.call(this,D[B],this.settings.errorClass,this.settings.validClass);
}}this.toHide=this.toHide.not(this.toShow);this.hideErrors();this.addWrapper(this.toShow).show();},validElements:function(){return this.currentElements.not(this.invalidElements());
},invalidElements:function(){return A(this.errorList).map(function(){return this.element;});},showLabel:function(C,D){var B=this.errorsFor(C);
if(B.length){B.removeClass().addClass(this.settings.errorClass);B.attr("generated")&&B.html(D);}else{B=A("<"+this.settings.errorElement+"/>").attr({"for":this.idOrName(C),generated:true}).addClass(this.settings.errorClass).html(D||"");
if(this.settings.wrapper){B=B.hide().show().wrap("<"+this.settings.wrapper+"/>").parent();}if(!this.labelContainer.append(B).length){this.settings.errorPlacement?this.settings.errorPlacement(B,A(C)):B.insertAfter(C);
}}if(!D&&this.settings.success){B.text("");typeof this.settings.success=="string"?B.addClass(this.settings.success):this.settings.success(B);
}this.toShow=this.toShow.add(B);},errorsFor:function(C){var B=this.idOrName(C);return this.errors().filter(function(){return A(this).attr("for")==B;
});},idOrName:function(B){return this.groups[B.name]||(this.checkable(B)?B.name:B.id||B.name);},checkable:function(B){return/radio|checkbox/i.test(B.type);
},findByName:function(B){var C=this.currentForm;return A(document.getElementsByName(B)).map(function(E,D){return D.form==C&&D.name==B&&D||null;
});},getLength:function(C,B){switch(B.nodeName.toLowerCase()){case"select":return A("option:selected",B).length;
case"input":if(this.checkable(B)){return this.findByName(B.name).filter(":checked").length;}}return C.length;
},depend:function(B,C){return this.dependTypes[typeof B]?this.dependTypes[typeof B](B,C):true;},dependTypes:{"boolean":function(B,C){return B;
},string:function(C,B){return !!A(C,B.form).length;},"function":function(C,B){return C(B);}},optional:function(B){return !A.validator.methods.required.call(this,A.trim(B.value),B)&&"dependency-mismatch";
},startRequest:function(B){if(!this.pending[B.name]){this.pendingRequest++;this.pending[B.name]=true;
}},stopRequest:function(C,B){this.pendingRequest--;if(this.pendingRequest<0){this.pendingRequest=0;}delete this.pending[C.name];
if(B&&this.pendingRequest==0&&this.formSubmitted&&this.form()){A(this.currentForm).submit();this.formSubmitted=false;
}else{if(!B&&this.pendingRequest==0&&this.formSubmitted){A(this.currentForm).triggerHandler("invalid-form",[this]);
this.formSubmitted=false;}}},previousValue:function(B){return A.data(B,"previousValue")||A.data(B,"previousValue",{old:null,valid:true,message:this.defaultMessage(B,"remote")});
}},classRuleSettings:{required:{required:true},email:{email:true},url:{url:true},date:{date:true},dateISO:{dateISO:true},dateDE:{dateDE:true},number:{number:true},numberDE:{numberDE:true},digits:{digits:true},creditcard:{creditcard:true}},addClassRules:function(B,C){B.constructor==String?this.classRuleSettings[B]=C:A.extend(this.classRuleSettings,B);
},classRules:function(D){var C={};var B=A(D).attr("class");B&&A.each(B.split(" "),function(){if(this in A.validator.classRuleSettings){A.extend(C,A.validator.classRuleSettings[this]);
}});return C;},attributeRules:function(F){var B={};var E=A(F);for(var D in A.validator.methods){var C=E.attr(D);
if(C){B[D]=C;}}if(B.maxlength&&/-1|2147483647|524288/.test(B.maxlength)){delete B.maxlength;}return B;
},metadataRules:function(B){if(!A.metadata){return{};}var C=A.data(B.form,"validator").settings.meta;
return C?A(B).metadata()[C]:A(B).metadata();},staticRules:function(C){var D={};var B=A.data(C.form,"validator");
if(B.settings.rules){D=A.validator.normalizeRule(B.settings.rules[C.name])||{};}return D;},normalizeRules:function(B,C){A.each(B,function(F,D){if(D===false){delete B[F];
return;}if(D.param||D.depends){var E=true;switch(typeof D.depends){case"string":E=!!A(D.depends,C.form).length;
break;case"function":E=D.depends.call(C,C);break;}if(E){B[F]=D.param!==undefined?D.param:true;}else{delete B[F];
}}});A.each(B,function(E,D){B[E]=A.isFunction(D)?D(C):D;});A.each(["minlength","maxlength","min","max"],function(){if(B[this]){B[this]=Number(B[this]);
}});A.each(["rangelength","range"],function(){if(B[this]){B[this]=[Number(B[this][0]),Number(B[this][1])];
}});if(A.validator.autoCreateRanges){if(B.min&&B.max){B.range=[B.min,B.max];delete B.min;delete B.max;
}if(B.minlength&&B.maxlength){B.rangelength=[B.minlength,B.maxlength];delete B.minlength;delete B.maxlength;
}}if(B.messages){delete B.messages;}return B;},normalizeRule:function(B){if(typeof B=="string"){var C={};
A.each(B.split(/\s/),function(){C[this]=true;});B=C;}return B;},addMethod:function(B,D,C){A.validator.methods[B]=D;
A.validator.messages[B]=C!=undefined?C:A.validator.messages[B];if(D.length<3){A.validator.addClassRules(B,A.validator.normalizeRule(B));
}},methods:{required:function(C,B,E){if(!this.depend(E,B)){return"dependency-mismatch";}switch(B.nodeName.toLowerCase()){case"select":var D=A(B).val();
return D&&D.length>0;case"input":if(this.checkable(B)){return this.getLength(C,B)>0;}default:return A.trim(C).length>0;
}},remote:function(F,B,E){if(this.optional(B)){return"dependency-mismatch";}var D=this.previousValue(B);
if(!this.settings.messages[B.name]){this.settings.messages[B.name]={};}D.originalMessage=this.settings.messages[B.name].remote;
this.settings.messages[B.name].remote=D.message;E=typeof E=="string"&&{url:E}||E;if(this.pending[B.name]){return"pending";
}if(D.old===F){return D.valid;}D.old=F;var C=this;this.startRequest(B);var G={};G[B.name]=F;A.ajax(A.extend(true,{url:E,mode:"abort",port:"validate"+B.name,dataType:"json",data:G,success:function(J){C.settings.messages[B.name].remote=D.originalMessage;
var I=J===true;if(I){var L=C.formSubmitted;C.prepareElement(B);C.formSubmitted=L;C.successList.push(B);
C.showErrors();}else{var K={};var H=J||C.defaultMessage(B,"remote");K[B.name]=D.message=A.isFunction(H)?H(F):H;
C.showErrors(K);}D.valid=I;C.stopRequest(B,I);}},E));return"pending";},minlength:function(C,B,D){return this.optional(B)||this.getLength(A.trim(C),B)>=D;
},maxlength:function(C,B,D){return this.optional(B)||this.getLength(A.trim(C),B)<=D;},rangelength:function(E,B,D){var C=this.getLength(A.trim(E),B);
return this.optional(B)||(C>=D[0]&&C<=D[1]);},min:function(C,B,D){return this.optional(B)||C>=D;},max:function(C,B,D){return this.optional(B)||C<=D;
},range:function(B,D,C){return this.optional(D)||(B>=C[0]&&B<=C[1]);},email:function(C,B){return this.optional(B)||/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i.test(C);
},url:function(C,B){return this.optional(B)||/^(https?|ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(\#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i.test(C);
},date:function(C,B){return this.optional(B)||!/Invalid|NaN/.test(new Date(C));},dateISO:function(C,B){return this.optional(B)||/^\d{4}[\/-]\d{1,2}[\/-]\d{1,2}$/.test(C);
},number:function(C,B){return this.optional(B)||/^-?(?:\d+|\d{1,3}(?:,\d{3})+)(?:\.\d+)?$/.test(C);},digits:function(C,B){return this.optional(B)||/^\d+$/.test(C);
},creditcard:function(B,G){if(this.optional(G)){return"dependency-mismatch";}if(/[^0-9-]+/.test(B)){return false;
}var F=0,D=0,C=false;B=B.replace(/\D/g,"");for(var E=B.length-1;E>=0;E--){var H=B.charAt(E);var D=parseInt(H,10);
if(C){if((D*=2)>9){D-=9;}}F+=D;C=!C;}return(F%10)==0;},accept:function(D,C,B){B=typeof B=="string"?B.replace(/,/g,"|"):"png|jpe?g|gif";
return this.optional(C)||D.match(new RegExp(".("+B+")$","i"));},equalTo:function(C,B,E){var D=A(E).unbind(".validate-equalTo").bind("blur.validate-equalTo",function(){A(B).valid();
});return C==D.val();}}});A.format=A.validator.format;})(jQuery);(function(B){var A={};if(B.ajaxPrefilter){B.ajaxPrefilter(function(E,G,F){var D=E.port;
if(E.mode=="abort"){if(A[D]){A[D].abort();}A[D]=F;}});}else{var C=B.ajax;B.ajax=function(D){var F=("mode" in D?D:B.ajaxSettings).mode,E=("port" in D?D:B.ajaxSettings).port;
if(F=="abort"){if(A[E]){A[E].abort();}return(A[E]=C.apply(this,arguments));}return C.apply(this,arguments);
};}})(jQuery);(function(A){if(!jQuery.event.special.focusin&&!jQuery.event.special.focusout&&document.addEventListener){A.each({focus:"focusin",blur:"focusout"},function(C,B){A.event.special[B]={setup:function(){this.addEventListener(C,D,true);
},teardown:function(){this.removeEventListener(C,D,true);},handler:function(E){arguments[0]=A.event.fix(E);
arguments[0].type=B;return A.event.handle.apply(this,arguments);}};function D(E){E=A.event.fix(E);E.type=B;
return A.event.handle.call(this,E);}});}A.extend(A.fn,{validateDelegate:function(D,C,B){return this.bind(C,function(F){var E=A(F.target);
if(E.is(D)){return B.apply(E,arguments);}});}});})(jQuery);
/*
jQuery Placeholder 1.1.1

Copyright (c) 2010 Michael J. Ryan (http://tracker1.info/)

Dual licensed under the MIT and GPL licenses:
	http://www.opensource.org/licenses/mit-license.php
	http://www.gnu.org/licenses/gpl.html

------------------------------------------------------------------------------

Sets up a watermark for inputted fields... this will create a LABEL.watermark 
tag immediately following the input tag, the positioning will be set absolute, 
and it will be positioned to match the input tag.

To activate on all tags with a 'data-watermark' attribute:

	$('input[placeholder],textarea[placeholder]').placeholder();


To style the tags as appropriate (you'll want to make sure the font matches):

	label.placeholder {
		cursor: text;				<--- display a cursor to match the text input

		padding: 4px 4px 4px 4px;   <--- this should match the border+padding 
											for the input field(s)
		color: #999999;				<--- this will display as faded
	}

You'll also want to have the color set for browsers with native support
	input:placeholder, textarea:placeholder {
		color: #999999;
	}
	input::-webkit-input-placeholder, textarea::-webkit-input-placeholder {
		color: #999999;
	}

------------------------------------------------------------------------------

Thanks to...
	http://www.alistapart.com/articles/makingcompactformsmoreaccessible
	http://plugins.jquery.com/project/overlabel

	This works similar to the overlabel, but creates the actual label tag
	based on a data-watermark attribute on the input tag, instead of 
	relying on the markup to provide it.

*****************************************************************************/
(function(A){var B="PLACEHOLDER-INPUT";
var C="PLACEHOLDER-LABEL";var G=false;var I={labelClass:"placeholder"};var F=document.createElement("input");
if("placeholder" in F){A.fn.placeholder=A.fn.unplaceholder=function(){};delete F;return;}delete F;A.fn.placeholder=function(K){H();
var J=A.extend(I,K);this.each(function(){var N=Math.random().toString(32).replace(/\./,""),L=A(this),M=A('<label style="position:absolute;display:none;top:0;left:0;"></label>');
if(!L.attr("placeholder")){return;}if(L.data(B)===B){D.call(this);E.call(this);return;}if(!L.attr("id")){L.attr("id","input_"+N);
}M.attr("id",L.attr("id")+"_placeholder").data(B,"#"+L.attr("id")).attr("for",L.attr("id")).css("fontSize",L.css("fontSize")).css("lineHeight",L.css("height")).addClass(J.labelClass).addClass(J.labelClass+"-for-"+this.tagName.toLowerCase()).addClass(C).text(L.attr("placeholder"));
M.click(function(){A(this).focus();});L.data(C,"#"+M.attr("id")).data(B,B).addClass(B).after(M);D.call(this);
E.call(this);});};A.fn.unplaceholder=function(){this.each(function(){var J=A(this),K=A(J.data(C));if(J.data(B)!==B){return;
}K.remove();J.removeData(B).removeData(C).removeClass(B);});};function H(){if(G){return;}A("."+B).live("keydown",D).live("focusout",E);
bound=true;G=true;}function D(){var J=A(this),K=A(J.data(C));K.css("display","none");}function E(){var J=this;
setTimeout(function(){var K=A(J);A(K.data(C)).css("top",K.position().top+"px").css("left",K.position().left+"px").css("display",!!K.val()?"none":"block");
},200);}}(jQuery));$(document).ready(function(){var A=true;$(".tab_content").show();$(".tab_content:first-child").show();
if($(".tab_content:first-child").find("input:visible").length){$(".tab_content:first-child").find("input:visible")[0].focus();
}$("ul.tabs li").click(function(){var B=$(this).parents(".tab_wrapper");$(this).parents("ul.tabs").find("li").removeClass("active");
$(this).addClass("active");B.find(".tab_content").hide();B.find(".tab_content").find("input").unplaceholder();
var C=$(this).find("a").attr("href");var D=function(){B.find("input[placeholder]:visible").placeholder();
if(B.find("input:visible").length){if(!A){B.find("input:visible")[0].focus();}}};B.find(C).fadeIn();D();
if(window[$(C).attr("id")+"_onactivate"]){window[$(C).attr("id")+"_onactivate"]();}return false;});$("ul.tabs li[selected]").click();
A=false;});function tab1_onactivate(){if(!$("#signin-form input[name=email]").val()){$("#signin-form input[name=email]").val($("#signup-form input[name=email]").val());
}if(!$("#signin-form input[name=password]").val()){$("#signin-form input[name=password]").val($("#signup-form input[name=password]").val());
}}var home=new (function(){this.initFriendPicker=function(){$("#friend-picker.invite-to-site").invite({target:"Site",dataURL:"/ep/invite/autocomplete?emailonly=1",inviteItemHandlers:{fb:{callback:function(A){}},"*":{callback:function(A){var D=$("#friend-picker.invite-to-site");
D.addClass("ac_loading");var B;var C;if(A[3]=="typedemail"){B=A[1];C=A[1];}else{if(A[3]=="email"){C=A[1].split("<span ")[0];
B=A[2];}}if(!B){alert("This does not look like a valid email address.");return;}if(!clientVars.isAdmin){var E=confirm("You are about to grant full site access to <"+B+">. An admin will be informed. Continue?");
if(!E){return;}}$.post("/ep/invite/invite",{email:B,fullName:C},function(F){if(typeof(F)=="object"&&"success" in F&&F.success==false){alert(F.message);
}else{$("#domain-members").refresh(function(){home.initFriendPicker();$("input[placeholder]").placeholder();
$("#friend-picker.invite-to-site").focus();});}}).fail(function(){alert("An error has occured. Please contact support if this error persists.");
}).always(function(){D.removeClass("ac_loading");});}}}});};this.init=function(){$(".signup-form-toggle").click(function(){$("#nofacebooksignup").toggle();
$("input[placeholder]:visible").placeholder();$("#signup-form #name").focus();return false;});$("#signin-button, #features-signup-button, .signin-button").click(function(){$(".signin-tab").click();
modals.showModal("#page-login-box",0);$("input").blur();});$("#signup-button").click(function(){$(".signup-tab").click();
modals.showModal("#page-login-box",0);$("input").blur();});$("#get-started-button").click(function(){location.href="/AWELCOMEPAD";
});$("#featured-screenshot img").click(function(){location.href="/AWELCOMEPAD";});if($("#presslogos a").length){trackLinks("#presslogos a","presslogo");
}if($("#friend-picker.invite-to-site").length){this.initFriendPicker();}};return this;})();$(document).ready(function(){home.init();
});
/*
 * Copyright 2009 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS-IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
$(document).ready(function(){etherpad.deobfuscateEmails();
$("input[placeholder]").placeholder();if(padmodals){padmodals.initFeedback();}});etherpad={};etherpad.validEmail=function(A){return(A.length>0&&A.match(/^[\w\.\_\+\-]+\@[\w\_\-]+\.[\w\_\-\.]+$/));
};etherpad.doOnceCallbacks={};etherpad.doOnce=function(A,B){if(!etherpad.doOnceCallbacks[A]){etherpad.doOnceCallbacks[A]=true;
B();}};etherpad.deobfuscateEmails=function(){$("a.obfuscemail").each(function(){$(this).html($(this).html().replace("e***rp*d","tencent"));
this.href=this.href.replace("e***rp*d","tencent");});};var didLogError=false;etherpad.logError=function(F,D,B,E,A){if(didLogError){return;
}didLogError=true;var C=new Image();C.src="/ep/api/errors?"+$.param({random:Math.random(),context:navigator.userAgent,message:F,file:D,line:B,column:E,url:window.location.href,errorObj:A?A.stack:""});
};$.fn.refresh=function(A){return this.each(function(){$(this).load($(this).attr("src"),{},function(){$(this).children().unwrap();
if(A){return A();}});});};
/*
 * Copyright 2009 Google Inc.
 * 
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 * 
 *      http://www.apache.org/licenses/LICENSE-2.0
 * 
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS-IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
if(!this.JSON){JSON={};
}(function(){function C(J){return J<10?"0"+J:J;}if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(J){return this.getUTCFullYear()+"-"+C(this.getUTCMonth()+1)+"-"+C(this.getUTCDate())+"T"+C(this.getUTCHours())+":"+C(this.getUTCMinutes())+":"+C(this.getUTCSeconds())+"Z";
};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(J){return this.valueOf();
};}var G=/[\u0000-\u001f\u007f-\uffff]/g,H=/[\\\"\u0000-\u001f\u007f-\uffff]/g,A,D,I={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},B;
function F(J){H.lastIndex=0;return H.test(J)?'"'+J.replace(H,function(K){var L=I[K];if(typeof L==="string"){return L;
}return"\\u"+("0000"+K.charCodeAt(0).toString(16)).slice(-4);})+'"':'"'+J+'"';}function E(Q,R){var M,N,L,O,P=A,K,J=R[Q];
if(J&&typeof J==="object"&&typeof J.toJSON==="function"){J=J.toJSON(Q);}if(typeof B==="function"){J=B.call(R,Q,J);
}switch(typeof J){case"string":return F(J);case"number":return isFinite(J)?String(J):"null";case"boolean":case"null":return String(J);
case"object":if(!J){return"null";}A+=D;K=[];if(typeof J.length==="number"&&!J.propertyIsEnumerable("length")){O=J.length;
for(M=0;M<O;M+=1){K[M]=E(M,J)||"null";}L=K.length===0?"[]":A?"[\n"+A+K.join(",\n"+A)+"\n"+P+"]":"["+K.join(",")+"]";
A=P;return L;}if(B&&typeof B==="object"){O=B.length;for(M=0;M<O;M+=1){N=B[M];if(typeof N==="string"){L=E(N,J);
if(L){K.push(F(N)+(A?": ":":")+L);}}}}else{for(N in J){if(Object.hasOwnProperty.call(J,N)){L=E(N,J);if(L){K.push(F(N)+(A?": ":":")+L);
}}}}L=K.length===0?"{}":A?"{\n"+A+K.join(",\n"+A)+"\n"+P+"}":"{"+K.join(",")+"}";A=P;return L;}}if(typeof JSON.stringify!=="function"){JSON.stringify=function(M,J,K){var L;
A="";D="";if(typeof K==="number"){for(L=0;L<K;L+=1){D+=" ";}}else{if(typeof K==="string"){D=K;}}B=J;if(J&&typeof J!=="function"&&(typeof J!=="object"||typeof J.length!=="number")){throw new Error("JSON.stringify");
}return E("",{"":M});};}if(typeof JSON.parse!=="function"){JSON.parse=function(J,L){var K;function M(R,Q){var O,P,N=R[Q];
if(N&&typeof N==="object"){for(O in N){if(Object.hasOwnProperty.call(N,O)){P=M(N,O);if(P!==undefined){N[O]=P;
}else{delete N[O];}}}}return L.call(R,Q,N);}G.lastIndex=0;if(G.test(J)){J=J.replace(G,function(N){return"\\u"+("0000"+N.charCodeAt(0).toString(16)).slice(-4);
});}if(/^[\],:{}\s]*$/.test(J.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){K=window["eval"]("("+J+")");
return typeof L==="function"?M({"":K},""):K;}throw new SyntaxError("JSON.parse");};}})();
/*
 * Copyright 2009 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS-IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var padmodals=(function(){var H=function(){};
function F(){H();$("#feedbackbox-topic").val("");$("#feedbackbox-subject").val("");$("#feedbackbox-message").val("");
}var D=false;function B(J){J=!!J;if(D!=J){D=J;if(J){$("#feedbackbox-send").css("opacity",0.75);}else{$("#feedbackbox-send").css("opacity",1);
}}}var C=false;function E(J){J=!!J;if(C!=J){C=J;if(J){$("#sharebox-send").css("opacity",0.75);}else{$("#sharebox-send").css("opacity",1);
}}}var G=function(){};function I(){G();}var A={init:function(){A.initFeedback();A.initShareBox();A.initModeration();
$(".modaldialog input[value=Cancel]").live("click",function(){modals.hideModal();});},initModeration:function(){$("#moderated-modal button[type=submit]").click(function(){pad.disableUnsavedPrompt();
document.location="/ep/pad/fork?padId="+clientVars.padId;});},initFeedback:function(){var J=$("#feedbackbox-email");
$("#feedbackbox-hide").click(function(){A.hideModal();});$("#feedbackbox-topic").on("change",function(){$("#feedbackbox-faq").hide();
$("#feedbackbox-feature-request").hide();$("#feedbackbox-subject").show();$("#feedbackbox-message").show();
if($("#feedbackbox-topic").val()=="howto"){$("#feedbackbox-faq").show();}else{if($("#feedbackbox-topic").val()=="feature"){$("#feedbackbox-feature-request").show();
$("#feedbackbox-subject").hide();$("#feedbackbox-message").hide();}}});$("#feedbackbox-send").click(function(){if($("#feedbackbox-email").is(":visible")){var K=$("#feedback-form").validate().element("#feedbackbox-email");
if(K){A.sendFeedbackEmail();}}else{A.sendFeedbackEmail();}});$("#feedbackbutton").click(function(){A.showFeedback();
});$("#footer-support-link").on("click",function(){A.showFeedback();return false;});$("#uservoicelinks a").click(function(){A.hideModal();
return true;});$("#feedbackemails a").each(function(){var K=$(this);K.attr("href","mailto:"+K.attr("href")+"@etherpad.com");
});if(J.length){$("#feedback-form").validate({rules:{"feedbackbox-email":{required:true,email:true}},errorPlacement:function(K,L){K.prependTo(L.parent());
},submitHandler:function(K){modals.submitModal(K);}});}},initShareBox:function(){$("#nootherusers a").click(A.showShareBox);
},getDefaultShareBoxMessageForName:function(J){return(J||"Somebody")+" has shared an EtherPad document with you.\n\nView it here:\n\n"+padutils.escapeHtml($("#sharebox-url").val()+"\n");
},getDefaultShareBoxSubjectForName:function(J){return(J||"Somebody")+" invited you to an EtherPad document";
},relayoutWithBottom:function(J){$("#modaloverlay").height(J);$("#sharebox").css("left",Math.floor(($(window).width()-$("#sharebox").outerWidth())/2));
$("#feedbackbox").css("left",Math.floor(($(window).width()-$("#feedbackbox").outerWidth())/2));},showFeedback:function(){A.showModal("#feedbackbox");
},showShareBox:function(){A.showModal("#sharebox",500);},showHistoryRevertTipBox:function(){A.showModal("#history-revert-dialog");
},showModal:function(J,L,K){modals.showModal(J,L,K);},hideModal:function(K,J){if(J){if($("#history-revert-dialog").css("display")=="none"){return;
}}padutils.cancelActions("hide-feedbackbox");padutils.cancelActions("hide-sharebox");$("#sharebox-response").hide();
modals.hideModal(K);},hideFeedbackLaterIfNoOtherInteraction:function(){return padutils.getCancellableAction("hide-feedbackbox",function(){A.hideModal();
});},hideShareboxLaterIfNoOtherInteraction:function(){return padutils.getCancellableAction("hide-sharebox",function(){A.hideModal();
});},sendFeedbackEmail:function(){if(D){return;}var L=$("#feedbackbox-message").val();var J=$("#feedbackbox-topic").val();
var K=$("#feedbackbox-subject").val();if(!L||!J||!K){$("#feedbackbox-response").text("Please choose out a topic and fill out all the fields.").get(0).className="badresponse";
$("#feedbackbox-response").show();return;}var O=($("#feedbackbox-email").hasClass("editempty")?"":$("#feedbackbox-email").val());
var R=typeof(pad)!="undefined"&&pad.getPadId();var M=typeof(pad)!="undefined"&&pad.getUserName();B(true);
$("#feedbackbox-response").text("Sending...").get(0).className="";$("#feedbackbox-response").show();$.ajax({type:"post",url:"/ep/pad/feedback",data:{feedback:L,padId:R,username:M,email:O,topic:J,subject:K},success:Q,error:P});
var N=A.hideFeedbackLaterIfNoOtherInteraction();function Q(S){B(false);F();$("#feedbackbox-response").text("Thanks for your feedback").get(0).className="goodresponse";
$("#feedbackbox-response").show();window.setTimeout(function(){$("#feedbackbox-response").fadeOut("slow",function(){N();
});},300);}function P(S){B(false);$("#feedbackbox-response").text("Could not send feedback.  Please email us at support@docs.qq.com instead.").get(0).className="badresponse";
$("#feedbackbox-response").show();}},sendInvite:function(){if(C){return;}if(!pad.isFullyConnected()){J("Error: Connection to the server is down or flaky.");
return;}var O=$("#sharebox-message").val();if(!O){J("Please enter a message body before sending.");return;
}var Q=($("#sharebox-to").hasClass("editempty")?"":$("#sharebox-to").val())||"";var L=Q.match(/[^\s,:;<>\"\'\/\(\)\[\]{}]+/g)||[];
if(L.length==0){J('Please enter at least one "To:" address.');$("#sharebox-to").focus().select();return;
}for(var M=0;M<L.length;M++){var N=L[M];if(!N.match(/^[\w\.\_\+\-]+\@[\w\_\-]+\.[\w\_\-\.]+$/)){J('"'+padutils.escapeHtml(N)+'" does not appear to be a valid email address.');
return;}}var K=$("#sharebox-subject").val();if(!K){K=A.getDefaultShareBoxSubjectForName(pad.getUserName());
$("#sharebox-subject").val(K);}var U=pad.getPadId();var P=pad.getUserName();E(true);$("#sharebox-response").text("Sending...").get(0).className="";
$("#sharebox-response").show();$.ajax({type:"post",url:"/ep/pad/emailinvite",data:{message:O,toEmails:L.join(","),subject:K,username:P,padId:U},success:T,error:S});
var R=A.hideShareboxLaterIfNoOtherInteraction();function T(V){E(false);$("#sharebox-response").text("Email invitation sent!").get(0).className="goodresponse";
$("#sharebox-response").show();window.setTimeout(function(){$("#sharebox-response").fadeOut("slow",function(){R();
});},1500);}function S(V){B(false);$("#sharebox-response").text("An error occurred; no email was sent.").get(0).className="badresponse";
$("#sharebox-response").show();}function J(V){$("#sharebox-response").text(V).get(0).className="badresponse";
$("#sharebox-response").show();}}};return A;}());pad_compatible=(function(){var B={};var C=navigator.userAgent.toLowerCase();
var A;(A=C.match(/rv:([\d.]+)\) like gecko/))?B.ie=A[1]:(A=C.match(/msie ([\d.]+)/))?B.ie=A[1]:(A=C.match(/firefox\/([\d.]+)/))?B.firefox=A[1]:(A=C.match(/chrome\/([\d.]+)/))?B.chrome=A[1]:(A=C.match(/opera.([\d.]+)/))?B.opera=A[1]:(A=C.match(/version\/([\d.]+).*safari/))?B.safari=A[1]:0;
if(B.ie){var E=navigator.appVersion.split(";");var D=E[1].replace(/[ ]/g,"");B.ie9=D=="MSIE9.0";B.ie10=D=="MSIE10.0";
}var F={isIE:function(){return B.ie;},isIE9:function(){return B.ie9;},isIE10:function(){return B.ie10;
},padDispatchEvent:function(G,I){if(G.dispatchEvent){var H=document.createEvent("Event");H.initEvent(I,true,true);
G.dispatchEvent(H);}else{if(window.fireEvent){G.fireEvent(I);}}},initArrayCompatible:function(){if(!Array.prototype.forEach){Array.prototype.forEach=function(I){var H=this.length;
var J=arguments[1];for(var G=0;G<H;G++){if(G in this){I.call(J,this[G],G,this);}}};}if(!Array.prototype.forEach){Array.prototype.forEach=function(I){var H=this.length;
var J=arguments[1];for(var G=0;G<H;G++){if(G in this){I.call(J,this[G],G,this);}}};}if(!Array.prototype.map){Array.prototype.map=function(P,N){var J,I,G;
var H=Object(this);var L=H.length>>>0;if(N){J=N;}I=new Array(L);G=0;while(G<L){var K,M;if(G in H){K=H[G];
M=P.call(J,K,G,H);I[G]=M;}G++;}return I;};}},initClassListCompatible:function(){if(!Object.prototype.classList){Object.defineProperty(Element.prototype,"classList",{get:function(){var H=this,G=H.className.split(" ");
G.add=function(){var I;for(i in arguments){I=true;for(var J=0;J<G.length;J++){if(G[J]==arguments[i]){I=false;
break;}}if(I){H.className+=(H.className?" ":"")+arguments[i];}}};G.remove=function(){H.className="";for(i in arguments){for(var I=0;
I<G.length;I++){if(G[I]!=arguments[i]){H.className+=(H.className?" ":"")+G[I];}}}};G.toggle=function(K){var I;
if(K){H.className="";I=false;for(var J=0;J<G.length;J++){if(G[J]!=K){H.className+=(H.className?" ":"")+G[J];
I=false;}else{I=true;}}if(!I){H.className+=(H.className?" ":"")+K;}}else{throw new TypeError("Failed to execute 'toggle': 1 argument required");
}return !I;};return G;},enumerable:false});}if(!window.location.origin){window.location.origin=window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:"");
}}};return F;})();var imgshrink=(function(){function A(D){var C;if(D.split(",")[0].indexOf("base64")>=0){C=atob(D.split(",")[1]);
}else{C=unescape(D.split(",")[1]);}var G=D.split(",")[0].split(":")[1].split(";")[0];var F=new ArrayBuffer(C.length);
var H=new Uint8Array(F);for(var E=0;E<C.length;E++){H[E]=C.charCodeAt(E);}return new Blob([F],{type:G});
}var B={maybeShrinkImage:function(C,E,F,G){if(!window.FileReader||!window.Image||C.type.indexOf("image")==-1||C.type.indexOf("image/gif")==0||C.size<500000){E(C);
return;}var D=new FileReader();D.onloadend=function(){var H=new Image();H.onload=function(){var M=F||1280,L=G||3280,J=H.width,I=H.height;
if(J>I){if(J>M){I*=M/J;J=M;}}else{if(I>L){J*=L/I;I=L;}}var K=document.createElement("canvas");K.width=J;
K.height=I;var N=K.getContext("2d");N.drawImage(H,0,0,J,I);var P=K.toDataURL(C.type,0.8);var O=A(P);E(O);
};H.src=D.result;};D.readAsDataURL(C);}};return B;}());
/*
 * Copyright 2009 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS-IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function isNodeText(A){return(A.nodeType==3);
}function nodeText(A){if($(A).children()&&$(A).children()[0]&&$($(A).children()[0]).attr("faketext")){return $($(A).children()[0]).attr("faketext");
}return A.innerText||A.textContent||A.nodeValue||(A.getAttribute&&A.getAttribute("faketext"))||"";}var _blockElems={div:1,p:1,pre:1,li:1,ol:1,ul:1};
function isBlockElement(A){return !!_blockElems[(A.tagName||"").toLowerCase()];}function object(B){var A=function(){};
A.prototype=B;return new A();}function extend(D,B,C){for(var A in B){if(typeof(C)=="undefined"||!(A in C)){D[A]=B[A];
}}return D;}function forEach(B,D){for(var A=0;A<B.length;A++){var C=D(B[A],A);if(C){break;}}}function decorate(B,C){for(var A in C){if(!B[A]){B[A]=C[A];
}}}function map(C,D){var B=[];for(var A=0;A<C.length;A++){if(D){B.push(D(C[A],A));}else{B.push(C[A]);
}}return B;}function filter(B,D){var C=[];for(var A=0;A<B.length;A++){if(D(B[A],A)){C.push(B[A]);}}return C;
}function isArray(A){return A&&typeof A==="object"&&!(A.propertyIsEnumerable("length"))&&typeof A.length==="number";
}var userAgent=navigator.userAgent.toLowerCase();var browser={version:(userAgent.match(/.+(?:rv|it|ra|ie)[\/: ]([\d.]+)/)||[])[1],safari:/webkit/.test(userAgent),opera:/opera/.test(userAgent),msie:/msie/.test(userAgent)&&!/opera/.test(userAgent)||/trident/.test(userAgent),mozilla:/mozilla/.test(userAgent)&&!/(compatible|webkit)/.test(userAgent),windows:/windows/.test(userAgent),mobile:/(iphone|ipad|android|ipod)/.test(userAgent),phone:/(iphone)/.test(userAgent),android:/(android)/.test(userAgent),edge:/edge/.test(userAgent)};
var iOS=(navigator.userAgent.match(/(iPad|iPhone|iPod)/g)?true:false);function getAssoc(B,A){return B["_magicdom_"+A];
}function setAssoc(C,A,B){C["_magicdom_"+A]=B;}function binarySearch(A,E){if(A<1){return 0;}if(E(0)){return 0;
}if(!E(A-1)){return A;}var D=0;var B=A-1;while((B-D)>1){var C=Math.floor((D+B)/2);if(E(C)){B=C;}else{D=C;
}}return B;}function binarySearchInfinite(C,B){var A=0;while(!B(A)){A+=C;}return binarySearch(A,B);}function htmlPrettyEscape(A){return A.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\r?\n/g,"\\n");
}function getClassArray(B,A){if(!B.className){return[];}var C=[];B.className.replace(/\S+/g,function(D){if((!A)||(A(D))){C.push(D);
}});return C;}function hasClass(C,A){var B=getClassArray(C,function(D){return D==A;});return B.length;
}function setClassArray(A,B){A.className=B.join(" ");}function addClass(C,B){var A=false;var D=getClassArray(C,function(E){if(E==B){A=true;
}return true;});if(!A){D.push(B);setClassArray(C,D);}}function removeClass(B,C){var A=false;var D=getClassArray(B,function(E){if(E==C){A=true;
return false;}return true;});if(A){setClassArray(B,D);}}function setClassPresence(B,A,C){if(C){addClass(B,A);
}else{removeClass(B,A);}}function hasParent(A,B){while(A){if(A==B){return true;}A=A.parentNode;}return false;
}function nodeMaxIndex(A){if(isNodeText(A)){return A.nodeValue.length;}else{return 1;}}function childIndex(A){var B=0;
while(A.previousSibling){B++;A=A.previousSibling;}return B;}function getStyle(A,B){var C=function(D){return D.replace(/\-(\w)/g,function(F,E){return E.toUpperCase();
});};if(A.currentStyle){return A.currentStyle[C(B)];}else{if(document.defaultView&&document.defaultView.getComputedStyle){return document.defaultView.getComputedStyle(A,null).getPropertyValue(B);
}else{return A.style[C(B)];}}}function _contains(B,C){for(var A=0;A<B.length;A++){if(C===B[A]){return true;
}}return false;}function _hashCode(C){var A=0,B,D;if(C.length==0){return A;}for(B=0;B<C.length;B++){D=C.charCodeAt(B);
A=((A<<5)-A)+D;A=A&A;}return A;}function now(){return(new Date()).getTime();}function showContextMenu(A,D,C){var B=A.target;
if(A.target.nodeName!="DIV"){B=A.target.parentNode;}C.css({left:clientVars.isDesktopApp?"18px":"20px",top:String($(B).position().top+2)+"px"}).show().click();
}function userAgentInfo(){var A=navigator.userAgent.toLowerCase(),B="",C=0;$.browser.chrome=/chrome/.test(navigator.userAgent.toLowerCase());
if($.browser.msie){A=$.browser.version;A=A.substring(0,A.indexOf("."));C=A;B="Internet Explorer";}if($.browser.chrome){A=A.substring(A.indexOf("chrome/")+7);
A=A.substring(0,A.indexOf("."));C=A;$.browser.safari=false;B="Chrome";}if($.browser.safari){A=A.substring(A.indexOf("safari/")+7);
A=A.substring(0,A.indexOf("."));C=A;B="Safari";}if($.browser.mozilla){if(navigator.userAgent.toLowerCase().indexOf("firefox")!=-1){A=A.substring(A.indexOf("firefox/")+8);
A=A.substring(0,A.indexOf("."));C=A;B="Firefox";}else{B="Mozilla (not Firefox)";}}if($.browser.opera){A=A.substring(A.indexOf("version/")+8);
A=A.substring(0,A.indexOf("."));C=A;B="Opera";}return{browser:B,version:C};}function noop(){}function identity(A){return A;
}
/*
 * Copyright 2009 Google Inc.
 * 
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 * 
 *      http://www.apache.org/licenses/LICENSE-2.0
 * 
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS-IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function newSkipList(){var H=window.PROFILER;
if(!H){H=function(){return{start:G,mark:G,literal:G,end:G,cancel:G};};}function G(){}var B={key:null,levels:1,upPtrs:[null],downPtrs:[null],downSkips:[1],downSkipWidths:[0]};
var E={key:null,levels:1,upPtrs:[null],downPtrs:[null],downSkips:[null],downSkipWidths:[null]};var A=0;
var D=0;var I={};B.downPtrs[0]=E;E.upPtrs[0]=B;function J(Z){var W=B.levels;var T=W-1;var X=-1,b=0;var V=new Array(W);
var Y=new Array(W);var a=new Array(W);V[T]=B;Y[T]=-1;a[T]=0;while(T>=0){var U=V[T];while(U.downPtrs[T]&&(X+U.downSkips[T]<Z)){X+=U.downSkips[T];
b+=U.downSkipWidths[T];U=U.downPtrs[T];}V[T]=U;Y[T]=X;a[T]=b;T--;if(T>=0){V[T]=U;}}return{nodes:V,idxs:Y,loc:Z,widthSkips:a,toString:function(){return"getPoint("+Z+")";
}};}function P(W){var V=0;var T=B;var U=B.levels-1;while(U>=0&&T.downPtrs[U]){while(T.downPtrs[U]&&(V+T.downSkipWidths[U]<=W)){V+=T.downSkipWidths[U];
T=T.downPtrs[U];}U--;}if(T===B){return(B.downPtrs[0]||null);}else{if(T===E){return(W==D?(E.upPtrs[0]||null):null);
}}return T;}function K(T){return(T&&T.width)||0;}function N(V,g,j){var X=H("insertKey",false);var W={key:g,levels:0,upPtrs:[],downPtrs:[],downSkips:[],downSkipWidths:[]};
X.mark("donealloc");var Y=V.nodes;var f=V.idxs;var n=V.loc;var m=V.widthSkips[0]+V.nodes[0].downSkipWidths[0];
var a=K(j);X.mark("loop1");while(W.levels==0||Math.random()<0.01){var T=W.levels;W.levels++;if(T==Y.length){Y[T]=B;
f[T]=-1;B.levels++;E.levels++;B.downPtrs[T]=E;E.upPtrs[T]=B;B.downSkips[T]=A+1;B.downSkipWidths[T]=D;
V.widthSkips[T]=0;}var Z=W;var U=Y[T];var d=U.downPtrs[T];var b=n-f[T];var h=U.downSkips[T]+1-b;U.downSkips[T]=b;
U.downPtrs[T]=Z;Z.downSkips[T]=h;Z.upPtrs[T]=U;Z.downPtrs[T]=d;d.upPtrs[T]=Z;var c=m-V.widthSkips[T];
var l=U.downSkipWidths[T]+a-c;U.downSkipWidths[T]=c;Z.downSkipWidths[T]=l;}X.mark("loop2");X.literal(Y.length,"PNL");
for(var T=W.levels;T<Y.length;T++){var U=Y[T];U.downSkips[T]++;U.downSkipWidths[T]+=a;}X.mark("map");
I["$KEY$"+g]=W;A++;D+=a;X.end();}function O(T){return T.nodes[0].downPtrs[0];}function S(U){U.loc++;for(var T=0;
T<U.nodes.length;T++){if(U.idxs[T]+U.nodes[T].downSkips[T]<U.loc){U.idxs[T]+=U.nodes[T].downSkips[T];
U.widthSkips[T]+=U.nodes[T].downSkipWidths[T];U.nodes[T]=U.nodes[T].downPtrs[T];}}}function M(W){var V=W.nodes[0].downPtrs[0];
var X=K(V.entry);for(var T=0;T<W.nodes.length;T++){if(T<V.levels){var U=V.upPtrs[T];var Y=V.downPtrs[T];
var a=U.downSkips[T]+V.downSkips[T]-1;U.downPtrs[T]=Y;Y.upPtrs[T]=U;U.downSkips[T]=a;var Z=U.downSkipWidths[T]+V.downSkipWidths[T]-X;
U.downSkipWidths[T]=Z;}else{var U=W.nodes[T];var Y=U.downPtrs[T];U.downSkips[T]--;U.downSkipWidths[T]-=X;
}}delete I["$KEY$"+V.key];A--;D-=X;}function R(V){var X=V.downSkipWidths[0];var Y=K(V.entry);var W=Y-X;
var U=V;var T=0;while(T<U.levels){U.downSkipWidths[T]+=W;T++;while(T>=U.levels&&U.upPtrs[T-1]){U=U.upPtrs[T-1];
}}D+=W;}function L(X,W){var V=(W?0:-1);var T=X;while(T!==B){var U=T.levels-1;T=T.upPtrs[U];if(W){V+=T.downSkipWidths[U];
}else{V+=T.downSkips[U];}}return V;}function F(T){return I["$KEY$"+T];}function Q(Y){var U=B;var T=B.levels-1;
var W=-1;function X(Z){if(Z===B){return false;}else{if(Z===E){return true;}else{return Y(Z.entry);}}}while(T>=0){var V=U.downPtrs[T];
while(!X(V)){W+=U.downSkips[T];U=V;V=U.downPtrs[T];}T--;}return W+1;}var C={length:function(){return A;
},atIndex:function(T){if(T<0){console.warn("atIndex("+T+")");}if(T>=A){console.warn("atIndex("+T+">="+A+")");
}return O(J(T)).entry;},splice:function(T,W,V){if(T<0){console.warn("splice("+T+", ...)");}if(T+W>A){console.warn("splice("+T+", "+W+", ...), N="+A);
console.warn("%s %s %s",typeof T,typeof W,typeof A);console.trace();}if(!V){V=[];}var Y=J(T);for(var U=0;
U<W;U++){M(Y);}for(var U=(V.length-1);U>=0;U--){var X=V[U];N(Y,X.key,X);var Z=F(X.key);Z.entry=X;}},next:function(T){return F(T.key).downPtrs[0].entry||null;
},prev:function(T){return F(T.key).upPtrs[0].entry||null;},push:function(T){C.splice(A,0,[T]);},slice:function(T,U){if(T===undefined){T=0;
}else{if(T<0){T+=A;}}if(U===undefined){U=A;}else{if(U<0){U+=A;}}if(T<0){T=0;}if(T>A){T=A;}if(U<0){U=0;
}if(U>A){U=A;}dmesg(String([T,U,A]));if(U<=T){return[];}var V=C.atIndex(T);var X=[V];for(var W=1;W<(U-T);
W++){V=C.next(V);X.push(V);}return X;},atKey:function(T){return F(T).entry;},indexOfKey:function(T){return L(F(T));
},indexOfEntry:function(T){return C.indexOfKey(T.key);},containsKey:function(T){return !!(F(T));},atOffset:function(T){return P(T).entry;
},keyAtOffset:function(T){return C.atOffset(T).key;},offsetOfKey:function(T){return L(F(T),true);},offsetOfEntry:function(T){return C.offsetOfKey(T.key);
},setEntryWidth:function(T,U){T.width=U;R(F(T.key));},totalWidth:function(){return D;},offsetOfIndex:function(T){if(T<0){return 0;
}if(T>=A){return D;}return C.offsetOfEntry(C.atIndex(T));},indexOfOffset:function(T){if(T<=0){return 0;
}if(T>=D){return A;}return C.indexOfEntry(C.atOffset(T));},search:function(T){return Q(T);},debugGetPoint:J,debugDepth:function(){return B.levels;
}};return C;}
/*
 * Copyright 2009 Google Inc.
 * 
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 * 
 *      http://www.apache.org/licenses/LICENSE-2.0
 * 
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS-IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function makeVirtualLineView(B){var E=20;
var D=null;function G(){return(B.textContent||B.innerText).length;}function F(){if(!D){var J=C();J.forwardByWhile(E);
D=J;}return D.getVirtualLine()+1;}function H(L){var J=C();J.forwardByWhile(E,null,L);var K=J.getVirtualLine();
J.backwardByWhile(8,function(){return J.getVirtualLine()==K;});J.forwardByWhile(1,function(){return J.getVirtualLine()!=K;
});var M=J.getOffset();return{vline:K,offset:(L-M)};}function I(Q,P){var J=C();J.binarySearch(function(){return J.getVirtualLine()>=Q;
});var M=J.getOffset();var L=J.getVirtualLine();J.forwardByWhile(E,null,M+P);J.backwardByWhile(1,function(){return J.getVirtualLine()!=L;
},M);var K=J.getOffset();var N=K-M;if(N<P&&L==(F()-1)){var O=G();N+=O-K;K=O;}return{vline:L,offset:N,lineChar:K};
}return{getNumVirtualLines:F,getVLineAndOffsetForChar:H,getCharForVLineAndOffset:I,makeCharSeeker:function(){return C();
}};function A(J){J=J.firstChild;while(J&&J.firstChild){J=J.firstChild;}if(J.data){return J;}return null;
}function C(){function T(a,b){var Z=a.parentNode;var g=(a.nodeValue.charAt(b)===" ");if(g){if(b==0){if(Z.previousSibling&&A(Z.previousSibling)){a=A(Z.previousSibling);
b=a.length-1;Z=a.parentNode;}else{return{top:Z.offsetTop,left:Z.offsetLeft};}}else{b--;}}var c=document.createElement("SPAN");
var f=a.nodeValue;var d=document.createDocumentFragment();d.appendChild(document.createTextNode(f.substring(0,b)));
c.appendChild(document.createTextNode(f.substr(b,1)));d.appendChild(c);d.appendChild(document.createTextNode(f.substring(b+1)));
Z.replaceChild(d,a);var h={top:c.offsetTop,left:c.offsetLeft+(g?c.offsetWidth:0),height:c.offsetHeight};
while(Z.firstChild){Z.removeChild(Z.firstChild);}Z.appendChild(a);return h;}var Y=(B.textContent||B.innerText);
var O=Y.length;var M=null;var J=0;var L=0;var P;var N;var V;var X=0;function Q(){var Z=M;if(!Z){Z=B.firstChild;
}else{Z=Z.nextSibling;}while(Z&&!A(Z)){Z=Z.nextSibling;}return Z;}function S(){var Z=M;if(!Z){Z=B.lastChild;
}else{Z=Z.previousSibling;}while(Z&&!A(Z)){Z=Z.previousSibling;}return Z;}var K;if(O>0){M=Q();var R=T(A(M),0);
V=R.height;P=R.top;N=R.left;function W(b,a){var Z=T(b,a);X+=Math.round((Z.top-P)/V);P=Z.top;N=Z.left;
}K={forward:function(f){var c=J;var Z=J+f;if(Z>(O-1)){Z=O-1;}while(J<Z){var d=A(M).length;var a=d-L;if(J+a>Z||!Q()){var b=Z-J;
if(b>=a){b=a-1;}J+=b;L+=b;break;}else{J+=a;L=0;M=Q();}}W(A(M),L);return J-c;},backward:function(c){var b=J;
var Z=J-c;if(Z<0){Z=0;}while(J>Z){if(J-L<=Z||!S()){var a=J-Z;if(a>L){a=L;}J-=a;L-=a;break;}else{J-=L+1;
M=S();L=A(M).length-1;}}W(A(M),L);return b-J;},getVirtualLine:function(){return X;},getLeftCoord:function(){return N;
}};}else{N=B.offsetLeft;K={forward:function(Z){return 0;},backward:function(Z){return 0;},getVirtualLine:function(){return 0;
},getLeftCoord:function(){return N;}};}K.getOffset=function(){return J;};K.getLineLength=function(){return O;
};K.toString=function(){return"seeker[curChar: "+J+"("+Y.charAt(J)+"), left: "+K.getLeftCoord()+", vline: "+K.getVirtualLine()+"]";
};function U(c,m,f,a){var b=null;var l=((typeof f)=="function");var j=f;var h=((typeof a)=="number");
var d=a;while(b!==0&&((!l)||j())){var Z=m;if(h){var g=(c?J-d:d-J);if(g<Z){Z=g;}}if(Z<0){break;}b=(c?K.backward(Z):K.forward(Z));
}}K.forwardByWhile=function(Z,b,a){U(false,Z,b,a);};K.backwardByWhile=function(Z,b,a){U(true,Z,b,a);};
K.binarySearch=function(Z){var b=Z;var a=function(){return !Z();};K.forwardByWhile(20,a);K.backwardByWhile(20,b);
K.forwardByWhile(10,a);K.backwardByWhile(5,b);K.forwardByWhile(1,a);return K.getOffset()+(Z()?0:1);};
return K;}}
/*
 * Copyright 2009 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS-IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
if(typeof(jimport)!="undefined"){jimport("com.etherpad.Easysync2Support");
}var _opt=null;function AttribPool(){var A={};A.numToAttrib={};A.attribToNum={};A.nextNum=0;A.putAttrib=function(C,E){var D=String(C);
if(D in A.attribToNum){return A.attribToNum[D];}if(E){return -1;}var B=A.nextNum++;A.attribToNum[D]=B;
A.numToAttrib[B]=[String(C[0]||""),String(C[1]||"")];return B;};A.getAttrib=function(C){var B=A.numToAttrib[C];
if(!B){return B;}return[B[0],B[1]];};A.getAttribKey=function(C){var B=A.numToAttrib[C];if(!B){return"";
}return B[0];};A.getAttribValue=function(C){var B=A.numToAttrib[C];if(!B){return"";}return B[1];};A.eachAttrib=function(C){for(var D in A.numToAttrib){var B=A.numToAttrib[D];
C(B[0],B[1]);}};A.copy=function(){var B=new AttribPool();A.eachAttrib(function(C,D){B.putAttrib([C,D]);
});return B;};A.modifyAttribs=function(H){for(var C=0;C<A.nextNum;C++){var D=C;var B=A.numToAttrib[D];
var G=String(B);var E=[B[0],H(B[0],B[1])];A.numToAttrib[D]=E;delete A.attribToNum[G];var F=String(E);
A.attribToNum[F]=D;}};A.toJsonable=function(){return{numToAttrib:A.numToAttrib,nextNum:A.nextNum};};A.fromJsonable=function(B){A.numToAttrib=B.numToAttrib;
A.nextNum=B.nextNum;A.attribToNum={};for(var C in A.numToAttrib){A.attribToNum[String(A.numToAttrib[C])]=Number(C);
}return A;};return A;}var Changeset={};Changeset.error=function error(B){typeof window!=="undefined"&&window.onfreakout&&window.onfreakout(B);
var A=new Error(B);A.easysync=true;throw A;};Changeset.assert=function assert(A,C){if(!A){var B=Array.prototype.slice.call(arguments,1).join("");
Changeset.error("Changeset: "+B);}};Changeset.parseNum=function(A){return parseInt(A,36);};Changeset.numToString=function(A){return A.toString(36).toLowerCase();
};Changeset.toBaseTen=function(A){var B=A.indexOf("$");var D=A.substring(0,B);var C=A.substring(B);return D.replace(/[0-9a-z]+/g,function(E){return String(Changeset.parseNum(E));
})+C;};Changeset.oldLen=function(A){return Changeset.unpack(A).oldLen;};Changeset.newLen=function(A){return Changeset.unpack(A).newLen;
};Changeset.charBank=function(A){return Changeset.unpack(A).charBank;};Changeset.isEmpty=function(C){var A=Changeset.opIterator(Changeset.unpack(C).ops);
while(A.hasNext()){var B=A.next();if(B.opcode!="="||B.attribs){return false;}}return true;};Changeset.opIterator=function(E,L){var D=/((?:\*[0-9a-z]+)*)(?:\|([0-9a-z]+))?([-+=])([0-9a-z]+)|\?|/g;
var M=(L||0);var B=M;var F=B;function C(){F=B;var N;if(_opt){N=_opt.nextOpInString(E,B);if(N){if(N.opcode()=="?"){Changeset.error("Hit error opcode in op stream");
}B=N.lastIndex();}}else{D.lastIndex=B;N=D.exec(E);B=D.lastIndex;if(N[0]=="?"){Changeset.error("Hit error opcode in op stream");
}}return N;}var A=C();var G=Changeset.newOp();function J(O){var N=(O||G);if(_opt&&A){N.attribs=A.attribs();
N.lines=A.lines();N.chars=A.chars();N.opcode=A.opcode();A=C();}else{if((!_opt)&&A[0]){N.attribs=A[1];
N.lines=Changeset.parseNum(A[2]||0);N.opcode=A[3];N.chars=Changeset.parseNum(A[4]);A=C();}else{Changeset.clearOp(N);
}}return N;}function H(){return !!(_opt?A:A[0]);}function I(){var N=G;if(_opt&&A){N.attribs=A.attribs();
N.lines=A.lines();N.chars=A.chars();N.opcode=A.opcode();}else{if((!_opt)&&A[0]){N.attribs=A[1];N.lines=Changeset.parseNum(A[2]||0);
N.opcode=A[3];N.chars=Changeset.parseNum(A[4]);}else{Changeset.clearOp(N);}}return N;}function K(){return F;
}return{next:J,hasNext:H,lastIndex:K,peekNext:I};};Changeset.clearOp=function(A){A.opcode="";A.chars=0;
A.lines=0;A.attribs="";};Changeset.newOp=function(A){return{opcode:(A||""),chars:0,lines:0,attribs:""};
};Changeset.cloneOp=function(A){return{opcode:A.opcode,chars:A.chars,lines:A.lines,attribs:A.attribs};
};Changeset.copyOp=function(B,A){A.opcode=B.opcode;A.chars=B.chars;A.lines=B.lines;A.attribs=B.attribs;
};Changeset.opString=function(B){if(!B.opcode){return"null";}var A=Changeset.opAssembler();A.append(B);
return A.toString();};Changeset.stringOp=function(A){return Changeset.opIterator(A).next();};Changeset.checkRep=function(C){var G=Changeset.unpack(C);
var F=G.oldLen;var J=G.newLen;var M=G.ops;var E=G.charBank;var I=Changeset.smartOpAssembler();var D=0;
var B=0;var H=0;var K=Changeset.opIterator(M);while(K.hasNext()){var A=K.next();switch(A.opcode){case"=":D+=A.chars;
B+=A.chars;break;case"-":D+=A.chars;Changeset.assert(D<F,D," >= ",F," in ",C);break;case"+":B+=A.chars;
H+=A.chars;Changeset.assert(B<J,B," >= ",J," in ",C);break;}I.append(A);}B+=F-D;E=E.substring(0,H);while(E.length<H){E+="?";
}I.endDocument();var L=Changeset.pack(F,B,I.toString(),E);Changeset.assert(L==C,L," != ",C);return C;
};Changeset.checkRepWithText=function(E,N){var G=Changeset.unpack(E);var F=G.oldLen;var P=G.newLen;var O=G.ops;
var D=G.charBank;var I=Changeset.smartOpAssembler();var C=0;var B=0;var H=0;function J(S,T,V,U){var R=T.slice(V,U);
var Q=R.split("\n");Changeset.assert(S.lines==(Q.length-1),S.lines," != ",Q.length-1," in ",R);if(Q.length-1){Changeset.assert(Q[Q.length-1]=="",Q[Q.length-1]," != ",""," in ",R);
}}var L=Changeset.opIterator(O);while(L.hasNext()){var A=L.next();switch(A.opcode){case"=":var K=B;C+=A.chars;
B+=A.chars;J(A,N,K,B);break;case"-":C+=A.chars;Changeset.assert(C<F,C," >= ",F," in ",E);break;case"+":var K=B;
B+=A.chars;H+=A.chars;J(A,N,K,B);}I.append(A);}B+=F-C;D=D.substring(0,H);while(D.length<H){D+="?";}I.endDocument();
var M=Changeset.pack(F,B,I.toString(),D);Changeset.assert(M==E,M," != ",E);return E;};Changeset.smartOpAssembler=function(){var G=Changeset.mergingOpAssembler();
var E=Changeset.mergingOpAssembler();var B=Changeset.mergingOpAssembler();var A=Changeset.stringAssembler();
var C="";var F=0;function H(){A.append(B.toString());B.clear();}function I(){A.append(G.toString());G.clear();
A.append(E.toString());E.clear();}function D(O){if(!O.opcode){return;}if(!O.chars){return;}if(O.opcode=="-"){if(C=="="){H();
}G.append(O);F-=O.chars;}else{if(O.opcode=="+"){if(C=="="){H();}E.append(O);F+=O.chars;}else{if(O.opcode=="="){if(C!="="){I();
}B.append(O);}}}C=O.opcode;}function M(R,P,T,S){var O=Changeset.newOp(R);O.attribs=Changeset.makeAttribsString(R,T,S);
var Q=P.lastIndexOf("\n");if(Q<0){O.chars=P.length;O.lines=0;D(O);}else{O.chars=Q+1;O.lines=P.match(/\n/g).length;
D(O);O.chars=P.length-(Q+1);O.lines=0;D(O);}}function K(){I();H();return A.toString();}function N(){G.clear();
E.clear();B.clear();A.clear();F=0;}function L(){B.endDocument();}function J(){return F;}return{append:D,toString:K,clear:N,endDocument:L,appendOpWithText:M,getLengthChange:J};
};if(_opt){Changeset.mergingOpAssembler=function(){var A=_opt.mergingOpAssembler();function C(F){A.append(F.opcode,F.chars,F.lines,F.attribs);
}function E(){return A.toString();}function B(){A.clear();}function D(){A.endDocument();}return{append:C,toString:E,clear:B,endDocument:D};
};}else{Changeset.mergingOpAssembler=function(){var C=Changeset.opAssembler();var A=Changeset.newOp();
var B=0;function D(I){if(A.opcode){if(I&&A.opcode=="="&&!A.attribs){}else{C.append(A);if(B){A.chars=B;
A.lines=0;C.append(A);B=0;}}A.opcode="";}}function F(I){if(I.chars>0){if(A.opcode==I.opcode&&A.attribs==I.attribs){if(I.lines>0){A.chars+=B+I.chars;
A.lines+=I.lines;B=0;}else{if(A.lines==0){A.chars+=I.chars;}else{B+=I.chars;}}}else{D();Changeset.copyOp(I,A);
}}}function G(){D(true);}function H(){D();return C.toString();}function E(){C.clear();Changeset.clearOp(A);
}return{append:F,toString:H,clear:E,endDocument:G};};}if(_opt){Changeset.opAssembler=function(){var A=_opt.opAssembler();
function C(E){A.append(E.opcode,E.chars,E.lines,E.attribs);}function D(){return A.toString();}function B(){A.clear();
}return{append:C,toString:D,clear:B};};}else{Changeset.opAssembler=function(){var A=[];function C(E){A.push(E.attribs);
if(E.lines){A.push("|",Changeset.numToString(E.lines));}A.push(E.opcode);A.push(Changeset.numToString(E.chars));
}function D(){return A.join("");}function B(){A.length=0;}return{append:C,toString:D,clear:B};};}Changeset.stringIterator=function(D){var A=0;
function B(H){Changeset.assert(H<=C(),"!(",H," <= ",C(),")");}function F(H){B(H);var I=D.substr(A,H);
A+=H;return I;}function E(H){B(H);var I=D.substr(A,H);return I;}function G(H){B(H);A+=H;}function C(){return D.length-A;
}return{take:F,skip:G,remaining:C,peek:E};};Changeset.stringAssembler=function(){var A=[];function B(D){A.push(String(D));
}function C(){return A.join("");}return{append:B,toString:C};};Changeset.textLinesMutator=function(C){var A=[0,0];
var D=false;var E=0,B=0;function O(X){C.splice.apply(C,X);}function S(){return C.toSource();}function J(X){if(C.get){return C.get(X);
}else{return C[X];}}function U(Y,X){if(C.slice){return C.slice(Y,X);}else{return[];}}function T(){if((typeof C.length)=="number"){return C.length;
}else{return C.length();}}function G(){A[0]=E;A[1]=0;if(B>0){F();}D=true;}function K(){O(A);A.length=2;
A[0]=A[1]=0;D=false;}function H(){return(E-A[0]<(A.length-2));}function W(X){print(X+": "+A.toSource()+" / "+E+","+B+" / "+S());
}function F(){if(!H()){A.push(J(A[0]+A[1]));A[1]++;}return 2+E-A[0];}function L(X,Z){if(X){if(Z){if(!D){G();
}for(var Y=0;Y<X;Y++){B=0;F();E++;}}else{if(D){if(X>1){K();}else{F();}}E+=X;B=0;}}}function R(Z,Y,X){if(Z){if(Y){L(Y,X);
}else{if(X&&!D){G();}if(D){F();}B+=Z;}}}function I(X){var Y="";if(X){if(!D){G();}function a(c){var b=A[0]+A[1];
return U(b,b+c).join("");}if(H()){if(B==0){Y=A[A.length-1];A.length--;Y+=a(X-1);A[1]+=X-1;}else{Y=a(X-1);
A[1]+=X-1;var Z=A.length-1;Y=A[Z].substring(B)+Y;A[Z]=A[Z].substring(0,B)+J(A[0]+A[1]);A[1]+=1;}}else{Y=a(X);
A[1]+=X;}}return Y;}function V(Y,Z){var a="";if(Y){if(Z){return I(Z);}else{if(!D){G();}var X=F();a=A[X].substring(B,B+Y);
A[X]=A[X].substring(0,B)+A[X].substring(B+Y);}}return a;}function M(Z,c){if(Z){if(!D){G();}if(c){var X=Changeset.splitTextLines(Z);
if(H()){var Y=A.length-1;var a=A[Y];var b=B;A[Y]=a.substring(0,b)+X[0];E++;X.splice(0,1);Array.prototype.push.apply(A,X);
E+=X.length;A.push(a.substring(b));B=0;}else{Array.prototype.push.apply(A,X);E+=X.length;}}else{var Y=F();
A[Y]=A[Y].substring(0,B)+Z+A[Y].substring(B);B+=Z.length;}}}function N(){var X=T();if(D){X+=A.length-2-A[1];
}return E<X;}function P(){if(D){K();}}var Q={skip:R,remove:V,insert:M,close:P,hasMore:N,removeLines:I,skipLines:L};
return Q;};Changeset.applyZip=function(I,K,H,J,G){var F=Changeset.opIterator(I,K);var E=Changeset.opIterator(H,J);
var D=Changeset.smartOpAssembler();var A=Changeset.newOp();var C=Changeset.newOp();var B=Changeset.newOp();
while(A.opcode||F.hasNext()||C.opcode||E.hasNext()){if((!A.opcode)&&F.hasNext()){F.next(A);}if((!C.opcode)&&E.hasNext()){E.next(C);
}G(A,C,B);if(B.opcode){D.append(B);B.opcode="";}}D.endDocument();return D.toString();};Changeset.unpack=function(B){var G=/Z:([0-9a-z]+)([><])([0-9a-z]+)|/;
var A=G.exec(B);if((!A)||(!A[0])){Changeset.error("Not a changeset: "+B);}var D=Changeset.parseNum(A[1]);
var E=(A[2]==">")?1:-1;var H=Changeset.parseNum(A[3]);var F=D+E*H;var I=A[0].length;var C=B.indexOf("$");
if(C<0){C=B.length;}return{oldLen:D,newLen:F,ops:B.substring(I,C),charBank:B.substring(C+1)};};Changeset.pack=function(C,G,F,D){var A=G-C;
var E=(A>=0?">"+Changeset.numToString(A):"<"+Changeset.numToString(-A));var B=[];B.push("Z:",Changeset.numToString(C),E,F,"$",D);
return B.join("");};Changeset.applyToText=function(H,E){var C=Changeset.unpack(H);Changeset.assert(E.length==C.oldLen,"mismatched apply: ",E.length," / ",C.oldLen);
var F=Changeset.opIterator(C.ops);var G=Changeset.stringIterator(C.charBank);var B=Changeset.stringIterator(E);
var A=Changeset.stringAssembler();while(F.hasNext()){var D=F.next();switch(D.opcode){case"+":A.append(G.take(D.chars));
break;case"-":B.skip(D.chars);break;case"=":A.append(B.take(D.chars));break;}}A.append(B.take(B.remaining()));
return A.toString();};Changeset.getNewlyMentionedEncryptedUserIds=function(G,H){var B=[];var F=Changeset.unpack(G);
var C=Changeset.opIterator(F.ops);while(C.hasNext()){var D=C.next();switch(D.opcode){case"+":var A=Changeset.attribsAttributeValue(D.attribs,"link",H);
if(A){var I=new RegExp(".*/ep/profile/(.*)");var E=A.match(I);if(E){B.push(E[1]);}}break;}}return B;};
function _trim(A){return A.replace(/^\s\s*/,"").replace(/\s\s*$/,"");}Changeset.convertToKeeps=function(E){var A=Changeset.mergingOpAssembler();
var C=Changeset.unpack(E);var D=Changeset.opIterator(C.ops);while(D.hasNext()){var F=D.next();var B=Changeset.newOp();
Changeset.copyOp(F,B);B.opcode="=";A.append(B);}A.endDocument();return Changeset.pack(C.newLen,C.newLen,A.toString(),"");
};Changeset.applyToTextAsDiff=function(Z,N,V,U,K,b){var D=Changeset.mergingOpAssembler();var P=Changeset.stringAssembler();
var Q=Changeset.unpack(Z);Changeset.assert(N.length==Q.oldLen,"mismatched apply: ",N.length," / ",Q.oldLen);
var T=Changeset.opIterator(Q.ops);var Y=Changeset.stringIterator(Q.charBank);var O=Changeset.stringIterator(N);
var H=true;var R=true;var S=false;var X=[];while(T.hasNext()){var E=T.next();var F=Changeset.newOp();
Changeset.copyOp(E,F);switch(E.opcode){case"+":S=false;var W=Y.take(E.chars);if(_trim(W)!=""){R=false;
}F.attribs+=("*"+Changeset.numToString(V));D.append(F);P.append(W);H=false;break;case"-":S=true;var a=O.take(E.chars);
if(_trim(a)!=""&&(E.attribs||b)){R=false;F.opcode="=";F.attribs+=("*"+Changeset.numToString(U));D.append(F);
}else{D.append(F);}H=false;if(E.lines==E.chars&&false){var M=Changeset.newOp();M.opcode="+";M.chars=1;
M.lines=0;M.attribs+=("*"+Changeset.numToString(U));P.append(" ");D.append(M);}break;case"=":var L=O.take(E.chars);
if(E.attribs){Changeset.eachAttribNumber(E.attribs,function(c){X.push(c);});F.attribs+=("*"+Changeset.numToString(V));
D.append(F);R=false;}else{var B=L.split("\n");if(B.length>4||(H&&B.length>3)){var J=B[0];var I=B[B.length-1];
if(!H){var G=Changeset.newOp();G.opcode="=";G.chars=J.length+1;G.lines=1;G.attribs+=("*"+Changeset.numToString(K));
D.append(G);}else{J="";}var A=Changeset.newOp();A.opcode="-";if(!H){A.chars=L.length-(J.length+1)-(I.length+1);
A.lines=B.length-3;}else{A.chars=L.length-(I.length+1);A.lines=B.length-2;}D.append(A);var C=Changeset.newOp();
C.opcode="=";C.chars=I.length+1;C.lines=1;C.attribs+=("*"+Changeset.numToString(K));D.append(C);}else{if(H&&B.length>1){var A=Changeset.newOp();
A.opcode="-";A.chars=B[0].length+1;A.lines=1;D.append(A);var C=Changeset.newOp();C.opcode="=";C.chars=E.chars-(B[0].length+1);
C.lines=E.lines-1;C.attribs+=("*"+Changeset.numToString(K));D.append(C);}else{D.append(F);}}}H=false;
break;}}var L=O.take(O.remaining());var B=L.split("\n");if(B.length>2){var J=B[0];var I=B[B.length-1];
if(!H){var G=Changeset.newOp();G.opcode="=";G.chars=J.length+1;G.lines=1;G.attribs+=("*"+Changeset.numToString(K));
D.append(G);}else{J="";}var A=Changeset.newOp();A.opcode="-";if(!H){A.chars=L.length-(J.length+1)-(I.length+1);
A.lines=B.length-3;}else{A.chars=L.length-(I.length+1);A.lines=B.length-2;}A.attribs+=("*"+Changeset.numToString(K));
D.append(A);var C=Changeset.newOp();C.opcode="=";C.chars=I.length+1;C.lines=1;C.attribs+=("*"+Changeset.numToString(K));
D.append(C);}else{}return[Changeset.pack(N.length,N.length+P.toString().length,D.toString(),P),R,X];};
Changeset.mutateTextLines=function(G,F){var C=Changeset.unpack(G);var D=Changeset.opIterator(C.ops);var E=Changeset.stringIterator(C.charBank);
var B=Changeset.textLinesMutator(F);while(D.hasNext()){var A=D.next();switch(A.opcode){case"+":B.insert(E.take(A.chars),A.lines);
break;case"-":B.remove(A.chars,A.lines);break;case"=":B.skip(A.chars,A.lines,(!!A.attribs));break;}}B.close();
};Changeset.composeAttributes=function(G,F,E,D){if((!G)&&E){return F;}if(!F){return G;}var A=[];G.replace(/\*([0-9a-z]+)/g,function(I,H){A.push(D.getAttrib(Changeset.parseNum(H)));
return"";});F.replace(/\*([0-9a-z]+)/g,function(M,L){var H=D.getAttrib(Changeset.parseNum(L));var K=false;
for(var I=0;I<A.length;I++){var J=A[I];if(J[0]==H[0]){if(H[1]||E){J[1]=H[1];}else{A.splice(I,1);}K=true;
break;}}if((!K)&&(H[1]||E)){A.push(H);}return"";});A.sort();var B=Changeset.stringAssembler();for(var C=0;
C<A.length;C++){B.append("*");B.append(Changeset.numToString(D.putAttrib(A[C])));}return B.toString();
};Changeset._slicerZipperFunc=function(A,B,C,D){if(A.opcode=="-"){Changeset.copyOp(A,C);A.opcode="";}else{if(!A.opcode){Changeset.copyOp(B,C);
B.opcode="";}else{switch(B.opcode){case"-":if(B.chars<=A.chars){if(A.opcode=="="){C.opcode="-";C.chars=B.chars;
C.lines=B.lines;C.attribs="";}A.chars-=B.chars;A.lines-=B.lines;B.opcode="";if(!A.chars){A.opcode="";
}}else{if(A.opcode=="="){C.opcode="-";C.chars=A.chars;C.lines=A.lines;C.attribs="";}B.chars-=A.chars;
B.lines-=A.lines;A.opcode="";}break;case"+":Changeset.copyOp(B,C);B.opcode="";break;case"=":if(B.chars<=A.chars){C.opcode=A.opcode;
C.chars=B.chars;C.lines=B.lines;C.attribs=Changeset.composeAttributes(A.attribs,B.attribs,A.opcode=="=",D);
B.opcode="";A.chars-=B.chars;A.lines-=B.lines;if(!A.chars){A.opcode="";}}else{C.opcode=A.opcode;C.chars=A.chars;
C.lines=A.lines;C.attribs=Changeset.composeAttributes(A.attribs,B.attribs,A.opcode=="=",D);A.opcode="";
B.chars-=A.chars;B.lines-=A.lines;}break;case"":Changeset.copyOp(A,C);A.opcode="";break;}}}};Changeset.applyToAttribution=function(D,C,B){var A=Changeset.unpack(D);
return Changeset.applyZip(C,0,A.ops,0,function(F,E,G){return Changeset._slicerZipperFunc(F,E,G,B);});
};Changeset.mutateAttributionLines=function(N,Q,O){var I=Changeset.unpack(N);var H=Changeset.opIterator(I.ops);
var M=I.charBank;var G=0;var F=Changeset.textLinesMutator(Q);var B=null;function L(){return(B&&B.hasNext())||F.hasMore();
}function P(R){if((!(B&&B.hasNext()))&&F.hasMore()){var S=F.removeLines(1);B=Changeset.opIterator(S);
}if(B&&B.hasNext()){B.next(R);}else{R.opcode="";}}var D=null;function J(R){if(!D){D=Changeset.mergingOpAssembler();
}D.append(R);if(R.lines>0){Changeset.assert(R.lines==1,"Can't have op.lines of ",R.lines," in attribution lines");
F.insert(D.toString(),1);D=null;}}var A=Changeset.newOp();var E=Changeset.newOp();var C=Changeset.newOp();
while(A.opcode||H.hasNext()||E.opcode||L()){if((!A.opcode)&&H.hasNext()){H.next(A);}if((!A.opcode)&&(!E.opcode)&&(!D)&&(!(B&&B.hasNext()))){break;
}else{if(A.opcode=="="&&A.lines>0&&(!A.attribs)&&(!E.opcode)&&(!D)&&(!(B&&B.hasNext()))){F.skipLines(A.lines);
A.opcode="";}else{if(A.opcode=="+"){if(A.lines>1){var K=M.indexOf("\n",G)+1-G;Changeset.copyOp(A,C);A.chars-=K;
A.lines--;C.lines=1;C.chars=K;}else{Changeset.copyOp(A,C);A.opcode="";}J(C);G+=C.chars;C.opcode="";}else{if((!E.opcode)&&L()){P(E);
}Changeset._slicerZipperFunc(E,A,C,O);if(C.opcode){J(C);C.opcode="";}}}}}Changeset.assert(!D,"line assembler not finished");
F.close();};Changeset.joinAttributionLines=function(D){var C=Changeset.mergingOpAssembler();for(var A=0;
A<D.length;A++){var E=D[A];var B=Changeset.opIterator(E);while(B.hasNext()){C.append(B.next());}}return C.toString();
};Changeset.splitAttributionLines=function(J,K){var G=Changeset.opIterator(J);var C=Changeset.mergingOpAssembler();
var I=[];var D=0;function E(L){C.append(L);if(L.lines>0){I.push(C.toString());C.clear();}D+=L.chars;}while(G.hasNext()){var A=G.next();
var F=A.chars;var B=A.lines;while(B>1){var H=K.indexOf("\n",D)+1;Changeset.assert(H>0,"newlineEnd <= 0 in splitAttributionLines");
A.chars=H-D;A.lines=1;E(A);F-=A.chars;B-=A.lines;}if(B==1){A.chars=F;A.lines=1;}E(A);}return I;};Changeset.splitTextLines=function(A){return A.match(/[^\n]*(?:\n|[^\n]$)/g);
};Changeset.compose=function(J,H,L){var B=Changeset.unpack(J);var A=Changeset.unpack(H);var K=B.oldLen;
var I=B.newLen;Changeset.assert(I==A.oldLen,"mismatched composition");var G=A.newLen;var D=Changeset.stringIterator(B.charBank);
var E=Changeset.stringIterator(A.charBank);var C=Changeset.stringAssembler();var F=Changeset.applyZip(B.ops,0,A.ops,0,function(O,N,M){var Q=O.opcode;
var P=N.opcode;if(Q=="+"&&P=="-"){D.skip(Math.min(O.chars,N.chars));}Changeset._slicerZipperFunc(O,N,M,L);
if(M.opcode=="+"){if(P=="+"){C.append(E.take(M.chars));}else{C.append(D.take(M.chars));}}});return Changeset.pack(K,G,F,C.toString());
};Changeset.attributeTester=function(D,B){if(!B){return C;}var A=B.putAttrib(D,true);if(A<0){return C;
}else{var E=new RegExp("\\*"+Changeset.numToString(A)+"(?!\\w)");return function(F){return E.test(F);
};}function C(F){return false;}};Changeset.identity=function(A){return Changeset.pack(A,A,"","");};Changeset.makeSplice=function(B,A,F,E,H,J){var D=B.length;
if(A>=D){A=D-1;}if(F>B.length-A-1){F=B.length-A-1;}var G=B.substring(A,A+F);var I=D+E.length-G.length;
var C=Changeset.smartOpAssembler();C.appendOpWithText("=",B.substring(0,A));C.appendOpWithText("-",G);
C.appendOpWithText("+",E,H,J);C.endDocument();return Changeset.pack(D,I,C.toString(),E);};Changeset.toSplices=function(G){var F=Changeset.unpack(G);
var B=[];var C=0;var E=Changeset.opIterator(F.ops);var H=Changeset.stringIterator(F.charBank);var D=false;
while(E.hasNext()){var A=E.next();if(A.opcode=="="){C+=A.chars;D=false;}else{if(!D){B.push([C,C,""]);
D=true;}if(A.opcode=="-"){C+=A.chars;B[B.length-1][1]+=A.chars;}else{if(A.opcode=="+"){B[B.length-1][2]+=H.take(A.chars);
}}}}return B;};Changeset.characterRangeFollow=function(M,N,L,K){var C=N;var A=L;var J=Changeset.toSplices(M);
var H=0;for(var G=0;G<J.length;G++){var F=J[G];var B=F[0]+H;var E=F[1]+H;var I=F[2].length;var D=I-(E-B);
if(B<=C&&E>=A){if(K){C=A=B;}else{C=A=B+I;}}else{if(E<=C){C+=D;A+=D;}else{if(B>=A){}else{if(B>=C&&E<=A){A+=D;
}else{if(E<A){C=B+I;A+=D;}else{A=B;}}}}}H+=D;}return[C,A];};Changeset.moveOpsToNewPool=function(A,F,C){var B=A.indexOf("$");
if(B<0){B=A.length;}var D=A.substring(0,B);var E=A.substring(B);return D.replace(/\*([0-9a-z]+)/g,function(K,H){var I=Changeset.parseNum(H);
var G=F.getAttrib(I);if(!G){return"";}var J=C.putAttrib(G);return"*"+Changeset.numToString(J);})+E;};
Changeset.makeAttribution=function(B){var A=Changeset.smartOpAssembler();A.appendOpWithText("+",B);return A.toString();
};Changeset.eachAttribNumber=function(A,D){var B=A.indexOf("$");if(B<0){B=A.length;}var C=A.substring(0,B);
C.replace(/\*([0-9a-z]+)/g,function(F,E){D(Changeset.parseNum(E));return"";});};Changeset.filterAttribNumbers=function(B,A){return Changeset.mapAttribNumbers(B,A);
};Changeset.mapAttribNumbers=function(A,E){var B=A.indexOf("$");if(B<0){B=A.length;}var D=A.substring(0,B);
var C=D.replace(/\*([0-9a-z]+)/g,function(H,G){var F=E(Changeset.parseNum(G));if(F===true){return H;}else{if((typeof F)==="number"){return"*"+Changeset.numToString(F);
}else{return"";}}});return C+A.substring(B);};Changeset.makeAText=function(A,B){return{text:A,attribs:(B||Changeset.makeAttribution(A))};
};Changeset.applyToAText=function(A,B,C){return{text:Changeset.applyToText(A,B.text),attribs:Changeset.applyToAttribution(A,B.attribs,C)};
};Changeset.applyToATextAsDiff=function(A,B,C){return{text:Changeset.applyToTextAsDiff(A,B.text),attribs:Changeset.applyToAttribution(A,B.attribs,C)};
};Changeset.cloneAText=function(A){return{text:A.text,attribs:A.attribs};};Changeset.copyAText=function(A,B){B.text=A.text;
B.attribs=A.attribs;};Changeset.appendATextToAssembler=function(C,B){var D=Changeset.opIterator(C.attribs);
var A=Changeset.newOp();while(D.hasNext()){D.next(A);if(!D.hasNext()){if(A.lines<=1){A.lines=0;A.chars--;
if(A.chars){B.append(A);}}else{var F=C.text.lastIndexOf("\n",C.text.length-2)+1;var E=C.text.length-F-1;
A.lines--;A.chars-=(E+1);B.append(A);A.lines=0;A.chars=E;if(A.chars){B.append(A);}}}else{B.append(A);
}}};Changeset.prepareForWire=function(C,B){var A=new AttribPool();var D=Changeset.moveOpsToNewPool(C,B,A);
return{translated:D,pool:A};};Changeset.isIdentity=function(B){var A=Changeset.unpack(B);return A.ops==""&&A.oldLen==A.newLen;
};Changeset.opAttributeValue=function(C,B,A){return Changeset.attribsAttributeValue(C.attribs,B,A);};
Changeset.attribsAttributeValue=function(C,D,A){var B="";if(C){Changeset.eachAttribNumber(C,function(E){if(A.getAttribKey(E)==D){B=A.getAttribValue(E);
}});}return B;};Changeset.builder=function(E){var B=Changeset.smartOpAssembler();var A=Changeset.newOp();
var D=Changeset.stringAssembler();var C={keep:function(I,G,F,H){A.opcode="=";A.attribs=(F&&Changeset.makeAttribsString("=",F,H))||"";
A.chars=I;A.lines=(G||0);B.append(A);return C;},keepText:function(H,G,F){B.appendOpWithText("=",H,G,F);
return C;},insert:function(F,H,G){B.appendOpWithText("+",F,H,G);D.append(F);return C;},remove:function(G,F){A.opcode="-";
A.attribs="";A.chars=G;A.lines=(F||0);B.append(A);return C;},insertAText:function(F){Changeset.appendATextToAssembler(F,B);
D.append(F.text);return C;},toString:function(){B.endDocument();var F=E+B.getLengthChange();return Changeset.pack(E,F,B.toString(),D.toString());
}};return C;};Changeset.makeAttribsString=function(E,A,D){if(!A){return"";}else{if((typeof A)=="string"){return A;
}else{if(D&&A&&A.length){if(A.length>1){A=A.slice();A.sort();}var C=[];for(var B=0;B<A.length;B++){var F=A[B];
if(E=="="||(E=="+"&&F[1])){C.push("*"+Changeset.numToString(D.putAttrib(F)));}}return C.join("");}}}};
Changeset.subattribution=function(I,F,H){var E=Changeset.opIterator(I,0);var D=Changeset.smartOpAssembler();
var A=Changeset.newOp();var B=Changeset.newOp();var C=Changeset.newOp();function G(){if(B.chars){while(B.opcode&&(A.opcode||E.hasNext())){if(!A.opcode){E.next(A);
}if(B.opcode&&A.opcode&&B.chars>=A.chars&&A.lines>0&&B.lines<=0){B.lines++;}Changeset._slicerZipperFunc(A,B,C,null);
if(C.opcode){D.append(C);C.opcode="";}}}}B.opcode="-";B.chars=F;G();if(H===undefined){if(A.opcode){D.append(A);
}while(E.hasNext()){E.next(A);D.append(A);}}else{B.opcode="=";B.chars=H-F;G();}return D.toString();};
Changeset.inverse=function(U,F,G,J){function P(a){if(F.get){return F.get(a);}else{return F[a];}}function Z(){if((typeof F.length)=="number"){return F.length;
}else{return F.length();}}function Q(a){if(G.get){return G.get(a);}else{return G[a];}}function Y(){if((typeof G.length)=="number"){return G.length;
}else{return G.length();}}var C=0;var E=0;var D=null;var I;var A=Changeset.newOp("+");var R=Changeset.unpack(U);
var N=Changeset.opIterator(R.ops);var H=Changeset.builder(R.newLen);function M(c,f){if((!D)||(I!=C)){D=Changeset.opIterator(Q(C));
I=C;var b=0;var d=false;while(!d){D.next(A);if(b+A.chars>=E){A.chars-=(E-b);d=true;}else{b+=A.chars;}}}while(c>0){if((!A.chars)&&(!D.hasNext())){C++;
E=0;I=C;A.chars=0;D=Changeset.opIterator(Q(C));}if(!A.chars){D.next(A);}var a=Math.min(c,A.chars);f(a,A.attribs,a==A.chars&&A.lines>0);
c-=a;A.chars-=a;E+=a;}if((!A.chars)&&(!D.hasNext())){C++;E=0;}}function X(b,a){if(a){C+=a;E=0;}else{if(D&&I==C){M(b,function(){});
}else{E+=b;}}}function S(f){var a=0;var b=Changeset.stringAssembler();var c=P(C).substring(E);a+=c.length;
b.append(c);var g=C+1;while(a<f){var d=P(g);a+=d.length;b.append(d);g++;}return b.toString().substring(0,f);
}function W(b){var a={};return function(c){if(!a[c]){a[c]=b(c);}return a[c];};}var K=[];var L=[];while(N.hasNext()){var B=N.next();
if(B.opcode=="="){if(B.attribs){K.length=0;L.length=0;Changeset.eachAttribNumber(B.attribs,function(a){K.push(J.getAttribKey(a));
L.push(J.getAttribValue(a));});var T=W(function(g){var d=[];for(var a=0;a<K.length;a++){var c=K[a];var f=L[a];
var b=Changeset.attribsAttributeValue(g,c,J);if(f!=b){d.push([c,b]);}}return Changeset.makeAttribsString("=",d,J);
});M(B.chars,function(a,c,b){H.keep(a,b?1:0,T(c));});}else{X(B.chars,B.lines);H.keep(B.chars,B.lines);
}}else{if(B.opcode=="+"){H.remove(B.chars,B.lines);}else{if(B.opcode=="-"){var V=S(B.chars);var O=0;M(B.chars,function(a,b,c){H.insert(V.substr(O,a),b);
O+=a;});}}}}return Changeset.checkRep(H.toString());};Changeset.follow=function(O,N,K,G,L){var C=Changeset.unpack(O);
var A=Changeset.unpack(N);var P=C.oldLen;var M=A.oldLen;Changeset.assert(P==M,"mismatched follow");var I=Changeset.stringIterator(C.charBank);
var H=Changeset.stringIterator(A.charBank);var F=C.newLen;var D=0;var B=0;var E=Changeset.attributeTester(["insertorder","first"],G);
var J=Changeset.applyZip(C.ops,0,A.ops,0,function(R,Q,S){if(R.opcode=="+"||Q.opcode=="+"){var T;if(Q.opcode!="+"){T=1;
}else{if(R.opcode!="+"){T=2;}else{var W=I.peek(1);var U=H.peek(1);var X=E(R.attribs);var V=E(Q.attribs);
if(X&&!V){T=1;}else{if(V&&!X){T=2;}else{if(W=="\n"&&U!="\n"){T=2;}else{if(W!="\n"&&U=="\n"){T=1;}else{if(K){T=2;
}else{T=1;}}}}}}}if(T==1){I.skip(R.chars);S.opcode="=";S.lines=R.lines;S.chars=R.chars;S.attribs="";R.opcode="";
}else{H.skip(Q.chars);Changeset.copyOp(Q,S);Q.opcode="";}}else{if(R.opcode=="-"){if(!Q.opcode){R.opcode="";
}else{if(R.chars<=Q.chars){Q.chars-=R.chars;Q.lines-=R.lines;R.opcode="";if(!Q.chars){Q.opcode="";}}else{R.chars-=Q.chars;
R.lines-=Q.lines;Q.opcode="";}}}else{if(Q.opcode=="-"){Changeset.copyOp(Q,S);if(!R.opcode){Q.opcode="";
}else{if(Q.chars<=R.chars){R.chars-=Q.chars;R.lines-=Q.lines;Q.opcode="";if(!R.chars){R.opcode="";}}else{S.lines=R.lines;
S.chars=R.chars;Q.lines-=R.lines;Q.chars-=R.chars;R.opcode="";}}}else{if(!R.opcode){Changeset.copyOp(Q,S);
Q.opcode="";}else{if(!Q.opcode){R.opcode="";}else{S.opcode="=";S.attribs=Changeset.followAttributes(R.attribs,Q.attribs,G);
if(R.chars<=Q.chars){S.chars=R.chars;S.lines=R.lines;Q.chars-=R.chars;Q.lines-=R.lines;R.opcode="";if(!Q.chars){Q.opcode="";
}}else{S.chars=Q.chars;S.lines=Q.lines;R.chars-=Q.chars;R.lines-=Q.lines;Q.opcode="";}}}}}}switch(S.opcode){case"=":D+=S.chars;
B+=S.chars;break;case"-":D+=S.chars;break;case"+":B+=S.chars;break;}});B+=F-D;if(L){newBank=JSON.stringify(Changeset.handsonActionFollow(JSON.parse(C.charBank),JSON.parse(A.charBank)))+"\n";
B+=newBank.length-A.charBank.length;A.charBank=newBank;}return Changeset.pack(F,B,J,A.charBank);};Changeset.handsonActionFollow=function(B,A){actionFollow(B,A);
return A;};Changeset.followAttributes=function(F,E,B){if((!E)||(!B)){return"";}if(!F){return E;}var A=[];
E.replace(/\*([0-9a-z]+)/g,function(H,G){A.push(B.getAttrib(Changeset.parseNum(G)));return"";});F.replace(/\*([0-9a-z]+)/g,function(K,J){var I=B.getAttrib(Changeset.parseNum(J));
for(var G=0;G<A.length;G++){var H=A[G];if(I[0]==H[0]){if(I[1]<=H[1]){A.splice(G,1);}break;}}return"";
});var C=Changeset.stringAssembler();for(var D=0;D<A.length;D++){C.append("*");C.append(Changeset.numToString(B.putAttrib(A[D])));
}return C.toString();};function actionFollow(B,A){B.map(function(C){if(C.type=="createRow"||C.type=="specCreateRow"){var D;
if(C.type=="createRow"){if(C.amount){D=C.amount;}else{return;}}else{if(C.data){D=C.data.length;}else{return;
}}A.map(function(E){if(E.type=="dataChange"){E.change.map(function(Q){if(Q[0]>=C.index){Q[0]+=D;}});}else{if(E.type=="createRow"||E.type=="specCreateRow"){if(E.index>=C.index){E.index+=D;
}}else{if(E.type=="removeRow"){if(E.index>=C.index){E.index+=D;}else{if(E.index+E.amount>C.index){E.type="useless-removeRow";
}}}else{if(E.type=="createCol"||E.type=="specCreateCol"){}else{if(E.type=="removeCol"){}else{if(E.type=="cellStyle2"||E.type=="specCellStyle2"){var M=E.stateBefore;
if(E.range.from.row>=C.index){E.range.highlight.row+=D;E.range.from.row+=D;E.range.to.row+=D;}else{if(E.range.to.row>=C.index){E.range.to.row+=D;
if(M){var J=C.index-E.range.from.row,N=E.range.to.col-E.range.from.col+1,K=getNullDataSet(N);for(var F=0;
F<D;F++){M.splice(J,0,deepClone(K));}}}}}else{if(E.type=="rowResize"){if(E.row>=C.index){E.row+=D;}}else{if(E.type=="colResize"){}else{if(E.type=="paste"){if((E.stateBefore&&E.stateBefore.z)||(E.stateUpdated&&E.stateUpdated.z)){return;
}if(E.range.to.row>=C.index){E.changes.map(function(Q){if(Q[0]>=C.index){Q[0]+=D;}});var P=E.stateBefore.style,O=E.stateUpdated?E.stateUpdated.style:null;
if(E.range.from.row>=C.index){E.range.from.row+=D;E.range.to.row+=D;}else{if(E.range.to.row>=C.index){E.range.to.row+=D;
var J=C.index-E.range.from.row,N=E.range.to.col-E.range.from.col+1,K=getNullDataSet(N);for(var F=0;F<D;
F++){P.splice(J,0,deepClone(K));if(O){O.splice(J,0,deepClone(K));}}}}}}else{if(E.type=="mergeCells"){}else{if(E.type=="unmergeCells"){}else{if(E.type=="columnSort"){if(E.range&&E.range.to.row<C.index){}else{var H={};
for(var G in E.sortIndex){var I=parseInt(G),L=parseInt(E.sortIndex[G]);if(I>=C.index){I+=D;}if(L>=C.index){L+=D;
}H[I]=L;}if(E.range){if(E.range.from.row>=C.index){E.range.from.row+=D;E.range.to.row+=D;}else{if(E.range.to.row>=C.index){E.range.to.row+=D;
for(var F=0;F<D;F++){var G=C.index+F;H[G]=G;}}}}else{for(var F=0;F<D;F++){var G=C.index+F;H[G]=G;}}E.sortIndex=H;
}}}}}}}}}}}}}});}else{if(C.type=="removeRow"){A.map(function(E){if(E.type=="dataChange"){E.change.map(function(P){if(P[0]>=C.index+C.amount){P[0]-=C.amount;
}else{if(P[0]>=C.index){E.type="useless-dataChange";}}});}else{if(E.type=="createRow"||E.type=="specCreateRow"){if(E.index>=C.index+C.amount){E.index-=C.amount;
}else{if(E.index>=C.index){E.index=C.index;}}}else{if(E.type=="removeRow"){if(E.index>=C.index+C.amount){E.index-=C.amount;
}else{if(E.index+E.amount<=C.index){}else{E.type="useless-removeRow";}}}else{if(E.type=="createCol"||E.type=="specCreateCol"){}else{if(E.type=="removeCol"){}else{if(E.type=="cellStyle2"||E.type=="specCellStyle2"){var F=E.stateBefore;
if(E.range.from.row>=C.index+C.amount){E.range.highlight.row-=C.amount;E.range.from.row-=C.amount;E.range.to.row-=C.amount;
}else{if(E.range.from.row>=C.index){if(E.range.to.row>=C.index+C.amount){var I=C.index+C.amount-E.range.from.row;
E.range.highlight.row=C.index;E.range.from.row=C.index;E.range.to.row-=C.amount;if(F){F.splice(0,I);}}else{E.type="useless-cellStyle2";
}}else{if(E.range.to.row>=C.index+C.amount){if(F){var J=C.index-E.range.from.row;F.splice(J,C.amount);
}E.range.to.row-=C.amount;}else{if(E.range.to.row>=C.index){E.range.to.row=C.index-1;}}}}}else{if(E.type=="rowResize"){if(E.row>=C.index+C.amount){E.row-=C.amount;
}else{if(E.row>=C.index){E.type="useless-rowResize";}}}else{if(E.type=="colResize"){}else{if(E.type=="paste"){if((E.stateBefore&&E.stateBefore.z)||(E.stateUpdated&&E.stateUpdated.z)){return;
}if(E.range.to.row>=C.index){var K=[];E.changes.map(function(P){if(P[0]>=C.index+C.amount){P[0]-=C.amount;
}else{if(P[0]>=C.index){P=null;}}if(P){K.push(P);}});if(K.length==0){E.type="useless-paste";}else{E.changes=K;
}var H=E.stateBefore.style,G=E.stateUpdated?E.stateUpdated.style:null;if(E.range.from.row>=C.index+C.amount){E.range.highlight.row-=C.amount;
E.range.from.row-=C.amount;E.range.to.row-=C.amount;}else{if(E.range.from.row>=C.index){if(E.range.to.row>=C.index+C.amount){var I=C.index+C.amount-E.range.from.row;
E.range.highlight.row=C.index;E.range.from.row=C.index;E.range.to.row-=C.amount;if(H){H.splice(0,I);}if(G){G.splice(0,I);
}}else{E.type="useless-paste";}}else{if(E.range.to.row>=C.index+C.amount){var J=C.index-E.range.from.row;
if(H){H.splice(J,C.amount);}if(G){G.splice(J,C.amount);}E.range.to.row-=C.amount;}else{if(E.range.to.row>=C.index){E.range.to.row=C.index-1;
}}}}}}else{if(E.type=="mergeCells"){}else{if(E.type=="unmergeCells"){}else{if(E.type=="columnSort"){if(E.range){if(E.range.from.row>=C.index+C.amount){E.range.highlight.row-=C.amount;
E.range.from.row-=C.amount;E.range.to.row-=C.amount;var M={};for(var L in E.sortIndex){var N=L-C.amount,O=E.sortIndex[L]-C.amount;
M[N]=O;}E.sortIndex=M;}else{if(E.range.to.row<C.index){}else{E.type="useless-columnSort";}}}else{E.type="useless-columnSort";
}}}}}}}}}}}}}});}else{if(C.type=="createCol"||C.type=="specCreateCol"){var D;if(C.type=="createCol"){if(C.amount){D=C.amount;
}else{return;}}else{if(C.data&&C.data[0]){D=C.data[0].length;}else{return;}}A.map(function(E){if(E.type=="dataChange"){E.change.map(function(H){if(H[1]>=C.index){H[1]+=D;
}});}else{if(E.type=="createRow"||E.type=="specCreateRow"){}else{if(E.type=="removeRow"){}else{if(E.type=="createCol"||E.type=="specCreateCol"){if(E.index>=C.index){E.index+=D;
}}else{if(E.type=="removeCol"){if(E.index>=C.index){E.index+=D;}else{if(E.index+E.amount>C.index){E.type="useless-removeCol";
}}}else{if(E.type=="cellStyle2"||E.type=="specCellStyle2"){var F=E.stateBefore;if(E.range.from.col>=C.index){E.range.highlight.col+=D;
E.range.from.col+=D;E.range.to.col+=D;}else{if(E.range.to.col>=C.index){E.range.to.col+=D;if(F){var G=C.index-E.range.from.col;
arrayEach(F,function(H){H.splice(G,0,getNullDataSet(null,D));});}}}}else{if(E.type=="rowResize"){}else{if(E.type=="colResize"){if(E.col>=C.index){E.col+=D;
}}else{if(E.type=="paste"){if((E.stateBefore&&E.stateBefore.z)||(E.stateUpdated&&E.stateUpdated.z)){return;
}if(E.range.to.col>=C.index){E.changes.map(function(H){if(H[1]>=C.index){H[1]+=D;}});var F=E.stateUpdated?E.stateUpdated.style:null;
if(F){if(E.range.from.col>=C.index){E.range.highlight.col+=D;E.range.from.col+=D;E.range.to.col+=D;}else{if(E.range.to.col>=C.index){E.range.to.col+=D;
var G=C.index-E.range.from.col;arrayEach(F,function(H){H.splice(G,0,getNullDataSet(null,D));});}}}}}else{if(E.type=="mergeCells"){}else{if(E.type=="unmergeCells"){}else{if(E.type=="columnSort"){}}}}}}}}}}}}});
}else{if(C.type=="removeCol"){A.map(function(E){if(E.type=="dataChange"){E.change.map(function(L){if(L[1]>=C.index+C.amount){L[1]-=C.amount;
}else{if(L[1]>=C.index){E.type="useless-dataChange";}}});}else{if(E.type=="createRow"||E.type=="specCreateRow"){}else{if(E.type=="removeRow"){}else{if(E.type=="createCol"||E.type=="specCreateCol"){if(E.index>=C.index+C.amount){E.index-=C.amount;
}else{if(E.index>=C.index){E.index=C.index;}}}else{if(E.type=="removeCol"){if(E.index>=C.index+C.amount){E.index-=C.amount;
}else{if(E.index+E.amount<=C.index){}else{E.type="useless-removeCol";}}}else{if(E.type=="cellStyle2"||E.type=="specCellStyle2"){var G=E.stateBefore;
if(E.range.from.col>=C.index+C.amount){E.range.highlight.col-=C.amount;E.range.from.col-=C.amount;E.range.to.col-=C.amount;
}else{if(E.range.from.col>=C.index){if(E.range.to.col>=C.index+C.amount){var J=C.index+C.amount-E.range.from.col;
E.range.highlight.col=C.index;E.range.from.col=C.index;E.range.to.col-=C.amount;if(G){arrayEach(G,function(L){L.splice(0,J);
});}}else{E.type="useless-cellStyle2";}}else{if(E.range.to.col>=C.index+C.amount){if(G){var K=C.index-E.range.from.col;
arrayEach(G,function(L){L.splice(K,C.amount);});}E.range.to.col-=C.amount;}else{if(E.range.to.col>=C.index){E.range.to.col=C.index-1;
}}}}}else{if(E.type=="rowResize"){}else{if(E.type=="colResize"){if(E.col>=C.index+C.amount){E.col-=C.amount;
}else{if(E.col>=C.index){E.type="useless-colResize";}}}else{if(E.type=="paste"){if((E.stateBefore&&E.stateBefore.z)||(E.stateUpdated&&E.stateUpdated.z)){return;
}if(E.range.to.col>=C.index){var I=[];E.changes.map(function(L){if(L[1]>=C.index+C.amount){L[1]-=C.amount;
}else{if(L[1]>=C.index){L=null;}}if(L){I.push(L);}});if(I.length==0){E.type="useless-paste";}else{E.changes=I;
}var H=E.stateBefore.style,F=E.stateUpdated?E.stateUpdated.style:null;if(E.range.from.col>=C.index+C.amount){E.range.highlight.col-=C.amount;
E.range.from.col-=C.amount;E.range.to.col-=C.amount;}else{if(E.range.from.col>=C.index){if(E.range.to.col>=C.index+C.amount){var J=C.index+C.amount-E.range.from.col;
E.range.highlight.col=C.index;E.range.from.col=C.index;E.range.to.col-=C.amount;if(H){arrayEach(H,function(L){L.splice(0,J);
});}if(F){arrayEach(F,function(L){L.splice(0,J);});}}else{E.type="useless-paste";}}else{if(E.range.to.col>=C.index+C.amount){var K=C.index-E.range.from.col;
if(H){arrayEach(H,function(L){L.splice(K,C.amount);});}if(F){arrayEach(F,function(L){L.splice(K,C.amount);
});}E.range.to.col-=C.amount;}else{if(E.range.to.col>=C.index){E.range.to.col=C.index-1;}}}}}}else{if(E.type=="mergeCells"){}else{if(E.type=="ummergeCells"){}else{if(E.type=="columnSort"){}}}}}}}}}}}}});
}}}}});return A;}function getNullDataSet(C){var B=[];for(var A=0;A<C;A++){B.push(null);}return B;}function deepClone(A){if(typeof A==="object"){return JSON.parse(JSON.stringify(A));
}return A;}function arrayEach(A,D){var B=-1,C=A.length;while(++B<C){if(D(A[B],B,A)===false){break;}}return A;
}
/*
 * Copyright 2009 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS-IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function makeCSSManager(O){var D=true;
function I(S){var Q=document.styleSheets;for(var P=0;P<Q.length;P++){var R=Q[P];if(R.title==S){return R;
}}if(pad_compatible.isIE9()){return Q[0];}return null;}var A=I(O);function F(){return(A.cssRules||A.rules);
}function N(P){if(A.deleteRule){A.deleteRule(P);}else{A.removeRule(P);}}function J(Q,P,R){if(!R){if(A.insertRule){A.insertRule(P+" {}",Q);
}else{A.addRule(P,null,Q);}}else{var S=P+" {"+(R||"")+"}";if(A.insertRule){A.insertRule(S,Q);}else{A.addRule(P,R,Q);
}}}var C=[];function G(Q){for(var P=0;P<C.length;P++){if(C[P]==Q){return P;}}return -1;}function E(P,R){if(D){var Q=G(P);
if(Q<0){J(0,P,R);C.splice(0,0,P);Q=0;}return F().item(Q).style;}else{B[P]={};return B[P];}}var B={};function L(){while(C.length){B[C[0]]=E(C[0]);
H(C[0]);}D=false;}function K(){return D;}function M(){D=true;for(var P in B){var Q=B[P].cssText;if(Q){E(P,String(Q));
}else{var R=E(P);for(k in B[P]){if(B[P][k]){R[k]=B[P][k];}}}delete B[P];}}function H(Q){if(D){var P=G(Q);
if(P>=0){N(P);C.splice(P,1);}}else{B[Q];}}return{selectorStyle:E,removeSelectorStyle:H,disable:L,enable:M,isEnabled:K,info:function(){return C.length+":"+F().length;
}};}
/*
 * Copyright 2009 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS-IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var colorutils={};
colorutils.css2triple=function(C){var B=colorutils.css2sixhex(C);function A(D){return Number("0x"+D)/255;
}return[A(B.substr(0,2)),A(B.substr(2,2)),A(B.substr(4,2))];};colorutils.css2sixhex=function(E){var A=/[0-9a-fA-F]+/.exec(E)[0];
if(A.length!=6){var C=A.charAt(0);var B=A.charAt(1);var D=A.charAt(2);A=C+C+B+B+D+D;}return A;};colorutils.triple2css=function(B){function A(D){var C=colorutils.clamp(Math.round(D*255),0,255);
return("0"+C.toString(16)).slice(-2);}return"#"+A(B[0])+A(B[1])+A(B[2]);};colorutils.clamp=function(A,C,B){return A<C?C:(A>B?B:A);
};colorutils.min3=function(C,B,A){return(C<B)?(C<A?C:A):(B<A?B:A);};colorutils.max3=function(C,B,A){return(C>B)?(C>A?C:A):(B>A?B:A);
};colorutils.colorMin=function(A){return colorutils.min3(A[0],A[1],A[2]);};colorutils.colorMax=function(A){return colorutils.max3(A[0],A[1],A[2]);
};colorutils.scale=function(B,A,C){return colorutils.clamp(A+B*(C-A),0,1);};colorutils.unscale=function(B,A,C){return colorutils.clamp((B-A)/(C-A),0,1);
};colorutils.scaleColor=function(C,B,A){return[colorutils.scale(C[0],B,A),colorutils.scale(C[1],B,A),colorutils.scale(C[2],B,A)];
};colorutils.unscaleColor=function(C,B,A){return[colorutils.unscale(C[0],B,A),colorutils.unscale(C[1],B,A),colorutils.unscale(C[2],B,A)];
};colorutils.luminosity=function(A){return A[0]*0.3+A[1]*0.59+A[2]*0.11;};colorutils.saturate=function(A){var C=colorutils.colorMin(A);
var B=colorutils.colorMax(A);if(B-C<=0){return[1,1,1];}return colorutils.unscaleColor(A,C,B);};colorutils.blend=function(C,B,A){return[colorutils.scale(A,C[0],B[0]),colorutils.scale(A,C[1],B[1]),colorutils.scale(A,C[2],B[2])];
}
/*
 * Copyright 2009 Google Inc.
 * 
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 * 
 *      http://www.apache.org/licenses/LICENSE-2.0
 * 
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS-IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
;
undoModule=(function(){var A=(function(){var O=[];var Q=0;var S="undoableEvent";var P="externalChange";
function R(){O.length=0;O.push({elementType:S,eventType:"bottom"});Q=1;}R();function V(a){var Z=extend({},a);
Z.elementType=S;O.push(Z);Q++;}function W(a){var Z=O.length-1;if(O[Z].elementType==P){O[Z].changeset=Changeset.compose(O[Z].changeset,a,D());
}else{O.push({elementType:P,changeset:a});}}function T(h){var f=O.length-1-h;var Z=O.length-1;while(Z>f||O[Z].elementType==P){if(O[Z].elementType==P){var b=O[Z];
var a=O[Z-1];if(a.backset){var d=b.changeset;var g=a.backset;a.backset=Changeset.follow(d,a.backset,false,D());
b.changeset=Changeset.follow(g,b.changeset,true,D());if((typeof a.selStart)=="number"){var c=Changeset.characterRangeFollow(d,a.selStart,a.selEnd);
a.selStart=c[0];a.selEnd=c[1];if(a.selStart==a.selEnd){a.selFocusAtStart=false;}}}O[Z-1]=b;O[Z]=a;if(Z>=2&&O[Z-2].elementType==P){b.changeset=Changeset.compose(O[Z-2].changeset,b.changeset,D());
O.splice(Z-2,1);Z--;}}else{Z--;}}}function Y(Z){T(Z);return O[O.length-1-Z];}function X(){return Q;}function U(){T(0);
Q--;return O.pop();}return{numEvents:X,popEvent:U,pushEvent:V,pushExternalChange:W,clearStack:R,getNthFromTop:Y};
})();var B=0;function L(){A.clearStack();B=0;}function J(Q,R){var O=0;var P=0;while(O>=0&&O<Q.length){O=Q.indexOf(R,O);
if(O>=0){P++;O++;}}return P;}function C(O,P){return J(Changeset.unpack(O).ops,P);}function M(P,O){if(!P){return O;
}if(!O){return P;}var W=C(P,"+");var V=C(O,"+");var T=C(P,"-");var S=C(O,"-");if(W==1&&V==1&&T==0&&S==0){var Q=Changeset.compose(P,O,D());
var U=C(Q,"+");var R=C(Q,"-");if(U==1&&R==0){return Q;}}else{if(W==0&&V==0&&T==1&&S==1){var Q=Changeset.compose(P,O,D());
var U=C(Q,"+");var R=C(Q,"-");if(U==0&&R==1){return Q;}}}return null;}function K(O){var P=A.getNthFromTop(0);
function R(){if((typeof O.selStart)=="number"){P.selStart=O.selStart;P.selEnd=O.selEnd;P.selFocusAtStart=O.selFocusAtStart;
}}if((!O.backset)||Changeset.isIdentity(O.backset)){R();}else{var Q=false;if(P.eventType==O.eventType){var S=M(O.backset,P.backset);
if(S){P.backset=S;R();Q=true;}}var T=A.numEvents()-B;while(A.numEvents()>T){A.popEvent();}if(!Q){A.pushEvent(O);
}B=0;}}function I(O){if(O&&!Changeset.isIdentity(O)){A.pushExternalChange(O);}}function G(O){if((typeof O.selStart)!="number"){return null;
}else{return{selStart:O.selStart,selEnd:O.selEnd,selFocusAtStart:O.selFocusAtStart};}}function F(){return B<A.numEvents()-1;
}function H(O){if(F()){var Q=A.getNthFromTop(B);var P=A.getNthFromTop(B+1);var R=O(Q.backset,G(P));A.pushEvent(R);
B+=2;}else{O();}}function E(){return B>=2;}function N(O){if(E()){var Q=A.getNthFromTop(0);var P=A.getNthFromTop(1);
O(Q.backset,G(P));A.popEvent();B-=2;}else{O();}}function D(){return undoModule.apool;}return{clearHistory:L,reportEvent:K,reportExternalChange:I,performUndo:H,performRedo:N,enabled:true,canPerformUndo:F,canPerformRedo:E,apool:null};
})();
/*
 * Copyright 2009 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS-IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
if(typeof(server_side_import)!="undefined"){server_side_import("etherpad.collab.ace.easysync2.Changeset");
}var _MAX_LIST_LEVEL=8;var ZEROWIDTH_SPACE="\u200b";function sanitizeUnicode(A){return A.replace(/[\uffff\ufffe\ufeff\ufdd0-\ufdef\ud800-\udfff]/g,"?");
}function makeContentCollector(m,N,I,c,Y){N=N||{};var D=c||{isNodeText:function(s){return(s.nodeType==3);
},nodeTagName:function(s){return s.tagName;},nodeValue:function(s){return s.nodeValue;},nodeNumChildren:function(s){return s.childNodes.length;
},nodeChild:function(u,s){return u.childNodes.item(s);},nodeProp:function(u,s){var v="http://www.w3.org/2000/svg";
if(s=="className"&&u.namespaceURI==v){return u[s].baseVal;}return u[s];},nodeAttr:function(s,u){return s.getAttribute&&s.getAttribute(u);
},optNodeInnerHTML:function(s){return s.innerHTML;}};var n={div:1,p:1,pre:1,li:1,table:1};function V(s){return !!n[(D.nodeTagName(s)||"").toLowerCase()];
}function L(s){return sanitizeUnicode(s.replace(/\u200b/g,"").replace(/[\n\r ]/g," ").replace(/\xa0/g," ").replace(/\t/g,"        "));
}function a(s){return L(s).replace(/-/g," ");}function R(u,s){return D.nodeProp(u,"_magicdom_"+s);}var C=(function(){var s=[];
var x=[];var u=null;var w=Changeset.newOp("+");var v={length:function(){return s.length;},atColumnZero:function(){return s[s.length-1]==="";
},startNew:function(){s.push("");v.flush(true);u=Changeset.smartOpAssembler();},textOfLine:function(y){return s[y];
},appendText:function(y,z){s[s.length-1]+=y;w.attribs=z;w.chars=y.length;u.append(w);},textLines:function(){return s.slice();
},attribLines:function(){return x;},flush:function(y){if(u){x.push(u.toString());u=null;}}};v.startNew();
return v;}());var A={};function Q(s){if(!C.atColumnZero()){A.startNewLine(s);}}var M=[];var P,H,G;var F=[-1,-1],E=[-1,-1];
var q={div:1,p:1,pre:1};var T=false;var K=0;function W(s,u){if(D.nodeNumChildren(s)==0){return true;}if(D.nodeNumChildren(s)==1&&R(s,"shouldBeEmpty")&&D.optNodeInnerHTML(s)=="&nbsp;"&&!R(s,"unpasted")){if(u){var v=D.nodeChild(s,0);
O(v,0,u);O(v,1,u);}return true;}return false;}function J(w,u){var v=C.length()-1;var s=C.textOfLine(v).length;
if(s==0&&u.listType&&u.listType!="none"){s+=1;}else{if(s==0&&u.textalignType&&u.textalignType!="none"){s+=1;
}}s+=w;return[v,s];}function U(s,u,v){if(!D.isNodeText(s)){O(s,u,v);}}function O(v,s,u){if(H&&v==H.node&&H.index==s){F=J(0,u);
}if(G&&v==G.node&&G.index==s){E=J(0,u);}}A.incrementFlag=function(s,u){s.flags[u]=(s.flags[u]||0)+1;};
A.decrementFlag=function(s,u){s.flags[u]--;};A.incrementAttrib=function(s,u){if(!s.attribs[u]){s.attribs[u]=1;
}else{s.attribs[u]++;}B(s);};A.decrementAttrib=function(s,u){s.attribs[u]--;B(s);};function o(s){var u=s.savedFontAttribs;
s.savedFontAttribs=s.attribs;s.attribs={};B(s);}function g(s,u){s.attribs=s.savedFontAttribs;s.savedFontAttribs=u;
B(s);}function X(s,u,w){var v=s.listType;s.listLevel=(s.listLevel||0)+1;if(u!="none"){s.listNesting=(s.listNesting||0)+1;
}s.listType=u;s.listStart=w;B(s);return v;}function h(s,u){s.listLevel--;if(s.listType!="none"){s.listNesting--;
}s.listType=u;delete s.lang;delete s.listStart;B(s);}function j(s,u){s.textalignType=u;s.textalignLevel=(s.textalignLevel||0)+1;
B(s);return u;}function b(s,u){s.textalignLevel--;s.textalignType=u;B(s);}function p(s,v){var u=s.author;
s.authorLevel=(s.authorLevel||0)+1;s.author=v;B(s);return u;}function l(s,u){s.authorLevel--;s.author=u;
B(s);}function r(s,v,u){if((typeof docContentAttr[s]!="boolean")){if(s=="color"){if(v.indexOf("rgb")!=-1){u.push([s,docContentAttr[s][0]]);
}else{u.push([s,v]);}}else{if(docContentAttr[s].contains(v)){u.push([s,v]);}else{u.push([s,docContentAttr[s][0]]);
}}}else{u.push([s,v]);}return u;}function B(s){var u=[];for(var v in s.attribs){if(s.attribs[v]&&!s.table&&docContentAttr[v]){if(attrQueue.size()>0){if(v=="font-family"&&!docContentAttr[v].contains(attrQueue.reverseList(v))){continue;
}u.push([v,attrQueue.reverseList(v)]);}else{u.push([v,"true"]);}}}if(s.link){var AD=["link",s.link];u.push(AD);
}if(s.img){var z=["img",s.img];u.push(z);}if(s.embed){var AA=["embed",s.embed];u.push(AA);}if(s.table){for(var w=0;
w<s.table.length;w++){var y=[s.table[w][0],s.table[w][1]];u.push(y);}var AC=["table",true];u.push(AC);
}if(s.tex){var AB=["tex",s.tex];u.push(AB);}if(s.authorLevel>0){var x=["author",s.author];if(I.putAttrib(x,true)==-1){I.putAttrib(x,false);
M.push(s.author);}u.push(x);}s.attribString=Changeset.makeAttribsString("+",u,I);}function Z(s){var u=[["list",s.listType],["insertorder","first"]];
if(s.listStart){u.push(["start",s.listStart]);s.listStart=parseInt(s.listStart)+1;}if(s.lang){u.push(["lang",s.lang]);
}if(s.author){var v=["author",s.author];if(I.putAttrib(v,true)==-1){I.putAttrib(v,false);M.push(s.author);
}u.push(v);}if(s.textalignType){var w=["textalign",s.textalignType];u.push(w);}C.appendText("*",Changeset.makeAttribsString("+",u,I));
}function S(s){var v=["textalign",s.textalignType];if(s.author){var u=["author",s.author];if(I.putAttrib(u,true)==-1){I.putAttrib(u,false);
M.push(s.author);}v.push(u);}C.appendText("*",Changeset.makeAttribsString("+",v,I));}A.startNewLine=function(s){if(s&&s.table){return;
}if(K>1){T=true;}K=0;if(s){var u=C.textOfLine(C.length()-1).length==0;if(u&&s.listType&&s.listType!="none"&&!s.table){Z(s);
}else{if(u&&s.textalignType&&s.textalignType!="none"&&!s.table){S(s);}}}C.startNew();};A.notifySelection=function(s){if(s){P=s;
H=P.startPoint;G=P.endPoint;}};A.doAttrib=function(s,u){s.localAttribs=(s.localAttribs||[]);s.localAttribs.push(u);
A.incrementAttrib(s,u);};A.collectContent=function(v,s){function AK(x,Ar,Ao,Aq,An){var Ap=(Ar.length-Ao.length);
F[1]=F[1]-Ap;E[1]=E[1]-Ap;if(x&&x.length){C.appendText(L(x),s.attribString);}if(Aq){s.link=Aq;}B(s);C.appendText(a(Ao),s.attribString);
s.link=null;B(s);if(An&&An.length){C.appendText(L(An),s.attribString);}AB="";}if(!s){s={flags:{},localAttribs:null,link:null,columnId:null,rowId:null,attribs:{},attribString:""};
}var Aj=s.localAttribs;s.localAttribs=null;var AY=V(v);var AW=W(v,s);if(AY){Q(s);}var AP=true;var Ah=C.length()-1;
U(v,0,s);if(D.isNodeText(v)){var z=D.nodeValue(v);if(s.MsoNormal){z=z.replace(/\s+/g," ");}var AV="";
var AG=0;if(z.length==0){if(H&&v==H.node){F=J(0,s);}if(G&&v==G.node){E=J(0,s);}}while(z.length>0){var AS=0;
if(s.flags.preMode){var AZ=z.split("\n",1)[0];AS=AZ.length+1;AV=z.substring(AS);z=AZ;}else{}if(H&&v==H.node&&H.index-AG<=z.length){F=J(H.index-AG,s);
}if(G&&v==G.node&&G.index-AG<=z.length){E=J(G.index-AG,s);}if(z[0]==ZEROWIDTH_SPACE){if(F[1]>-1){F[1]--;
}if(E[1]>-1){E[1]--;}}var AB=z;if((!s.flags.preMode)&&/^[\r\n]*$/.exec(z)){AB="";}var AN=C.textOfLine(C.length()-1).length==0;
if(AN){AB=AB.replace(/^\n*/,"");}if(AN&&s.listType&&s.listType!="none"&&!s.table){Z(s);}else{if(AN&&s.textalignType&&s.textalignType!="none"){S(s);
}}var Ae=new RegExp("^[\\s]*((http|https)://[^\\s]+.(png|jpg|jpeg|gif|svg)(\\?.*)?)[\\s]*$","i");var AX=z.match(Ae);
if(AX&&!s.link&&!z.match(/https:\/\/www.dropbox.com/)){s.img=AX[1];B(s);C.appendText("*",s.attribString);
s.img=null;B(s);A.startNewLine(s);F[0]++;F[1]=AB.length;E[0]++;E[1]=AB.length;}else{if(typeof(embedlyUrl)!="undefined"){var Ak=new RegExp("^[\\s]*((http|https)://[^\\s]+)[\\s]*$","i");
var AT=z.match(Ak);if(AT&&!s.link&&embedlyUrl(AT[1])){s.embed=AT[1];B(s);C.appendText("*",s.attribString);
s.embed=null;B(s);A.startNewLine(s);F[0]++;F[1]=AB.length;E[0]++;E[1]=AB.length;}}}if(typeof(location)!="undefined"){var AL=new RegExp("(.*)("+location.protocol+"//"+location.host+"/([^\\s]+)#([^:][^\\s]+))(.*)");
var y=z.match(AL);if(y){AK(y[1],y[2],y[4],"/"+y[3],y[5]);}else{AL=new RegExp("(.*)("+location.protocol+"//"+location.host+"/([^\\s#]+)-([a-zA-Z0-9]{11}))(#[^\\s]+)?(.*)");
y=z.match(AL);if(y){var Al=y[5]?": "+y[5].replace(/#:h=/,""):"";AK(y[1],y[2],y[3]+Al,"/"+y[4]+(y[5]||""),y[6]);
}}}var AL=new RegExp("(.*)(https://github.com/([^/]+)/([^/]+)/(issues|pull)/([\\d]+))(.*)");var y=z.match(AL);
if(y){AK(y[1],y[2],y[3]+"/"+y[4]+"#"+y[6],y[2],y[7]);}var Ai=new RegExp("(.*)(\ud83c\udccf|\ud83c\udc04|\ud83c[\udd70-\ude51][^\ud83c]|\ud83c[\udde6-\uddff]\ud83c[\udde6-\uddff]|\ud83c[\udf00-\udfff]|\ud83d[\udc00-\ude4f]|\ud83d[\ude80-\udeff]|[\u2000-\u3299]\ufe0f|[\u23e9-\u23f3]|\u26ce|[\u2705-\u27bf]|[\u0030-\u0039]\ufe0f\u20e3)(.*)");
var AA=z.match(Ai);var AQ=function(An,x){return((((AA[2].charCodeAt(x?2:0)-55296)<<10)|(AA[2].charCodeAt(x?3:1)-56320))+65536).toString(16);
};if(AA){var AF;if(AA[2].length==4){AF=AQ(AA[2]).toLowerCase()+"_"+AQ(AA[2],true).toLowerCase();}else{if(AA[2].charCodeAt(0)>=8192&&AA[2].charCodeAt(0)<=12953){AF=AA[2].charCodeAt(0).toString(16).toLowerCase();
}else{if(AA[2].charCodeAt(0)>=48&&AA[2].charCodeAt(0)<=57){AF="00"+AA[2].charCodeAt(0).toString(16)+"_"+AA[2].charCodeAt(2).toString(16);
}else{AF=AQ(AA[2]);}}}AK(AA[1],AA[2],":emoji_"+AF+": ",undefined,AA[3]);}if(s.table){s.table.push([s.rowId+":"+s.columnId,L(AB)]);
}else{C.appendText(L(AB),s.attribString);}AG+=AS;z=AV;if(z.length>0){A.startNewLine(s);}}}else{var u=(D.nodeTagName(v)||"").toLowerCase();
var w=D.nodeProp(v,"className");if(!w){w=D.nodeAttr(v,"class");}if(u=="br"){A.startNewLine(s);}else{if(u=="script"||u=="style"){}else{if(u=="img"){s.img=D.nodeAttr(v,"src");
B(s);C.appendText("*",s.attribString);s.img=null;B(s);}else{if((u=="span"&&(w&&/inline-embed/.exec(w)))){s.embed=D.nodeAttr(v,"embed");
B(s);C.appendText("*",s.attribString);s.embed=null;B(s);AP=false;}else{if((u=="span"&&(w&&/inline-tex/.exec(w)))){s.tex=D.nodeAttr(v,"tex");
B(s);C.appendText("*",s.attribString);s.tex=null;B(s);}else{if(AW&&s.table&&(u=="td"||u=="th")){s.columnId++;
}else{if(!AW){if(w&&/MsoNormal/.exec(w)){s.MsoNormal=true;}var AE=D.nodeAttr(v,"style");var AD=(u=="pre");
if((!AD)&&N.safari){AD=(AE&&/\bwhite-space:\s*pre\b/i.exec(AE));}if(AD){A.incrementFlag(s,"preMode");
}var AJ=null;var AO=null;var AR=null;var Aa=null;if(m){if(AE&&/\bfont-weight:\s*normal\b/i.exec(AE)){AO=(o(s)||{});
}if(u=="b"||u=="strong"){attrQueue.add("bold&true");A.doAttrib(s,"bold");}if(u=="i"||u=="em"){attrQueue.add("italic&true");
A.doAttrib(s,"italic");}if(u=="u"||u=="ins"){attrQueue.add("underline&true");A.doAttrib(s,"underline");
}if(u=="s"||u=="del"||u=="strike"){attrQueue.add("strikethrough&true");A.doAttrib(s,"strikethrough");
}if(u=="font"&&v.size){attrQueue.add("font-size&"+fontSizeToOrder[v.size]);A.doAttrib(s,"font-size");
}if(u=="font"&&v.face){attrQueue.add("font-family&"+v.face);A.doAttrib(s,"font-family");}if(u=="font"&&v.color){attrQueue.add("color&"+v.color);
A.doAttrib(s,"color");}if(u=="sup"){attrQueue.add("superscript&true");A.doAttrib(s,"superscript");}if(u=="sub"){attrQueue.add("subscript&true");
A.doAttrib(s,"subscript");}this.spiltStyle(AE,s);if(u=="code"||u=="pre"){AJ=(X(s,"code1")||"none");if(!AD){AD=true;
A.incrementFlag(s,"preMode");}}if(w&&w.match("highlight")){A.doAttrib(s,"highlight");}if(u=="a"&&D.nodeAttr(v,"href")){s.link=D.nodeAttr(v,"href");
B(s);}if(u=="ul"||u=="ol"){var AM=w&&/(?:^| )lang-(([a-z]+))\b/.exec(w);if(AM&&AM[1]){s.lang=AM[1];}var AU;
var AI=w&&/(?:^| )list-(([a-z]+)[12345678]?)\b/.exec(w);AU=AI&&AI[1]||"bullet"+String(Math.min(_MAX_LIST_LEVEL,(s.listNesting||0)+1));
var Ag=D.nodeAttr(v,"start");if(K>1&&AU.indexOf("indent")>-1&&s.listType&&s.listType.indexOf("indent")==-1){}else{AJ=(X(s,AU,Ag)||"none");
}if(AI&&AI[1].indexOf("code")>-1){if(!AD){AD=true;A.incrementFlag(s,"preMode");}}}if((u=="div"||u=="p")&&w&&/text-align-type/.exec(w)){var Ac=w&&/(?:^| )text-align-type-([a-z]+)\b/.exec(w);
var Af=Ac&&Ac[1]||"left";AR=(j(s,Af)||"none");}if((u=="div"||u=="p")&&w&&/gutter/.exec(w)){K=K+1;}if((u=="div"||u=="p")&&w&&w.match(/(?:^| )ace-line\b/)){}if(s.table&&(u=="td"||u=="th")){s.columnId++;
}if(Y&&w){var AH=w.match(/\S+/g);if(AH&&AH.length>0){for(var AC=0;AC<AH.length;AC++){var Ab=AH[AC];var Am=Y(Ab);
if(Am){break;}}}}}if(AP){var Ad=D.nodeNumChildren(v);var u=(D.nodeTagName(v)||"").toLowerCase();if(AP){for(var AC=0;
AC<Ad;AC++){var Ab=D.nodeChild(v,AC);A.collectContent(Ab,s);}if(s.table&&u=="table"){B(s);C.appendText("*",s.attribString);
s.table=null;B(s);}}}if(s.link){s.link=null;B(s);}if(AD){A.decrementFlag(s,"preMode");}if(s.localAttribs){for(var AC=0;
AC<s.localAttribs.length;AC++){attrQueue.recycleAttr(s.localAttribs[AC]);A.decrementAttrib(s,s.localAttribs[AC]);
}}if(AJ){h(s,AJ);}if(AR){b(s,AR);}if(Aa){l(s,Aa);}if(AO){g(s,AO);}s.MsoNormal=false;}}}}}}}}U(v,1,s);
if(AY){if(C.length()-1==Ah){A.startNewLine(s);}else{Q(s);}}s.localAttribs=Aj;};A.notifyNextNode=function(s){if((!s)||(V(s)&&!W(s))){Q(null);
}};A.spiltStyle=function(x,w){if(x){var u=x.split(";");if(u){for(var s=0;s<u.length;s++){if(u[s]&&(/\bfont-weight\b/i.exec(u[s]))||(/\bfont-style\b/i.exec(u[s]))||(/underline/i.exec(u[s]))||(/line-through/i.exec(u[s])||/\bsub\b/i.exec(u[s])||/\bsuper\b/i.exec(u[s]))){if(u[s]&&/\bfont-weight\b/i.exec(u[s])){attrQueue.add("bold&true");
A.doAttrib(w,"bold");}if(u[s]&&/\bfont-style\b/i.exec(u[s])){attrQueue.add("italic&true");A.doAttrib(w,"italic");
}if(u[s]&&/\bsub\b/i.exec(u[s])){attrQueue.add("subscript&true");A.doAttrib(w,"subscript");}if(u[s]&&/\bsuper\b/i.exec(u[s])){attrQueue.add("superscript&true");
A.doAttrib(w,"superscript");}if(u[s]&&/underline/i.exec(u[s])){attrQueue.add("underline&true");A.doAttrib(w,"underline");
}if(u[s]&&/line-through/i.exec(u[s])){attrQueue.add("strikethrough&true");A.doAttrib(w,"strikethrough");
}}else{var v=u[s].split(":");if(v[0]&&v[1]&&docContentAttr[v[0].trim()]){var y=v[1]&&v[1].trim()||"true";
y=y.replace(/\"/g,"");attrQueue.add(v[0].trim()+"&"+v[1].trim());A.doAttrib(w,v[0].trim());}}}}}};var f=function(){return F;
};var d=function(){return E;};A.getLines=function(){return C.textLines();};A.finish=function(){C.flush();
var u=C.attribLines();var s=A.getLines();s.length--;u.length--;var w=f();var x=d();function y(){var AE=2000;
var AI=10;var AG=0;var AF=0;for(var z=s.length-1;z>=0;z--){var AB=s[z];var AD=u[z];if(AB.length>AE+AI){var AA=[];
var AC=[];while(AB.length>AE){lengthToTake=AE;AA.push(AB.substring(0,lengthToTake));AB=AB.substring(lengthToTake);
AC.push(Changeset.subattribution(AD,0,lengthToTake));AD=Changeset.subattribution(AD,lengthToTake);}if(AB.length>0){AA.push(AB);
AC.push(AD);}function AH(AJ){if(AJ[0]<0){return;}var AK=AJ[0];var AM=AJ[1];if(AK>z){AK+=(AA.length-1);
}else{if(AK==z){var AL=0;while(AM>AA[AL].length){AM-=AA[AL].length;AL++;}AK+=AL;}}AJ[0]=AK;AJ[1]=AM;}AH(w);
AH(x);AG++;AF+=AA.length;AA.unshift(z,1);s.splice.apply(s,AA);AC.unshift(z,1);u.splice.apply(u,AC);}}return{linesWrapped:AG,numLinesAfter:AF};
}var v=y();return{selStart:w,selEnd:x,linesWrapped:v.linesWrapped,numLinesAfter:v.numLinesAfter,lines:s,lineAttribs:u,newAuthors:M,nestedDomLines:T};
};return A;}
/*
 * Copyright 2009 Google Inc.
 * 
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 * 
 *      http://www.apache.org/licenses/LICENSE-2.0
 * 
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS-IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function makeChangesetTracker(X,S,C,W){var E=Changeset.makeAText("\n");
var B=null;var A=Changeset.identity(1);var L=false;var I=false;var O=false;var R=null;var M=null;function U(){if(R&&M===null){M=S.setTimeout(function(){try{R();
}catch(Y){}finally{M=null;}},0);}}var J=null;var Q=null;function T(Y){if(Q===null){Q=S.setTimeout(function(){try{if(!D.hasUncommittedChanges()&&J){window.updateSheetTabs(J);
J=null;}if(J!=null){T(500);}}catch(Z){}finally{Q=null;}},Y);}}var H=false;var P=false;var G=false;var F="BB08J2";
var N=false;var V=0;var K=[];var D;return D={isTracking:function(){return L;},isSheet:function(){return H;
},setSheet:function(Y){H=Y;},getSubId:function(){return F;},setSubId:function(Y){if(!D.hasUncommittedChanges()){F=Y;
P=false;G=false;return true;}return false;},setSheetPosition:function(Y){V=Y;},setBaseText:function(Y){D.setBaseAttributedText(Changeset.makeAText(Y),null);
},setBaseAttributedText:function(Z,Y,a){W.withCallbacks("setBaseText",function(b){L=true;B=null;I=true;
try{if(H){A=Changeset.identity(V);window.updateSheetTabs(a);D.setHandsonActionText(Z.text);C.fromJsonable({numToAttrib:{"0":["author","p.7"],"1":["table","123"]},nextNum:2});
b.setDocumentAttributedText({text:unescape("%u672A%u547D%u540D%u8868%u683C%0A%0A*%0A%0A"),attribs:"*0+5|1+1*0|1+1*0*1+1*0|1+1|1+1"});
}else{E=Changeset.cloneAText(Z);if(Y){var c=(new AttribPool()).fromJsonable(Y);E.attribs=Changeset.moveOpsToNewPool(E.attribs,c,C);
}A=Changeset.identity(E.text.length);b.setDocumentAttributedText(E);}}catch(d){}finally{I=false;}});},getBaseAttributedText:function(){return Changeset.cloneAText(E);
},composeUserChangeset:function(Y){if(!L){return;}if(I){return;}if(Changeset.isIdentity(Y)){return;}A=Changeset.compose(A,Y,C);
U();},postHandsonActionHeader:function(a,Y,Z){if(!D.hasUncommittedChanges()){O=true;if(Y){F=Y;}if(Z){N=Z;
}D.postHandsonActionChangeset(a,false);return true;}return false;},postHandsonActionChangeset:function(a,c){var b=a;
var Y=Changeset.newLen(A);if(!Changeset.isIdentity(A)){Y=Changeset.oldLen(A);var d=JSON.parse(Changeset.charBank(A));
b=d.concat(a);}var Z=Changeset.builder(Y);Z.keep(Y-1);Z.insert(JSON.stringify(b)+"\n");A=Z.toString();
G=c||false;if(G){G+="\n";}U();},setHandsonActionText:function(Y){X.domAndRepSpliceToHandson(Y.split("\n").filter(function(Z){if(Z.length>0&&Z[0]=="["){return true;
}else{return false;}}));},getIsNeedKeyData:function(){return P;},setIsNeedKeyData:function(Y,Z){if(F!=Z){Y=false;
}if(!Y){G=false;}P=Y;},applyChangesToBase:function(Y,f,b,Z,d,a){if(!L){return;}W.withCallbacks("applyChangesToBase",function(q){if(H){if(d){J=Changeset.charBank(Y);
T(0);return;}if(B){K.push([Y,Z,a]);}else{if(!Changeset.isIdentity(A)){var c=A;A=Changeset.follow(Y,c,false,C,Z==F);
var o=document.getElementById("sheet-id");var g=o.getHotInstance();if(c!=A){if(g){g.runHooks("beforeRevertAction",Changeset.charBank(c));
}}if(a||Z==F){D.setHandsonActionText(Changeset.charBank(Y));}if(c!=A){if(g){g.runHooks("beforeUpdateAction",Changeset.charBank(A));
}}}else{if(a||Z==F){D.setHandsonActionText(Changeset.charBank(Y));}A=Changeset.identity(Changeset.newLen(Y));
}}}else{if(b){var p=(new AttribPool()).fromJsonable(b);Y=Changeset.moveOpsToNewPool(Y,p,C);}E=Changeset.applyToAText(Y,E,C);
var h=Y;if(B){var j=B;B=Changeset.follow(Y,j,false,C);h=Changeset.follow(j,Y,true,C);}var l=true;var c=A;
A=Changeset.follow(h,c,l,C);var n=Changeset.follow(c,h,!l,C);var m=true;I=true;try{q.applyChangesetToDocument(n,m);
}catch(r){}finally{I=false;}}});},prepareUserChangeset:function(){var Y;if(B){if(H){if(!Changeset.isIdentity(A)){var f=Changeset.oldLen(B);
var h=JSON.parse(Changeset.charBank(B));var g=JSON.parse(Changeset.charBank(A));a=JSON.stringify(h.concat(g));
var b=Changeset.builder(f);b.keep(f-1);b.insert(a+"\n");Y=b.toString();}else{Y=B;}}else{Y=Changeset.compose(B,A,C);
}}else{if(Changeset.isIdentity(A)){Y=null;}else{Y=A;}}var Z=null;if(Y){B=Y;A=Changeset.identity(Changeset.newLen(Y));
Z=Y;}var c=null;if(Z){var d=Changeset.prepareForWire(Z,C);c=d.pool.toJsonable();Z=d.translated;}var a={changeset:Z,apool:c,keydata:G,subId:F,head:O,oSubId:N};
N=false;O=false;return a;},userChangesetForWire:function(){var Z=null;var a=null;if(!Changeset.isIdentity(A)){var Y=Changeset.prepareForWire(A,C);
Z=Y.pool.toJsonable();a=Y.translated;}return{changeset:a,apool:Z};},applyPreparedChangesetToBase:function(d,a,f){if(!B){throw new Error("applySubmittedChangesToBase: no submitted changes to apply");
}if(H){if(K.length>0){var Z=B;var b=A;K.map(function(h){var j=h[0];var g=h[1];var l=B;B=Changeset.follow(j,B,false,C,a==g);
if(!Changeset.isIdentity(A)){var m=Changeset.follow(l,j,true,C);A=Changeset.follow(m,A,false,C,a==g);
}});var c=document.getElementById("sheet-id");var Y=c.getHotInstance();if(b!=A){if(Y){Y.runHooks("beforeRevertAction",Changeset.charBank(b));
}}if(Z!=B){if(Y){Y.runHooks("beforeRevertAction",Changeset.charBank(Z));}}K.map(function(g){var l=g[0];
var h=g[1];var j=g[2];if(j||a==h){D.setHandsonActionText(Changeset.charBank(l));}});K=[];if(Z!=B){if(Y){Y.runHooks("beforeUpdateAction",Changeset.charBank(B));
}if(Changeset.isIdentity(A)){A=Changeset.identity(Changeset.newLen(B));}}if(b!=A){if(Y){Y.runHooks("beforeUpdateAction",Changeset.charBank(A));
}}}}else{E=Changeset.applyToAText(B,E,C);}B=null;},setUserChangeNotificationCallback:function(Y){R=Y;
},hasUncommittedChanges:function(){return !!(B||(!Changeset.isIdentity(A)));}};}
/*
 * Copyright 2009 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS-IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
if(typeof(server_side_import)!="undefined"){server_side_import("etherpad.collab.ace.easysync2.Changeset");
}var linestylefilter={};linestylefilter.ATTRIB_CLASSES={bold:"tag:b",italic:"tag:i",underline:"tag:u",strikethrough:"tag:s",superscript:"tag:sup",subscript:"tag:sub",code:"line:code"};
linestylefilter.getAuthorClassName=function(A){return"author-"+A.replace(/[^a-y0-9]/g,function(B){if(B=="."){return"-";
}return"z"+B.charCodeAt(0)+"z";});};linestylefilter.className2Author=function(A){var B=A.replace(/^fa-author-|^author-|^gutter-author-/,"");
if(B!=A){return B.replace(/[a-y0-9]+|-|z.+?z/g,function(C){if(C=="-"){return".";}else{if(C.charAt(0)=="z"){return String.fromCharCode(Number(C.slice(1,-1)));
}else{return C;}}});}return null;};var RELATIVE_URL_RE=new RegExp("^(/|https?://[w.]*docx.qq.com).*");
var RELATIVE_URL_RE2=new RegExp("^(/|https?://[w.]*docs.qq.com).*");linestylefilter.getLineStyleFilter=function(D,E,A,C){if(D==0){A("","line:longKeep line:gutter-noauthor");
return A;}var B=A;var F=(function(){var Z=D;var S=0;var Q;var R;var G;var O=null;var U=0;var J=null;var I=null;
var N=null;var W="";var V=false;var P=false;var K="";function Y(d,c){var a=[];var b=[];Changeset.eachAttribNumber(d,function(h){var f=C.getAttribKey(h);
if(f){var g=C.getAttribValue(h);if(g){if(f=="author"){hasAuthor=true;var j=false;Changeset.eachAttribNumber(d,function(o){var m=C.getAttribKey(o);
if(m&&m=="list"){j=true;}});if(c>U){O=g;U=c;}a.push(linestylefilter.getAuthorClassName(g));}else{if(f=="link"){a.push("attrlink","url:"+encodeURIComponent(g));
if(g.match(RELATIVE_URL_RE)||g.match(RELATIVE_URL_RE2)){a.push("internal");}}else{if(f=="autolink"){a.push("tag:autolink");
}else{if(f=="image-width"){a.push("image-width:"+g);}else{if(f=="image-height"){a.push("image-height:"+g);
}else{if(f=="image-textalign"){b.push("text-align:"+g);}else{if(f=="splitline"){a.push("splitline:"+g);
}else{if(f=="img"){a.push("attrimg img:"+encodeURIComponent(g));}else{if(f=="attachmentPlaceholder"){a.push("placeholder-"+encodeURIComponent(g));
}else{if(f=="embed"){a.push("attrembed embed:"+encodeURIComponent(g));}else{if(f=="table"){a.push("attrtable table:"+encodeURIComponent(g));
}else{if(f=="tex"){a.push("attrtex tex:"+encodeURIComponent(g));}else{if(f=="last-col"){a.push("last-col");
V=true;}else{if(f=="colname"){a.push("colname");P=true;}else{if(f=="diff"&&g=="plus"){a.push("added");
I=false;}else{if(f=="diff"&&g=="minus"){a.push("removed");I=false;}else{if(f=="longkeep"){a.push("longkeep");
I=(I!=false);}else{if(f=="list"&&/(\D+)(\d+)/.test(g)){a.push("list:"+g);var l=/(\D+)(\d+)/.exec(g);N=l[1];
}else{if(f=="start"){a.push("start:"+g);}else{if(f=="highlight"){a.push("highlight");}else{if(f=="lang"){a.push("lang:"+g);
}else{if(docContentAttr&&docContentAttr[f]){a.push(f+":"+g);b.push(f+":"+g);}else{if(linestylefilter.ATTRIB_CLASSES[f]){a.push(linestylefilter.ATTRIB_CLASSES[f]);
}else{if(f=="textalign"){a.push("textalign:"+g);!K&&(K=g);}else{if(f=="lineFontSize"){!J&&(J=g);}}}}}}}}}}}}}}}}}}}}}}}}}}}});
W=b.join("&");return a.join(" ");}var X=Changeset.opIterator(E);var H,M;function L(){H=X.next();M=(H.opcode&&Y(H.attribs,H.chars));
}L();function T(){if(S<Z){Q=M;R=W;G=H.chars;L();while(H.opcode&&M==Q){G+=H.chars;L();}}}T();return function(b,d){var g=true;
while(b.length>0){if(G<=0){return B(b,d);}var c=b.length;if(c>G){c=G;}var h=b.substring(0,c);b=b.substring(c);
var f=(d&&d+" ")+Q;B(h,f,R);if(f.indexOf("added")==-1){g=false;}S+=c;G-=c;if(G==0){T();}}var a="";if(!P){a+=O?"line:gutter-"+linestylefilter.getAuthorClassName(O):"line:gutter-noauthor";
}a+=(I?" line:longKeep":"");a+=(V?" line:lastCol":"");a+=(P?" line:aCol":"");a+=(N?" line:line-list-type-"+N:"");
a+=(K?" line:text-align-type-"+K:"");a+=(J?" line:line-fontsize-"+J:"");a+=" line:emptyGutter";if(g){a+=" line:allAdd";
}B("",a);};})();return F;};linestylefilter.getAtSignSplitterFilter=function(E,C){var B=/@/g;B.lastIndex=0;
var A=null;var D;while((D=B.exec(E))){if(!A){A=[];}A.push(D.index);}if(!A){return C;}return linestylefilter.textAndClassFuncSplitter(C,A);
};linestylefilter.getRegexpFilter=function(A,B,C){return function(K,I){A.lastIndex=0;var D=null;var F=null;
var E;while((E=A.exec(K))){if(!D){D=[];F=[];}var G=E.index;var H=E[0];D.push([G,H]);F.push(G,G+H.length);
}if(!D){return I;}function L(O){for(var N=0;N<D.length;N++){var M=D[N];if(O>=M[0]&&O<M[0]+M[1].length){return M[1];
}}return false;}var J=(function(){var M=0;return function(N,O,R){var P=N.length;var Q=O;I(N,Q,R);M+=P;
};})();return linestylefilter.textAndClassFuncSplitter(J,F);};};linestylefilter.REGEX_WORDCHAR_WITHOUT_00DF=/[\u0030-\u0039\u0041-\u005A\u0061-\u007A\u00C0-\u00D6\u00D8-\u00DE\u00E0-\u00F6\u00F8-\u00FF\u0100-\u1FFF\u3040-\u9FFF\uF900-\uFDFF\uFE70-\uFEFE\uFF10-\uFF19\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFDC]/;
linestylefilter.REGEX_WORDCHAR=/[\u0030-\u0039\u0041-\u005A\u0061-\u007A\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u00FF\u0100-\u1FFF\u3040-\u9FFF\uF900-\uFDFF\uFE70-\uFEFE\uFF10-\uFF19\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFDC]/;
linestylefilter.REGEX_URLCHAR=new RegExp("("+/[-:@a-zA-Z0-9_.,~%+\/\\?=&#;()!'$]/.source+"|"+linestylefilter.REGEX_WORDCHAR_WITHOUT_00DF.source+")");
linestylefilter.REGEX_URL=new RegExp(/(?:(?:https?|sftp|ftps?|ssh|ircs?|file|gopher|telnet|nntp|worldwind|chrome|chrome-extension|svn|git|mms|smb|afp|nfs|(x-)?man|gopher|txmt):\/\/|mailto:|xmpp:|sips?:|tel:|sms:|news:|bitcoin:|magnet:|urn:|geo:)/.source+linestylefilter.REGEX_URLCHAR.source+"*(?![:.,;\\)'])"+linestylefilter.REGEX_URLCHAR.source,"gi");
linestylefilter.getURLFilter=linestylefilter.getRegexpFilter(linestylefilter.REGEX_URL,"url");linestylefilter.getCodeSpanFilter=linestylefilter.getRegexpFilter(new RegExp(/`[^`]+`/g),"code",true);
linestylefilter.EMOJI_LIST=["+1","-1","100","1234","8ball","a","ab","abc","abcd","accept","aerial_tramway","airplane","alarm_clock","alien","ambulance","anchor","angel","anger","angry","anguished","ant","apple","aquarius","aries","arrow_backward","arrow_double_down","arrow_double_up","arrow_down","arrow_down_small","arrow_forward","arrow_heading_down","arrow_heading_up","arrow_left","arrow_lower_left","arrow_lower_right","arrow_right","arrow_right_hook","arrow_up","arrow_up_down","arrow_up_small","arrow_upper_left","arrow_upper_right","arrows_clockwise","arrows_counterclockwise","art","articulated_lorry","astonished","athletic_shoe","atm","b","baby","baby_bottle","baby_chick","baby_symbol","back","baggage_claim","balloon","ballot_box_with_check","bamboo","banana","bangbang","bank","bar_chart","barber","baseball","basketball","bath","bathtub","battery","bear","bee","beer","beers","beetle","beginner","bell","bento","bicyclist","bike","bikini","bird","birthday","black_circle","black_joker","black_large_square","black_medium_small_square","black_medium_square","black_nib","black_small_square","black_square_button","blossom","blowfish","blue_book","blue_car","blue_heart","blush","boar","boat","bomb","book","bookmark","bookmark_tabs","books","boom","boot","bouquet","bow","bowling","boy","bread","bride_with_veil","bridge_at_night","briefcase","broken_heart","bug","bulb","bullettrain_front","bullettrain_side","bus","busstop","bust_in_silhouette","busts_in_silhouette","cactus","cake","calendar","calling","camel","camera","cancer","candy","capital_abcd","capricorn","car","card_index","carousel_horse","cat","cat2","cd","chart","chart_with_downwards_trend","chart_with_upwards_trend","checkered_flag","cherries","cherry_blossom","chestnut","chicken","children_crossing","chocolate_bar","christmas_tree","church","cinema","circus_tent","city_sunrise","city_sunset","cl","clap","clapper","clipboard","clock1","clock10","clock1030","clock11","clock1130","clock12","clock1230","clock130","clock2","clock230","clock3","clock330","clock4","clock430","clock5","clock530","clock6","clock630","clock7","clock730","clock8","clock830","clock9","clock930","closed_book","closed_lock_with_key","closed_umbrella","cloud","clubs","cn","cocktail","coffee","cold_sweat","collision","computer","confetti_ball","confounded","confused","congratulations","construction","construction_worker","convenience_store","cookie","cool","cop","copyright","corn","couple","couple_with_heart","couplekiss","cow","cow2","credit_card","crescent_moon","crocodile","crossed_flags","crown","cry","crying_cat_face","crystal_ball","cupid","curly_loop","currency_exchange","curry","custard","customs","cyclone","dancer","dancers","dango","dart","dash","date","de","deciduous_tree","department_store","diamond_shape_with_a_dot_inside","diamonds","disappointed","disappointed_relieved","dizzy","dizzy_face","do_not_litter","dog","dog2","dollar","dolls","dolphin","door","doughnut","dragon","dragon_face","dress","dromedary_camel","droplet","dvd","e-mail","ear","ear_of_rice","earth_africa","earth_americas","earth_asia","egg","eggplant","eight","eight_pointed_black_star","eight_spoked_asterisk","electric_plug","elephant","email","end","envelope","envelope_with_arrow","es","euro","european_castle","european_post_office","evergreen_tree","exclamation","expressionless","eyeglasses","eyes","facepunch","factory","fallen_leaf","family","fast_forward","fax","fearful","feet","ferris_wheel","file_folder","fire","fire_engine","fireworks","first_quarter_moon","first_quarter_moon_with_face","fish","fish_cake","fishing_pole_and_fish","fist","five","flags","flashlight","flipper","floppy_disk","flower_playing_cards","flushed","foggy","football","footprints","fork_and_knife","fountain","four","four_leaf_clover","fr","free","fried_shrimp","fries","frog","frowning","fuelpump","full_moon","full_moon_with_face","game_die","gb","gem","gemini","ghost","gift","gift_heart","girl","globe_with_meridians","goat","golf","grapes","green_apple","green_book","green_heart","grey_exclamation","grey_question","grimacing","grin","grinning","guardsman","guitar","gun","haircut","hamburger","hammer","hamster","hand","handbag","hankey","hash","hatched_chick","hatching_chick","headphones","hear_no_evil","heart","heart_decoration","heart_eyes","heart_eyes_cat","heartbeat","heartpulse","hearts","heavy_check_mark","heavy_division_sign","heavy_dollar_sign","heavy_exclamation_mark","heavy_minus_sign","heavy_multiplication_x","heavy_plus_sign","helicopter","herb","hibiscus","high_brightness","high_heel","hocho","honey_pot","honeybee","horse","horse_racing","hospital","hotel","hotsprings","hourglass","hourglass_flowing_sand","house","house_with_garden","hushed","ice_cream","icecream","id","ideograph_advantage","imp","inbox_tray","incoming_envelope","information_desk_person","information_source","innocent","interrobang","iphone","it","izakaya_lantern","jack_o_lantern","japan","japanese_castle","japanese_goblin","japanese_ogre","jeans","joy","joy_cat","jp","key","keycap_ten","kimono","kiss","kissing","kissing_cat","kissing_closed_eyes","kissing_heart","kissing_smiling_eyes","knife","koala","koko","kr","lantern","large_blue_circle","large_blue_diamond","large_orange_diamond","last_quarter_moon","last_quarter_moon_with_face","laughing","leaves","ledger","left_luggage","left_right_arrow","leftwards_arrow_with_hook","lemon","leo","leopard","libra","light_rail","link","lips","lipstick","lock","lock_with_ink_pen","lollipop","loop","loud_sound","loudspeaker","love_hotel","love_letter","low_brightness","m","mag","mag_right","mahjong","mailbox","mailbox_closed","mailbox_with_mail","mailbox_with_no_mail","man","man_with_gua_pi_mao","man_with_turban","mans_shoe","maple_leaf","mask","massage","meat_on_bone","mega","melon","memo","mens","metro","microphone","microscope","milky_way","minibus","minidisc","mobile_phone_off","money_with_wings","moneybag","monkey","monkey_face","monorail","moon","mortar_board","mount_fuji","mountain_bicyclist","mountain_cableway","mountain_railway","mouse","mouse2","movie_camera","moyai","muscle","mushroom","musical_keyboard","musical_note","musical_score","mute","nail_care","name_badge","necktie","negative_squared_cross_mark","neutral_face","new","new_moon","new_moon_with_face","newspaper","ng","night_with_stars","nine","no_bell","no_bicycles","no_entry","no_entry_sign","no_good","no_mobile_phones","no_mouth","no_pedestrians","no_smoking","non-potable_water","nose","notebook","notebook_with_decorative_cover","notes","nut_and_bolt","o","o2","ocean","octopus","oden","office","ok","ok_hand","ok_woman","older_man","older_woman","on","oncoming_automobile","oncoming_bus","oncoming_police_car","oncoming_taxi","one","open_book","open_file_folder","open_hands","open_mouth","ophiuchus","orange_book","outbox_tray","ox","package","page_facing_up","page_with_curl","pager","palm_tree","panda_face","paperclip","parking","part_alternation_mark","partly_sunny","passport_control","paw_prints","peach","pear","pencil","pencil2","penguin","pensive","performing_arts","persevere","person_frowning","person_with_blond_hair","person_with_pouting_face","phone","pig","pig2","pig_nose","pill","pineapple","pisces","pizza","point_down","point_left","point_right","point_up","point_up_2","police_car","poodle","poop","post_office","postal_horn","postbox","potable_water","pouch","poultry_leg","pound","pouting_cat","pray","princess","punch","purple_heart","purse","pushpin","put_litter_in_its_place","question","rabbit","rabbit2","racehorse","radio","radio_button","railway_car","rainbow","raised_hand","raised_hands","raising_hand","ram","ramen","rat","recycle","red_car","red_circle","registered","relaxed","relieved","repeat","repeat_one","restroom","revolving_hearts","rewind","ribbon","rice","rice_ball","rice_cracker","rice_scene","ring","rocket","roller_coaster","rooster","rose","rotating_light","round_pushpin","rowboat","ru","rugby_football","runner","running","running_shirt_with_sash","sa","sagittarius","sailboat","sake","sandal","santa","satellite","satisfied","saxophone","school","school_satchel","scissors","scorpius","scream","scream_cat","scroll","seat","secret","see_no_evil","seedling","seven","shaved_ice","sheep","shell","ship","shirt","shit","shoe","shower","signal_strength","six","six_pointed_star","ski","skull","sleeping","sleepy","slot_machine","small_blue_diamond","small_orange_diamond","small_red_triangle","small_red_triangle_down","smile","smile_cat","smiley","smiley_cat","smiling_imp","smirk","smirk_cat","smoking","snail","snake","snowboarder","snowflake","snowman","sob","soccer","soon","sos","sound","space_invader","spades","spaghetti","sparkle","sparkler","sparkles","sparkling_heart","speak_no_evil","speaker","speech_balloon","speedboat","star","star2","stars","station","statue_of_liberty","steam_locomotive","stew","straight_ruler","strawberry","stuck_out_tongue","stuck_out_tongue_closed_eyes","stuck_out_tongue_winking_eye","sun_with_face","sunflower","sunglasses","sunny","sunrise","sunrise_over_mountains","surfer","sushi","suspension_railway","sweat","sweat_drops","sweat_smile","sweet_potato","swimmer","symbols","syringe","tada","tanabata_tree","tangerine","taurus","taxi","tea","telephone","telephone_receiver","telescope","tennis","tent","thought_balloon","three","thumbsdown","thumbsup","ticket","tiger","tiger2","tired_face","tm","toilet","tokyo_tower","tomato","tongue","top","tophat","tractor","traffic_light","train","train2","tram","triangular_flag_on_post","triangular_ruler","trident","triumph","trolleybus","trophy","tropical_drink","tropical_fish","truck","trumpet","tshirt","tulip","turtle","tv","twisted_rightwards_arrows","two","two_hearts","two_men_holding_hands","two_women_holding_hands","u5272","u5408","u55b6","u6307","u6708","u6709","u6e80","u7121","u7533","u7981","u7a7a","uk","umbrella","unamused","underage","unlock","up","us","v","vertical_traffic_light","vhs","vibration_mode","video_camera","video_game","violin","virgo","volcano","vs","walking","waning_crescent_moon","waning_gibbous_moon","warning","watch","water_buffalo","watermelon","wave","wavy_dash","waxing_crescent_moon","waxing_gibbous_moon","wc","weary","wedding","whale","whale2","wheelchair","white_check_mark","white_circle","white_flower","white_large_square","white_medium_small_square","white_medium_square","white_small_square","white_square_button","wind_chime","wine_glass","wink","wolf","woman","womans_clothes","womans_hat","womens","worried","wrench","x","yellow_heart","yen","yum","zap","zero","zzz"];
linestylefilter.REGEX_EMOJI=new RegExp(":(\\"+linestylefilter.EMOJI_LIST.join("|")+"):","gi");linestylefilter.getEmojiSpanFilter=linestylefilter.getRegexpFilter(linestylefilter.REGEX_EMOJI,"emoji");
linestylefilter.REGEX_EMOJI_CODE=new RegExp(":emoji_[^:]+:","gi");linestylefilter.getEmojiCodeSpanFilter=linestylefilter.getRegexpFilter(linestylefilter.REGEX_EMOJI_CODE,"emoji-code");
linestylefilter.REGEX_TEX=/\$\$.+\$\$/g;linestylefilter.getTexFilter=linestylefilter.getRegexpFilter(linestylefilter.REGEX_TEX,"tex");
linestylefilter.REGEX_HASHTAG=RegExp("(^|.)(#(?:_|"+linestylefilter.REGEX_WORDCHAR.source+")+)","g");
linestylefilter.getHashtagFilter=function(H,D){var C=linestylefilter.REGEX_HASHTAG;var I="hashtag";C.lastIndex=0;
var A=null;var B=null;var E=RegExp("^#\\d+$");H.replace(C,function(M,K,J,N,O){if(E.test(J)||linestylefilter.REGEX_WORDCHAR.test(K)||/^&$/.test(K)){return M;
}if(!A){A=[];B=[];}var L=N+K.length;A.push([L,J]);B.push(L,L+J.length);return M;});if(!A){return D;}function F(L){for(var K=0;
K<A.length;K++){var J=A[K];if(L>=J[0]&&L<J[0]+J[1].length){return J[1];}}return false;}var G=(function(){var J=0;
return function(K,L,O){var M=K.length;var N=L;var P=F(J);D(K,N,O);J+=M;};})();return linestylefilter.textAndClassFuncSplitter(G,B);
};linestylefilter.getTokenizerFilter=function(H,B,F,I){var A=I.getLineTokens(H,F||"start");var E=A.state;
A=A.tokens;var C=0;var D=[];forEach(A,function(J){if(J.type!="text"){D.push(C,C+J.value.length);}C+=J.value.length;
});var G=(function(){B("","line:lexer_"+E);return function(J,M,N){var O=false;for(var L=0;L<A.length;
L++){var K=A[L];if(K.value==J&&K.type!="text"){var P=M+" "+K.type.replace(/\./g," ");B(J,P,N);O=true;
break;}}if(!O){B(J,M,N);}};})();return linestylefilter.textAndClassFuncSplitter(G,D);};linestylefilter.textAndClassFuncSplitter=function(D,B){var A=0;
var C=0;while(B&&A<B.length&&B[A]==0){A++;}function E(F,H,I){if((!B)||A>=B.length){D(F,H,I);C+=F.length;
}else{var K=B;var G=K[A]-C;var J=F.length;if(G>=J){D(F,H,I);C+=F.length;if(G==J){A++;}}else{if(G>0){D(F.substring(0,G),H,I);
C+=G;}A++;E(F.substring(G),H,I);}}}return E;};linestylefilter.getFilterStack=function(B,F,E,G,D,C){var A=linestylefilter.getURLFilter(B,F);
if(!(C&&D)){A=linestylefilter.getHashtagFilter(B,A);}A=linestylefilter.getCodeSpanFilter(B,A);if(G){A=linestylefilter.getTexFilter(B,A);
}A=linestylefilter.getEmojiSpanFilter(B,A);A=linestylefilter.getEmojiCodeSpanFilter(B,A);if(C&&D){A=linestylefilter.getTokenizerFilter(B,A,D,C);
}if(E!==undefined&&E.msie){A=linestylefilter.getAtSignSplitterFilter(B,A);}return A;};linestylefilter.populateDomLine=function(F,D,E,H,G){var A=F;
if(A.slice(-1)=="\n"){A=A.substring(0,A.length-1);}function C(I,J){H.appendSpan(I,J,G);}var B=linestylefilter.getFilterStack(A,C);
B=linestylefilter.getLineStyleFilter(A.length,D,B,E);B(A,"");};
/*
 * Copyright 2009 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS-IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function _htmlEscaped(A){return String(A).replace(/\"/g,"&quot;").replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/&/g,"&amp;");
}var domline={};domline.noop=function(){};domline.identity=function(A){return A;};domline.embedhtml={};
domline.hashCode=function(B){var A=0;if(B.length==0){return A;}for(i=0;i<B.length;i++){var C=B.charCodeAt(i);
A=((A<<5)-A)+C;A=A&A;}return A;};domline.addToLineClass=function(A,B){B.replace(/\S+/g,function(C){if(C.indexOf("line:")==0){A=(A?A+" ":"")+C.substring(5);
}});return A;};domline.addTable=function(D,C){if(D==="true"){return;}if(!C){return"<span class='inline-table'><div style='' contenteditable='false'></div></span>";
}else{if(!window.isSheet){return"<span class='inline-table'><div style='' contenteditable='false'><iframe id='sheet-id' src='/ep/sheet' width='100%' height='50px' style='border:0' scrolling='yes'></iframe></div></span>";
}else{var A="";if($("#padeditor").hasClass("sheet-style")){var B=$("#editor").height();if(!$("#padbody").hasClass("tim")){B-=59;
}A=("height = '"+B+"px'");}return"<span class='inline-table'><div style='' contenteditable='false'><iframe id='sheet-id' name = 'sheet' src='/ep/sheet2?_bid=2517' width='100%' style='border:0px' scrolling='no' "+A+"></iframe></div></span>";
}}};domline.addSurrogate=function(D,E,G,F,C){var A=domline.hashCode(D);content='<span class="inline-'+E+'" '+E+'="'+_htmlEscaped(D)+'"><div contenteditable="false" class="embed-'+A+'">';
var B=domline.embedhtml[A];if(B){content+=B;}else{content+='<img class="inline-img" src="/static/img/pixel.gif" contenteditable="false">';
}content+="</div></span>";if(B==undefined){domline.embedhtml[A]=false;F(D,function(J){J=J||"";domline.embedhtml[A]=J;
var L=G.querySelectorAll(".embed-"+A);for(var K=0;K<L.length;K++){var M=L[K];M.innerHTML=J;if(document&&C){var I=M.querySelectorAll("img, iframe");
for(var H=0;H<I.length;++H){if(I[H].addEventListener){I[H].addEventListener("load",C,false);}else{I[H].attachEvent("onload",C);
}}}}});}return content;};var validUrlRe=new RegExp("^(?:https?|sftp|ftps?|ssh|ircs?|file|gopher|telnet|nntp|worldwind|chrome|chrome-extension|svn|git|mms|smb|afp|nfs|(x-)?man|gopher|txmt|x-hackpad-image-upload)://|^mailto:|^xmpp:|^sips?:|^tel:|^sms:|^news:|^bitcoin:|^magnet:|^urn:|^geo:|^/","i");
domline.createDomLine=function(W,M,E,H,P,N,S,O,K,R){var A={node:null,appendSpan:domline.noop,prepareForAdd:domline.noop,notifyAdded:domline.noop,clearSpans:domline.noop,finishUpdate:domline.noop,lineMarker:0};
var c=(E||{});var J=H;var U=false;if(J){A.node=J.createElement("div");}else{A.node={innerHTML:"",className:""};
}var C=[];var D,L;var I=null;function T(d){return domline.processSpaces(d,M);}var V=domline.identity;
var a=(M?V:T);var b=(M?T:V);var B="ace-line";var Z="http://loadstate";var G=false;var F=null;A.appendSpan=function(s,d,AH,AG){if(d.indexOf("list")>=0){var f=/(?:^| )list:(\S+)/.exec(d);
var o=/(?:^| )lang:(\S+)/.exec(d);if(o){o=o[1];}var w=/(?:^| )start:(\S+)/.exec(d);if(f){f=f[1];w=w?'start="'+w[1]+'"':"";
if(f){var AE=/(\D+)(\d+)/.exec(f);var p=AE[1];var r=AE[2];var AM=0;if(E=="email"){if(f.indexOf("indent")>-1){var AK=parseInt(f.substring("indent".length));
var AL=AK*1.5;D='<ul class="listtype-'+p+" listindent"+r+" list-"+f+'" style="list-style-type: none; margin: 0 0 0 '+AL+'em"><li>';
}if(f.indexOf("taskdone")>-1){D='<ul class="listtype-'+p+" listindent"+r+" list-"+f+'" style="list-style-type: none; margin: 0"><li><input type="checkbox" checked disabled>&nbsp;';
}else{if(f.indexOf("task")>-1){D='<ul class="listtype-'+p+" listindent"+r+" list-"+f+'" style="list-style-type: none; margin: 0"><li><input type="checkbox" disabled>&nbsp;';
}}}else{if(f.indexOf("number")<0){D='<ul class="listtype-'+p+" listindent"+r+" list-"+f+(o?" lang-"+o:"")+'" '+(o?'spellcheck="false"':"")+"><li>";
L="</li></ul>";}else{D="<ol "+w+' class="listtype-'+p+" listindent"+r+" list-"+f+'"><li>';L="</li></ol>";
}}}A.lineMarker=s.length;return;}}if(d.indexOf("textalign")>=0&&d.indexOf("img")<0){A.lineMarker=s.length;
return;}var h=null;var AF="";if(d.indexOf("url")>=0){d=d.replace(/(^| )url:(\S+)/g,function(AQ,AP,AN){try{h=decodeURIComponent(AN);
}catch(AO){h=AN;}return AP+"url";});if(d.indexOf("attrlink")>=0){AF=' class="attrlink"';}}var y=null;
if(d.indexOf("splitline")>=0){d=d.replace(/(^| )splitline:(\S+)/g,function(AP,AO,AN){y=AN;return AO+"splitline";
});}var j=null;if(d.indexOf("img")>=0){d=d.replace(/(^| )img:(\S+)/g,function(AP,AO,AN){j=decodeURIComponent(AN);
return AO+"img";});}var l=null;if(d.indexOf("emoji-code")>=0){d=d.replace(/(^| )emoji-code:(\S+)/g,function(AP,AO,AN){l=decodeURIComponent(AN).replace(/:/g,"");
return AO+"emoji";});}var u=null;if(d.indexOf("emoji")>=0){d=d.replace(/(^| )emoji:(\S+)/g,function(AP,AO,AN){u=decodeURIComponent(AN).replace(/:/g,"");
return AO+"emoji";});}var v=null;if(d.indexOf("embed")>=0){d=d.replace(/(^| )embed:(\S+)/g,function(AP,AO,AN){v=decodeURIComponent(AN);
return AO+"embed";});}var AB=null;if(d.indexOf("table")>=0){d=d.replace(/(^| )table:(\S+)/g,function(AP,AN,AO){AB=AO;
U=true;return AN+"table";});}var z=null;if(d.indexOf("tex")>=0){d=d.replace(/(^| )tex:(\S+)/g,function(AP,AO,AN){z=decodeURIComponent(AN);
return AO+"tex";});}if(d.indexOf("hashtag")>=0){d=d.replace(/(^| )hashtag:(\S+)/g,function(AP,AO,AN){h="/ep/search/?q="+AN;
if(typeof clientVars==="object"&&clientVars.padId){h+="&via="+clientVars.padId;}return AO+"hashtag url internal";
});}var q=null;var m="";var n="";if((!s)&&d){B=domline.addToLineClass(B,d);}else{if(s){if(h){if(P&&h.indexOf("/")==0){h=P+h;
}if(!validUrlRe.test(h)){h="";}m=m+"<a"+AF+' href="'+_htmlEscaped(h)+'">';n="</a>"+n;}if(q){q.sort();
m=m+"<"+q.join("><")+">";q.reverse();n="</"+q.join("></")+">"+n;}var AC="";if(AG){AC=" style='"+AG(AH)+"'";
}var g=null;var AD="";if(j){if(!validUrlRe.test(j)){j="";}if(j===Z){var AJ=O?'style="max-width:100%; max-height:auto;" ':"";
g="<div class='loading-media-fail'><div class='loading-media-image'></div><div class='loading-media-word'>加载失败,请重新加载!</div></div>";
AD=" nodeValue='*'";}else{var AJ=O(d);g="<img "+AJ+'class="inline-img"  src="'+_htmlEscaped(j)+'" faketext="*">';
AD=" nodeValue='*'";F=K;}}else{if(l){var x="";if(typeof clientVars==="object"&&clientVars.cdn){x=clientVars.cdn;
}var AI=l.split("_")[2]?"_"+l.split("_")[2]:"";var AA=l.split("_")[1]+AI;AA=AA.replace("fe0f","").replace("_","-");
g='<span class="emoji-glyph" title=":'+l+':" style="background-image:url('+x+"/static/img/emoji/unicode/"+AA+'.png)">:'+l+":</span><span></span>";
}else{if(u){var x="";if(typeof clientVars==="object"&&clientVars.cdn){x=clientVars.cdn;}g='<span class="emoji-glyph" title=":'+u+':" style="background-image:url('+x+"/static/img/emoji/"+u+'.png)">:'+u+":</span><span></span>";
}else{if(v&&N){if(E=="email"||E=="stream"){g=N(v);}else{g=domline.addSurrogate(v,"embed",H,N,K);}}else{if(AB){g=domline.addTable(AB,H);
F=K;}else{if(z&&S){g=domline.addSurrogate(z,"tex",H,S,K);}else{if(y){g="<hr class="+y+">";}else{g=a(domline.escapeHTML(s));
}}}}}}}if(B.indexOf("aCol")>-1&&(d.indexOf("colname")==-1&&!G)){G=true;C.push("<span>","&#8203;","</span>");
}if(d){d=d.replace(/[<]/g,"&lt").replace(/[>]/g,"&gt").replace(/["]/g,"&quot");}if((j&&!$.getAgent.isMobile())||y){C.push("<span contenteditable=false",AC,' class="',d||"",'">',m,g,n,"</span>");
}else{C.push("<span ",AC,' class="',d||"",'">',m,g,n,"</span>");}}}};A.clearSpans=function(){C=[];B="ace-line";
G=false;A.lineMarker=0;};function Y(d){$(".load_media").remove();window.blockingCooperation=false;if(pad_imageprocessor.getSelectImg){pad_imageprocessor.setCurrentDropImg(d.currentTarget);
pad_imageprocessor.refreshImgBarPosition(d.currentTarget);}pad_locate.locateRefreshAtCursor();}function X(f){$(".load_media").remove();
window.blockingCooperation=false;var g={node:$(f.currentTarget)[0],index:0,maxIndex:0};var d=padeditor.ace.getLineAndCharForPoint(g);
padeditor.ace.inCallStack("replaceImg",function(){padeditor.ace.performDocumentReplaceRange([d[0],d[1]],[d[0],d[1]+1],"");
setTimeout(function(){setStatusTips("图片上传失败",null,"#ff0000");},800);});}function Q(){if(B.indexOf("aCol")>-1&&!G){C.push("<span>","&#8203;","</span>");
}var d=b(C.join(""));if(!d){if((!J)||(!E)){d+="&nbsp;";}else{if(c.edge){d+="<br/>";}else{if(pad_compatible.isIE9()||pad_compatible.isIE10()){d+="<span></span>";
}else{d+="<br/>";}}}}if(W){d=(D||"")+d+(L||"");}C=D=L=null;if(d!==I){I=d;A.node.innerHTML=I;if(J&&F){var g=A.node.querySelectorAll("img, iframe");
for(var f=0;f<g.length;++f){if(g[f].addEventListener){$(g[f]).one("load",F);$(g[f]).one("load",Y);$(g[f]).one("error",X);
}else{g[f].attachEvent("onload",F);}}}}if(B!==null){if(R){function m(p){if(!p){return"";}var o=p.split(" ");
if(o.length>=2){return o[0].substr(0,1)+o[o.length-1].substr(0,1);}else{return p.substr(0,1);}}function n(p){if(!p){return"";
}var o=p.split(" ");return o.length>=2?o[0]+" "+o[o.length-1].substr(0,1):p;}var l=$(B.split(" ")).filter(function(){return this.match("^gutter-author-|^author-");
});if(l){var j=map(l,linestylefilter.className2Author);if(j.length){var h=R[j[0]];if(h){A.node.setAttribute("data-author-initials",m(h.name));
A.node.setAttribute("data-author-name",n(h.name));A.node.setAttribute("data-author-link",h.userLink||"");
}}}}if(U){B=(B+" sheet-display");}A.node.className=B;}}A.prepareForAdd=Q;A.finishUpdate=Q;A.getInnerHTML=function(){return I||"";
};return A;};domline.escapeHTML=function(B){var A=/[&<>'"]/g;/']/;if(!A.MAP){A.MAP={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;","'":"&#39;"};
}return B.replace(A,function(C){return A.MAP[C];});};domline.processSpaces=function(F,G){if(F.indexOf("<")<0&&!G){return F.replace(/ /g,"&nbsp;");
}var B=[];F.replace(/<[^>]*>?| |[^ <]+/g,function(H){B.push(H);});if(G){var D=true;var E=false;for(var A=B.length-1;
A>=0;A--){var C=B[A];if(C==" "){if(D||E){B[A]="&nbsp;";}D=false;E=true;}else{if(C.charAt(0)!="<"){D=false;
E=false;}}}for(var A=0;A<B.length;A++){var C=B[A];if(C==" "){B[A]="&nbsp;";break;}else{if(C.charAt(0)!="<"){break;
}}}}else{for(var A=0;A<B.length;A++){var C=B[A];if(C==" "){B[A]="&nbsp;";}}}return B.join("");};embedlyUrlMasks=["http:\\/\\/.*youtube\\.com\\/watch.*","http:\\/\\/.*\\.youtube\\.com\\/v\\/.*","https:\\/\\/.*youtube\\.com\\/watch.*","https:\\/\\/.*\\.youtube\\.com\\/v\\/.*","http:\\/\\/youtu\\.be\\/.*","http:\\/\\/.*\\.youtube\\.com\\/user\\/.*","http:\\/\\/.*\\.youtube\\.com\\/.*\\#.*\\/.*","http:\\/\\/m\\.youtube\\.com\\/watch.*","http:\\/\\/m\\.youtube\\.com\\/index.*","http:\\/\\/.*\\.youtube\\.com\\/profile.*","http:\\/\\/.*\\.youtube\\.com\\/view_play_list.*","http:\\/\\/.*\\.youtube\\.com\\/playlist.*","http:\\/\\/www\\.ustream\\.tv\\/recorded\\/.*","http:\\/\\/www\\.ustream\\.tv\\/channel\\/.*","http:\\/\\/www\\.ustream\\.tv\\/.*","https:\\/\\/.*\\.airbnb.*","http:\\/\\/.*twitvid\\.com\\/.*","http:\\/\\/video\\.google\\.com\\/videoplay\\?.*","http:\\/\\/www\\.xtranormal\\.com\\/watch\\/.*","http:\\/\\/socialcam\\.com\\/v\\/.*","http:\\/\\/www\\.socialcam\\.com\\/v\\/.*","http:\\/\\/www\\.whitehouse\\.gov\\/photos-and-video\\/video\\/.*","http:\\/\\/www\\.whitehouse\\.gov\\/video\\/.*","http:\\/\\/wh\\.gov\\/photos-and-video\\/video\\/.*","http:\\/\\/wh\\.gov\\/video\\/.*","http:\\/\\/www\\.hulu\\.com\\/watch.*","http:\\/\\/www\\.hulu\\.com\\/w\\/.*","http:\\/\\/www\\.hulu\\.com\\/embed\\/.*","http:\\/\\/hulu\\.com\\/watch.*","http:\\/\\/hulu\\.com\\/w\\/.*","http:\\/\\/www\\.vimeo\\.com\\/groups\\/.*\\/videos\\/.*","http:\\/\\/www\\.vimeo\\.com\\/.*","http:\\/\\/vimeo\\.com\\/groups\\/.*\\/videos\\/.*","http:\\/\\/vimeo\\.com\\/.*","http:\\/\\/vimeo\\.com\\/m\\/\\#\\/.*","http:\\/\\/www\\.ted\\.com\\/talks\\/.*\\.html.*","http:\\/\\/www\\.ted\\.com\\/talks\\/lang\\/.*\\/.*\\.html.*","http:\\/\\/www\\.ted\\.com\\/index\\.php\\/talks\\/.*\\.html.*","http:\\/\\/www\\.ted\\.com\\/index\\.php\\/talks\\/lang\\/.*\\/.*\\.html.*","http:\\/\\/fora\\.tv\\/.*\\/.*\\/.*\\/.*","http:\\/\\/video\\.pbs\\.org\\/video\\/.*","http:\\/\\/gist\\.github\\.com\\/.*","https:\\/\\/gist\\.github\\.com\\/.*","http:\\/\\/twitter\\.com\\/.*\\/status\\/.*","http:\\/\\/twitter\\.com\\/.*\\/statuses\\/.*","http:\\/\\/www\\.twitter\\.com\\/.*\\/status\\/.*","http:\\/\\/www\\.twitter\\.com\\/.*\\/statuses\\/.*","http:\\/\\/mobile\\.twitter\\.com\\/.*\\/status\\/.*","http:\\/\\/mobile\\.twitter\\.com\\/.*\\/statuses\\/.*","https:\\/\\/twitter\\.com\\/.*\\/status\\/.*","https:\\/\\/twitter\\.com\\/.*\\/statuses\\/.*","https:\\/\\/www\\.twitter\\.com\\/.*\\/status\\/.*","https:\\/\\/www\\.twitter\\.com\\/.*\\/statuses\\/.*","https:\\/\\/mobile\\.twitter\\.com\\/.*\\/status\\/.*","https:\\/\\/mobile\\.twitter\\.com\\/.*\\/statuses\\/.*","http:\\/\\/www\\.crunchbase\\.com\\/.*\\/.*","http:\\/\\/crunchbase\\.com\\/.*\\/.*","http:\\/\\/www\\.slideshare\\.net\\/.*\\/.*","http:\\/\\/www\\.slideshare\\.net\\/mobile\\/.*\\/.*","http:\\/\\/slidesha\\.re\\/.*","http:\\/\\/scribd\\.com\\/doc\\/.*","http:\\/\\/www\\.scribd\\.com\\/doc\\/.*","http:\\/\\/scribd\\.com\\/mobile\\/documents\\/.*","http:\\/\\/www\\.scribd\\.com\\/mobile\\/documents\\/.*","http:\\/\\/www\\.kickstarter\\.com\\/projects\\/.*\\/.*","http:\\/\\/foursquare\\.com\\/.*","http:\\/\\/www\\.foursquare\\.com\\/.*","https:\\/\\/foursquare\\.com\\/.*","https:\\/\\/www\\.foursquare\\.com\\/.*","http:\\/\\/4sq\\.com\\/.*","http:\\/\\/chart\\.ly\\/symbols\\/.*","http:\\/\\/chart\\.ly\\/.*","http:\\/\\/maps\\.google\\.com\\/maps\\?.*","http:\\/\\/maps\\.google\\.com\\/\\?.*","http:\\/\\/maps\\.google\\.com\\/maps\\/ms\\?.*","https:\\/\\/maps\\.google\\.com\\/maps\\?.*","https:\\/\\/maps\\.google\\.com\\/\\?.*","https:\\/\\/maps\\.google\\.com\\/maps\\/ms\\?.*","http:\\/\\/.*\\.craigslist\\.org\\/.*\\/.*","http:\\/\\/tumblr\\.com\\/.*","http:\\/\\/.*\\.tumblr\\.com\\/post\\/.*","http:\\/\\/www\\.quantcast\\.com\\/wd:.*","http:\\/\\/www\\.quantcast\\.com\\/.*","http:\\/\\/pastebin\\.com\\/.*","http:\\/\\/cl\\.ly\\/.*","http:\\/\\/cl\\.ly\\/.*\\/content","http:\\/\\/www\\.kiva\\.org\\/lend\\/.*","http:\\/\\/prezi\\.com\\/.*\\/.*","http:\\/\\/www\\.qwiki\\.com\\/q\\/.*","http:\\/\\/crocodoc\\.com\\/.*","http:\\/\\/.*\\.crocodoc\\.com\\/.*","https:\\/\\/crocodoc\\.com\\/.*","https:\\/\\/.*\\.crocodoc\\.com\\/.*","http:\\/\\/www\\.wikipedia\\.org\\/wiki\\/.*","http:\\/\\/www\\.wikimedia\\.org\\/wiki\\/File.*","http:\\/\\/.*yfrog\\..*\\/.*","http:\\/\\/twitter\\.com\\/.*\\/status\\/.*\\/photo\\/.*","http:\\/\\/twitter\\.com\\/.*\\/statuses\\/.*\\/photo","http:\\/\\/pic\\.twitter\\.com\\/.*","http:\\/\\/www\\.twitter\\.com\\/.*\\/statuses\\/.*\\/photo\\/.*","http:\\/\\/mobile\\.twitter\\.com\\/.*\\/status\\/.*\\/photo\\/.*","http:\\/\\/mobile\\.twitter\\.com\\/.*\\/statuses\\/.*\\/photo\\/.*","https:\\/\\/twitter\\.com\\/.*\\/status\\/.*\\/photo\\/.*","https:\\/\\/twitter\\.com\\/.*\\/statuses\\/.*\\/photo\\/.*","https:\\/\\/www\\.twitter\\.com\\/.*\\/status\\/.*\\/photo\\/.*","https:\\/\\/www\\.twitter\\.com\\/.*\\/statuses\\/.*\\/photo\\/.*","https:\\/\\/mobile\\.twitter\\.com\\/.*\\/status\\/.*\\/photo\\/.*","https:\\/\\/mobile\\.twitter\\.com\\/.*\\/statuses\\/.*\\/photo\\/.*","http:\\/\\/www\\.flickr\\.com\\/photos\\/.*","http:\\/\\/flic\\.kr\\/.*","http:\\/\\/twitpic\\.com\\/.*","http:\\/\\/www\\.twitpic\\.com\\/.*","http:\\/\\/twitpic\\.com\\/photos\\/.*","http:\\/\\/www\\.twitpic\\.com\\/photos\\/.*","http:\\/\\/.*imgur\\.com\\/.*","http:\\/\\/.*\\.posterous\\.com\\/.*","http:\\/\\/i.*\\.photobucket\\.com\\/albums\\/.*","http:\\/\\/s.*\\.photobucket\\.com\\/albums\\/.*","http:\\/\\/media\\.photobucket\\.com\\/image\\/.*","http:\\/\\/xkcd\\.com\\/.*","http:\\/\\/www\\.xkcd\\.com\\/.*","http:\\/\\/imgs\\.xkcd\\.com\\/.*","http:\\/\\/www\\.asofterworld\\.com\\/index\\.php\\?id=.*","http:\\/\\/www\\.asofterworld\\.com\\/.*\\.jpg","http:\\/\\/asofterworld\\.com\\/.*\\.jpg","http:\\/\\/www\\.qwantz\\.com\\/index\\.php\\?comic=.*","http:\\/\\/.*dribbble\\.com\\/shots\\/.*","http:\\/\\/drbl\\.in\\/.*","https:\\/\\/www.dropbox.com\\/s\\/.*.png","http:\\/\\/.*\\.smugmug\\.com\\/.*","http:\\/\\/.*\\.smugmug\\.com\\/.*\\#.*","http:\\/\\/emberapp\\.com\\/.*\\/images\\/.*","http:\\/\\/emberapp\\.com\\/.*\\/images\\/.*\\/sizes\\/.*","http:\\/\\/emberapp\\.com\\/.*\\/collections\\/.*\\/.*","http:\\/\\/emberapp\\.com\\/.*\\/categories\\/.*\\/.*\\/.*","http:\\/\\/embr\\.it\\/.*","http:\\/\\/picasaweb\\.google\\.com.*\\/.*\\/.*\\#.*","http:\\/\\/picasaweb\\.google\\.com.*\\/lh\\/photo\\/.*","http:\\/\\/picasaweb\\.google\\.com.*\\/.*\\/.*","http:\\/\\/dailybooth\\.com\\/.*\\/.*","http:\\/\\/img\\.ly\\/.*","http:\\/\\/www\\.tinypic\\.com\\/view\\.php.*","http:\\/\\/tinypic\\.com\\/view\\.php.*","http:\\/\\/www\\.tinypic\\.com\\/player\\.php.*","http:\\/\\/tinypic\\.com\\/player\\.php.*","http:\\/\\/www\\.tinypic\\.com\\/r\\/.*\\/.*","http:\\/\\/tinypic\\.com\\/r\\/.*\\/.*","http:\\/\\/.*\\.tinypic\\.com\\/.*\\.jpg","http:\\/\\/.*\\.tinypic\\.com\\/.*\\.png","http:\\/\\/.*\\.deviantart\\.com\\/art\\/.*","http:\\/\\/.*\\.deviantart\\.com\\/gallery\\/.*","http:\\/\\/.*\\.deviantart\\.com\\/\\#\\/.*","http:\\/\\/.*\\.deviantart\\.com","http:\\/\\/.*\\.deviantart\\.com\\/gallery","http:\\/\\/.*\\.deviantart\\.com\\/.*\\/.*\\.jpg","http:\\/\\/.*\\.deviantart\\.com\\/.*\\/.*\\.gif","http:\\/\\/.*\\.deviantart\\.net\\/.*\\/.*\\.jpg","http:\\/\\/.*\\.deviantart\\.net\\/.*\\/.*\\.gif","http:\\/\\/instagr\\.am\\/p\\/.*","http:\\/\\/instagram\\.com\\/p\\/.*","http:\\/\\/skitch\\.com\\/.*\\/.*\\/.*","http:\\/\\/img\\.skitch\\.com\\/.*","https:\\/\\/skitch\\.com\\/.*\\/.*\\/.*","https:\\/\\/img\\.skitch\\.com\\/.*","http:\\/\\/www\\.evernote\\.com\\/shard\\/.*","https:\\/\\/www\\.evernote\\.com\\/shard\\/.*","http:\\/\\/twitrpix\\.com\\/.*","http:\\/\\/.*\\.twitrpix\\.com\\/.*","http:\\/\\/ow\\.ly\\/i\\/.*","http:\\/\\/.*amazon\\..*\\/gp\\/product\\/.*","http:\\/\\/.*amazon\\..*\\/.*\\/dp\\/.*","http:\\/\\/.*amazon\\..*\\/dp\\/.*","http:\\/\\/.*amazon\\..*\\/o\\/ASIN\\/.*","http:\\/\\/.*amazon\\..*\\/gp\\/offer-listing\\/.*","http:\\/\\/.*amazon\\..*\\/.*\\/ASIN\\/.*","http:\\/\\/.*amazon\\..*\\/gp\\/product\\/images\\/.*","http:\\/\\/.*amazon\\..*\\/gp\\/aw\\/d\\/.*","http:\\/\\/www\\.amzn\\.com\\/.*","http:\\/\\/amzn\\.com\\/.*","http:\\/\\/itunes\\.apple\\.com\\/.*","https:\\/\\/itunes\\.apple\\.com\\/.*","https:\\/\\/soundcloud\\.com\\/.*","https:\\/\\/soundcloud\\.com\\/.*\\/.*","https:\\/\\/soundcloud\\.com\\/.*\\/sets\\/.*","https:\\/\\/soundcloud\\.com\\/groups\\/.*","http:\\/\\/snd\\.sc\\/.*","http:\\/\\/www\\.last\\.fm\\/music\\/.*","http:\\/\\/www\\.last\\.fm\\/music\\/+videos\\/.*","http:\\/\\/www\\.last\\.fm\\/music\\/+images\\/.*","http:\\/\\/www\\.last\\.fm\\/music\\/.*\\/_\\/.*","http:\\/\\/www\\.last\\.fm\\/music\\/.*\\/.*","http:\\/\\/www\\.rdio\\.com\\/\\#\\/artist\\/.*\\/album\\/.*","http:\\/\\/www\\.rdio\\.com\\/artist\\/.*\\/album\\/.*","http:\\/\\/www\\.npr\\.org\\/.*\\/.*\\/.*\\/.*\\/.*","http:\\/\\/www\\.npr\\.org\\/.*\\/.*\\/.*\\/.*\\/.*\\/.*","http:\\/\\/www\\.npr\\.org\\/.*\\/.*\\/.*\\/.*\\/.*\\/.*\\/.*","http:\\/\\/www\\.npr\\.org\\/templates\\/story\\/story\\.php.*","http:\\/\\/grooveshark\\.com\\/.*","http:\\/\\/espn\\.go\\.com\\/video\\/clip.*","http:\\/\\/espn\\.go\\.com\\/.*\\/story.*","http:\\/\\/abcnews\\.com\\/.*\\/video\\/.*","http:\\/\\/abcnews\\.com\\/video\\/playerIndex.*","http:\\/\\/abcnews\\.go\\.com\\/.*\\/video\\/.*","http:\\/\\/abcnews\\.go\\.com\\/video\\/playerIndex.*","http:\\/\\/washingtonpost\\.com\\/wp-dyn\\/.*\\/video\\/.*\\/.*\\/.*\\/.*","http:\\/\\/www\\.washingtonpost\\.com\\/wp-dyn\\/.*\\/video\\/.*\\/.*\\/.*\\/.*","http:\\/\\/www\\.boston\\.com\\/video.*","http:\\/\\/boston\\.com\\/video.*","http:\\/\\/www\\.boston\\.com\\/.*video.*","http:\\/\\/boston\\.com\\/.*video.*","http:\\/\\/www\\.facebook\\.com\\/photo\\.php.*","http:\\/\\/www\\.facebook\\.com\\/video\\/video\\.php.*","http:\\/\\/www\\.facebook\\.com\\/v\\/.*","https:\\/\\/www\\.facebook\\.com\\/photo\\.php.*","https:\\/\\/www\\.facebook\\.com\\/video\\/video\\.php.*","https:\\/\\/www\\.facebook\\.com\\/v\\/.*","http:\\/\\/cnbc\\.com\\/id\\/.*\\?.*video.*","http:\\/\\/www\\.cnbc\\.com\\/id\\/.*\\?.*video.*","http:\\/\\/cnbc\\.com\\/id\\/.*\\/play\\/1\\/video\\/.*","http:\\/\\/www\\.cnbc\\.com\\/id\\/.*\\/play\\/1\\/video\\/.*","http:\\/\\/cbsnews\\.com\\/video\\/watch\\/.*","http:\\/\\/www\\.google\\.com\\/profiles\\/.*","http:\\/\\/google\\.com\\/profiles\\/.*","http:\\/\\/www\\.cnn\\.com\\/video\\/.*","http:\\/\\/edition\\.cnn\\.com\\/video\\/.*","http:\\/\\/money\\.cnn\\.com\\/video\\/.*","http:\\/\\/today\\.msnbc\\.msn\\.com\\/id\\/.*\\/vp\\/.*","http:\\/\\/www\\.msnbc\\.msn\\.com\\/id\\/.*\\/vp\\/.*","http:\\/\\/www\\.msnbc\\.msn\\.com\\/id\\/.*\\/ns\\/.*","http:\\/\\/today\\.msnbc\\.msn\\.com\\/id\\/.*\\/ns\\/.*","http:\\/\\/guardian\\.co\\.uk\\/.*\\/video\\/.*\\/.*\\/.*\\/.*","http:\\/\\/www\\.guardian\\.co\\.uk\\/.*\\/video\\/.*\\/.*\\/.*\\/.*","http:\\/\\/bravotv\\.com\\/.*\\/.*\\/videos\\/.*","http:\\/\\/www\\.bravotv\\.com\\/.*\\/.*\\/videos\\/.*","http:\\/\\/video\\.nationalgeographic\\.com\\/.*\\/.*\\/.*\\.html","http:\\/\\/dsc\\.discovery\\.com\\/videos\\/.*","http:\\/\\/animal\\.discovery\\.com\\/videos\\/.*","http:\\/\\/health\\.discovery\\.com\\/videos\\/.*","http:\\/\\/investigation\\.discovery\\.com\\/videos\\/.*","http:\\/\\/military\\.discovery\\.com\\/videos\\/.*","http:\\/\\/planetgreen\\.discovery\\.com\\/videos\\/.*","http:\\/\\/science\\.discovery\\.com\\/videos\\/.*","http:\\/\\/tlc\\.discovery\\.com\\/videos\\/.*","http:\\/\\/video\\.forbes\\.com\\/fvn\\/.*","http:\\/\\/pinterest\\.com\\/pin\\/.*","https:\\/\\/speakerdeck\\.com\\/.*\\/.*"];
embedlyRegexps=null;embedlyUrl=function(A){return false;}
/*
 * Copyright 2009 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS-IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
;
var ace={};ace.ui={};ace.editor=function(v,C,T){var w=/\s/;var x=/[\u0030-\u0039\u0041-\u005A\u0061-\u007A\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u00FF\u0100-\u1FFF\u3040-\u9FFF\uF900-\uFDFF\uFE70-\uFEFE\uFF10-\uFF19\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFDC]/;
var z={bold:true,italic:true,underline:true,strikethrough:true,superscript:true,subscript:true,list:true,code:true};
var b=[];var E=null;var g;var X=false;var o=null;var R=false;var H=true;var Y=false;var AB=1;var S;var AO=pad_locate;
var B={lines:newSkipList(),selStart:null,selEnd:null,selFocusAtStart:false,alltext:"",alines:[],apool:new AttribPool()};
var D=$(v)[0];var A=this;var K="";var L="monospace";var n=12;window.globalEditor=this;A.getCurrentCallStack=function(){return E;
};A.getDynamicCSS=function(){return o;};A.getIdleWorkTimer=function(){return G;};A.getInInternationalComposition=function(){return R;
};A.getIsEditable=function(){return H;};function r(){return $(D).height();}function AH(){return $(D).width();
}A.getObserver=function(){return C;};A.getRep=function(){return B;};A.getRoot=function(){return D;};A.getRootSelector=function(){return v;
};A.getTextFace=function(){return L;};A.getThisAuthor=function(){return K;};A.textLineHeight=function(){return 20;
};A.setInInternationalComposition=function(AP){R=AP;};A.setIsScrolling=function(AP){Y=AP;};function AI(AP){L=AP;
D.style.fontFamily=L;}function AN(AP){n=AP;D.style.fontSize=n+"px";D.style.lineHeight=A.textLineHeight()+"px";
}function AD(AP){setClassPresence(D,"mobile-app",AP);}function AE(AP){setClassPresence(D,"desktop-app",AP);
}if(undoModule.enabled){undoModule.apool=B.apool;}A.setProperty=function(AR,AQ){var AP=AR.toLowerCase();
if(AP=="showsauthorcolors"){}else{if(AP=="showsuserselections"){setClassPresence(D,"userSelections",!!AQ);
}else{if(AP=="showslinenumbers"){l();}else{if(AP=="grayedout"){setClassPresence(document.body,"grayedout",!!AQ);
}else{if(AP=="dmesg"){M=AQ;window.dmesg=AQ;}else{if(AP=="userauthor"){K=String(AQ);}else{if(AP=="shortnames"){A.setShortNames(AQ);
}else{if(AP=="textface"){AI(AQ);if(AQ=="monospace"){$(D).attr("spellcheck","false");}else{if(ace.util.isValidBrowserForSpellcheck()){$(D).removeAttr("spellcheck");
}}}else{if(AP=="textsize"){}else{if(AP=="tokenizer"){A.setTokenizer(AQ);}else{if(AP=="langtokenizer"){A.setTokenizer(AQ[0],AQ[1]);
}else{if(AP=="ismobileapp"){AD(AQ);}else{if(AP=="isdesktopapp"){AE(AQ);}else{if(AP=="notitle"){setClassPresence(D,"notitle",AQ);
}else{if(AP=="min-height"){D.style.minHeight=AQ+"px";}else{if(AP=="max-height"){D.style.maxHeight=AQ+"px";
}}}}}}}}}}}}}}}}};function y(){decorate(A,new ace.selection(A));decorate(A,new ace.lists(A));decorate(A,new ace.textalign(A));
decorate(A,new ace.attr(A));decorate(A,new ace.format(A));decorate(A,new ace.insert(A));decorate(A,new ace.autolink(A));
decorate(A,new ace.code(A));decorate(A,new ace.tables(A));decorate(A,new ace.authors(A));decorate(A,makeChangesetTracker(A,window,B.apool,{withCallbacks:function(AP,AQ){A.inCallStackIfNecessary(AP,function(){A.fastIncorp();
AQ({setDocumentAttributedText:function(AR){A.setDocAText(AR);},applyChangesetToDocument:function(AT,AS){var AR=E.editEvent.eventType;
E.startNewEvent("nonundoable");A.performDocumentApplyChangeset(AT,AS);E.startNewEvent(AR);}});});}}));
C&&C.attachEditor(A);A.inCallStack("setup",function(){if(browser.mozilla){addClass(D,"mozilla");}else{if(browser.safari){addClass(D,"safari");
}else{if(browser.msie){addClass(D,"msie");try{document.execCommand("BackgroundImageCache",false,true);
}catch(AQ){}}}}setClassPresence(D,"doesWrap",true);o=makeCSSManager("dynamicsyntax");setClassPresence(D,"authorColors",false);
p();while(D.firstChild){D.removeChild(D.firstChild);}var AP=O("");Q(0,B.lines.length(),[AP]);N(null,[AP.domInfo],null);
B.alines=Changeset.splitAttributionLines(Changeset.makeAttribution("\n"),"\n");if(!$("#padbody").find(".sheet-style").length){$("body").addClass("newpad");
}!T&&j();});if(!ace.util.isValidBrowserForSpellcheck()){$(D).attr("spellcheck","false");}A.setupSelectionToolbar();
setTimeout(function(){$(D).addClass("loaded");},0);}A.importAText=function(AP,AQ,AS){AP=Changeset.cloneAText(AP);
if(AQ){var AR=(new AttribPool()).fromJsonable(AQ);AP.attribs=Changeset.moveOpsToNewPool(AP.attribs,AR,B.apool);
}A.inCallStackIfNecessary("importText"+(AS?"Undoable":""),function(){A.setDocAText(AP);});};A.setDocAText=function(AR){A.fastIncorp();
var AT=B.lines.totalWidth();var AS=B.lines.length();var AV=B.lines.offsetOfIndex(AS-1);var AU=B.lines.atIndex(AS-1).text.length;
var AQ=Changeset.smartOpAssembler();var AP=Changeset.newOp("-");AP.chars=AV;AP.lines=AS-1;AQ.append(AP);
AP.chars=AU;AP.lines=0;AQ.append(AP);Changeset.appendATextToAssembler(AR,AQ);var AW=AT+AQ.getLengthChange();
var AX=Changeset.checkRep(Changeset.pack(AT,AW,AQ.toString(),AR.text.slice(0,-1)));A.performDocumentApplyChangeset(AX);
G.atMost(100);if(B.alltext!=AR.text){M(htmlPrettyEscape(B.alltext));M(htmlPrettyEscape(AR.text));throw new Error("mismatch error setting raw text in setDocAText");
}};A.dispose=function(){X=true;if(G){G.never();}h();};function h(){C&&C.detachEditor();C=null;}function j(){$(D).on("mousedown mouseout mouseover mouseup touchstart touchmove paste focus blur",function(AP){C&&C.trigger(AP.type,[AP]);
});$(D).on("dragstart",function(AP){AP.preventDefault();});$(D).on("keydown keypress keyup",function(AP){C&&C.trigger("key-event",[AP]);
});$(D).on("touchend click",function(AP){C&&C.trigger("click",[AP]);});$(document).on("dragover drop",function(AP){C&&C.trigger(AP.type,[AP]);
});$(window).on("scroll",throttle(function(AP){C&&C.trigger("scroll-throttled",[AP]);},100));$(window).on("scroll",function(AP){C&&C.trigger("scroll",[AP]);
});$(window).on("resize",throttle(function(AP){C&&C.trigger("resize",[AP]);},100));if(browser.msie){$(document.documentElement).on("click",function(AP){C&&C.trigger("ie-click",[AP]);
});$(document.documentElement).on("compositionstart compositionend",function(AP){C&&C.trigger(AP.type,[AP]);
});}else{if(document.documentElement){$(document.documentElement).on("compositionstart compositionend",function(AP){C&&C.trigger(AP.type,[AP]);
});$(document.documentElement).on("click",function(AP){C&&C.trigger("capture-click",[AP]);});}}$(window).on("unload",h);
$("#editor").blur(function(){if(!H){return;}if(B.alltext.replace(/\n/i,"")===""){$("body").addClass("newpad");
}});$("#editor").focus(function(){if(!H){return;}$("body").removeClass("newpad");});}var M=window.dmesg=noop;
var I=window.PROFILER;if(!I){I=function(){return{start:noop,mark:noop,literal:noop,end:noop,cancel:noop};
};}A.inCallStack=function(AR,AY){if(X){return;}if(E){console.error("Can't enter callstack "+AR+", already in "+E.type);
}var AU=false;function AX(){AU=true;console.profile();}function AS(Aa){return{eventType:Aa,backset:null};
}function AT(Aa){if(B.selStart&&B.selEnd){var Ae=B.lines.offsetOfIndex(B.selStart[0])+B.selStart[1];var Ac=B.lines.offsetOfIndex(B.selEnd[0])+B.selEnd[1];
Aa.selStart=Ae;Aa.selEnd=Ac;Aa.selFocusAtStart=B.selFocusAtStart;}if(undoModule.enabled){var Ab=false;
try{if(Aa.eventType=="setup"||Aa.eventType=="importText"||Aa.eventType=="setBaseText"){undoModule.clearHistory();
}else{if(Aa.eventType=="nonundoable"){if(Aa.changeset){undoModule.reportExternalChange(Aa.changeset);
}}else{undoModule.reportEvent(Aa);}}Ab=true;}catch(Ad){}finally{if(!Ab){undoModule.enabled=false;}}}}function AZ(Ac,Ab){var Aa=E.editEvent;
if(!Ab){AT(Aa);}E.editEvent=AS(Ac);return Aa;}E={type:AR,docTextChanged:false,selectionAffected:false,userChangedSelection:false,domClean:false,profileRest:AX,isUserChange:false,repChanged:false,editEvent:AS(AR),startNewEvent:AZ};
var AV=false;var AW;try{AW=AY();AV=true;}catch(AQ){b.push({error:AQ,time:+new Date()});M(AQ.toString());
throw AQ;}finally{var AP=E;if(AV){AT(AP.editEvent);if(AP.domClean&&AP.type!="setup"){if(AP.selectionAffected){A.updateBrowserSelectionFromRep();
}if(AP.docTextChanged&&AP.type=="applyChangesToBase"){pad_imageprocessor.refreshImgBarPosition();}if((AP.docTextChanged||AP.userChangedSelection)&&AP.type!="applyChangesToBase"){pad_locate.locateRefreshAtCursor(true);
A.scrollSelectionIntoView();C&&C.trigger("caret");}if(AP.isUserChange&&AP.selectionAffected&&AP.repChanged&&!AP.isTriggeringAutocomplete){A.handleAutocomplete();
}if(AP.docTextChanged&&AP.type.indexOf("importText")<0){C&&C.trigger("caret");}}}else{if(E.type=="idleWorkTimer"){G.atLeast(1000);
}}E=null;if(AU){console.profileEnd();}}return AW;};A.inCallStackIfNecessary=function(AQ,AP){if(!E){A.inCallStack(AQ,AP);
}else{AP();}};A.getUnhandledErrors=function(){return b.slice();};A.callWithAce=function(AS,AQ,AR){var AP=function(){return AS(A);
};if(AR!==undefined){var AT=AP;AP=function(){A.fastIncorp();AT();};}if(AQ!==undefined){return A.inCallStack(AQ,AP);
}else{return AP();}};var G=ace.util.makeIdleAction(function(){if(!H||T){return;}if(R){G.atLeast(500);
return;}A.inCallStack("idleWorkTimer",function(){var AP=ace.util.newTimeLimit(99);var AR=false;var AS=false;
try{V(AP);AR=true;if(AP()||Y){return;}C&&C.trigger("idlework",[AP]);if(AP()){return;}AS=true;}catch(AT){}finally{if(AS){G.atMost(1000);
}else{if(AR){G.atMost(500);}else{var AQ=Math.round(AP.elapsed()/2);if(AQ<100){AQ=100;}G.atMost(AQ);}}}});
});A.getTextInRange=function(AQ,AP){var AR=B.lines.offsetOfIndex(AQ[0])+AQ[1];var AS=B.lines.offsetOfIndex(AP[0])+AP[1];
return B.alltext.substring(AR,AS);};A.createChangesetFromRange=function(AQ,AR){var AZ=AQ[0];var AY=AR[0];
var AP=Changeset.builder(B.lines.totalWidth());A.buildRemoveRange(AP,[0,0],AQ);A.buildKeepRange(AP,AQ,AR,[],B.apool);
var AU=B.lines.length()-1;var AV=B.lines.atIndex(AU).text.length;A.buildRemoveRange(AP,AR,[AU,AV+1]);
var AW=AP.toString();var AX={text:B.alltext,attribs:Changeset.joinAttributionLines(B.alines)};var AS=Changeset.applyToAText(AW,AX,B.apool);
var AT=new AttribPool();AS.attribs=Changeset.moveOpsToNewPool(AS.attribs,B.apool,AT);return{apool:AT,atext:AS};
};A.replaceRange=function(AT,AP,AS,AR,AQ){A.inCallStackIfNecessary("replaceRange",function(){A.fastIncorp();
A.performDocumentReplaceRange(AT,AP,AS,AR,AQ);});};A.performDocumentReplaceRange=function(AQ,AR,AU,AV,AS){if(AQ==undefined){AQ=B.selStart;
}if(AR==undefined){AR=B.selEnd;}var AP=Changeset.builder(B.lines.totalWidth());u(AP,AQ);A.buildRemoveRange(AP,AQ,AR);
AP.insert(AU,[["author",K]].concat(AV||[]),B.apool);var AT=AP.toString();A.performDocumentApplyChangeset(AT,AS);
};A.performDocumentReplaceCharRange=function(AR,AQ,AP){if(AR==AQ&&AP.length==0){return;}if(AQ==B.alltext.length){if(AR==AQ){AR--;
AQ--;AP="\n"+AP.substring(0,AP.length-1);}else{if(AP.length==0){AR--;AQ--;}else{AQ--;AP=AP.substring(0,AP.length-1);
}}}A.performDocumentReplaceRange(A.lineAndColumnFromChar(AR),A.lineAndColumnFromChar(AQ),AP);};A.performDocumentApplyAttributesToRange=function(AQ,AR,AT){var AP=Changeset.builder(B.lines.totalWidth());
u(AP,AQ);A.buildKeepRange(AP,AQ,AR,AT,B.apool);var AS=AP.toString();A.performDocumentApplyChangeset(AS);
};function AM(AR,AP,AQ){if(AP>=B.alltext.length){AP=B.alltext.length-1;}A.performDocumentApplyAttributesToRange(A.lineAndColumnFromChar(AR),A.lineAndColumnFromChar(AP),AQ);
}function u(AQ,AP){var AR=B.lines.offsetOfIndex(AP[0]);AQ.keep(AR,AP[0]);AQ.keep(AP[1]);}A.buildRemoveRange=function(AR,AQ,AP){var AT=B.lines.offsetOfIndex(AQ[0]);
var AS=B.lines.offsetOfIndex(AP[0]);if(AP[0]>AQ[0]){AR.remove(AS-AT-AQ[1],AP[0]-AQ[0]);AR.remove(AP[1]);
}else{var AU=Math.min(AP[1],B.lines.atIndex(AP[0]).width-1);AR.remove(AU-AQ[1]);}};A.buildKeepRange=function(AR,AQ,AP,AT,AS){var AV=B.lines.offsetOfIndex(AQ[0]);
var AU=B.lines.offsetOfIndex(AP[0]);if(AP[0]>AQ[0]){AR.keep(AU-AV-AQ[1],AP[0]-AQ[0],AT,AS);AR.keep(AP[1],0,AT,AS);
}else{var AW=Math.min(AP[1],B.lines.atIndex(AP[0]).width-1);AR.keep(AW-AQ[1],0,AT,AS);}};A.performDocumentReplaceSelection=function(AS,AR){if(!(B.selStart&&B.selEnd)){return;
}var AQ=B.selStart;var AP=B.selEnd;if(!AR){if(AQ[1]==B.lines.atIndex(AQ[0]).lineMarker){AQ=[AQ[0],0];
}if(AP[1]==B.lines.atIndex(AP[0]).lineMarker){AP=[AP[0],0];}}A.performDocumentReplaceRange(AQ,AP,AS);
};function s(){S={cleanNodesNearChanges:{}};}s();function P(AT){var AP;var AV;if(!A.isNodeDirty(AT)){AP=AT;
var AU=AP.previousSibling;var AS=AP.nextSibling;AV=((AU&&A.isNodeDirty(AU))||(AS&&A.isNodeDirty(AS)));
}else{var AQ=AT.previousSibling;while(AQ&&A.isNodeDirty(AQ)){AQ=AQ.previousSibling;}if(AQ){AP=AQ;}else{var AR=AT.nextSibling;
while(AR&&A.isNodeDirty(AR)){AR=AR.nextSibling;}if(AR){AP=AR;}}if(!AP){return;}AV=true;}if(AV){S.cleanNodesNearChanges["$"+F(AP)]=true;
}else{var AY=F(AP);var AU=AP.previousSibling;var AS=AP.nextSibling;var Ac=((AU&&F(AU))||null);var Ab=((AS&&F(AS))||null);
var AW=B.lines.prev(B.lines.atKey(AY));var AX=B.lines.next(B.lines.atKey(AY));var Aa=((AW&&AW.key)||null);
var AZ=((AX&&AX.key)||null);if(Ac!=Aa||Ab!=AZ){S.cleanNodesNearChanges["$"+F(AP)]=true;}}}A.observeChangesAroundSelection=function(){if(E.observedSelection){return;
}E.observedSelection=true;var AT=I("getSelection",false);var AR=A.getSelection();AT.end();if(AR){function AS(AU){if((!AU)||AU==D){return null;
}while(AU.parentNode!=D){AU=AU.parentNode;}return AU;}var AQ=AS(AR.startPoint.node);var AP=AS(AR.endPoint.node);
if(AQ){P(AQ);}if(AP&&AQ!=AP){P(AP);}}};function AG(){if(D.getElementsByTagName){var AR=D.getElementsByTagName("style");
for(var AQ=0;AQ<AR.length;AQ++){var AP=AR[AQ];while(AP.parentNode&&AP.parentNode!=D){AP=AP.parentNode;
}if(AP.parentNode==D){P(AP);}}}}function q(){var AP=I("getDirtyRanges",false);AP.forIndices=0;AP.consecutives=0;
AP.corrections=0;var AT={};var AR=B.lines.length();function AV(Ai){if(AT[Ai]===undefined){AP.forIndices++;
var Aj;if(Ai<0||Ai>=AR){Aj=true;}else{var Ak=B.lines.atIndex(Ai).key;Aj=(J(Ak)||false);}AT[Ai]=Aj;}return AT[Ai];
}var AW={};function AX(Ai){if(AW[Ai]===undefined){AP.consecutives++;AW[Ai]=(function(){var Ak=AV(Ai-1);
var Aj=AV(Ai);if((!Ak)||(!Aj)){return false;}if((Ak===true)&&(Aj===true)){return !D.firstChild;}if((Ak===true)&&Aj.previousSibling){return false;
}if((Aj===true)&&Ak.nextSibling){return false;}if((Ak===true)||(Aj===true)){return true;}return Ak.nextSibling==Aj;
})();}return AW[Ai];}function AY(Ai){return !!AV(Ai);}var AQ=[[-1,AR+1]];function Af(Ai){var Aj=-1;forEach(AQ,function(Ak,Al){if(Ai>=Ak[1]){return false;
}if(Ai<Ak[0]){return true;}Aj=Al;return true;});return Aj;}function Ae(Ai,Aj){var Al=AQ[Ai][0];var Ak=AQ[Ai][1];
if((Al+1)==Ak){AQ.splice(Ai,1);}else{if(Aj==Al){AQ[Ai][0]++;}else{if(Aj==(Ak-1)){AQ[Ai][1]--;}else{AQ.splice(Ai,1,[Al,Aj],[Aj+1,Ak]);
}}}}function AU(Ai,Aj){var Al=AQ[Ai][0];var Ak=AQ[Ai][1];AQ.splice(Ai,1,[Al,Aj],[Aj,Ak]);}var Aa={};function Ac(Ai){if(Aa[Ai]){return true;
}AP.corrections++;Aa[Ai]=true;var Aj=Af(Ai);var Al=AY(Ai);if(Aj<0){if(Al){console.log("somehow lost clean line");
}return true;}if(!Al){Ae(Aj,Ai);return false;}else{var An=AQ[Aj][0];var Am=AQ[Aj][1];var Ak=false;if(An<Ai&&AY(Ai-1)&&!AX(Ai)){AU(Aj,Ai);
Ak=true;}if(Am>(Ai+1)&&AY(Ai+1)&&!AX(Ai+1)){AU(Aj,Ai+1);Ak=true;}return !Ak;}}function AZ(Ak,Al){var Aj=0;
var Ai=Ak;while(Aj<Al&&Ai>=0){if(Ac(Ai)){Aj++;}else{Aj=0;}Ai--;}Aj=0;Ai=Ak;while(Aj<Al&&Ai<AR){if(Ac(Ai)){Aj++;
}else{Aj=0;}Ai++;}}if(AR==0){AP.cancel();if(!AX(0)){AU(0,0);}}else{AP.mark("topbot");AZ(0,1);AZ(AR-1,1);
AP.mark("obs");for(var Ah in S.cleanNodesNearChanges){var Ad=Ah.substring(1);if(B.lines.containsKey(Ad)){var Ag=B.lines.indexOfKey(Ad);
AZ(Ag,2);}}AP.mark("stats&calc");AP.literal(AP.forIndices,"byidx");AP.literal(AP.consecutives,"cons");
AP.literal(AP.corrections,"corr");}var Ab=[];for(var AS=0;AS<AQ.length-1;AS++){Ab.push([AQ[AS][1],AQ[AS+1][0]]);
}AP.end();return Ab;}A.markNodeClean=function(AQ){var AP={};AP.nodeId=F(AQ);AP.knownHTML=AQ.innerHTML;
if(browser.msie){AP.knownText=AQ.innerText;}setAssoc(AQ,"dirtiness",AP);};A.isNodeDirty=function(AP){var AR=I("cleanCheck",false);
if(AP.parentNode!=D){return true;}var AQ=getAssoc(AP,"dirtiness");if(!AQ){return true;}if(AP.id!==AQ.nodeId){return true;
}if(browser.msie){if(AP.innerText!==AQ.knownText){return true;}}if(AP.innerHTML!==AQ.knownHTML){return true;
}AR.end();return false;};function V(Ak){if(window.isSheet){return;}if(window.blockingCooperation){return;
}if(E.domClean){return false;}R=false;E.isUserChange=true;Ak=(Ak||function(){return false;});var AR=I("incorp",false);
if(!D.firstChild){D.innerHTML="<div><!-- --></div>";}AR.mark("obs");A.observeChangesAroundSelection();
AG();AR.mark("dirty");var Aa=q();var Ax=true;var Ah=0;var AP,AU;while(Ah<Aa.length){AP=Aa[Ah][0];AU=Aa[Ah][1];
if(!((AP==0||J(B.lines.atIndex(AP-1).key))&&(AU==B.lines.length()||J(B.lines.atIndex(AU).key)))){Ax=false;
break;}Ah++;}if(!Ax){var A3=D.childNodes.length;for(var Ac=0;Ac<A3;Ac++){var Aj=D.childNodes.item(Ac);
if((Aj.tagName)&&((!Aj.id)||(!B.lines.containsKey(Aj.id)))){P(Aj);}}Aa=q();}s();AR.mark("getsel");var AT=A.getSelection();
var AQ,AS;var Ao=0;var Ai=[];var Ae=0;var AZ=[];AR.mark("ranges");AR.literal(Aa.length,"numdirt");var An=[];
while(Ao<Aa.length){var Ar=Aa[Ao];AP=Ar[0];AU=Ar[1];var Ad=(((AP==0)&&D.firstChild)||J(B.lines.atIndex(AP-1).key).nextSibling);
Ad=(Ad&&A.isNodeDirty(Ad)&&Ad);var AV=(((AU==B.lines.length())&&D.lastChild)||J(B.lines.atIndex(AU).key).previousSibling);
AV=(AV&&A.isNodeDirty(AV)&&AV);if(Ad&&AV){var Ab=makeContentCollector(true,browser,B.apool,null,linestylefilter.className2Author);
Ab.notifySelection(AT);var Au=[];for(var AY=Ad;AY&&!(AY.previousSibling&&AY.previousSibling==AV);AY=AY.nextSibling){if(browser.msie){try{var As=document.body.createTextRange();
As.moveToElementText(AY);As.execCommand("unlink",false,null);}catch(A2){}}Ab.collectContent(AY);Au.push(AY);
}Ab.notifyNextNode(AV.nextSibling);var AW=Ab.getLines();if((AW.length<=1||AW[AW.length-1]!=="")&&AV.nextSibling){AU++;
var Ap=AV.nextSibling;Ab.collectContent(Ap);AZ.push(Ap);Ab.notifyNextNode(Ap.nextSibling);}var AX=Ab.finish();
var Al=AX.selStart;var Am=AX.selEnd;AW=AX.lines;var A0=AX.lineAttribs;var Az=AX.linesWrapped;if(AX.newAuthors.length){C&&C.trigger("missing-authors",[AX.newAuthors]);
}if(Az>0){}if(Al[0]>=0){AQ=[Al[0]+AP+Ae,Al[1]];}if(Am[0]>=0){AS=[Am[0]+AP+Ae,Am[1]];}var Aw=[];var Ay=AV;
var At=new Array(AW.length);for(var Ac=0;Ac<AW.length;Ac++){var A1=AW[Ac];var Av=O(A1);Aw.push(Av);At[Ac]=Av.domInfo;
}An.push([Ay,At]);forEach(Au,function(A4){AZ.push(A4);});var Ag={};if(AQ){Ag.selStart=AQ;}if(AS){Ag.selEnd=AS;
}Ag.preserveAuthorship=AX.nestedDomLines;Ai.push([AP+Ae,AU-AP,Aw,A0,Ag]);Ae+=(AW.length-(AU-AP));}else{if(AU>AP){Ai.push([AP+Ae,AU-AP,[],[]]);
}}Ao++;}var Aq=(Ai.length>0);AR.mark("splice");forEach(Ai,function(A4){AC(A4[0],A4[1],A4[2],A4[3],A4[4]);
});AR.mark("insert");forEach(An,function(A5){N(A5[0],A5[1],Ak);if(An.length==1&&AZ.length==1&&A5[0]==AZ[0]){var A6=A5[1][0].node;
var A4=AZ[0];A4.id=A6.id;if(A6.outerHTML==A4.outerHTML){AZ=[A6];A.markNodeClean(A4);B.lines.atKey(A4.id).lineNode=A4;
B.lines.atKey(A4.id).domInfo.node=A4;}}});AR.mark("del");forEach(AZ,function(A4){A4.parentNode.removeChild(A4);
});AR.mark("findsel");if(AT&&!AQ){AQ=A.getLineAndCharForPoint(AT.startPoint);}if(AT&&!AS){AS=A.getLineAndCharForPoint(AT.endPoint);
}var Af=B.lines.length();if(AQ&&AQ[0]>=Af){AQ[0]=Af-1;AQ[1]=B.lines.atIndex(AQ[0]).text.length;}if(AS&&AS[0]>=Af){AS[0]=Af-1;
AS[1]=B.lines.atIndex(AS[0]).text.length;}AR.mark("repsel");if(AT){c(AQ,AS,AT&&AT.focusAtStart);}AR.mark("browsel");
if(AT&&(Aq||A.isCaret())){E.selectionAffected=true;if(Aq&&A.isCaret()&&iOS){A.renumberList(AQ[0],true);
}}A.updateToolbarIfNecessary(AT,A.isCaret(),AT&&Math.abs(AS[0]-AQ[0])>1);E.domClean=true;AR.mark("fixview");
l();AR.end("END");return Aq;}A.fastIncorp=function(){V(ace.util.newTimeLimit(0));};A.incorpIfQuick=function(){var AP=A.incorpIfQuick;
var AS=(AP.failures||0);if(AS<5){var AR=ace.util.newTimeLimit(40);var AT=V(AR);if(AR()){AP.failures=AS+1;
}return true;}else{var AQ=(AP.skipCount||0);AQ++;if(AQ==20){AQ=0;AP.failures=0;}AP.skipCount=AQ;}return false;
};A.createDomLineEntry=function(AQ){var AP=O(AQ);return AP;};A.insertDomLines=function(AQ,AR,AP){N(AQ,AR,AP);
};A.doRepLineSplice=function(AR,AP,AQ){Q(AR,AP,AQ);};function O(AR){function AT(AV,AW){C&&C.trigger("embed",[AV,AW]);
}function AS(AW){W();var AV=A.findMagicDomNode(AW.target);AV&&A.markNodeClean(AV);}function AU(AV){if(AV&&(/\bimage-width:\b/i).exec(AV)||(/\bimage-height:\b/i).exec(AV)){var AZ=(/\bimage-width:[0-9]+\b/i).exec(AV);
var AX=(/\bimage-height:[0-9]+\b/i).exec(AV);var AY=AZ&&AZ[0].split(":")[1];var AW=AX&&AX[0].split(":")[1];
if(AY&&AW){return"style = 'width:"+AY+"px;height:"+AW+"px;'";}else{return"";}}return"";}var AQ=domline.createDomLine(AR.length>0,true,browser,document,null,AT,A.onMath,AU,AS,A.getAuthorInfos());
var AP=AQ.node;return{key:F(AP),text:AR,lineNode:AP,domInfo:AQ,lineMarker:0};}function N(AR,AP,AS){AS=(AS||function(){return false;
});var AQ;var AT;if(AP.length<1){return;}var AV=B.lines.atKey(F(AP[0].node));var AU=B.lines.atKey(F(AP[AP.length-1].node));
var AW=B.lines.offsetOfEntry(AV);var AX=B.lines.offsetOfEntry(AU)+AU.width;forEach(AP,function(Ab){var AY=I("insertLine",false);
var Aa=Ab.node;var Ac=F(Aa);var AZ;AY.mark("findEntry");if(AQ){var Ad=B.lines.next(AQ);if(Ad&&Ad.key==Ac){AZ=Ad;
AT+=AQ.width;}}if(!AZ){AY.literal(1,"nonopt");AZ=B.lines.atKey(Ac);AT=B.lines.offsetOfKey(Ac);}else{AY.literal(0,"nonopt");
}function Ae(Ak){if(!Ak){return;}var An=false;if((Ak.indexOf("subscript")!=-1)||(Ak.indexOf("superscript")!=-1)){An=true;
}var Ag="",Af="",Ai="";var Ah=Ak.split("&");for(var Aj in Ah){if(Ah[Aj]&&(/:/i.exec(Ah[Aj]))){Af=Ah[Aj].split(":")[0];
Ai=Ah[Aj].split(":")[1];if(Af=="bold"){Ag+="font-weight: bold;";}if(Af=="italic"){Ag+="font-style: italic;";
}if(Af=="subscript"){Ag+="vertical-align: sub;";}if(Af=="superscript"){Ag+="vertical-align: super;";}if(Af=="underline"||Af=="strikethrough"){var Am=/\btext-decoration:\s*line-through\b/i;
var Al=/\btext-decoration:\s*underline\b/i;if(Am.exec(Ag)){Ag=Ag.replace(Am,"text-decoration: underline line-through");
}else{if(Al.exec(Ag)){Ag=Ag.replace(Al,"text-decoration: underline line-through");}else{if(Af=="underline"){Ag+="text-decoration: underline;";
}else{Ag+="text-decoration: line-through;";}}}}if((Af!="bold")&&(Af!="italic")&&(Af!="underline")&&(Af!="strikethrough")&&(Af!="subscript")&&(Af!="superscript")){if(docContentAttr[Af]){Af=Af.replace(/[<]/g,"&lt").replace(/[>]/g,"&gt").replace(/["]/g,"&quot");
Ai=Ai.replace(/[<]/g,"&lt").replace(/[>]/g,"&gt").replace(/["]/g,"&quot");Ag+=Af+":"+Ai+";";}}}}return Ag;
}AQ=AZ;AY.mark("spans");A.getSpansForLine(AZ,function(Af,Ah,Ag){Ab.appendSpan(Af,Ah,Ag,Ae);},AT,AS());
AY.mark("addLine");Ab.prepareForAdd();AZ.lineMarker=Ab.lineMarker;if(!AR){D.insertBefore(Aa,D.firstChild);
}else{D.insertBefore(Aa,AR.nextSibling);}AR=Aa;Ab.notifyAdded();AY.mark("markClean");A.markNodeClean(Aa);
AY.end();});}A.getSpansForLine=function(AQ,AZ){var AS=AQ.text;var Ae=AQ.width;if(AS.length==0){var Ab=linestylefilter.getLineStyleFilter(0,"",AZ,B.apool);
Ab("","");}else{var Af=0;var AR=B.lines.indexOfEntry(AQ);var AV=A.getLangForCodeLine(AR);var AU=null;
if(AV||L=="monospace"){AU="start";for(var AY=5,AP=B.lines.prev(AQ);AY&&AP;AY--,AP=B.lines.prev(AP)){if(!AP.domInfo.node.children[0]){break;
}var AX=AP.domInfo.node.children[0].className.match(/list-code/);if(!AX||!AX.length){break;}var AW=AP.domInfo.node.className.match(/lexer_(\S+)/);
if(AW&&AW[1]){AU=AW[1];break;}}}var Aa=A.getTokenizer(AV);var Ad=A.getLineListType(AR);var AT=linestylefilter.getFilterStack(AS,AZ,browser,L!="monospace"&&!AV&&Ad.indexOf("code")==-1,AU,(AR>0&&Aa)?Aa:null);
var Ac=B.alines[AR];AT=linestylefilter.getLineStyleFilter(AS.length,Ac,AT,B.apool);AT(AS,"");}};function Q(AP,AR,AQ){forEach(AQ,function(AY){AY.width=AY.text.length+1;
});var AT=B.lines.offsetOfIndex(AP);var AU=B.lines.offsetOfIndex(AP+AR);var AV=B.lines.offsetOfIndex(AP);
var AX=B.lines.offsetOfIndex(AP+AR);B.lines.splice(AP,AR,AQ);E.docTextChanged=true;E.repChanged=true;
var AW=B.lines.offsetOfIndex(AP+AQ.length);var AS=map(AQ,function(AY){return AY.text+"\n";}).join("");
B.alltext=B.alltext.substring(0,AT)+AS+B.alltext.substring(AU,B.alltext.length);}function AC(AW,Ah,Ap,Az,AQ){var Aq=B.lines.offsetOfIndex(AW);
var Av=B.lines.offsetOfIndex(AW+Ah);var Au=B.lines.offsetOfIndex(AW);var At,Ax;if(AQ&&AQ.selStart){At=B.lines.offsetOfIndex(AQ.selStart[0])+AQ.selStart[1]-Au;
}if(AQ&&AQ.selEnd){Ax=B.lines.offsetOfIndex(AQ.selEnd[0])+AQ.selEnd[1]-Au;}var AT=map(Ap,function(A5){return A5.text+"\n";
}).join("");var Ac=B.alltext.substring(Aq,Av);var Ar=B.alines.slice(AW,AW+Ah).join("");var Ab=Az.join("|1+1")+"|1+1";
var An=AJ(Ac,AT,Ar,Ab,At,Ax);var Aa=An[0];var AY=An[1];var AS=Ac.substring(Aa,Ac.length-AY);var AP=AT.substring(Aa,AT.length-AY);
var AR=Aq+Aa;var AU=Av-AY;var AX=false;if(AS.charAt(AS.length-1)=="\n"&&AP.charAt(AP.length-1)=="\n"){AS=AS.slice(0,-1);
AP=AP.slice(0,-1);AU--;AY++;}if(AS.length==0&&AR==B.alltext.length&&AP.length>0){AR--;AU--;AP="\n"+AP.slice(0,-1);
AX=true;}if(AU==B.alltext.length&&AS.length>0&&AP.length==0){if(B.alltext.charAt(AR-1)=="\n"){AR--;AU--;
}}if(!(AS.length==0&&AP.length==0)){var A2=B.alltext;var A4=A2.length;var Af=B.lines.indexOfOffset(AR);
var Al=B.lines.offsetOfIndex(Af);function Aj(){var A5=Changeset.builder(A4);A5.keep(Al,Af);A5.keep(AR-Al);
return A5;}function AZ(BC,BB){var A7=Changeset.opIterator(BC);var A5=0;var A8=Aa;var BA=AT.length-AY-(AX?1:0);
while(A7.hasNext()){var A9=A7.next();var A6=A5+A9.chars;if(!(A6<=A8||A5>=BA)){BB(Math.max(A8,A5),Math.min(BA,A6),A9.attribs);
}A5=A6;}}var A0=(AP==AS);var Ag;if(A0){var Ay=ace.util.cachedStrFunc(function(A5){return Changeset.mapAttribNumbers(A5,function(A7){var A6=B.apool.getAttribKey(A7);
if(f(A6)){return B.apool.putAttrib([A6,""]);}return false;});});var Ae=Aj();if(AX){Ae.keep(1,1);}AZ(Ar,function(A7,A5,A6){Ae.keepText(AT.substring(A7,A5),Ay(A6));
});var A3=Ae.toString();var Ad=Aj();if(AX){Ad.keep(1,1);}AZ(Ab,function(A7,A5,A6){Ad.keepText(AT.substring(A7,A5),A6);
});var A1=Ad.toString();Ag=Changeset.compose(A3,A1,B.apool);}else{var AV=Aj();var As=B.lines.indexOfOffset(AU);
var Ak=B.lines.offsetOfIndex(As);if(Ak>AR){AV.remove(Ak-AR,As-Af);AV.remove(AU-Ak);}else{AV.remove(AU-AR);
}var Aw=false;var Ao=Changeset.makeAttribsString("+",(K?[["author",K]]:[]),B.apool);var Am=ace.util.cachedStrFunc(function(A5){var A6=AQ&&AQ.preserveAuthorship;
if(A6||Aw){return Changeset.composeAttributes(Ao,A5,true,B.apool);}else{return Changeset.composeAttributes(A5,Ao,true,B.apool);
}});var Ai="";AZ(Ab,function(A8,A7,A6){var A5=Changeset.attribsAttributeValue(A6,"author",B.apool);if(A5&&A5!=Ai){if(!Ai){Ai=A5;
}else{Aw=true;}}});if(AX){AV.insert("\n",Am(""));}AZ(Ab,function(A7,A5,A6){AV.insert(AT.substring(A7,A5),Am(A6));
});Ag=AV.toString();}m(Ag);}Q(AW,Ah,Ap);}function AJ(AW,AX,Ah,Ai,Al,AY){function AZ(Am){return f(B.apool.getAttribKey(Am));
}function Ag(Aq){var An=[];var Ap=[];var Am=Changeset.opIterator(Aq);while(Am.hasNext()){var Ao=Am.next();
An.push(Ao.chars);Ap.push(Ao.attribs);}return[An,Ap];}function AU(Aq,Ap){var Ao=Aq[0];var Ar=Aq[1];var Am=(Ap?Ao.length-1:0);
var An=0;return function As(){while(An>=Ao[Am]){if(Ap){Am--;}else{Am++;}An=0;}var At=Ar[Am];An++;return At;
};}var AT=AW.length;var AS=AX.length;var Ad=Math.min(AT,AS);var Ae=Ag(Changeset.filterAttribNumbers(Ah,AZ));
var Ac=Ag(Changeset.filterAttribNumbers(Ai,AZ));var AQ=0;var Ak=AU(Ae,false);var Aj=AU(Ac,false);while(AQ<Ad){if(AW.charAt(AQ)==AX.charAt(AQ)&&Ak()==Aj()){AQ++;
}else{break;}}var AP=0;var Ab=AU(Ae,true);var Af=AU(Ac,true);while(AP<Ad){if(AP==0){Ab();Af();AP++;}else{if(AW.charAt(AT-1-AP)==AX.charAt(AS-1-AP)&&Ab()==Af()){AP++;
}else{break;}}}var AR=-1;if((typeof AY)=="number"){AR=AS-AY;}if(AQ+AP>AT){var AV=AT-AQ;var Aa=AP;if(AR>=AV&&AR<=Aa){AP=AR;
}else{AP=AV;}AQ=AT-AP;}if(AQ+AP>AS){var AV=AS-AQ;var Aa=AP;if(AR>=AV&&AR<=Aa){AP=AR;}else{AP=AV;}AQ=AS-AP;
}return[AQ,AP];}function m(AP,AS){Changeset.checkRep(AP);if(Changeset.oldLen(AP)!=B.alltext.length){var AQ="doRepApplyChangeset length mismatch: "+Changeset.oldLen(AP)+"/"+B.alltext.length;
window.onfreakout&&window.onfreakout(AQ);throw new Error(AQ);}(function AR(AU){var AT=E.editEvent;if(AT.eventType=="nonundoable"){if(!AT.changeset){AT.changeset=AU;
}else{AT.changeset=Changeset.compose(AT.changeset,AU,B.apool);}}else{var AV=Changeset.inverse(AU,{get:function(AW){return B.lines.atIndex(AW).text+"\n";
},length:function(){return B.lines.length();}},B.alines,B.apool);if(!AT.backset){AT.backset=AV;}else{AT.backset=Changeset.compose(AV,AT.backset,B.apool);
}}})(AP);Changeset.mutateAttributionLines(AP,B.alines,B.apool);if(A.isTracking()&&!T){A.composeUserChangeset(AP);
}}A.performDocumentApplyChangeset=function(AQ,AS){m(AQ,AS);var AP=null;if(B.selStart&&B.selEnd){var AW=B.lines.offsetOfIndex(B.selStart[0])+B.selStart[1];
var AT=B.lines.offsetOfIndex(B.selEnd[0])+B.selEnd[1];var AR=Changeset.characterRangeFollow(AQ,AW,AT,AS);
AP=[AR[0],AR[1],B.selFocusAtStart];}var AV={splice:function(AY,AX,AZ){AU(AY,AX,map(Array.prototype.slice.call(arguments,2),function(Aa){return Aa.slice(0,-1);
}),null);},get:function(AX){return B.lines.atIndex(AX).text+"\n";},length:function(){return B.lines.length();
},slice_notused:function(AY,AX){return map(B.lines.slice(AY,AX),function(AZ){return AZ.text+"\n";});}};
Changeset.mutateTextLines(AQ,AV);if(AP){A.performSelectionChange(A.lineAndColumnFromChar(AP[0]),A.lineAndColumnFromChar(AP[1]),AP[2]);
}function AU(AX,AZ,Af,Ac){Ac=(Ac||ace.util.newTimeLimit(50));var AY=[];if(AZ>0){var Ad=B.lines.atIndex(AX);
for(var Ae=0;Ae<AZ;Ae++){AY.push(Ad.key);Ad=B.lines.next(Ad);}}var Aa=map(Af,O);Q(AX,AZ,Aa);$("body").removeClass("newpad");
var Ab;if(AX>0){Ab=J(B.lines.atIndex(AX-1).key);}else{Ab=null;}N(Ab,map(Aa,function(Ag){return Ag.domInfo;
}),Ac);if(Aa.length==1&&AY.length==1){AY=A.domAndRepSpliceToTable(Aa,AY,AX);}if(browser.msie){$(".attrimg").on("mousedown",function(Ag){Ag.preventDefault();
window.event.returnValue=false;});}forEach(AY,function(Ah){var Ag=document.getElementById(Ah);Ag.parentNode.removeChild(Ag);
});if((B.selStart&&B.selStart[0]>=AX&&B.selStart[0]<=AX+AZ)||(B.selEnd&&B.selEnd[0]>=AX&&B.selEnd[0]<=AX+AZ)){E.selectionAffected=true;
}}};A.setAttributeOnSelection=function(AP,AQ){if(!(B.selStart&&B.selEnd)){return;}A.performDocumentApplyAttributesToRange(B.selStart,B.selEnd,[[AP,AQ]]);
};A.setAttributeOnLine=function(AP,AS,AQ){var AT=[AP,0];var AR=[AP+1,0];A.performDocumentApplyAttributesToRange(AT,AR,[[AS,AQ?AQ:""]]);
};A.toggleAttributeOnSelection=function(AP,AR){if(document.activeElement.id=="sheet-id"){document.activeElement.triggerAttrToggle({bold:"b",italic:"i",underline:"u",strikethrough:"del"}[AP]);
return false;}if(!(B.selStart&&B.selEnd)){return;}if(A.isCaret()&&document.execCommand&&_contains($.getObjAttribute(docContentAttr),AP)){var AU=$.attrNameTurnOrder(AP);
if(AP=="font-size"){for(var AQ in fontSizeToOrder){if(fontSizeToOrder[AQ]==AR){document.execCommand(AU,false,parseInt(AQ));
}}}else{document.execCommand(AU,false,AR);}}else{console.log("self.isCaret() = "+A.isCaret()+"attributeName = "+AP);
if(AP=="font-size"){A.setLineFontSize(AR);}}var AS=true;var Ae=Changeset.makeAttribsString("+",[[AP,"true"]],B.apool);
var Af=new RegExp(Ae.replace(/\*/g,"\\*")+"(\\*|$)");function Ad(Ag){return Af.test(Ag);}var Aa=B.selStart[0];
var AX=B.selEnd[0];for(var AQ=Aa;AQ<=AX;AQ++){var AV=Changeset.opIterator(B.alines[AQ]);var Ac=0;var AZ=0;
var AT=B.lines.atIndex(AQ).text.length;if(AQ==Aa){AZ=B.selStart[1];}if(AQ==AX){AT=B.selEnd[1];}while(AV.hasNext()){var AY=AV.next();
var Ab=Ac;var AW=Ab+AY.chars;if(!Ad(AY.attribs)){if(!(AW<=AZ||Ab>=AT)){AS=false;break;}}Ac=AW;}if(!AS){break;
}}if(AS){A.performDocumentApplyAttributesToRange(B.selStart,B.selEnd,[[AP,""]]);}else{if(AP=="subscript"){A.performDocumentApplyAttributesToRange(B.selStart,B.selEnd,[[AP,AR],["superscript",""]]);
}else{if(AP=="superscript"){A.performDocumentApplyAttributesToRange(B.selStart,B.selEnd,[[AP,AR],["subscript",""]]);
}else{A.performDocumentApplyAttributesToRange(B.selStart,B.selEnd,[[AP,AR]]);}}}};A.performSelectionChange=function(AR,AP,AQ){if(c(AR,AP,AQ)){E.selectionAffected=true;
}};function c(AQ,AP,AR){AR=!!AR;var AS=(AR&&((!AQ)||(!AP)||(AQ[0]!=AP[0])||(AQ[1]!=AP[1])));if(((!ace.util.equalLineAndChars(B.selStart,AQ))||(!ace.util.equalLineAndChars(B.selEnd,AP))||(B.selFocusAtStart!=AS))){B.selStart=AQ;
B.selEnd=AP;B.selFocusAtStart=AS;E.repChanged=true;return true;}return false;}A.doUndoRedo=function(AQ){if(undoModule.enabled){var AP;
if(AQ=="undo"){AP="performUndo";}if(AQ=="redo"){AP="performRedo";}if(AP){var AR=E.editEvent.eventType;
E.startNewEvent(AQ);undoModule[AP](function(AT,AS){if(AT){A.performDocumentApplyChangeset(AT);}if(AS){A.performSelectionChange(A.lineAndColumnFromChar(AS.selStart),A.lineAndColumnFromChar(AS.selEnd),AS.selFocusAtStart);
}var AU=E.startNewEvent(AR,true);return AU;});}}};A.doExport=function(AT){var AP=window.location.href;
AP=AP.split("#")[0];AP=AP.split("/");var AS=AP[AP.length-1];AP[AP.length-1]="ep/pad/export";AP.push(AS);
AP=AP.join("/");if(!$("#editor").data("ismac")&&!pad_compatible.isIE()){var AQ=document.createElementNS("http://www.w3.org/1999/xhtml","a");
AQ.href=AP;var AR=document.createEvent("MouseEvents");AR.initMouseEvent("click",true,false,window,0,0,0,0,0,false,false,false,false,0,null);
AQ.dispatchEvent(AR);}else{window.open(AP);}};A.doExport2=function(AR){padutils.toolToast("正在导出,请稍候...",{top:"5px"});
var AP="/ep/pad/export/"+window.clientVars.padId;var AQ={v:2};$.post(AP,AQ,function(AS,AU){if(AU==="success"&&AS.s){U(true);
var AT="/ep/pad/exportfile/"+window.clientVars.padId+"?s="+AS.s;window.open(AT);}else{U(false);}}).error(function(){U(false);
});};function U(AP){padutils.hideToolToast();if(!AP){$.Custom_Dialog("导出不成功，请稍后重试。",{type:$.Custom_Dialog.Type.Question,title:"提示",overlay_close:false,buttons:[{caption:"我要反馈",callback:function(){$.showSupportPage();
return true;}},{caption:"确定",callback:function(){return true;}}]});}}A.canUndoRedo=function(AP){if(!undoModule.enabled){return false;
}if(AP=="undo"){return undoModule.canPerformUndo();}if(AP=="redo"){return undoModule.canPerformRedo();
}return false;};function l(){if(AH()==0||r()==0){return;}function AR(AU,AV,AT){if(AU[AV]!=AT){AU[AV]=AT;
return true;}return false;}for(var AQ=0;AQ<2;AQ++){var AP=$(D).outerHeight();var AS=r();if(AP<AS){if(browser.msie){AR(document.documentElement.style,"overflowY","auto");
}}else{}if(g!=AP){g=AP;C&&C.trigger("height-change",[AP]);}}if(browser.mozilla){AR(D.style,"height","");
}p();}function p(){A.setEditable(H);}A.setEditable=function(AP){H=AP;if(!H){a(false);}else{a(true);}if(browser.mozilla){try{document.execCommand("enableObjectResizing",false,false);
}catch(AQ){}}else{if(browser.ie){$(document).on("onresizestart",function(AR){AR.data.preventDefault();
});}}setClassPresence(D,"static",!H);};function a(AP){try{function AQ(AT,AV,AU){if(String(AT[AV]).toLowerCase()!=AU){AT[AV]=AU;
return true;}return false;}if(browser.msie||browser.safari||browser.mozilla){AQ(D,"contentEditable",(AP?"true":"false"));
}else{var AR=AQ(document,"designMode",(AP?"on":"off"));if(AR&&AP&&browser.opera){j();}}return true;}catch(AS){return false;
}}A.findMagicDomNode=function(AP){while(AP&&AP.parentNode!=D){AP=AP.parentNode;}return AP;};A.isWordChar=function(AP){return !!x.exec(AP);
};function Z(AP){return !!w.exec(AP);}function AL(AP,AQ){return[AP,AQ-B.lines.atIndex(AP).lineMarker];
}A.markerfulLineAndChar=function(AP,AQ){return[AP,AQ+B.lines.atIndex(AP).lineMarker];};function W(){C&&C.trigger("invalidate-cache");
}function J(AR){var AP=I("getCleanNodeByKey",false);AP.extra=0;var AQ=document.getElementById(AR);while(AQ&&A.isNodeDirty(AQ)){AP.extra++;
AQ.id="";AQ=document.getElementById(AR);}AP.literal(AP.extra,"extra");AP.end();return AQ;}function F(AQ){var AP=AQ.id;
if(AP){return AP;}return(AQ.id=(T?"previewdomid":"magicdomid")+(AB++));}function f(AP){return !!z[AP];
}A.isCaret=function(){return(B.selStart&&B.selEnd&&B.selStart[0]==B.selEnd[0]&&B.selStart[1]==B.selEnd[1]);
};A.caretLine=function(){return B.selStart[0];};A.caretColumn=function(){return B.selStart[1];};A.caretDocChar=function(){return B.lines.offsetOfIndex(A.caretLine())+A.caretColumn();
};A.caretWord=function(){var AP=A.caretDocChar()-1;while(AP>0&&!Z(B.alltext.charAt(AP))&&B.alltext.charAt(AP)!="*"){AP--;
}AP++;var AS=A.lineAndColumnFromChar(AP);var AQ="";while(!Z(B.alltext.charAt(AP))&&AP<B.alltext.length){AQ+=B.alltext.charAt(AP);
AP++;}var AR=A.lineAndColumnFromChar(AP);return{word:AQ,start:AS,end:AR};};A.lineAndColumnFromChar=function(AP){var AQ=B.lines.atOffset(AP);
var AR=B.lines.offsetOfEntry(AQ);var AS=B.lines.indexOfEntry(AQ);return[AS,AP-AR];};A.charFromLineAndColumn=function(AP){var AS=AP[0];
var AR=B.lines.offsetOfIndex(AS);var AQ=AP[1];return AR+AQ;};function AF(AP){W();A.markNodeClean(A.findMagicDomNode(AP));
}window.onEmbedResize=AF;A.beginAppending=function AK(){var AP;AP=document.createRange();AP.selectNodeContents(document.body);
AP.collapse(false);var AQ=window.getSelection();AQ.removeAllRanges();AQ.addRange(AP);};function AA(){var AQ=B.alltext;
var AP=AQ.length;if(AP>0){AP--;}return AQ.substring(0,AP);}A.exportText=function(){if(E&&!E.domClean){A.inCallStackIfNecessary("exportText",function(){A.fastIncorp();
});}return AA();};var d=null;A.getVisibleHeight=function(){return d;};A.setVisibleHeight=function(AP){d=AP;
};y();A.ace_beginAppending=A.beginAppending;A.ace_doInsertImageBlob=function(AP){C&&C.trigger("insert-image",[AP]);
};A.ace_canUndoRedo=A.canUndoRedo;A.ace_doUndoRedo=A.doUndoRedo;A.ace_performDocumentReplaceSelection=A.performDocumentReplaceSelection;
A.ace_doSetHeadingLevel=A.doSetHeadingLevel;A.ace_getBaseAttributedText=A.getBaseAttributedText;A.ace_getRep=A.getRep;
A.ace_scrollSelectionIntoView=A.scrollSelectionIntoView;A.ace_setProperty=A.setProperty;A.ace_exportText=A.exportText;
A.ace_setOnOpenLink=A.setOnOpenLink=function(AP){C&&C.on("open-link",function(AS,AR,AQ){AP(AR,AQ);return false;
});};A.ace_setOnAttach=A.onAttach=function(AP){C&&C.on("attach",function(AS,AQ,AR){AP(AQ,AR);return false;
});};A.ace_setAttachmentUrl=A.setAttachmentUrl=function(AR,AP,AQ){C&&C.trigger("set-attachment",[AR,AP,AQ]);
};A.ace_doReturnKey=A.doReturnKey=function(){C&&C.trigger("return-key");};A.ace_doDeleteKey=A.doDeleteKey=function(){C&&C.trigger("delete-key");
};};ace.observer=function(){var B=null;var H=null;var C=null;var F=null;var G=null;var E=null;var D=null;
function n(y){B=y;H=new ace.keystrokes(B);C=new ace.mouse(B);F=new ace.ui.toc(B);G=new ace.ui.lineAnnotator(B);
E=new ace.ui.carets(B);D=new ace.media(B);$(B.getRoot()).attr("tabindex",-1);if(!$("#padeditor").hasClass("sheet-style")&&clientVars.isMobile){$("body.embed>header").css("position","absolute");
}U();}function h(){window.setTimeout(function(){$("body.embed>header").css("position","absolute");$("body.embed>header").css("top",document.body.scrollTop+"px");
},500);document.body.addEventListener("touchmove",I,false);}function W(z,y,AA){D.setAttachmentUrl(z,y,AA);
}function P(){return D.insertpixelImage();}function o(){$("body.embed>header").hide();$("body.embed>header").css("position","fixed");
$("body.embed>header").css("top",0);setTimeout(function(){$("body.embed>header").show();},100);document.body.removeEventListener("touchmove",I,false);
}function q(){H=null;C=null;F=null;G=null;E=null;D=null;$(B.getRoot()).off(".ace");B=null;}function U(){A("blur",Y);
A("capture-click",Q);A("caret",X);A("click",Z);A("compositionend",K);A("compositionstart",K);A("dragover",w);
A("drop",a);A("embed",c);A("focus",d);A("idlework",b);A("ie-click",M);A("insert-image",g);A("invalidate-cache",f);
A("key-event",R);A("mousedown",r);A("mouseout",L);A("mouseup",v);A("paste",j);A("remove-user-caret",O);
A("resize",m);A("scroll",S);A("scroll-finished",N);A("scroll-throttled",V);A("touchmove",s);A("touchstart",p);
A("update-user-caret",T);}function A(y,z){$(B.getRoot()).on("observer-"+y+".ace",z);}function l(y){$(B.getRoot()).off("observer-"+y+".ace",func);
}function J(z,y){$(B.getRoot()).trigger("observer-"+z,y);}function u(z,y){return $(B.getRoot()).triggerHandler("observer-"+z,y);
}function Y(z,y){if($.getAgent.isIOS()&&$.genMTIMVer()){padeditor.ace.setEditable(false);}C.onBlur(y);
}function I(y){y.preventDefault();}function Q(z,y){C.captureClick(y);if($(y.target).parents("#formatPainterButton").length==0){B.setNodeFormat(y);
}}function X(AA,z){var y=E.onCaretUpdate(z);if(y){pad.notifyUserCaretUpdate(E.getCurrentCaretPosition());
}}function Z(AA,y){var z=C.processClick(y);if(z){if(window.gEditable&&$.isMobilePhone()&&$.genMTIMVer()&&y.target.className!="inline-img"){if(!padeditor.ace.getIsEditable()){padeditor.ace.setEditable(true);
}}D.onClick(y);C.onClickMisc(y);}}function K(z,y){C.onCompositionEvent(y);}function w(z,y){D.onDragOver(y.originalEvent);
}function a(z,y){D.onDrop(y.originalEvent);}function c(AA,y,z){embed.onEmbed(y,z);}function d(z,y){C.onFocus(y);
}function M(z,y){C.handleIEOuterClick(y);if($(y.target).parents("#formatPainterButton").length==0){B.setNodeFormat(y);
}}function b(z,y){G.updateLineNumbers(ace.util.newTimeLimit(33));if(y()){return;}F.updateTableOfContents(ace.util.newTimeLimit(33));
}function f(y){F.invalidateCache();G.invalidateCache();}function g(z,y){D.insertImage(y);}function R(z,y){H.onKeyEvent(y);
}function r(z,y){D.onMouseDown(y);}function x(z,y){C.onMouseEvent(y);}function L(z,y){C.handleMouseOut(y);
}function v(z,y){D.onMouseUp(y);}function j(z,y){D.onPaste(y);}function O(z,y){E.removeUserCaret(y);}function m(y){F.updateCurrentTOC();
E.updateAllCarets();J("invalidate-cache");}function S(y){C.onScroll();}function N(y){F.updateCurrentTOC();
}function V(z,y){E.updateAllCarets();}function p(z,y){C.handleTouchStart(y);}function s(z,y){C.handleTouchMove(y);
}function T(AA,z,y){E.updateUserCaret(z,y);}return{attachEditor:n,detachEditor:q,off:l,on:A,trigger:J,triggerHandler:u,lockMove:h,unlockMove:o,attachmentUrl:W,insertpixelImage:P};
};ace.ui.toc=function(E){var A=[];var B=[];var C=0;var D={};function K(Z){var P=E.getRep();var U=E.getRoot();
var N=[];var g=P.apool.attribToNum[["bold","true"]];var h=domline.escapeHTML(document.location.href.split("#")[0]);
if(!D["toc-div"]){D["toc-div"]=[];}var T=false;for(var R=0;R<U.childNodes.length;++R){if(D["toc-div"][R]!=U.childNodes[R].id){T=true;
D["toc-div"][R]=U.childNodes[R].id;}}if(!T&&!B.length){return;}if(T){B=[];C=0;}if(B.length){N=B;}var b=C?C:1;
for(var Q=b;Q<P.alines.length;Q++){if(Q%10==0&&Z()){B=N;C=Q;return;}var c=P.alines[Q];var d=0;var X=Changeset.opIterator(c);
var Y=false;while(X.hasNext()){var S=X.next();Changeset.eachAttribNumber(S.attribs,function(o){if(o==g){d+=S.chars;
}if(Changeset.opAttributeValue(S,"table",P.apool)||Changeset.opAttributeValue(S,"embed",P.apool)||Changeset.opAttributeValue(S,"img",P.apool)){Y=true;
}});}if(Y){continue;}var V=P.lines.atIndex(Q);var f=V.lineNode;var a=V.text;var m=a.length;var l=E.getLineListType(Q);
var j=f.offsetTop;}B=[];C=0;function W(){A=N;J(N);H();}if(A.length!=N.length){W();return;}for(var O in N){if(N[O][0]!=A[O][0]||N[O][1]!=A[O][1]||N[O][2]!=A[O][2]||N[O][3]!=A[O][3]||N[O][4]!=A[O][4]){W();
return;}}}function L(){D={};}function H(){var O;var T=$(window).scrollTop();var R=$("body > header").outerHeight();
var S=50;var Q=E.getRootSelector();$(Q+" .list-hone1, "+Q+" .toc-entry").each(function(W,U){var V=E.findMagicDomNode(U);
if($(U).offset().top>T+R+S){return false;}O=V;});var P=$("#toc-div .toc-entry.current");P.removeClass("current");
if(O){$("#toc-div .toc-entry[data-node-id="+O.id+"]").addClass("current");var N=$("#toc-div .toc-entry.current");
if(N.length&&P[0]!=N[0]){$("#toc-div").scrollTop(N.offset().top-$("#toc-div").offset().top-N.outerHeight(true)+$("#toc-div").scrollTop());
}}}function G(){var O=$("#padsidebar");var N=$("#toc-div");if(!N.length){return;}N.css({"max-height":Math.max(250,$(window).height()-N.position().top-150)});
}function J(O){$("#toc-div .toc-entry").remove();var N=0;for(;N<O.length;N++){var P=O[N][2];var Q=padutils.escapeHtml(O[N][1]);
var S=$("<a href='"+O[N][3]+"'/>").attr({tooltip:Q,title:Q,offset:O[N][0]}).html(Q);var R=$("<li class='toc-entry level"+(P+1)+"' data-node-id='"+O[N][4]+"'/>").append(S);
if(P!=-1){R.css("margin-left",P+"em");}$("#toc-div ul").append(R);}if(O.length>9){$("#toc-div ul").addClass("more-than-nine");
}else{$("#toc-div ul").removeClass("more-than-nine");}$("#toc-div .sidebarheading").toggle(N>0);var T=$("#padsidebar [data-tooltip]").filter(function(){return $(this).width()>=160;
});padutils.tooltip(T);G();}$(".toc-entry a").live("click",function(O){var N=parseInt($(this).attr("offset"))+$("#padpage")[0].offsetTop-$("#padbar").outerHeight();
$("html, body").animate({scrollTop:N},100);document.location.href=$(this).attr("href");return false;});
if(!padutils.getIsMobile()){var I=$("#padsidebar");var M=$("#toc-div");var F=function(){if($("body").hasClass("embed")){return;
}var N=$("body > header").height();I.css({top:N+"px",left:$("#editor").offset().left+$("#editor").outerWidth(true)+10}).addClass("fixed");
G();};$(window).scroll(throttle(F,33));F();$(window).resize(throttle(F,33));$(window).resize(function(){G();
});}return{invalidateCache:L,updateCurrentTOC:H,updateTableOfContents:K};};ace.ui.lineAnnotator=function(A){var C=1;
var K=document.getElementById("sidediv");var B={};var F=0;var M=document.createElement("div");var D=A.getRoot();
K.innerHTML='<table border="0" cellpadding="0" cellspacing="0" align="right"><tr><td id="sidedivinner"><div>&nbsp;</div></td></tr></table>';
var E=document.getElementById("sidedivinner");function J(P,N,O,R){if(O<1){O=1;}if(O!=N){while(N<O){N++;
var Q=document.createElement("DIV");Q.style.top="0";if(R){Q.appendChild(R(N));}P.appendChild(Q);}while(O<N){P.removeChild(P.lastChild);
N--;}}return N;}function G(Q,S,T,N){N=N||0;if(A.getCurrentCallStack()&&A.getCurrentCallStack().domClean){var P=Q.childNodes[N];
var O=D.childNodes[N];var R=false;if(!B[Q.id]){B[Q.id]=[];}while(P&&O){if(R||B[Q.id][N]!=O.id){B[Q.id][N]=O.id;
R=true;if(S(P,O)){$(P).css("top",$(O).offset().top-$(D).offset().top+2+"px");}}P=P.nextSibling;O=O.nextSibling;
if(N++%10==0&&N!=1&&T()){return N;}}}return 0;}function H(P){var Q=A.getRep();C=J(E,C,Q.lines.length());
var N=0;var O=false;function R(S,U){if(U.childNodes[0]&&hasClass(U.childNodes[0],"list-code1")){if(O==false){if(!S.previousSibling||!S.previousSibling.innerHTML){N=0;
}else{N=parseInt(S.previousSibling.innerHTML,10)||1;}}N=N+1;O=true;if(N==1){var T=document.createElement("A");
var W=A.getLineAndCharForPoint({node:U,index:0,maxIndex:0});T.innerHTML=A.getLangForCodeLine(W[0])||"txt";
if(T.innerHTML=="coffee"){T.innerHTML="coff";}else{if(T.innerHTML=="cpp"){T.innerHTML="c++";}}addClass(T,"lang-menu");
if(S.innerHTML!=T.outerHTML+"<span></span>"){var V=document.createElement("SPAN");V.innerHTML="";S.innerHTML="";
S.appendChild(T);S.appendChild(V);$(T).on("click",function(X){X.preventDefault();L(X,W[0]);return false;
});}return true;}else{if(S.innerHTML!=String(N)){S.innerHTML=N;}return true;}}else{O=false;if(S.innerHTML!=""){S.innerHTML="";
return false;}}return false;}F=G(E,R,P,F);}function L(N,O){$("#hp-editor-lang .hp-ui-button-menu-wrapper a").off(".hp-lang").on("click.hp-lang",function(Q){var P=$(this).text().replace(/^\s+|\s+$/g,"");
P=P=="c++"?"cpp":P;A.inCallStackIfNecessary("set-language",function(){var R=O;while(A.getLineListType(R).indexOf("code")>-1){A.performDocumentApplyAttributesToRange([R,0],[R,1],[["lang",P]]);
R=R+1;}});return false;});showContextMenu(N,"lang-menu",$("#hp-editor-lang"));}function I(){B={};}return{invalidateCache:I,updateLineNumbers:H};
};ace.util={};ace.util.newTimeLimit=function(E){var C=now();var F=0;var A=false;var D=false;var B=function(){if(A){if((!D)){D=true;
}return true;}var G=now()-C;if(G>E){A=true;return true;}else{F=G;return false;}};B.elapsed=function(){return now()-C;
};return B;};ace.util.doAlert=function(B){var A=$(".hp-editor-alert-msg");if(!A.length){A=$("<div>").addClass("global-msg hp-editor-alert-msg").hide().appendTo($("body"));
}window.clearTimeout(A.data("fadeOutTimer"));A.fadeIn().text(B).data("fadeOutTimer",window.setTimeout(function(){A.fadeOut();
},3000));};ace.util.makeIdleAction=function(E){var A=null;var B=0;function D(){if(A){window.clearTimeout(A);
A=null;}}function C(H){D();B=H;var G=H-now();if(G<0){G=0;}A=window.setTimeout(F,G);}function F(){A=null;
if(window.blockingCooperation){return;}E();}return{atMost:function(H){var G=now()+H;if((!A)||B>G){C(G);
}},atLeast:function(H){var G=now()+H;if((!A)||B<G){C(G);}},never:function(){D();}};};ace.util.isValidBrowserForSpellcheck=function(){var A=userAgentInfo();
if((A.browser=="Chrome"&&A.version>=29)||(A.browser=="Firefox"&&A.version>=20)||(A.browser=="Internet Explorer"&&A.version>=8)){return true;
}return false;};ace.util.cachedStrFunc=function(B){var A={};return function(C){if(!A[C]){A[C]=B(C);}return A[C];
};};ace.util.equalLineAndChars=function(B,A){if(!B){return !A;}if(!A){return !B;}return(B[0]==A[0]&&B[1]==A[1]);
};ace.ui.carets=function(B){var A=null;var C=B.getRoot();var G=32;function K(){return A;}function J(O){var L=false;
var M=B.getRep();if((!clientVars.demoMode&&clientVars.userId.indexOf("g.")==0)||$(".user-caret").length>10){return L;
}if(M.selStart){var N=M.selStart[0];if(A!=N||O){A=N;L=true;}}var P=$(".user-caret").length>0;if((P||clientVars.demoMode)&&(L||!$("#user-caret-"+clientVars.userId.replace(".","-")).is(":visible"))){E({changedBy:clientVars.userId,caret:A},true);
}return L;}function E(L,g){var T=B.getRep();var N=B.getAuthorInfos();if(!N[L.changedBy]||L.caret==null){return;
}if(L.changedBy.indexOf("g.")==0&&!clientVars.demoMode){return;}if(!g&&L.changedBy==clientVars.userId){return;
}if(L.caret>=T.lines.length()){return;}var X="#user-caret-"+L.changedBy.replace(".","-");var M=$(X);var U=false;
if(!M.length){var R="/static/img/nophoto.png";var V="";if(L.changedBy==clientVars.userId){R=clientVars.userPic||"/static/img/nophoto.png";
V=clientVars.userLink;}else{for(var P=0;P<clientVars.invitedUserInfos.length;++P){if(clientVars.invitedUserInfos[P].userId==L.changedBy){R=clientVars.invitedUserInfos[P].userPic||"/static/img/nophoto.png";
V=clientVars.invitedUserInfos[P].userLink;break;}}}var W=$("<img>").attr("src",R);var a=N[L.changedBy].name.split(" ")[0];
var Z=$("<span>").addClass("user-caret-lbl").addClass("initials-shown").text(a);var Q=N[L.changedBy].name.split(" ");
var Y=$("<span>").addClass("user-caret-initials").text((Q[0][0]||"")+(Q.length>=2?(Q[Q.length-1][0]||""):"")).css("opacity","0");
M=$("<span>").attr("id",X.substring(1)).addClass("user-caret").addClass(linestylefilter.getAuthorClassName(L.changedBy)).data("name",a).data("userId",L.changedBy).attr("title",N[L.changedBy].name).append(W).append(Z).append(Y).appendTo("#padeditor");
W.css("border-color",N[L.changedBy].bgcolor);Z.css("background-color",N[L.changedBy].bgcolor);Y.css("background-color",N[L.changedBy].bgcolor);
U=true;window.setTimeout(function(){M.fadeIn();},300);}var d=$(C).offset();var S=T.lines.atIndex(L.caret);
var j=I();var c=H();if(S){var O=$(S.lineNode).offset().top+$(S.lineNode).height()/2+(browser.phone?-9:-19);
var b=d.left-G;var f=O<j;var h=O>c;M.show().data("theoreticalCaretTop",O).data("realCaretTop",O);if(!f&&!h){M.show().offset({top:O,left:b});
}M.find("img").css("margin-right",0);M.find(".user-caret-lbl").css("width","120px");}F();if(U){M.hide();
}}function I(){var L=clientVars.isDesktopApp?40:7;return $(window).scrollTop()+(browser.mobile?5:$("body > header").height()+L);
}function H(){var N=$(C).offset();var M=44;var L=$("body").hasClass("hasBanner")?200:100;return $(window).scrollTop()+$(window).height()-(browser.mobile?0:M)+N.top-(browser.mobile?(browser.phone?30:148):(clientVars.isDesktopApp?10:L));
}function F(){var O=$(C).offset();var N=I();var M=H();$.each($(".user-caret"),function(V,U){var P=$(U);
var Q=P.data("theoreticalCaretTop");var S=O.left-G;if(Q==undefined){return;}var R=Q<N;var T=Q>M;P.off(".user-caret");
if(P.data("userId")==clientVars.userId||!R){P.removeClass("user-caret-offscreen-top");}if(P.data("userId")==clientVars.userId||!T){P.removeClass("user-caret-offscreen-bottom");
}if(R||T){Q=R?N:M;P.data("realCaretTop",Q).show().addClass(R?"user-caret-offscreen-top":"user-caret-offscreen-bottom").addClass("user-caret-transition-off").offset({top:Q,left:S});
P.on("click.user-caret",function(){$(window).scrollTop(Math.max(0,P.data("theoreticalCaretTop")-O.top-75));
});}else{P.data("realCaretTop",P.data("theoreticalCaretTop")).show().offset({top:P.data("theoreticalCaretTop"),left:S});
window.setTimeout(function(){P.removeClass("user-caret-transition-off");},0);}});var L={};$.each($(".user-caret"),function(R,Q){Q=$(Q);
var P=Q.data("realCaretTop");if(P==undefined){return;}if(!L[P]){L[P]=[];}L[P].push(Q);});$.each(L,function(T,P){if(P.length>1){var S=browser.mobile?10:24;
var R=-1*S;for(var Q=0;Q<P.length;++Q){R+=S;P[Q].find("img").css("margin-right",R+"px");P[Q].find(".user-caret-initials").css("margin-right",R+"px").css("opacity","1");
}for(var Q=0;Q<P.length;++Q){P[Q].find(".user-caret-lbl").css("width",Math.max(0,120-R)+"px").addClass("initials-shown");
}}else{if(P.length==1){P[0].find("img").css("margin-right",0);P[0].find(".user-caret-lbl").css("width","120px");
P[0].find(".user-caret-lbl").removeClass("initials-shown");P[0].find(".user-caret-initials").css("margin-right",0).css("opacity","0");
}}});}function D(N){var M="#user-caret-"+N.userId.replace(".","-");var L=$(M);if(L.length){window.clearInterval(L.data("cursorEffect"));
L.fadeOut(undefined,function(){L.remove();if($(".user-caret").length==1&&$(".user-caret")[0].id=="user-caret-"+clientVars.userId.replace(".","-")&&!clientVars.demoMode){D({userId:clientVars.userId});
}});}}return{getCurrentCaretPosition:K,onCaretUpdate:J,removeUserCaret:D,updateAllCarets:F,updateUserCaret:E};
};ace.keystrokes=function(A){var J="    ";var F=false;var C=A.getObserver();var I=false;var H=[];var K=[{listType:"comment",text:"//",allowed:function(){return !A.isMonospace();
}},{text:"[]",listType:"task"},{text:"[ ]",listType:"task"},{text:"- ",listType:"bullet",allowed:function(){return !A.isMonospace();
}},{text:"# ",listType:"hone",allowed:function(){return !A.isMonospace();}},{text:"## ",listType:"htwo",allowed:function(){return !A.isMonospace();
}},{text:"### ",listType:"hthree",allowed:function(){return !A.isMonospace();}},{text:"* ",listType:"bullet",allowed:function(){return !A.isMonospace();
}},{charRegexp:[/\d/,/\./,/ /],regexp:/^\d\. /,listType:"number"},{charRegexp:[/\d/,/\d/,/\./,/ /],regexp:/^\d\d\. /,listType:"number"},{text:"    ",listType:"code",allowed:function(){return !A.isMonospace();
}}];var D={searchSet:K,nextCharIndex:0};var T=navigator.userAgent.match(/iPad/i)!=null;var R=navigator.userAgent.match(/iPhone/i)!=null;
var O=(T||R);function M(X){var X=X.replace(/[*+]/i,"");if(X.substring(0,4)==J&&X.substring(0,5)!="     "){return true;
}return false;}function Q(X){var X=X.replace(/[*+]/i,"");if(X.substring(0,1)==" "){return true;}return false;
}function G(X){if(X.substring(0,1)=="*"){return true;}return false;}function U(Y){if($("#beginne-guide-wrapper").is(":visible")){Y.preventDefault();
Y.stopPropagation();return false;}if(!A.getIsEditable()||((/MSIE 10/).test(navigator.userAgent)&&pad_imageprocessor.getSelectImg())){if(!$.getAgent.isMobile()&&$.getType()=="word"){var Z=Y.keyCode;
var a=Y.which;if(Z==8||a==8||Z==46||a==46){try{Y.preventDefault();Y.stopPropagation();pad_imageprocessor.deleteImg();
}catch(f){console.log("delete img error = "+f.toString());}}}return;}var X=Y.type;var b=Y.charCode;var Z=Y.keyCode;
var a=Y.which;var d=false;if(Y.which==0&&browser.android){var c=A.getSelection();if(c&&c.startPoint&&c.startPoint.index>0){d=true;
var j=c.startPoint.node.nodeValue[c.startPoint.index-1];a=b=Z=j.charCodeAt(0);if(a==160){a=32;}else{if(a==46){a=190;
}}}if(X=="keyup"){H.push(a);}if(Y.type!="keyup"&&String.fromCharCode(b)!="@"){return;}}else{if(X=="keypress"){H.push(b);
}}if(X=="keyup"&&I){setClassPresence(A.getRoot(),"authorColors",true);I=false;}var g=((!b)&&((X=="keyup")||(X=="keydown"))&&(Z==16||Z==17||Z==18||Z==20||Z==224||Z==91));
if(g){return;}var h=((browser.msie||browser.safari)?(X=="keydown"):(X=="keypress"));var l=((browser.msie||browser.safari)?(X=="keydown"):(X=="keypress"));
A.inCallStack("handleKeyEvent",function(){var m=false;if(X=="keypress"||(h&&Z==13)){C.trigger("keypress");
}m=V(Y,X,b,Z,a,d);if(!m){m=S(Y,X,b,Z,a,d);}if(X=="keydown"){A.getIdleWorkTimer().atLeast(200);}else{if(X=="keypress"){A.getIdleWorkTimer().atLeast(500);
}else{if(X=="keyup"){var n=200;A.getIdleWorkTimer().atLeast(n);A.getIdleWorkTimer().atMost(n);}}}var p=(browser.mozilla&&Y.altKey&&b==0&&Z==0);
var o=(browser.safari&&Y.altKey&&Z==229);if(F||p||o){A.getIdleWorkTimer().atLeast(3000);F=true;}if((!m)&&(!F)&&(!A.getInInternationalComposition())){if(X!="keyup"||!A.incorpIfQuick()){A.observeChangesAroundSelection();
}}if(X=="keyup"){F=false;H.shift();}});}function V(Y,Z,AA,h,m,y){var X=A.getRep();var p=((browser.msie||browser.safari)?(Z=="keydown"):(Z=="keypress"));
var d=((browser.msie||browser.safari)?(Z=="keydown"):(Z=="keypress"));var a=String.fromCharCode(m).toLowerCase();
var r=null;function o(){if(r==null&&A.isCaret()){var AF=A.getLineListType(A.caretLine());r=A.isMonospace()||AF.indexOf("code")==0;
}return r;}var b=A.findAutolinkStartPosition();if(b&&Z==(browser.mozilla?"keypress":"keydown")){var j={9:"enter",13:"enter",27:"cancel",38:"up",40:"down"}[h];
if(j){var f=A.isValidLinkStart(b)?A.linkWord(b):A.caretWord();var AE=A.caretWordPopupPosition();var AD=A.autocompleteCallback(f.word,j,f.start,f.end,AE);
if(AD){A.fastIncorp();Y.preventDefault();return true;}else{if(j=="cancel"){A.fastIncorp();A.clearAutolink(b);
return true;}}}}if(Z==(browser.mozilla?"keypress":"keydown")&&Y.altKey){var j={38:"up",40:"down"}[h];
if(j){var c=Changeset.builder(X.lines.totalWidth());var g=((X.selStart[0]!=X.selEnd[0])&&(X.selEnd[1]==0))?X.selEnd[0]-1:X.selEnd[0];
var q=false;if(j=="up"&&X.selStart[0]>0&&g<X.lines.length()-1){c.keep(X.lines.offsetOfIndex(X.selStart[0]-1),X.selStart[0]-1);
c.remove(X.lines.atIndex(X.selStart[0]-1).text.length+1,1);for(var l=X.selStart[0];l<=g;l++){c.keep(X.lines.atIndex(l).text.length+1,1);
}c.insertAText({text:X.lines.atIndex(X.selStart[0]-1).text,attribs:X.alines[X.selStart[0]-1]});c.insert("\n",[[]],X.apool);
q=true;}else{if(j=="down"&&g<X.lines.length()-2){c.keep(X.lines.offsetOfIndex(X.selStart[0]),X.selStart[0]);
c.insertAText({text:X.lines.atIndex(g+1).text,attribs:X.alines[g+1]});c.insert("\n",[[]],X.apool);for(var l=X.selStart[0];
l<=g;l++){c.keep(X.lines.atIndex(l).text.length+1,1);}c.remove(X.lines.atIndex(g+1).text.length+1,1);
q=true;}}if(q){A.fastIncorp();X=A.getRep();var s=c.toString();if(!Changeset.isIdentity(s)){A.performDocumentApplyChangeset(s);
}A.performSelectionChange([X.selStart[0],X.selStart[1]],[X.selEnd[0],X.selEnd[1]],X.selFocusAtStart);
Y.preventDefault();return true;}}}if(a=="@"&&(Z=="keydown"||Z=="keypress")&&(!o())){var x=A.caretDocChar()-1;
var v=X.alltext.charAt(x);if(/\s/.test(v)){A.fastIncorp();X=A.getRep();C.trigger("track",["at-linking"]);
Y.preventDefault();A.performDocumentReplaceRange(y?[X.selStart[0],X.selStart[1]-1]:X.selStart,X.selEnd,"@",[["autolink","true"]]);
return true;}}if(a=="#"&&String.fromCharCode(AA).toLowerCase()=="#"&&(Z=="keydown"||Z=="keypress")&&(!o())){A.fastIncorp();
X=A.getRep();C.trigger("track",["hashtag"]);Y.preventDefault();A.performDocumentReplaceRange(X.selStart,X.selEnd,"#",[["autolink","true"]]);
return true;}if(!b&&a==":"&&(Z=="keydown"||Z=="keypress")&&(!o())){var x=A.caretDocChar()-1;var v=X.alltext.charAt(x);
if(/\s/.test(v)){A.fastIncorp();X=A.getRep();C.trigger("track",["emoji"]);Y.preventDefault();A.performDocumentReplaceRange(X.selStart,X.selEnd,":",[["autolink","true"]]);
return true;}}if((b||A.isWordChar(a))&&(Z=="keypress"||((Z=="keyup"||Z=="keydown")&&(m==8||m==37||m==39)))&&(!o())&&(!O)){A.fastIncorp();
var f;if(A.isCaret()){if(A.isValidLinkStart(b)){f=A.linkWord(b);}else{f=A.caretWord();}var n=f.word;if(Z=="keypress"){n+=String.fromCharCode(m);
}var u=A.shouldTriggerLink(n,f.start);if(!b&&u&&n[0]!=":"){C.trigger("track",["atless-linking"]);A.setAutolink(f.start,n);
A.getCurrentCallStack().isTriggeringAutocomplete=true;return true;}else{if(b){if(!u||b[0]!=f.start[0]||b[1]!=f.start[1]){A.clearAutolink(b);
A.autocompleteCallback(null);return true;}}}}}if(p&&h==8){var AB=(A.isCaret()&&X.selStart[1]==X.lines.atIndex(X.selStart[0]).lineMarker);
if(AB&&!A.getInInternationalComposition()){A.fastIncorp();Y.preventDefault();E(Y);}return true;}if(p&&h==13){try{A.fastIncorp();
}catch(w){console.log("return key error "+w.toString());}Y.preventDefault();L(Y);return true;}if(d&&a=="e"&&B(Y)){A.fastIncorp();
Y.preventDefault();A.toggleAttributeOnSelection("highlight");return true;}if(p&&h==9&&!B(Y)){A.fastIncorp();
Y.preventDefault();P(Y.shiftKey);return true;}if(Z=="keydown"&&(a=="c"||a=="x")&&B(Y)){setClassPresence(A.getRoot(),"authorColors",false);
I=true;}if(d&&a=="z"&&B(Y)){A.fastIncorp();Y.preventDefault();if(Y.shiftKey){A.doUndoRedo("redo");}else{A.doUndoRedo("undo");
}return true;}if(d&&a=="y"&&!Y.shiftKey&&B(Y)){A.fastIncorp();Y.preventDefault();A.doUndoRedo("redo");
return true;}if(d&&a=="u"&&Y.shiftKey&&B(Y)){A.fastIncorp();Y.preventDefault();A.doInsertOrderedList();
return true;}if(d&&a=="i"&&Y.shiftKey&&B(Y)){A.fastIncorp();Y.preventDefault();A.doInsertUnorderedList();
return true;}if(d&&a=="y"&&Y.shiftKey&&B(Y)){A.fastIncorp();Y.preventDefault();A.doInsertTaskList();return true;
}if(d&&_contains(["b","i","u","d"],a)&&!Y.shiftKey&&B(Y)){var AC={b:{command:"bold"},i:{command:"italic"},u:{command:"underline"},d:{command:"strikethrough"}};
console.log("this click ctrl");var z=AC[a].command;A.fastIncorp();Y.preventDefault();A.toggleAttributeOnSelection(z,true);
return true;}if(d&&h==187&&B(Y)&&!A.isCaret()){A.fastIncorp();X=A.getRep();Y.preventDefault();A.performDocumentApplyAttributesToRange(X.selStart,X.selEnd,[[Y.shiftKey?"subscript":"superscript",""]]);
A.toggleAttributeOnSelection(Y.shiftKey?"superscript":"subscript");return true;}if(d&&a=="h"&&B(Y)){A.fastIncorp();
Y.preventDefault();E();return true;}if(d&&a=="s"&&B(Y)){return true;}return false;}function S(o,n,r,u,v,q){var l=false;
if(n!="keyup"){return;}var a=A.getRep();var j=false;var f=D.nextCharIndex;var Y=D.searchSet;D.searchSet=[];
var c=H[0];for(var X=0;X<Y.length;X++){if(!Y[X]||("allowed" in Y[X]&&!Y[X].allowed())||!c){continue;}var s=a.selStart[1];
var Z=a.selStart[0];var g=a.lines.atIndex(Z);var h=g.lineMarker;function w(x,y){if(typeof(x)=="number"){return x==y;
}else{return(x[0]<=y)&&(x[1]>=y);}}if((Y[X].text&&Y[X].text.charCodeAt(f)==c)||(Y[X].charRegexp&&String.fromCharCode(c).match(Y[X].charRegexp[f]))){var b=Y[X].text?Y[X].text.length:Y[X].charRegexp.length;
if(b==f+1){A.fastIncorp();a=A.getRep();g=a.lines.atIndex(Z);function p(x,y){if(x.text){var z=x.text.length;
return y.text.substr(y.lineMarker,z)==x.text;}else{if(x.regexp){return y.text.match(x.regexp);}}}if(p(Y[X],g)){o.preventDefault();
l=true;var d=A.getLineListType(Z);if(d.indexOf("code")>-1){}else{var m=1;if(d){m=Number(/([a-z]+)([12345678])/.exec(d)[2])+1;
}if(Y[X].listType=="htwo"){A.performDocumentReplaceRange([Z,0],[Z,b+h]," ");A.performSelectionChange(A.markerfulLineAndChar(Z,0),A.markerfulLineAndChar(Z,1),true);
A.setAttributeOnLine(Z,"bold",true);}else{if(Y[X].listType=="table"){A.performDocumentReplaceRange([Z,0],[Z,b+h],"*",[["table","123"]]);
A.performSelectionChange(A.markerfulLineAndChar(Z+1,0),A.markerfulLineAndChar(Z+1,0),true);}else{A.performDocumentReplaceRange([Z,0],[Z,b+h],"");
A.setLineListType(Z,Y[X].listType+m);}}C.trigger("track",["keyboard-macro",Y[X].listType]);}}j=true;}else{D.searchSet.push(Y[X]);
}}}if(!j&&D.searchSet.length){D.nextCharIndex++;}else{D.searchSet=K;D.nextCharIndex=0;}return l;}function W(){return $("#padbody").find(".sheet-style").length;
}function B(X){if(navigator.platform.match(/(ipod touch)|(ipad)|(iphone)|(mac)/i)){return X.metaKey&&!X.altKey;
}return X.ctrlKey&&!X.altKey;}function N(){var X=A.getRep();if(A.isCaret()&&A.caretLine()>0){var Y=A.caretLine();
var b=X.lines.atIndex(Y);var Z=X.lines.prev(b);if(A.caretColumn()==Z.lineMarker){var d=Z.text.substr(Z.lineMarker);
var a=/^ *(?:)/.exec(d)[0];var c=Changeset.builder(X.lines.totalWidth()).keep(X.lines.offsetOfIndex(Y),Y).keep(Z.lineMarker,0).insert(a,[["author",A.getThisAuthor()]],X.apool).toString();
A.performDocumentApplyChangeset(c);A.performSelectionChange([Y,a.length+b.lineMarker],[Y,a.length+b.lineMarker]);
}}}function L(p,f){var a=A.getRep();if(!(a.selStart&&a.selEnd)){return;}function o(r){return r.indexOf("hone")>-1||r.indexOf("htwo")>-1||r.indexOf("hthree")>-1;
}var X=a.selStart[0];var Y=A.getLineListType(X);var Z=A.getLineTextAlignType(X);if(Y&&!o(Y)){if(X+1<a.lines.length()){var j=Y.indexOf("code")==0;
var b=(X>=0&&a.lines.atIndex(X));var d=(X-1>=0&&a.lines.atIndex(X-1));var n=(d&&d.text.length==d.lineMarker);
var l=(b&&b.text.length==b.lineMarker+((Z=="center"||Z=="right")?1:0));var q=(b&&A.isCaret()&&(a.selStart[1]==b.lineMarker));
if(p.shiftKey){A.performDocumentReplaceSelection("\n");var c=Y.match(/[2-9]$/);c=c?Number(c[0]):null;
A.setLineListType(X+1,c?"indent"+c:null);}else{if(j?n&&l:l){if(Y.indexOf("indent")==0){E();}else{A.doIndentOutdent(true,true);
}}else{if(q){A.performDocumentReplaceSelection("\n");if(!f){Y=Y.replace("taskdone","task");A.setLineListType(X,Y);
A.setNextLineFontSize(X,Y);}if(Z){A.setLineTextAlignType(X,Z);}}else{A.performDocumentReplaceSelection("\n");
if(Z){A.setLineTextAlignType(X+1,Z);}if(!f){Y=Y.replace("taskdone","task");A.setLineListType(X+1,Y);A.setNextLineFontSize(X,Y);
}}}}}if(j){var g=A.getLangForCodeLine(X);if(g){A.performDocumentApplyAttributesToRange([X+1,0],[X+1,1],[["lang",g]]);
}N();}}else{if(Z&&!f){var h=(X>=0&&a.lines.atIndex(X));var m=(h&&A.isCaret()&&(a.selStart[1]==h.lineMarker));
A.performDocumentReplaceSelection("\n");if(m){A.setLineTextAlignType(X,Z);}else{A.setLineTextAlignType(X+1,Z);
}}else{A.performDocumentReplaceSelection("\n");N();}}if(X>=0){setTimeout(function(){A.getLastNodeAttrs(X);
},0);}}function P(Z){var Y=A.getRep();var X=Y.lines.atIndex(A.caretLine()).text;var d=A.getLineListType(A.caretLine()).indexOf("code")==0;
var c=A.getLineListType(Y.selStart[0]);if(!A.isCaret()){return;}if(c){if(M(X)&&Z){var b=[Y.selStart[0],(G(X)?1:0)];
var a=[Y.selStart[0],(G(X)?5:4)];A.performDocumentReplaceRange(b,a,"");}else{A.doIndentOutdent(Z);}}else{if(M(X)){if(Z){var b=[Y.selStart[0],(G(X)?1:0)];
var a=[Y.selStart[0],(G(X)?5:4)];A.performDocumentReplaceRange(b,a,"");}else{A.doIndentOutdent(Z);}}else{if(!Q(X)&&Z){return;
}A.performDocumentReplaceSelection(J,true);}}}function E(s){var Z=A.getRep();var g=s||{};var l=false;
if(Z.selStart){if(A.isCaret()){var j=A.caretLine();var d=A.caretColumn();var f=Z.lines.atIndex(j);var p=f.text;
var m=f.lineMarker;if(/^ +$/.exec(p.substring(m,d))){var r=d-m;var q=J.length;var o=((r-1)%q)+1;A.performDocumentReplaceRange([j,d-o],[j,d],"");
l=true;}}if(!l){if(A.isCaret()){var X=A.caretLine();var f=Z.lines.atIndex(X);if(A.caretColumn()<=f.lineMarker){var u="delete_newline";
var v=(X>0?A.getLineListType(X-1):"");var n=A.getLineListType(X);var h=(X>0&&Z.lines.atIndex(X-1));var Y=A.getLineTextAlignType(X);
if(n){var a=n.match(/[2-9]$/);a=a?Number(a[0])-1:null;A.setLineListType(X,a?"indent"+a:null,true);Y&&A.setLineTextAlignType(X,Y);
}else{if(Y=="right"||Y=="center"){if(Y=="right"){A.setLineTextAlignType(X,"center");}else{if(Y=="center"){A.setLineTextAlignType(X,null);
}}}else{if(X>0){if(Y=="left"){A.setLineTextAlignType(X,null);}if((h.text=="*"&&A.getLineHasMagicObject(X-1))||h.text=="**"){A.performDocumentReplaceRange([X-1,0],[X,0],"");
}else{A.performDocumentReplaceRange([X-1,h.text.length],[X,0],"");}}}}}else{var b=A.caretDocChar();if(b>0){if(g.metaKey||g.ctrlKey||g.altKey){var c=b-1;
while(c>f.lineMarker&&A.isWordChar(Z.alltext.charAt(c-1))){c--;}A.performDocumentReplaceCharRange(c,b,"");
}else{A.performDocumentReplaceCharRange(b-1,b,"");}}}}else{A.performDocumentReplaceSelection("");}}}}C.on("return-key",function(Y,X){L({},X);
});C.on("delete-key",function(X){E({});});return{onKeyEvent:U};};ace.mouse=function(A){var C=[];var I=null;
var J=null;var X=A.getRoot();var E=false;var D=false;var G;var F;var H;function W(f,g){C.push(f,g);setTimeout(Y,300);
}function Y(){C.splice(0,2);}function S(f){D=false;G=f.originalEvent.touches[0].clientX;F=f.originalEvent.touches[0].clientY;
}function V(f){if(Math.abs(f.originalEvent.touches[0].clientX-G)<10&&Math.abs(f.originalEvent.touches[0].clientY-F)<10){return;
}D=true;}function Z(f){for(var g=0;g<C.length;g+=2){var h=C[g];var j=C[g+1];if(Math.abs(f.clientX-h)>25||Math.abs(f.clientY-j)>25){continue;
}f.stopPropagation();f.preventDefault();return;}}function N(f){A.inCallStack("handleClick",function(){A.getIdleWorkTimer().atMost(200);
});var g=f.type=="touchend";if(g){if(D){f.preventDefault();return false;}W(G,F);}else{if(f.ctrlKey||f.button>1){return false;
}}if(g){window.focus();}return true;}function d(f){if(!f||f.nodeName!="SPAN"){return false;}return getClassArray(f,function(g){return g.match("^author-");
}).length;}function b(g){var h=[];for(var f=0;f<g.childNodes.length;f++){if(g.childNodes[f].nodeType===1){h.push(g.childNodes[f]);
}}return h;}function R(f,g){while(f&&f!=g){f=f.parentNode;}if(f==g){return true;}return false;}var B={};
function c(){if(B.tooltip){return;}B.tooltip=document.createElement("DIV");B.tooltip.innerHTML='<div></div><div class="body"></div><div class="url"></div>';
B.tooltip.id="tooltip";A.getRoot().parentNode.appendChild(B.tooltip);}function K(f){if(B.tooltip){if(!f.relatedTarget||!R(f.relatedTarget,B.target)){B.target=null;
A.getDynamicCSS().selectorStyle("#padbody #tooltip:before").borderBottomColor="rgba(59, 58, 60, 0.95)";
B.tooltip.style.display="none";}}}function U(f){if((f.target.tagName||"").toLowerCase()!="html"){return;
}var g=A.getRoot();if(!(f.pageY>g.clientHeight)){return;}A.inCallStack("handleOuterClick",function(){A.fastIncorp();
var l=A.getRep();if(A.isCaret()){var h=l.lines.length()-1;var j=l.lines.atIndex(h).text.length;A.performSelectionChange([h,j],[h,j]);
}});}function Q(g){var v=A.getRoot();var q=A.getLastAutolinkPosition();if(q){var u=A.findAutolinkStartPosition(q[0]);
if(u){A.inCallStack("removeAutolink",function(){A.fastIncorp();A.clearAutolink(u);A.setLastAutolinkPosition(null);
});}}function s(AB){return(AB.tagName||"").toLowerCase()=="div"&&AB.className.indexOf("ace-line")>-1;
}f=g.target;while(f&&f.parentNode&&!s(f)){if(f.tagName.toLowerCase()!="div"){f=f.parentNode;}else{break;
}}if(f&&(g.clientX<$(v).offset().left)&&s(f)&&!browser.mobile&&!clientVars.isDesktopApp){if(f.getAttribute("data-author-link")){window.open(f.getAttribute("data-author-link"),"_blank");
}g.preventDefault();return false;}function r(AB){return(AB.tagName||"").toLowerCase()=="a"&&AB.href;}var f=g.target;
while(f&&f.parentNode&&!r(f)){f=f.parentNode;}if(f&&r(f)){try{var w=!g.metaKey&&hasClass(f.parentNode,"internal");
var z=A.getObserver().triggerHandler("open-link",[f.href,w]);if(z===undefined){if(browser.mobile||w){window.top.location=f.href;
}else{var h=window.open("","_blank");if(h){h.opener=null;h.location=f.href;h.focus();}}}}catch(y){}g.preventDefault();
g.stopPropagation();return;}function x(AB){return(AB.tagName||"").toLowerCase()=="ul"&&AB.className.indexOf("list-task")>-1;
}f=g.target;while(f&&f.parentNode&&!x(f)){if(f.tagName.toLowerCase()=="li"){f=f.parentNode;}else{break;
}}var j=g.clientX||(g.originalEvent.changedTouches[0].pageX-g.target.offsetLeft);j-=$(g.target).children()[0]?$(g.target).children().offset().left:$(v).offset().left;
var AA=10;if(f&&(g.offsetX<0||j<(f.offsetLeft-AA))&&x(f)){if(f.className.indexOf("list-taskdone")>-1){f.className=f.className.replace("list-taskdone","list-task").replace("listtype-taskdone","listtype-task");
}else{if(f.className.indexOf("list-task")>-1){f.className=f.className.replace("list-task","list-taskdone").replace("listtype-task","listtype-taskdone");
}}g.preventDefault();g.stopPropagation();return;}function m(AB){return(AB.tagName||"").toLowerCase()=="ul"&&AB.className.indexOf("list-h")>-1;
}f=g.target;while(f&&f.parentNode&&!m(f)){if(f.tagName.toLowerCase()=="li"){f=f.parentNode;}else{break;
}}var l=clientVars.isDesktopApp?30:0;if(f&&(g.offsetX<0||j-20-l<f.offsetLeft)&&m(f)&&!browser.mobile){A.showHeadingsMenu(g);
g.preventDefault();return;}function p(AB){return(AB.tagName||"").toLowerCase()=="div"&&AB.className.indexOf("toc-entry")>-1;
}f=g.target;while(f&&f.parentNode&&!p(f)){if(f.tagName.toLowerCase()!="div"){f=f.parentNode;}else{break;
}}if(f&&(g.offsetX<57+l||j<57+l)&&p(f)&&!browser.mobile){A.showHeadingsMenu(g);g.preventDefault();return false;
}function o(AB){return(AB.tagName||"").toLowerCase()=="span"&&AB.className.indexOf("inline-tex")>-1;}f=g.target;
while(f&&f.parentNode&&!o(f)){f=f.parentNode;}if(f&&o(f)){f.parentNode.className=f.parentNode.className.replace("tex","");
f.parentNode.innerHTML=f.getAttribute("tex").replace(/\$\$$/,"$");}}function L(f){if(f.type=="compositionstart"){A.setInInternationalComposition(true);
}else{if(f.type=="compositionend"){A.setInInternationalComposition(false);}}}function P(){A.setIsScrolling(true);
window.clearTimeout(H);H=window.setTimeout(function(){A.getObserver().trigger("scroll-finished");A.setIsScrolling(false);
},100);}function O(f){A.restoreSelection();$("body").addClass("ace-focused");$("body").addClass("edit-mode");
if(!browser.msie){M();}if(clientVars.demoMode){A.getObserver().trigger("track",["demofocus"]);}}function T(f){setTimeout(function(){$("body").removeClass("ace-focused");
},33);if(!browser.msie){a();}if(browser.msie){A.setSelection(null);}}function a(){clearTimeout(J);I=setTimeout(function(){E=document.hidden||document.mozHidden||document.msHidden||document.webkitHidden;
if(!E){setClassPresence(X,"authorColors",false);}},100);}function M(){clearTimeout(I);J=setTimeout(function(){if(!E){}},100);
}return{captureClick:Z,handleIEOuterClick:U,handleMouseOut:K,handleTouchMove:V,handleTouchStart:S,onBlur:T,onClickMisc:Q,onCompositionEvent:L,onFocus:O,onScroll:P,processClick:N};
};ace.media=function(A){var C=A.getObserver();var B=null;function M(X,Y){imgshrink.maybeShrinkImage(X,function(b){var Z=document.baseURI+"ep/api/attach_local";
if(browser.msie||Z.indexOf("undefined")!=-1){Z=document.location.protocol+"//"+document.location.host+"/ep/api/attach_local";
}var a=location.hostname+"_"+pad.getPadId()+"_"+clientVars.userId+"_"+(+new Date())+"_"+X.name;var c=new FormData();
c.append("file",b);$.ajax({xhr:function(){var d=new window.XMLHttpRequest();d.upload.addEventListener("load",function(f){padeditbar.insertLoading(Y);
},false);return d;},url:Z,data:c,processData:false,contentType:false,headers:{"X-Xsrf-Protection":clientVars.xsrf},type:"POST",dataType:"json",success:function(f,h,g){var d=f.url;
setTimeout(function(){A.callWithAce(function(j){D(Y,d,a);});C.trigger("track",["file-attach",null,null,{success:true,padId:clientVars.padId,userId:clientVars.userId,type:X.type,path:a,size:X.size,uploadSize:b.size}]);
},500);}}).error(function(f,g,d){A.callWithAce(function(h){D(Y);});C.trigger("track",["file-attach",null,null,{success:false,padId:clientVars.padId,userId:clientVars.userId,type:X.type,path:a,size:X.size,request:f,textStatus:g,error:d}]);
});});}function E(X){while(X){X=X.childNodes[0];if(X&&X.tagName=="IMG"){return X;}}return null;}function H(Y){var a=Y.childNodes.length;
for(var X=0;X<a;X++){var Z=E(Y.childNodes[X]);if(Z){return Z;}}return null;}function L(Y){var a=Y.childNodes.length;
for(var X=a-1;X>=0;X--){var Z=E(Y.childNodes[X]);if(Z){return Z;}}return null;}function G(Y){var X="attachment-"+(+new Date());
A.inCallStackIfNecessary("dropImageData",function(){padeditbar.jugeIsInsertReturn("start");var a=A.getRep();
var c=a.selStart;var b=a.selEnd;if(!a.selStart||!a.selEnd){c=b=[0,0];}A.performDocumentReplaceRange(c,b,"*",[["img","/static/img/pixel.gif"],["attachmentPlaceholder",X]]);
padeditbar.jugeIsInsertReturn("end");});var Z=C.triggerHandler("attach",[Y,X]);if(Z===undefined){M(Y,X);
}}function O(){var X="attachment-"+(+new Date());A.inCallStackIfNecessary("dropImageData",function(){var Y=A.getRep();
var a=Y.selStart;var Z=Y.selEnd;if(!Y.selStart||!Y.selEnd){a=Z=[0,0];}A.performDocumentReplaceRange(a,Z,"*",[["img","/static/img/pixel.gif"],["attachmentPlaceholder",X]]);
padeditbar.jugeIsInsertReturn("end");});return X;}function F(d){$(".lightbox-container").remove();var X=$("<div>").addClass("lightbox-container");
$("body").append(X);var a=$('<button class="hp-ui-button dialog-cancel-x"><span class="hp-ui-button-content icon-x"></span></button>');
a.on("click",Z);function Z(){$(".lightbox-container").remove();$(document).off("keydown",b);}function Y(h){if(h){$("#lightbox-prev img").addClass("arrow-clicked");
}else{$("#lightbox-next img").addClass("arrow-clicked");}$(".lightbox-container img").bind("animationEnd oAnimationEnd mozAnimationEnd webkitAnimationEnd",function(){$(".lightbox-container img").removeClass("arrow-clicked");
});var g=U(h);if(g){$("#lightbox-img").hide(0);$("#lightbox-img").attr("src",g);return false;}return true;
}function b(j){var h=j.keyCode||j.which;var g={left:37,up:38,right:39,down:40};if(h==g.left||h==g.up){Y(true);
}else{if(h==g.down||h==g.right){Y();}}if(j.keyCode==27){Z();}return false;}$(document).keydown(b);var c=$("<div>").addClass("lightbox-inner").addClass("center-content").append($("<img id='lightbox-img'>").click(function(){return Y(false);
}).attr("src",d)).append(a);var f=$("<div>").addClass("center-wrap").append(c);X.append(f);X.append($("<button id='lightbox-next'><img src='/static/img/lightbox-right.png'/></button>").click(function(){return Y(false);
}));X.append($("<button id='lightbox-prev'><img src='/static/img/lightbox-left.png'/></button>").click(function(){return Y(true);
}));X.css("z-index",1000).click(Z);$("#lightbox-img").bind("load",function(){$(this).stop(true,true).fadeIn();
});event.preventDefault();}function U(Z){var X=B;while(X&&!(X.tagName&&X.tagName.toLowerCase()=="span"&&(hasClass(X,"attrimg")||hasClass(X,"attrembed")))){X=X.parentNode;
}do{X=(Z?X.previousSibling:X.nextSibling);}while(X&&!(X.tagName&&X.tagName.toLowerCase()=="span"&&hasClass(X,"attrimg")));
if(X){B=E(X);return B.src;}else{X=B;}while(X&&!(X.tagName&&X.tagName.toLowerCase()=="div"&&hasClass(X,"ace-line"))){X=X.parentNode;
}if(!X){return null;}var Y=Z?X.previousSibling:X.nextSibling;while(Y){var a=Z?L(Y):H(Y);if(a){B=a;return B.src;
}Y=Z?Y.previousSibling:Y.nextSibling;}}function Q(X){return;if(X.target.nodeName.toLowerCase()=="img"){if($(X.target).attr("contenteditable")=="false"){$(X.target).attr("contenteditable",true);
}if($(X.target).parent().attr("contenteditable")=="false"){$(X.target).parent().attr("contenteditable",true);
}}}function N(X){return;setTimeout(function(){if(X.target.nodeName.toLowerCase()=="img"){if($(X.target).attr("contenteditable")=="true"){$(X.target).attr("contenteditable",false);
}if($(X.target).parent().attr("contenteditable")=="true"){$(X.target).parent().attr("contenteditable",false);
}}},0);}function P(X){if($.getAgent.isAndroid()){if(X.type==="click"){return;}}var a=padeditor.ace.getIsEditable();
var Z=$.isMobilePhone();if(Z){I(X.target);}if(X.target.className=="inline-img"){if(a&&Z){return;}if(Z){if(UA_Util.MTIMLargerOrEqual("1.0.2")||UA_Util.MQQLargerOrEqual("6.7.0")){R(X.target.src);
}else{B=X.target;F(X.target.src);}}else{if(window.gEditable){I(X.target);pad_imageprocessor.onImageClick(X);
}}return;}if(X.target.className=="remove-media"){var b={node:X.target,index:0,maxIndex:0};var Y=A.getLineAndCharForPoint(b);
A.inCallStack("removeMedia",function(){A.performDocumentReplaceRange([Y[0],Y[1]-1],[Y[0],Y[1]],"");});
}}function I(X){var Y=null;while(X){if($(X).hasClass("inline-img")){Y=X;break;}X=X.firstChild;}if(Y){Y=Y.parentNode;
setTimeout(function(){$.setCursorPosition(Y,1);},50);}}function T(X){if(X&&X.dataTransfer&&X.dataTransfer.items&&X.dataTransfer.items.length&&X.dataTransfer.items[0].kind=="file"){X.preventDefault();
}if((browser.msie||browser.safari)&&X&&X.dataTransfer){X.preventDefault();}}function K(X){if(!X.dataTransfer){return;
}if(!X.dataTransfer.files.length){return;}X.preventDefault();X.stopPropagation();var a=false;for(var Y=0;
Y<X.dataTransfer.files.length;Y++){var Z=X.dataTransfer.files[Y];if(Z.type.indexOf("image/")==0){G(Z);
a=true;}}if(!a){alert("Sorry, only image attachments are supported!");}}function J(a){var Z=a.originalEvent.clipboardData;
if(!Z){return;}if(Z.getData){var f=false;var g=null;if(/text\/plain/.test(Z.types)){g=Z.getData("text/plain");
var n=Z.getData("text/html");}if(g){var m=g.split(/[\r|\n]+/);var Y=[];for(var X=0;X<m.length;X++){var d=m[X].split("\t");
if(d.length>1&&(Y.length==0||Y[0].length==d.length)){Y.push(d);}else{f=false;break;}if(Y[X][0]!=""){f=true;
}}if(f){a.stopPropagation();a.preventDefault();var l=[["table",true]];for(var X=0;X<Y.length;X++){for(var b=0;
b<Y[X].length;b++){l.push([X+":"+b,Y[X][b]]);}}A.inCallStackIfNecessary("insertPastedTable",function(){var j=A.getRep();
if(j.selStart[1]!=0||j.selStart[0]==0){A.performDocumentReplaceRange(j.selStart,j.selEnd,"\n",[]);}A.performDocumentReplaceRange(j.selStart,j.selEnd,"*",l);
if(j.selEnd[1]!=0){A.performDocumentReplaceRange(j.selStart,j.selEnd,"\n",[]);}});}return;}}var c=Z.items||[];
for(var X=0;X<c.length;X++){if(c[X].kind=="file"&&c[X].type.indexOf("image/")==0){var h=c[X].getAsFile();
if(h){a.stopPropagation();a.preventDefault();G(h);return;}}}}function D(Z,X,Y){A.inCallStackIfNecessary("nonundoable",function(){var d=A.getRep();
var h=d.apool.attribToNum[["attachmentPlaceholder",Z]];for(var a=0;a<d.alines.length;a++){var g=d.alines[a];
var f=Changeset.opIterator(g);var b=0;while(f.hasNext()){var c=f.next();Changeset.eachAttribNumber(c.attribs,function(j){if(j==h){if(X){A.performDocumentApplyAttributesToRange([a,b],[a,b+c.chars],[["img",X],["attachmentKey",Y],["attachmentPlaceholder",Y?null:Z]]);
}else{A.performDocumentReplaceRange([a,b],[a,b+c.chars],"");}}});b+=c.chars;}}});}function W(Y,X){A.getDynamicCSS().selectorStyle(".placeholder-"+Y).background="#3da440 linear-gradient(to right, #ccc 100%, #3da440 0%) no-repeat "+$(A.getRootSelector()+" .ace-line").width()*X+"px 0px";
}function S(){var Z=[];var Y=null;var X=A.getRep().lines.atIndex(0).lineNode;while(X){if(H(X)){Y=H(X);
while(Y){Z.push(Y.src);Y=V(Y);}}X=X.nextSibling;}return Z;}function V(Y){var X=Y;while(X&&!(X.tagName&&X.tagName.toLowerCase()=="span"&&(hasClass(X,"attrimg")||hasClass(X,"attrembed")))){X=X.parentNode;
}do{X=X.nextSibling;}while(X&&!(X.tagName&&X.tagName.toLowerCase()=="span"&&hasClass(X,"attrimg")));if(X){Y=E(X);
return Y;}else{return null;}}function R(a){var Y=S();var Z=0;for(var X=0;X<Y.length;X++){if(Y[X]===a){Z=X;
break;}}if(Y.length>0){var b={currentImageIndex:Z,imageList:Y};mqq.invoke("docx","getDocxImageIndex",b);
}}C.on("startzoom",function(){B=pad_imageprocessor.getCurrentDropImg();F(B.src);});C.on("set-attachment",function(a,Z,X,Y){D(Z,X,Y);
});return{insertImage:G,onClick:P,onDragOver:T,onDrop:K,onMouseDown:Q,onMouseUp:N,onPaste:J,zoom:F,setAttachmentUrl:D,insertpixelImage:O};
};embed={};embed.resizeTwitterEmbed=function(A){var C=false;var B=window.setInterval(function(){var D=$(A.contentDocument).find("iframe");
if(D.hasClass("twitter-tweet-rendered")&&D.height()){window.clearInterval(B);setTimeout(function(){$(A).height($(A.contentDocument).height());
if(window.onEmbedResize){window.onEmbedResize(A);}},1000);}},1000);};embed.resizeOembedScript=function(A){var C=false;
var B=window.setInterval(function(){var D;D=$(A.contentDocument).find("body > .gist");if(!D.length){D=$(A.contentDocument).find("body");
}if(D.height()){window.clearInterval(B);$(A).height(D.height()+25);if(window.onEmbedResize){window.onEmbedResize(A);
}}},1000);};embed.onEmbed=function(C,A){var B=580;if(padutils.getIsMobile()){B=Math.min(B,$(window).width()-65);
}$.get("/ep/api/embed",{url:C,maxwidth:B},function(D){if(!D){A();}else{if(D.html){if((D.provider_name=="CrunchBase"||D.provider_name=="Amazon")&&D.thumbnail_url){A('<img class="inline-img" src="'+D.thumbnail_url+'">');
return;}var E=$("<div/>").append(D.html);if(!padutils.getIsMobile()){E=E.append('<div class="remove-media"></div>');
}E.find("object").append('<param name="wmode" value="opaque"/>');E.find("embed").attr("wmode","opaque");
A(E.html());}else{if(D.type=="photo"&&D.url){A('<img class="inline-img" src="'+D.url+'"><div class="remove-media"></div>');
}else{if(D.type=="link"&&D.thumbnail_url){A('<img class="inline-img" src="'+D.thumbnail_url+'"><div class="remove-media"></div>');
}else{A();}}}}}).error(function(){A();});};ace.selection=function(A){var E="\u200b";var G={selStart:[],selEnd:[]};
var C=null;var B=A.getRoot();function M(){var X=window.getSelection();if(X&&X.type!="None"&&X.rangeCount!==0){var W=X.getRangeAt(0);
function a(b){while(b&&!(b.tagName&&b.tagName.toLowerCase()=="body")){b=b.parentNode;}return !!b;}function Z(h,g){if(!a(h)){return{node:B,index:0,maxIndex:1};
}var b=h;var f=b.childNodes.length;if(isNodeText(b)||(b.getAttribute&&b.getAttribute("faketext"))){return{node:b,index:g,maxIndex:(b.nodeValue).length};
}else{if(f==0){return{node:b,index:0,maxIndex:1};}else{if(g==f){var c=b.childNodes.item(f-1);var d=nodeMaxIndex(c);
return{node:c,index:d,maxIndex:d};}else{var c=b.childNodes.item(g);var d=nodeMaxIndex(c);return{node:c,index:0,maxIndex:d};
}}}}var Y={};if(!hasParent(W.startContainer,B)||!hasParent(W.endContainer,B)){return null;}Y.startPoint=Z(W.startContainer,W.startOffset);
Y.endPoint=Z(W.endContainer,W.endOffset);Y.focusAtStart=(((W.startContainer!=W.endContainer)||(W.startOffset!=W.endOffset))&&X.anchorNode&&(X.anchorNode==W.endContainer)&&(X.anchorOffset==W.endOffset));
C=Y;return Y;}else{return null;}}function Q(X){var W=X;while(isNodeText(W)&&W.wholeText){if(W.nodeValue!=W.wholeText){if(W.nextSibling){W=W.nextSibling;
}else{break;}}else{return W;}}return X;}function D(Z){function d(g){return{node:g.node,index:g.index,maxIndex:g.maxIndex};
}var b;function c(m){var g=d(m);if(b){function j(){while(g.node.childNodes.length>0){if(g.index==0){g.node=g.node.firstChild;
g.maxIndex=nodeMaxIndex(g.node);}else{if(g.index==g.maxIndex){g.node=g.node.lastChild;g.maxIndex=nodeMaxIndex(g.node);
g.index=g.maxIndex;}else{break;}}}}if(isNodeText(g.node)&&g.index==g.maxIndex){var h=g.node;while((!h.nextSibling)&&(h!=B)&&(h.parentNode!=B)&&h.parentNode!=null){h=h.parentNode;
}if(h.nextSibling&&(!((typeof h.nextSibling.tagName)=="string"&&h.nextSibling.tagName.toLowerCase()=="br"))&&(h!=g.node)&&(h!=B)&&(h.parentNode!=B)){if(h.nextSibling.firstChild&&typeof h.nextSibling.firstChild.tagName=="string"&&h.nextSibling.firstChild.tagName.toLowerCase()!="img"){g.node=h.nextSibling;
g.maxIndex=nodeMaxIndex(g.node);g.index=0;j();}}}if(!isNodeText(g.node)){j();}}if(isNodeText(g.node)){var l=Q(g.node);
return{container:l,offset:g.index};}else{return{container:g.node.parentNode,offset:childIndex(g.node)+g.index};
}}var X=window.getSelection?window.getSelection():document.getSelection();if(X&&Z){b=(Z.startPoint.node===Z.endPoint.node&&Z.startPoint.index===Z.endPoint.index);
var W=c(Z.startPoint);var Y=c(Z.endPoint);if((!b)&&Z.focusAtStart&&X.collapse&&X.extend){X.removeAllRanges();
X.collapse(Y.container,Y.offset);X.extend(W.container,W.offset);}else{if(Z&&X.rangeCount&&X.getRangeAt(0).startContainer===W.container&&X.getRangeAt(0).endContainer===Y.container&&X.getRangeAt(0).startOffset===W.offset&&X.getRangeAt(0).endOffset===Y.offset){return;
}if(W.container&&hasClass(W.container.parentNode,"emoji-glyph")){W.container=W.container.parentNode.parentNode;
Y.container=Y.container.parentNode.parentNode;}var a=document.createRange();try{a.setStart(W.container,W.offset);
}catch(f){W.offset=1;Y.offset=1;a.setStart(W.container,W.offset);}a.setEnd(Y.container,Y.offset);X.removeAllRanges();
X.addRange(a);}}}function J(){var W=A.getRep();var X=C&&C.startPoint?C.startPoint.node:null;if(X&&T(X)){C&&D(C);
}else{if(W.selStart){if(A.getLineHasMagicObject(W.selStart[0])){if(W.selStart[0]<W.lines.length()-1){W.selStart[0]=W.selStart[0]+1;
W.selEnd[0]=W.selStart[0];}}else{W.selStart[1]=W.selStart[1]+1;W.selEnd[1]=W.selStart[1];}if(W.selStart[0]>=W.lines.length()){W.selStart[0]=W.lines.length()-1;
W.selEnd[0]=W.selStart[0];}L();}}}function L(){var Y=A.getRep();var Z=Y.selStart,X=Y.selEnd;if(!(Z&&X)){D(null);
return;}if(B.ownerDocument.activeElement!=B){return;}var W={};var a=[Z[0],Z[1]];W.startPoint=H(a);var b=[X[0],X[1]];
W.endPoint=H(b);W.focusAtStart=!!Y.selFocusAtStart;D(W);A.getObserver().trigger("caret");}function V(f){var X=f.node;
var b=f.index;function Y(l){return l.offsetLeft;}function Z(l){return l.offsetLeft+l.offsetWidth;}if(!isNodeText(X)){if(b==0){return Y(X);
}else{return Z(X);}}else{var a=b;var d=X.nodeValue.length-b;var W;for(W=X.previousSibling;W&&isNodeText(W);
W=W.previousSibling){a+=W.nodeValue;}var c=(W?Z(W):Y(X.parentNode));for(W=X.nextSibling;W&&isNodeText(W);
W=W.nextSibling){d+=W.nodeValue;}var j=(W?Y(W):Z(X.parentNode));var g=(a/(a+d));var h=c+g*(j-c);return Math.round(h);
}}function F(Z,a){return;var W=Z.offsetTop+50;if(a){var Y=(window.screen&&window.screen.availHeight)||200;
W+=Y/2;}var X=A.getVisibleHeight();if(!X){X=$(window).height();if(padutils.getIsMobile()){X/=2;}}if(W<$("#padeditor").offset().top){$("html, body").animate({scrollTop:0},100);
}else{if(W>$(window).scrollTop()+X){$("html, body").animate({scrollTop:W-X},100);}else{if(W<$(window).scrollTop()){$("html, body").animate({scrollTop:W-13},100);
}}}}function S(){var W=A.getRep();if(!W.selStart){return;}var X=(W.selFocusAtStart?W.selStart[0]:W.selEnd[0]);
F(W.lines.atIndex(X).lineNode);}function T(W){if(browser.msie){return B.contains(W)&&W.constructor!=window.HTMLUnknownElement;
}else{return B.contains(W);}}function I(Y){var Z=A.getRep();if(Y.node==B){if(Y.index==0){return[0,0];
}else{var c=Z.lines.length();var g=Z.lines.atIndex(c-1);return[c-1,g.text.length];}}else{var W=Y.node;
var X=0;if(isNodeText(W)){X=Y.index;if(nodeText(W)[0]==E){X=Math.max(X-1,0);}}else{if(Y.index>0){X=nodeText(W).length;
}}var a,b;while((a=W.parentNode)!=B){if((b=W.previousSibling)){W=b;X+=nodeText(W).length;if(nodeText(W)[0]==E){X=Math.max(X-1,0);
}}else{W=a;}}if(W.id==""){console.log("BAD");}if(W.firstChild&&isBlockElement(W.firstChild)){X+=1;}else{if(typeof W.className=="string"&&W.className.indexOf("text-align-type-")!=-1){X+=1;
}}var d=Z.lines.atKey(W.id);var f=Z.lines.indexOfEntry(d);return[f,X];}}function H(j){var h=A.getRep();
var l=j[0];var X=j[1];var f=h.lines.atIndex(l);X-=f.lineMarker;if(X<0){X=0;}var Y=f.lineNode;var W=Y;
var Z=false;if(X==0){var c=0;if(browser.msie&&l==(h.lines.length()-1)&&Y.childNodes.length==0){c=1;}if(browser.msie&&Y.childNodes.length==0){c=1;
}return{node:Y,index:c,maxIndex:1};}while(!(W==Y&&Z)){if(Z){if(W.nextSibling){W=W.nextSibling;Z=false;
}else{W=W.parentNode;}}else{if(isNodeText(W)||(W.getAttribute&&W.getAttribute("faketext"))){var b=W.nodeValue;
var a=b?b.length:0;if(b&&b[0]==E){X+=1;}var g=(X<=a);if(X==a){var d=W.parentNode.nextSibling&&W.parentNode.nextSibling.firstChild;
if(d&&isNodeText(d)&&d.nodeValue[0]==E){g=false;}}if(g){return{node:W,index:X,maxIndex:a};}X-=a;Z=true;
}else{if(W.firstChild){W=W.firstChild;}else{Z=true;}}}}return{node:Y,index:1,maxIndex:1};}function N(b,a,c){return;
var X=A.getRep();if(!(X.selStart&&X.selEnd)){return;}var W=$("#hp-editor-selection-wrapper");if(b&&!a){var Z=$(B).offset();
if(W.is(":visible")&&G.selStart.join(",")==X.selStart.join(",")&&G.selEnd.join(",")==X.selEnd.join(",")){return;
}W.removeClass("link-mode").removeClass("link-hover-mode").removeClass("newpad-mode");var Y=O();W.css({top:Y.y+(Y.height/2)+20-Z.top+$(window).scrollTop(),left:Y.x+(Y.width/2)-W.width()/2-Z.left-4});
G={selStart:X.selStart.slice(0),selEnd:X.selEnd.slice(0)};if(W.is(":visible")){return;}window.setTimeout(function(){W.addClass("hp-editor-selection-shown");
},0);}else{W.removeClass("hp-editor-selection-shown");if($("body").hasClass("ace-focused")){W.removeClass("link-mode").removeClass("newpad-mode");
}}}function O(){var Y=document.selection,W;var a=0,c=0;var b=0,Z=0;if(Y){if(Y.type!="Control"){W=Y.createRange();
a=W.boundingLeft;c=W.boundingTop;b=W.boundingWidth;Z=W.boundingHeight;}}else{if(window.getSelection){Y=window.getSelection();
if(Y.rangeCount){W=Y.getRangeAt(0).cloneRange();if(W.getBoundingClientRect){var X=W.getBoundingClientRect();
a=X.left;c=X.top;b=X.right-X.left;Z=X.bottom-X.top;}}}}return{x:a,y:c,width:b,height:Z};}function K(X){var Z={node:X,index:0,maxIndex:0};
var W=I(Z);var Y=[W[0],W[1]+$(X).text().length];return{ss:W,se:Y};}function R(){return;var X;var W=$("#hp-editor-selection-wrapper");
padutils.tooltip("#hp-editor-selection-link, #hp-editor-selection-newpad");W.off(".hp-editor-selection").on("click.hp-editor-selection",function(){if(!W.hasClass("link-mode")&&!W.hasClass("link-hover-mode")&&!W.hasClass("newpad-mode")){J();
}return false;}).on("mouseover.hp-editor-selection",function(){window.clearTimeout(X);}).on("mouseout",function(){if(W.hasClass("link-hover-mode")){X=window.setTimeout(function(){if(!$("#hp-editor-selection-link-url").is(":focus")){W.removeClass("link-hover-mode");
}},500);}});$("#hp-editor-selection-link").off(".hp-editor-selection").on("click.hp-editor-selection",function(b){W.addClass("link-mode");
$("#tooltip").remove();$("#hp-editor-selection-link-url").val("");setTimeout(function(){$("#hp-editor-selection-link-url").focus();
},100);A.getObserver().trigger("track",["createLinkStart"]);return false;});var a=function(){var d=A.getRep();
if(W.hasClass("link-hover-mode")){var f=K($("#hp-editor-selection-link-url").data("link-hover-target"));
A.inCallStack("linkHover",function(){A.performSelectionChange(f.ss,f.se);});}var b=$("#hp-editor-selection-link-url").val();
if(!b){return false;}if(!padutils.isWhitelistUrlScheme(b)){b=window.location.protocol+"//"+b;}var c=window.location.protocol+"//"+window.location.host;
if(b.indexOf(c)==0){b=b.substring(c.length);if(b[0]!="/"){b="/"+b;}}var g=A.createChangesetFromRange(d.selStart,d.selEnd);
U(g.atext.text.replace("\n",""),b);W.removeClass("link-mode");W.removeClass("link-hover-mode");A.getObserver().trigger("track",["createLinkDone",null,null,{url:b}]);
return false;};$("#hp-editor-selection-link-confirm").off(".hp-editor-selection").on("click.hp-editor-selection",function(b){a();
});$("#hp-editor-selection-link-url").off(".hp-editor-selection").on("keydown.hp-editor-selection",function(b){if(b.keyCode==13){a();
}}).on("blur.hp-editor-selection",function(){window.setTimeout(function(){W.removeClass("link-hover-mode");
},100);});$("#hp-editor-selection-link-delete").off(".hp-editor-selection").on("click.hp-editor-selection",function(c){var b=K($("#hp-editor-selection-link-url").data("link-hover-target"));
A.inCallStack("linkHover",function(){A.performDocumentApplyAttributesToRange(b.ss,b.se,[["link",""]]);
});W.removeClass("link-hover-mode");});var Z=function(b){var b=b||$("#hp-editor-selection-newpad-title").val();
if(!b){return;}var c=A.getRep();A.getObserver().trigger("track",["popup-pagecreate"]);var d=A.createChangesetFromRange(c.selStart,c.selEnd);
A.getObserver().trigger("create-page",[d.atext,d.apool.toJsonable(),b]);W.removeClass("newpad-mode");
};$("#hp-editor-selection-newpad").off(".hp-editor-selection").on("click.hp-editor-selection",function(g){W.addClass("newpad-mode");
$("#tooltip").remove();var c=A.getRep();var f=A.createChangesetFromRange(c.selStart,c.selEnd);var b=f.atext.text;
var d=b.split("\n").length==1||(b.split("\n").length==2&&b.split("\n")[1]=="");if(d){$("#hp-editor-selection-newpad-title").val(b.replace("\n",""));
setTimeout(function(){$("#hp-editor-selection-newpad-title").focus();},100);}else{$("#hp-editor-selection-newpad-title").val("");
setTimeout(function(){$("#hp-editor-selection-newpad-title").focus();},100);}return false;});$("#hp-editor-selection-newpad-confirm").off(".hp-editor-selection").on("click.hp-editor-selection",function(b){Z();
});$("#hp-editor-selection-newpad-title").off(".hp-editor-selection").on("keydown.hp-editor-selection",function(b){if(b.keyCode==13){Z();
}});var Y;$(document).on("mouseover",".ace-line .attrlink a",function(b){Y=window.setTimeout(function(){if((W.is(":visible")&&!W.hasClass("link-hover-mode"))||W.hasClass("link-mode")||W.hasClass("newpad-mode")){return;
}window.clearTimeout(X);var d=$(B).offset();W.addClass("link-hover-mode");W.css({top:$(b.currentTarget).offset().top+$(b.currentTarget).height()+10-d.top,left:$(b.currentTarget).offset().left+($(b.currentTarget).width()/2)-W.outerWidth(true)/2-((W.outerWidth(true)-W.outerWidth())/2)-d.left-4});
var c=$(b.currentTarget).attr("href");if(c.charAt(0)=="/"){c=window.location.protocol+"//"+window.location.host+c;
}$("#hp-editor-selection-link-url").val(c).data("link-hover-target",b.currentTarget);if(W.is(":visible")){return;
}window.setTimeout(function(){W.addClass("hp-editor-selection-shown");},0);},500);});$(document).on("mouseout",".ace-line .attrlink a",function(b){window.clearTimeout(Y);
X=window.setTimeout(function(){if(!$("#hp-editor-selection-link-url").is(":focus")){W.removeClass("link-hover-mode");
}},500);});}function U(W,Y){var X=A.getRep();if(!(X.selStart&&X.selEnd)){return;}A.inCallStack("linkinsert",function(){A.fastIncorp();
var a=A.getRep();var Z=a.selStart;var c=[Z[0],Z[1]+W.length];A.replaceRange(a.selStart,a.selEnd,W);A.performDocumentApplyAttributesToRange(Z,c,[["link",Y]]);
if($.browser.mozilla){var b=[Z[0],Z[1]+W.length];A.replaceRange(b,b," ");}});}function P(W){window.focus();
B.focus();if(W){var X=null;if(W.split("h=")[1]){X=_trim(W.split("h=")[1]);}A.inCallStackIfNecessary("gotoline",function(){A.fastIncorp();
var Z=A.getRep();var b=0;for(var Y=0;Y<Z.lines.length();Y++){var a=Z.lines.atIndex(Y);var c=_trim(a.text.substring(a.lineMarker));
if(_hashCode(c)===parseInt(W)){W=Y+1;break;}if(X&&X==c.substring(0,X.length).replace(/ /g,"-")){W=Y+1;
break;}}if(W<Z.lines.length()){A.performSelectionChange([W-1,b],[W-1,b]);F(Z.lines.atIndex(W).lineNode,true);
}});}}return{focus:P,getLineAndCharForPoint:I,getSelection:M,restoreSelection:J,scrollNodeVerticallyIntoView:F,scrollSelectionIntoView:S,setSelection:D,setupSelectionToolbar:R,updateBrowserSelectionFromRep:L,updateToolbarIfNecessary:N};
};var SelectionState=function(){var E={registerSelectionStateListeners:B,registerSelectionState:I,isCaret:true};
function B(){$(window).bind("mouseup",function(K){var J=K.target;while(J&&J!=document.body){if(J.classList&&J.classList.contains("dropdown-wrapper")){return;
}else{J=J.parentNode;}}setTimeout(function(){A();},0);});$(window).bind("getselectionstate",function(){setTimeout(function(){A();
},0);});$(window).on("touchend",function(){setTimeout(function(){A();},0);});$(window).on("keyup",function(J){if(J.ctrlKey||J.keyCode==8||J.keyCode==37||J.keyCode==38||J.keyCode==39||J.keyCode==40){setTimeout(function(){A();
},0);}});pad_compatible.padDispatchEvent(window,"SelectionStateInitFinished");}function A(){var J=G();
if(!J){return null;}var L=H(J);var K=document.createEvent("CustomEvent");K.initCustomEvent("AfterSelectionState",true,true,{state:L});
$(window).trigger(K);}function F(J){E.isCaret=J.collapsed;}function G(){return T();function T(){if(window.getSelection){var c=window.getSelection();
try{var a=c.getRangeAt(0);}catch(b){console.log(b);return null;}F(a);if(!$(a.startContainer).is("#editor")&&!$(a.startContainer).parents("#editor").length){return null;
}return{words:U(a),lines:V(a)};}}function U(a){var b=J(a.startContainer);var c=J(a.endContainer);if(!c){do{if(!b&&L(a.startContainer)&&L(a.endContainer)){if(a.startContainer==a.endContainer){b=K(a.startContainer);
break;}else{if(a.endOffset==0&&a.startOffset==0){b=K(a.startContainer);break;}}}if(!b){b=K($("#editor").children()[a.startOffset]);
break;}}while(0);c=S(b);}else{if(!b&&c){var g=N(c);b=K(g);}else{if(a.endOffset==0&&a.startOffset==0&&a.startContainer==a.endContainer){var f=X(b);
if(f){b=c=f;}}else{if(a.startContainer!=a.endContainer&&a.startContainer.length==a.startOffset){b=P(J(a.startContainer));
}}}}var d=[];if(b){d.push(b);}while(b&&b!=c){b=P(b);if(b){d.push(b);}}return d;}function V(c){var a=N(c.startContainer);
var b=N(c.endContainer);if(c.endOffset==0&&c.startOffset==0&&a&&b&&a!=b){if(b&&b.previousSibling){b=b.previousSibling;
}}else{if(!a&&!b){var f=c.startOffset>0?(c.startOffset-1):0;b=a=Z($("#editor").children()[f]);}}var d=[];
if(a){d.push(a);}else{if(b){d.push(b);}}while(a&&a!=b){a=Q(a);if(a){d.push(a);}}return d;}function P(b){var c=J(b);
if(c){var a=c.nextSibling;while(a&&!M(a)){a=a.nextSibling;}if(a){return a;}else{return K(Q(b));}}return null;
}function Q(c){var b=N(c);if(b){var a=b.nextSibling;if(a&&L(a)){return a;}}return null;}function K(a){while(a&&!M(a)){a=a.firstChild;
}return a;}function Z(a){while(a&&!L(a)){a=a.firstChild;}return a;}function S(c){if(c){var b=c;var a=c.nextSibling;
while(a&&M(a)){b=a;a=b.nextSibling;}return b;}}function X(c){var a=J(c);if(!a){return null;}var b=a.previousSibling;
return J(b);}function N(a){return O(a,L);}function J(a){return O(a,M);}function L(a){return R(a)&&(a.id&&a.id.indexOf("magicdomid")!=-1);
}function R(a){return((a.nodeName).toLowerCase()=="div");}function M(a){return W(a)||Y(a);}function W(a){return((a.nodeName).toLowerCase()=="span");
}function Y(a){return((a.nodeName).toLowerCase()=="br");}function O(a,b){if(!a){return null;}if(b(a)){return a;
}else{while(!b(a.parentNode)){a=a.parentNode;if(a==document.body){return null;}}return a.parentNode;}}}var C=[];
var D=[];function H(J){if(!J){return null;}return R(J);function R(T){var U=Q(T.lines);var V=S(T.words);
return U.concat(V);}function Q(U){if(U&&U.length){var T=null;for(var X=0;X<U.length;X++){var Z=N(U[X]);
if(T==null){T=Z;}else{var V=[];for(var W=0;W<T.length;W++){var Y=T[W];if(Z.contains(Y)){V.push(Y);}}if(V){T=V;
}else{return[];}}}return T;}return L(null,null);}function S(U){if(!U||!U.length){return K(null,null);
}var T=null;for(var W=0;W<U.length;W++){var Z=P(U[W]);if(T==null){T=Z;}else{var V=[];for(var X=0;X<T.length;
X++){var Y=T[X];if(Z.contains(Y)){V.push(Y);}}if(V){T=V;}else{return[];}}}return T?T:[];}function N(T){if(!T){return[];
}return L(T,T.classList);}function P(T){if(!T){return[];}return K(T,T.classList);}function O(W,T){if(!W||!T){return false;
}var V=false;if(typeof T=="object"){if(T instanceof Array){for(var U=0;U<T.length;U++){if(typeof T[U]=="string"){if(W.contains(T[U])){V=T[U];
break;}}else{if(T[U]&&T[U] instanceof Array){var Y=true;for(var X=0;X<T[U].length;X++){if(!W.contains(X[U])){Y=false;
break;}}if(Y){V=Y;break;}}}}}}else{if(typeof T=="string"){V=W.contains(T);if(V){V=T;}}}return V;}function L(T,U){return M(D,T,U);
}function K(T,U){return M(C,T,U);}function M(U,Z,Y){var V=[];var X=null;for(var T=0;T<U.length;T++){if(typeof U[T]["judge"]=="function"){var W=U[T]["judge"](Z,Y);
if(W==true){typeof U[T]["key"]=="string"&&V.push(U[T]["key"]);}else{if(typeof W=="string"){V.push(W);
}}}else{if(U[T]["classes"]&&(X=O(Y,U[T]["classes"]))){typeof U[T]["key"]=="string"&&V.push([U[T]["key"],X].join("&"));
}}}return V;}}function I(K){if(typeof K.type=="string"){var J=null;if(K.type=="word"){J=C;}else{if(K.type=="line"){J=D;
}}if(J){J.push(K);}}}B();return E;};if(typeof selectionState=="undefined"){var selectionState=null;}if(!$("#padbody").find(".sheet-style").length){selectionState=new SelectionState();
}var SheetSelectionState=function(){var I={registerSelectionStateListeners:B,registerSelectionState:J};
function B(){if(window.frames.sheet){K();}else{$(top).bind("SheetDocumentLoadFinished",function(){K();
});}function K(){$(window.frames.sheet).bind("mouseup",function(L){setTimeout(function(){A();},0);});
$(window).bind("mouseup",function(L){setTimeout(function(){A();},0);});$(window.frames.sheet).bind("getselectionstate",function(){setTimeout(function(){A();
},0);});$(window.frames.sheet).bind("keyup",function(L){if([37,38,39,40].contains(L.keyCode)){setTimeout(function(){A();
},0);}});$(window).bind("getselectionstate",function(){setTimeout(function(){A();},0);});pad_compatible.padDispatchEvent(window,"SelectionStateInitFinished");
}}function A(){var K=E();if(!K||!K.length){return null;}var M=G(K);var L=document.createEvent("CustomEvent");
L.initCustomEvent("AfterSelectionState",true,true,{state:M});$(window).trigger(L);}function E(){return $("td.current",window.frames.sheet.document)||null;
}var C=[];function G(L){if(!L||!L.length){return[];}var K=null;for(var N=0;N<L.length;N++){var Q=D(L[N]);
if(K==null){K=Q;}else{var M=[];for(var O=0;O<K.length;O++){var P=K[O];if(Q.contains(P)){M.push(P);}}if(M){K=M;
}else{return[];}}}return K?K:[];}function D(K){if(!K){return[];}return H(K);}function H(K){return F(C,K);
}function F(L,O){var M=[];for(var K=0;K<L.length;K++){if(typeof L[K]["judge"]=="function"){var N=L[K]["judge"](O);
if(N==true){typeof L[K]["key"]=="string"&&M.push(L[K]["key"]);}else{if(typeof N=="string"){M.push(N);
}}}}return M;}function J(K){if(typeof K.judge=="function"){C.push(K);}}B();return I;};$(window).on("resize",function(){});
if(typeof selectionState=="undefined"){var selectionState=null;}if(!clientVars.isMobile&&$("#padbody").find(".sheet-style").length){selectionState=new SheetSelectionState();
}ace.lists=function(A){var L=8;var P=A.getRoot();function B(W){var V=A.getRep();var U=V.alines[W];if(U){var T=Changeset.opIterator(U);
if(T.hasNext()){return Changeset.opAttributeValue(T.next(),"list",V.apool)||"";}}return"";}function J(X){var T=A.getRep();
var W=T.alines[X];if(W){var V=Changeset.opIterator(W);if(V.hasNext()){var U=V.next();return(Changeset.opAttributeValue(U,"table",T.apool)||Changeset.opAttributeValue(U,"embed",T.apool)||Changeset.opAttributeValue(U,"img",T.apool)||Changeset.opAttributeValue(U,"splitline",T.apool))||false;
}}return"";}function F(W){var V=A.getRep();var U=V.alines[W];if(U){var T=Changeset.opIterator(U);if(T.hasNext()){return Changeset.opAttributeValue(T.next(),"start",V.apool)||"";
}}return"";}function S(Z,f){var V=A.getRep();if(!(V.selStart&&V.selEnd)){return false;}var a,c;a=V.selStart[0];
c=Math.max(a,V.selEnd[0]-((V.selEnd[1]==0)?1:0));var W=[];var X=false;for(var T=a;T<=c;T++){var U=B(T);
if(U){U=/([a-z]+)([12345678])/.exec(U);if(U){X=true;var d=U[1];var Y=Number(U[2]);if((d=="indent"||f)&&Y==1&&Z){W.push([T,null]);
}else{var b=Math.max(1,Math.min(L,Y+(Z?-1:1)));if(Y!=b){W.push([T,d+b]);}}}}else{if(!Z){W.push([T,"indent1"]);
X=true;}}}if(W.length>0){D(W);}return X;}function H(U,Z){var Y=A.getRep();var T=B(U);if(!T){return null;
}T=/([a-z]+)[12345678]/.exec(T);if(!T||T[1]!="number"){return null;}if(Z){var a=F(U);if(a){return;}}while(U-1>=0&&(T=B(U-1))){T=/([a-z]+)([12345678])/.exec(T);
curLevel=Number(T[2]);if(!T){break;}U--;}var V=Changeset.builder(Y.lines.totalWidth());loc=[0,0];function X(b,f){var g=1;
var d=f;var c;while(c=B(b)){c=/([a-z]+)([12345678])/.exec(c);d=Number(c[2]);if(isNaN(d)){return b;}else{if(c[1]!="number"){b++;
}else{if(d==f){var h=F(b);A.buildKeepRange(V,loc,(loc=[b,0]));if(h!=g){A.buildKeepRange(V,loc,(loc=[b,1]),[["start",g]],Y.apool);
}else{A.buildKeepRange(V,loc,(loc=[b,1]));}g++;b++;}else{if(d<f){return b;}else{b=X(b,f+1);}}}}}return b;
}X(U,1);var W=V.toString();if(!Changeset.isIdentity(W)){A.performDocumentApplyChangeset(W);}}function G(V,U,T){D([[V,U]],T);
}function D(c,d){var Y=A.getRep();var U=[0,0];var W=Changeset.builder(Y.lines.totalWidth());for(var X=0;
X<c.length;X++){var Z=c[X];var T=Z[0];var V=Z[1];var b=A.getLineTextAlignType(T);A.buildKeepRange(W,U,(U=[T,0]));
if(J(T)){}else{if(B(T)){var f=V&&V.indexOf("indent")==0&&B(T).indexOf("indent")==-1;if(V&&!f){A.buildKeepRange(W,U,(U=[T,1]),[["list",V]],Y.apool);
}else{A.buildRemoveRange(W,U,(U=[T,1]));}}else{if(V){W.insert("*",[["author",A.getThisAuthor()],["insertorder","first"],["list",V],(b?["textalign",b]:[])],Y.apool);
}}}}var a=W.toString();if(!Changeset.isIdentity(a)){A.performDocumentApplyChangeset(a);}if(!d){if(H(T+1)==null){H(T);
}}}function R(){E("bullet");}function Q(){E("number");}function M(){E("code");}function O(){E("comment");
}function E(Y){var U=A.getRep();if(!(U.selStart&&U.selEnd)){return;}var V,X;V=U.selStart[0];X=Math.max(V,U.selEnd[0]-((U.selEnd[1]<=U.lines.atIndex(U.selEnd[0]).lineMarker)?1:0));
var a=true;for(var T=V;T<=X;T++){if(B(T).indexOf(Y)<0){a=false;break;}}var b=[];for(var T=V;T<=X;T++){var c=B(T);
var W=1;var Z=/[a-z]+([12345678])/.exec(c);if(Z){W=Number(Z[1]);}b.push([T,a?"indent"+W:Y+W]);}D(b);}function K(){var U=A.getRep();
if(!(U.selStart&&U.selEnd)){return;}var V,X;V=U.selStart[0];X=Math.max(V,U.selEnd[0]-((U.selEnd[1]<=U.lines.atIndex(U.selEnd[0]).lineMarker)?1:0));
var a=true;for(var T=V;T<=X;T++){if(B(T).indexOf("task")<0){a=false;break;}}var b=[];for(var T=V;T<=X;
T++){if(U.lines.atIndex(T).text.length==0&&X>V){continue;}var Z="task";var Y=1;var W=/([a-z]+)([12345678])/.exec(B(T));
if(W){Z=W[1].indexOf("task")>-1?W[1]:Z;Y=Number(W[2]);}b.push([T,a?"indent"+Y:Z+Y]);}D(b);}function I(T){return"#:h="+T.substring(0,30).replace(/ /g,"-");
}function C(T){A.inCallStackIfNecessary("headingChange",function(){var U=A.caretLine();var Y=B(U);var X=1;
var W=/[a-z]+([12345678])/.exec(Y);if(W){X=Number(W[1]);}var V={"1":"hone","2":"indent","3":"hthree","0":"indent"}[T];
if(V=="indent"){G(U,"");}else{G(U,V+X);}if(T==0){A.setAttributeOnLine(U,"bold",false);}else{if(T==2){A.setAttributeOnLine(U,"bold",true);
}}A.getObserver().trigger("track",["heading-menu-action","change-heading",T]);});}function N(U){if(clientVars.isMobile){return;
}function T(){$("#hp-editor-headings").hide();P.focus();}$("#hp-editor-headings").off(".hp-headings").on("menu-closed.hp-headings",function(){$("#hp-editor-headings").hide();
});$("#hp-editor-headings-1").off(".hp-headings").on("click.hp-headings",function(){C(1);T();return false;
});$("#hp-editor-headings-2").off(".hp-headings").on("click.hp-headings",function(){C(2);T();return false;
});$("#hp-editor-headings-3").off(".hp-headings").on("click.hp-headings",function(){C(3);T();return false;
});$("#hp-editor-headings-normal").off(".hp-headings").on("click.hp-headings",function(){C(0);T();return false;
});$("#hp-editor-headings-link").off(".hp-headings").on("click.hp-headings",function(){var Y=A.getRep();
var V=Y.lines.atIndex(A.caretLine());var W=_trim(V.text.substring(V.lineMarker));var Z=_hashCode(W);var X=window.top.location.href.split("#")[0];
A.getObserver().trigger("track",["heading-menu-action","get link"]);prompt("Copy this link to your clipboard",X+I(W));
T();return false;});showContextMenu(U,"headings-menu",$("#hp-editor-headings"));}return{doInsertCodeList:M,doInsertComment:O,doInsertOrderedList:Q,doIndentOutdent:S,doInsertTaskList:K,doInsertUnorderedList:R,doSetHeadingLevel:C,getLineHasMagicObject:J,getLineListType:B,getLineListPosition:F,locationFragmentForHeading:I,renumberList:H,setLineListType:G,showHeadingsMenu:N};
};ace.textalign=function(A){var G=A.getRoot();function B(K){var J=A.getRep();var I=J.alines[K];if(I){var H=Changeset.opIterator(I);
if(H.hasNext()){return Changeset.opAttributeValue(H.next(),"textalign",J.apool)||"";}}}function E(I,H){C([[I,H]]);
}function C(Q){var M=A.getRep();var I=[0,0];var J=Changeset.builder(M.lines.totalWidth());for(var L=0;
L<Q.length;L++){var N=Q[L];var H=N[0];var K=N[1];var P=A.getLineListType(H);var R=A.getLineListPosition(H);
var S=B(H);A.buildKeepRange(J,I,(I=[H,0]));if(S&&K){A.buildKeepRange(J,I,(I=[H,1]),[["textalign",K]],M.apool);
}else{if(K){J.insert("*",[["author",A.getThisAuthor()],(P?["list",P]:[]),["start",R],["textalign",K]],M.apool);
}else{if(!K){A.buildRemoveRange(J,I,(I=[H,1]));}}}}var O=J.toString();if(!Changeset.isIdentity(O)){A.performDocumentApplyChangeset(O);
}}function D(M){var H=A.getRep();if(!(H.selStart&&H.selEnd)){return;}var J,K;J=H.selStart[0];K=Math.max(J,H.selEnd[0]-((H.selEnd[1]<=H.lines.atIndex(H.selEnd[0]).lineMarker)?1:0));
var L={};for(var I=J;I<=K;I++){if(B(I).indexOf(M)<0){L[String(I)]=M;}}return L;}function F(M){var K=D(M);
var L=Object.getOwnPropertyNames(K);var I=[];for(var H=0;H<L.length;H++){var J=L[H];I.push([Number(J),K[J]]);
}if(I.length>0){C(I);}}return{doTextAlign:F,getLineTextAlignType:B,setLineTextAlignType:E,setLineTextAlignTypes:C};
};ace.attr=function(B){var I=B.getRoot();var A=B.getRep();function F(N){var L=[];var K=A.alines[N];if(K){var J=Changeset.opIterator(K);
while(J.hasNext()){var O=J.next();var M=D(O);L.push(M);}C(L);}}function D(K){var J=$.extend(true,{},K);
return J;}function C(J){if(J.length>=2){Changeset.eachAttribNumber(J[J.length-2].attribs,function(K){padeditor.ace.callWithAce(function(L){padeditor.ace.focus();
B.fastIncorp();B.toggleAttributeOnSelection(A.apool.getAttribKey(K),A.apool.getAttribValue(K));},A.apool.getAttribKey(K),true);
});}}function E(M,O,N){var J=[0,0];var K=Changeset.builder(A.lines.totalWidth());B.buildKeepRange(K,J,(J=[M,0]));
B.buildKeepRange(K,J,(J=[M,1]),[["list",O],["lineFontSize",N]],A.apool);var L=K.toString();if(!Changeset.isIdentity(L)){B.performDocumentApplyChangeset(L);
}}function G(L){var J=B.getLineListType(A.selStart[0]);if(J){var K=A.lines.atIndex(A.selStart[0]).text.replace(/[*]/g,"");
var M=A.lines.atIndex(A.selStart[0]).text.substring(A.selStart[1],A.selEnd[1]);if(K==M){E(A.selStart[0],J,L);
}}return"";}function H(J,M){if(J&&J>0&&M){var N=A.lines.atIndex(J).lineNode.className;var O=new RegExp("line-fontsize-[0-9]+..","g");
var K=O.exec(N);if(K&&K[0]){var L=(/[0-9]+../g).exec(K[0]);L&&L[0]&&E(J+1,M,L[0]);}}}return{getLastNodeAttrs:F,setNextLineAttrs:C,setLineFontSize:G,setNextLineFontSize:H,deepCopy:D,};
};ace.format=function(A){var R=A.getRoot();var H=A.getRep();var E=null;var D=null;var C=false;var B=[];
var F={bold:"",italic:"",underline:"",strikethrough:"",superscript:"",subscript:"",color:"#000000",};
F["font-family"]="Microsoft YaHei";F["font-size"]="12pt";F["background-color"]="#ffffff";function J(S){return S.tagName;
}function K(S){return(S.nodeType==3);}function I(S,T){return S.getAttribute&&S.getAttribute(T);}function M(){B=[];
}function L(){return C;}function O(Z){var V=[];var Y=[];var T=Z.split(";");for(var S=0;S<=T.length-1;
S++){if(T[S]&&T[S]!=""){var U=T[S].split(":");if(U&&U[0]&&U[1]&&U[0]!=""&&U[1]!=""){var X=[];if((/font-weight/i.exec(T[S]))||(/font-style/i.exec(T[S]))||(/underline/i.exec(T[S]))||(/line-through/i.exec(T[S]))||/\bsub\b/i.exec(T[S])||/\bsuper\b/i.exec(T[S])){if((/font-weight/i.exec(T[S]))){B.push(["bold",true]);
}if(/font-style/i.exec(T[S])){B.push(["italic",true]);}if(/underline/i.exec(T[S])){B.push(["underline",true]);
}if(/line-through/i.exec(T[S])){B.push(["strikethrough",true]);}if(/\bsub\b/i.exec(T[S])){B.push(["subscript",true]);
}if(/\bsuper\b/i.exec(T[S])){B.push(["superscript",true]);}}else{if(docContentAttr[U[0].trim()]){X.push(U[0].trim());
X.push(U[1].trim());B.push(X);}}}}}for(var W in F){if(W){V.push(W);}}for(var S in B){B[S][0]&&Y.push(B[S][0]);
}for(var W in V){if(!Y.contains(V[W])){B.push([V[W],F[V[W]]]);}}}function N(){var T=G();if(C){C=false;
toolbarController&&toolbarController.toolbarbuttons&&toolbarController.toolbarbuttons.formatpainterbutton&&toolbarController.toolbarbuttons.formatpainterbutton.uncheck();
return;}if(T){if(T.collapsed){var S=T.endContainer;while(K(S)){S=S.parentNode;}if(S&&(J(S)=="SPAN")){if((T.endOffset==T.endContainer.length)&&S.nextSibling&&(J(S.nextSibling)=="SPAN")){E=S.nextSibling;
D=I(E,"style");if(D){C=true;}}else{E=S;D=I(E,"style");if(D){C=true;}}}}else{if(T.startContainer&&T.startContainer.nodeValue&&T.startContainer.nodeValue.length==T.startOffset){var S=T.endContainer;
}else{var S=T.startContainer;}while(K(S)){S=S.parentNode;}if(S&&(J(S)=="SPAN")){E=S;D=I(E,"style");if(D){C=true;
}}}}toolbarController&&toolbarController.toolbarbuttons&&toolbarController.toolbarbuttons.formatpainterbutton&&toolbarController.toolbarbuttons.formatpainterbutton.check();
}function Q(){var S=G();if(S&&S.collapsed){}else{A.toggleAttributeOnSelection("bold","");A.toggleAttributeOnSelection("italic","");
A.toggleAttributeOnSelection("underline","");A.toggleAttributeOnSelection("strikethrough","");A.toggleAttributeOnSelection("subscript","");
A.toggleAttributeOnSelection("superscript","");A.toggleAttributeOnSelection("font-family","Microsoft YaHei");
A.toggleAttributeOnSelection("font-size","12pt");A.toggleAttributeOnSelection("color","#000000");A.toggleAttributeOnSelection("background-color","#ffffff");
}}function P(X){var W=G();if(C){if(W&&W.collapsed){}else{if(B){var U=A.getSelection();var T,S;if(!U){C=false;
toolbarController&&toolbarController.toolbarbuttons&&toolbarController.toolbarbuttons.formatpainterbutton&&toolbarController.toolbarbuttons.formatpainterbutton.uncheck();
return;}if(U&&!T){T=A.getLineAndCharForPoint(U.startPoint);}if(U&&!S){S=A.getLineAndCharForPoint(U.endPoint);
}var V=H.lines.length();if(T&&T[0]>=V){T[0]=V-1;T[1]=H.lines.atIndex(T[0]).text.length;}if(S&&S[0]>=V){S[0]=V-1;
S[1]=H.lines.atIndex(S[0]).text.length;}O(D);A.inCallStack("setNodeFormat",function(){A.fastIncorp();
A.performDocumentApplyAttributesToRange(T,S,B);A.updateBrowserSelectionFromRep();M();});}}}C=false;toolbarController&&toolbarController.toolbarbuttons&&toolbarController.toolbarbuttons.formatpainterbutton&&toolbarController.toolbarbuttons.formatpainterbutton.uncheck();
}function G(){var S=window.getSelection();if(S&&S.type!="None"&&S.rangeCount!==0){var T=S.getRangeAt(0);
return T;}return null;}return{getCursorNodeFormat:N,clearAllNodeFormat:Q,getCurRange:G,setNodeFormat:P,getFromatState:L,};
};ace.insert=function(C){var J=C.getRoot();var A=null;function H(){var K=document.createElement("input");
K.setAttribute("id","hideImgSelector");K.setAttribute("type","file");K.setAttribute("accept","image/*");
K.setAttribute("style","display:none");document.body.appendChild(K);if(!!window.FileReader){$(document).off("change").on("change","#hideImgSelector",function(){for(var L=0;
L<this.files.length;++L){padeditor.aceObserver.trigger("insert-image",[this.files[L]]);}});}K.click();
}function I(){padeditor.ace.callWithAce(function(M){padeditbar.jugeIsInsertReturn("start");var K=M.getRep();
var N=K.selStart;var L=K.selEnd;if(!K.selStart||!K.selEnd){N=L=[0,0];}M.performDocumentReplaceRange(N,L,"*",[["splitline","horizontal-splitline"]]);
padeditor.ace.performDocumentReplaceSelection("\n",true);},"insertline",true);}function G(){padeditor.ace.callWithAce(function(L){padeditbar.jugeIsInsertReturn("start");
var K=L.getRep();var M=[K.selStart[0],K.selStart[1]];var N=[K.selEnd[0],K.selEnd[1]];L.replaceRange(M,M,"*",[["table","123"]]);
padeditbar.jugeIsInsertReturn("end");},"tableinsert",true);}function F(){var K=C.getCurRange();if(K&&K.collapsed){A=new B($("#linkbubble-template"),"#template-linkbubble-wrapper");
A.position();}}function D(K){var L=new RegExp("^(?:https?|sftp|ftps?|ssh|ircs?|file|gopher|telnet|nntp|worldwind|chrome|chrome-extension|svn|git|mms|smb|afp|nfs|(x-)?man|gopher|txmt|x-hackpad-image-upload)://|^mailto:|^xmpp:|^sips?:|^tel:|^sms:|^news:|^bitcoin:|^magnet:|^urn:|^geo:|^/","i");
return !!L.test(K);}function E(){if(A){A.remove();A=null;}}function B(K,L){if(!this.isExist()){this.add(K,L);
this.bindEvent(K,L);}this.remove=function(){$(".docs-linkbubble-bubble").remove();};}B.prototype.add=function(K,L){K.append($(L).html());
};B.prototype.position=function(){var K=pad_locate.getOffsetByRange();$(".docs-linkbubble-bubble").css("left",K.left-18);
$(".docs-linkbubble-bubble").css("top",K.top+K.height-$("#padpage")[0].offsetTop+9);};B.prototype.isExist=function(){return !!$(".docs-linkbubble-bubble")[0];
};B.prototype.bindEvent=function(K,L){K.on("click",function(M){M.preventDefault();M.stopPropagation();
});$(".docs-link-urlinput-url").on("change",function(M){var N=M.target.value;if(!D(N)){$(".docs-link-urlerror").show();
}else{$(".docs-link-urlerror").hide();}});$(".docs-link-urlinput-url").on("keyup",function(M){var N=M.target.value;
if(N==""){$(".docs-link-insertlinkbubble-done").addClass("docs-link-insertlinkbubble-disable");}else{$(".docs-link-insertlinkbubble-done").removeClass("docs-link-insertlinkbubble-disable");
}});$(".docs-link-insertlinkbubble-done").on("click",function(){var N=$(".docs-link-insertlinkbubble-text").val();
var M=$(".docs-link-urlinput-url").val();if(D(M)){if(N==""){C.callWithAce(function(O){var P=O.getRep();
var Q=P.selStart;var R=P.selEnd;O.replaceRange(Q,R,M,[["link",M]]);},"linkinsert",true);A.remove();}else{C.callWithAce(function(O){var P=O.getRep();
var Q=P.selStart;var R=P.selEnd;O.replaceRange(Q,R,N,[["link",M]]);},"linkinsert",true);A.remove();}}});
};return{insertImage:H,inserttable:G,insertline:I,insertlink:F,removeLinkBubble:E,};};ace.autolink=function(A){var C=null;
function L(){return C;}var B=function(V,U,W,T,S){};function P(V,U,W,T,S){return B(V,U,W,T,S);}function Q(S){B=S;
}var D=function(S,T){return S[0]=="@";};function N(S,T){return D(S,T);}function J(S){D=S;}function K(S,T){console.log("Set marker at",S);
A.performDocumentApplyAttributesToRange(S,[S[0],S[1]+1],[["autolink","true"]]);}function M(S){C=S;}function I(S){console.log("Clear marker at",S);
C=null;S=E(S[0]);if(!S){console.log("No autolink marker found!");return;}A.performDocumentApplyAttributesToRange(S,[S[0],S[1]+1],[["autolink",null]]);
}function E(a){if(!A.isCaret()){return;}var W=A.getRep();var Y=W.apool.attribToNum[["autolink","true"]];
var S=a||A.caretLine();var Z=W.alines[S];var V=Changeset.opIterator(Z);var X;var U=0;while(V.hasNext()){var T=V.next();
Changeset.eachAttribNumber(T.attribs,function(b){if(b==Y){X=[S,U];}});U+=T.chars;}return X;}function R(){var U=A.getCurrentCallStack();
console.log("type="+U.type);var W=O();var T=E();C=T;var S=H(T)?F(T):A.caretWord();if(!W&&T&&S&&D(S.word,S.start)){if(U.docTextChanged){var V=G();
B(S.word,null,S.start,S.end,V);}}else{if(T&&U.docTextChanged){if(!D(S.word,S.start)){B(null);}}else{B(null);
}}}function H(S){var U=A.caretLine();var T=A.caretColumn();if(S){if(S[0]==U&&S[1]<T){return true;}}return false;
}function F(T){var S=A.charFromLineAndColumn(T);var U="";var W=A.getRep();while(S<A.caretDocChar()){U+=W.alltext.charAt(S);
S++;}var V=A.lineAndColumnFromChar(S);return{word:U,start:T,end:V};}function G(){var T=A.getSelection();
var V=(T.focusAtStart?T.startPoint:T.endPoint);var S=V.node;while(S&&S.parentNode&&S.tagName!="SPAN"){S=S.parentNode;
}while(S&&S.previousSibling&&!hasClass(S,"autolink")){S=S.previousSibling;}if(!S){return null;}if(!hasClass(S,"autolink")&&S.tagName!="AUTOLINK"){return null;
}var U=S.offsetLeft;var W=S.offsetTop+A.textLineHeight()+3;return{x:U,y:W};}function O(){var S=A.getSelection();
if(!S){return false;}var T=(S.focusAtStart?S.startPoint:S.endPoint);var U=T.node.parentNode;return hasClass(U,"attrlink");
}return{autocompleteCallback:P,caretWordPopupPosition:G,clearAutolink:I,findAutolinkStartPosition:E,handleAutocomplete:R,isValidLinkStart:H,getLastAutolinkPosition:L,linkWord:F,setAutocompleteCallback:Q,setAutolink:K,setLastAutolinkPosition:M,setTriggerLink:J,shouldTriggerLink:N};
};ace.code=function(A){var K=A.getRoot();var B=[];var E=false;var D=false;var C={};var F=null;function J(Q,P){$.post("/ep/api/latex",{formula:Q},function(S){if(S.length){var V=/^([-]?\d+)\r\n(\S+)\s([-]?\d+)\s(\d+)\s(\d+)\r?\n?([\s\S]*)/;
var R=S.match(V);var T=R[1];var W=R[2];var Y=R[3];var X=R[4];var Z=R[5];var U=R[6];if(T=="0"){P('<img class="" src="'+W+'">');
}else{P("<pre>"+U+"</pre>");}}}).error(function(){P();});}function I(P){var Q=C["default"];if(P){if(!C[P]){G(P);
}else{Q=C[P];}}return Q;}function G(Q){var P=function(){require(["helper"],function(R){A.setProperty("langtokenizer",[R("foo."+Q),Q]);
});};if(!D){$.ajax({url:"/static/js/tok/require_all.js",dataType:"script",cache:true,success:function(){E=true;
P();if(B.length){for(var R=0;R<B.length;++R){B[R]();}B=[];}}});D=true;}else{if(E){P();}else{B.push(P);
}}}function M(){return A.getTextFace()=="monospace";}function N(Q,P){if(userAgentInfo()=="Firefox"){$(K).attr("spellcheck","false");
}C[P||"default"]=Q;window.clearTimeout(F);F=window.setTimeout(function(){A.inCallStackIfNecessary("setTokenizer",function(){A.fastIncorp();
var R=A.getRep();O(0,R.alltext.length);});},0);}function H(S){var R=A.getRep();var Q=R.alines[S];if(Q){var P=Changeset.opIterator(Q);
if(P.hasNext()){lang=Changeset.opAttributeValue(P.next(),"lang",R.apool)||"";lang=lang=="c++"?"cpp":lang;
return lang;}}return"";}function L(U){if(!U){return;}var Q="",P="",S="";var R=U.split("&");for(var T in R){if(R[T]&&(/:/i.exec(R[T]))){P=R[T].split(":")[0];
S=R[T].split(":")[1];if(P=="bold"){Q+="font-weight: bold;";}if(P=="italic"){Q+="font-style: italic;";
}if(P=="underline"||P=="strikethrough"){var W=/\btext-decoration:\s*line-through\b/i;var V=/\btext-decoration:\s*underline\b/i;
if(W.exec(Q)){Q=Q.replace(W,"text-decoration: underline line-through");}else{if(V.exec(Q)){Q=Q.replace(V,"text-decoration: underline line-through");
}else{if(P=="underline"){Q+="text-decoration: underline;";}else{Q+="text-decoration: line-through;";}}}}if((P!="bold")&&(P!="italic")&&(P!="underline")&&(P!="strikethrough")){if(docContentAttr[P]){P=P.replace(/[<]/g,"&lt").replace(/[>]/g,"&gt").replace(/["]/g,"&quot");
S=S.replace(/[<]/g,"&lt").replace(/[>]/g,"&gt").replace(/["]/g,"&quot");Q+=P+":"+S+";";}}}}return Q;}function O(T,Z,U,X){var Q=A.getRep();
if(Z<=T){return;}if(T<0||T>=Q.lines.totalWidth()){return;}var P=Q.lines.atOffset(T);var R=Q.lines.offsetOfEntry(P);
var S=Q.lines.indexOfEntry(P);var Y=false;var a=null;var d=null;U=(U||noop);var W;var V=function(f,h,g){P.domInfo.appendSpan(f,h,g,L);
};if(X){var c=V;V=function(f,g){X(f,g,c,W);W+=f.length;};}while(P&&R<Z&&!U()){var b=R+P.width;W=R;P.domInfo.clearSpans();
A.getSpansForLine(P,V,R);P.domInfo.finishUpdate();A.markNodeClean(P.lineNode);if(Q.selStart&&Q.selStart[0]==S||Q.selEnd&&Q.selEnd[0]==S){Y=true;
}if(a===null){a=S;}d=S;R=b;P=Q.lines.next(P);S++;}if(Y){A.getCurrentCallStack().selectionAffected=true;
}}return{getLangForCodeLine:H,getTokenizer:I,isMonospace:M,onMath:J,setTokenizer:N};};ace.tables=function(A){window.handleTableChange=function(P,F){var O={node:P,index:0,maxIndex:0};
var K=A.getLineAndCharForPoint(O);var H=[];for(var E=0;E<F.length;E++){var J=F[E][0];var I=F[E][1];var Q=F[E][2];
var N=F[E][3];var L=F[E][4]||[];var M=F[E][5]||[];H.push([J+":"+I,N]);for(var G=0;G<L.length;G++){H.push([J+":"+I+":"+L[G],true]);
}for(var G=0;G<M.length;G++){H.push([J+":"+I+":"+M[G]]);}}A.inCallStackIfNecessary("tableChanges",function(){A.performDocumentApplyAttributesToRange(K,[K[0],K[1]+1],H);
});};function D(L,G,O){var E=document.getElementById(G[0]);var F=L[0].domInfo.node;var I=E.children.length&&hasClass(E.children[0],"table");
var M=F.children.length&&hasClass(F.children[0],"table");if(I&&M){G=[];F.parentNode.removeChild(F);E.id=F.id;
E.className=F.className;var N=A.getRep();var K=Changeset.opIterator(N.alines[O]);var H=E.children[0].children[0].children[0].children[0];
C(H,K);var J=H.onAfterEdit();B(H,J);A.markNodeClean(E);}return G;}function B(E,I){var G=E.nextSibling;
if(G){E.parentNode.removeChild(G);}var H=I.cloneNode(true);var F=document.createElement("div");addClass(F,"shadow-table");
F.appendChild(H);E.parentNode.appendChild(F);}function C(H,G){var F=[];while(G.hasNext()){var I=G.next();
Changeset.eachAttribNumber(I.attribs,function(N){var L=A.getRep();var J=L.apool.getAttribKey(N).split(":");
var P=L.apool.getAttribValue(N);var M=J[0];var K=J[1];if(J.length==2){H.setDataAtCell(M,K,P);}if(J.length==3){var O=J[2];
F.push([M,K,O]);}});}for(var E=0;E<F.length;E++){H.setAttribAtCell(F[E][0],F[E][1],F[E][2]);}}window.fillTable=function(E){var F={node:E.parentNode.parentNode.parentNode.parentNode,index:0,maxIndex:0};
if(!A.isNodeDirty(F.node)){var J=A.getRep();var I=A.getLineAndCharForPoint(F);var G=Changeset.opIterator(J.alines[I[0]]);
C(E,G);var H=E.onAfterEdit();B(E,H);A.markNodeClean(F.node);}else{console.log(F.node);}};window.deleteTable=function(F){var H={node:F,index:0,maxIndex:0};
var E=A.getLineAndCharForPoint(H);var G=[E[0],E[1]+1];A.inCallStack("deleteTable",function(){A.performDocumentReplaceRange(E,G,"");
});};return{domAndRepSpliceToTable:D};};var ActionState={BeforeSend:"STATE_BEFORE_SEND",WaitConfirm:"STATE_WAIT_CONFIRM",Confirmed:"STATE_CONFIRMED"};
var L2SAction=function(B,A){this.type=B;this.json=A;this.localID=null;this.serverID=null;this.state=ActionState.BeforeSend;
};var L2SActionQueue=function(){var A=[];this.input=function(B){if(!B){return false;}A.push(B);return true;
};this.out=function(){return A.shift();};this.empty=function(){A=[];};this.isEmpty=function(){return((A.length==0)?true:false);
};this.size=function(){return A.length;};this.sendJson=function(){var B=[];while(!this.isEmpty()){B.push(this.out().json);
}return B;};};ace.authors=function(C){var A={};var B=false;function M(){return B;}function N(O){B=O;}function H(){return A;
}function L(O,R){if((typeof O)!="string"){throw new Error("setAuthorInfo: author ("+O+") is not a string");
}var P=C.getDynamicCSS();if(!R){delete A[O];if(P){P.removeSelectorStyle(F("gutter-"+linestylefilter.getAuthorClassName(O)));
P.removeSelectorStyle(E(linestylefilter.getAuthorClassName(O)));}}else{A[O]=R;C.getObserver().trigger("invalidate-cache");
C.getObserver().trigger("caret",[true]);if(R.bgcolor){if(P){var S=R.bgcolor;var U=clientVars.isDesktopApp?2:4;
S=D(R.bgcolor,0.4);name_bgcolor=D(R.bgcolor,0.2);var T=F("gutter-"+linestylefilter.getAuthorClassName(O));
var Q=P.selectorStyle(T);if(!browser.msie){if(!clientVars.isDesktopApp&&B=="initials"){Q.borderLeft=U+"px solid white";
Q.paddingLeft="19px";Q.paddingRight="19px";}else{Q.borderLeft=U+"px solid "+S;Q.paddingLeft="54px";Q.paddingRight="60px";
}}else{Q.paddingLeft="55px";Q.paddingRight="60px";}P.selectorStyle(K(linestylefilter.getAuthorClassName(O))).color=name_bgcolor;
P.selectorStyle(J(linestylefilter.getAuthorClassName(O))).display="none";P.selectorStyle(E(linestylefilter.getAuthorClassName(O))).borderBottom="2px dotted "+S;
var T=I("gutter-"+linestylefilter.getAuthorClassName(O),linestylefilter.getAuthorClassName(O));P.selectorStyle(T).borderBottom="0px solid "+S;
}}}}function G(){var O=[];for(var P in A){O.push(A[P].name);}return O;}function K(O){return"#editor .ace-line.gutter-"+O+":before";
}function J(O){return".gutter-"+O+":not(.line-list-type-comment) + .gutter-"+O+":not(.line-list-type-comment):before, .gutter-"+O+":not(.line-list-type-comment) + .gutter-noauthor + .gutter-"+O+":not(.line-list-type-comment):before, .line-list-type-comment.gutter-"+O+" + .line-list-type-comment.gutter-"+O+":before";
}function F(O){return".edit-mode ."+O;}function E(O){return".authorColors ."+O;}function I(O,P){return".authorColors ."+O+" ."+P;
}function D(P,Q){var O=colorutils.css2triple(P);O=colorutils.blend(O,[1,1,1],Q);return colorutils.triple2css(O);
}return{getAuthorInfos:H,getAuthorNames:G,getShortNames:M,setAuthorInfo:L,setShortNames:N};};
/*
 * Copyright 2009 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS-IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
$(window).bind("load",function(){getCollabClient.windowLoaded=true;
});function getCollabClient(AQ,C,d,T,AX){var D=AQ;var G=C.rev;var n=C.padId;var x=C.globalPadId;var F="IDLE";
var R;var AA;var J="CONNECTING";var Y=null;var AL=null;var f=false;var P=0;var v=0;var AF=0;var I=d.userId;
var l;var j;var B;var E={};var V={};var S={};E[I]=d;S[I]=d;var M=[];var h=0;var w=[];var AB=[];var AD=[];
var N=[];var q=0;AE(C.historicalAuthorData);c(d);var A={onUserJoin:function(){},onUserLeave:function(){},onUserKill:function(){},onUpdateUserInfo:function(){},onUserSiteJoin:function(){},onUpdateUserSiteInfo:function(){},onUserSiteLeave:function(){},onUserEdited:function(){},onGroupJoin:function(){},onGroupRemove:function(){},onUpdateGroupInfo:function(){},onChannelStateChange:function(){},onClientMessage:function(){},onInternalAction:function(){},onConnectionTrouble:function(){},onServerMessage:function(){},onSiteToClientMessage:function(){},onModeratedPadEdited:function(){}};
$(window).bind("unload",function(){if(B){B.onclosed=function(){};B.onhiccup=function(){};var Aj=navigator.userAgent.match(/iPhone/i)!=null;
if(Aj){B.disconnect(false);}else{B.disconnect(true);}}});if($.browser.mozilla){$(window).bind("keydown",function(Aj){if(Aj.which==27){Aj.preventDefault();
}});}D.setProperty("userAuthor",I);D.setSheet(C.padType=="sheet");D.setSheetPosition(C.pos);D.setSubId(C.padSubId);
D.setBaseAttributedText({text:unescape(C.initialAttributedText.text),attribs:C.initialAttributedText.attribs},C.apool,C.header);
D.setUserChangeNotificationCallback(O("handleUserChanges",X));if(C.missedChanges){D.callWithAce(function(Al){var Am=Al.getRep();
var Aj;var Ak;if(C.missedChanges.committedChangeset){F="COMMITTING";j=C.missedChanges.committedChangesetSocketId;
Aj=C.missedChanges.committedChangeset;Ak=(new AttribPool()).fromJsonable(C.missedChanges.committedChangesetAPool);
Aj=Changeset.moveOpsToNewPool(Aj,Ak,Am.apool);Al.performDocumentApplyChangeset(Aj);AJ();}if(C.missedChanges.furtherChangeset){Aj=C.missedChanges.furtherChangeset;
Ak=(new AttribPool()).fromJsonable(C.missedChanges.furtherChangesetAPool);Aj=Changeset.moveOpsToNewPool(Aj,Ak,Am.apool);
Al.performDocumentApplyChangeset(Aj);}},"applyMissedChanges",true);}function r(Aj){H("abandoning connect "+Aj);
if(B){B.onclosed=function(){};B.onhiccup=function(){};B.disconnect();}B=null;K("DISCONNECTED",Aj);}function s(Aj){H(Aj);
window.onfreakout&&window.onfreakout(Aj);}function H(Aj){if(typeof window.ajlog=="string"){window.ajlog+=Aj+"\n";
}N.push(Aj);}var W=0;function U(Aj){W=setTimeout(O("setTimeout(handleUserChanges)",X),Aj);}function X(){H("handling user changes");
if(W){clearTimeout(W);W=0;}f=true;if(clientVars.userIsGuest){if(top.location.pathname=="/"){return;}if(!padutils.getIsMobile()&&clientVars.padId=="AWELCOMEPAD"){$("body").addClass("guestbanner");
$("#guestbanner #guest-banner-msg").html('Your changes are not being saved. <a href="#">Sign In</a> to start using Hackpad.').effect("pulsate",{times:1},500,function(){$(this).stop(true);
}).click(function(){modals.showModal("#page-login-box",0);return false;});}else{modals.showHTMLModal($("#page-login-box"));
}return;}if((!B)||J=="CONNECTING"){if(J=="CONNECTING"&&v&&(((+new Date())-v)>30000)){r("initsocketfail");
}else{if(F=="IDLE"){F="WAITING";A.onInternalAction("userChangesBeforeConnected");}U(1000);}return;}var Aj=(+new Date());
if(F=="COMMITTING"){if(Aj-P>45000){H("slow commit: disconnecting");Y="slowcommit";B.disconnect();}else{if(Aj-P>5000){A.onConnectionTrouble("SLOW");
U(P+45000-Aj);}else{U(3000);}}return;}if(!n){if(F=="IDLE"){F="WAITING";A.onInternalAction("userChangesBeforePadId");
}return;}f=false;var Ak=P+500;if(Aj<Ak){U(Ak-Aj);return;}H("performing commit");if(AJ()){P=Aj;AA=l;Q(R);
A.onInternalAction("commitPerformed");U(3000);}}function Ai(Ak){var Aj=new Date();var Al=Aj.getTime()+Ak;
while(true){Aj=new Date();if(Aj.getTime()>Al){return;}}}function AJ(){var Aj=D.prepareUserChangeset();
if(!Aj.changeset){return false;}F="COMMITTING";R={type:"USER_CHANGES",baseRev:G,changeset:Aj.changeset,apool:Aj.apool,keydata:Aj.keydata,head:Aj.head,subId:Aj.subId,oSubId:Aj.oSubId};
return true;}function AM(){var Aj={};Aj.screen=[$(window).width(),$(window).height(),window.screen.availWidth,window.screen.availHeight,window.screen.width,window.screen.height].join(",");
Aj.ip=C.clientIp;Aj.useragent=C.clientAgent;return Aj;}function AK(){var Aj={type:"CLIENT_READY",roomType:"padpage",roomName:"padpage/"+x,data:{lastRev:G,userInfo:E[I],stats:AM()}};
if(j){Aj.data.isReconnectOf=j;Aj.data.isCommitPending=(F=="COMMITTING");if(Aj.data.isCommitPending){P=(+new Date())-1;
}}Q(Aj);AN();if(f){X();}}function a(Ak){var Aj=false;if(AX){return;}Z("setUpSocket",function(){Y=null;
j=l;l=String(Math.floor(Math.random()*1000000000000));B=new EtherpadWebSocket(l,n);B.onmessage=O("socket.onmessage",Ac);
B.onclosed=O("socket.onclosed",AP);B.onopen=O("socket.onopen",function(){m=0;h=0;K("CONNECTED");if(n){AK();
}});B.onhiccup=O("socket.onhiccup",Ah);B.onlogmessage=H;B.connectLite=Ak;B.connect();Aj=true;});if(Aj){v=+new Date();
}else{r("initsocketfail");}}function AH(){if(getCollabClient.windowLoaded){a();}else{setTimeout(AH,200);
}}setTimeout(AH,0);function AW(){if(J=="DISCONNECTED"){K("CONNECTING");a();}}function Aa(Ak,Aj){n=Ak;
x=Aj;if(J=="CONNECTED"){AK();}}var m=0;function Ah(Aj){H("HICCUP (connected:"+(!!Aj.connected)+")");var Ak=Aj.connected;
if(!Ak){m++;if(m>1){K("RECONNECTING");}}else{m=0;K("CONNECTED");}}function AG(Aj){if(Aj){setStatusTips("保存成功",3000);
}else{setStatusTips("保存失败,稍后将自动重试。");}}function Q(Ak){if(!B){H("Can't sendMessage without a socket!");
return;}if(Ak.type=="USER_CHANGES"){if(AL){clearTimeout(AL);}var Aj={act_type:82};$.report(Aj);function Al(Am,An){if(Am){Aj={act_type:83};
AG(Am);}else{Aj={act_type:84};AG(Am);}$.report(Aj);}B.postMessage(JSON.stringify({type:"COLLABROOM",data:Ak}),Al);
}else{B.postMessage(JSON.stringify({type:"COLLABROOM",data:Ak}));}AF=+(new Date());q=B.getLastReceivedSeqNumber();
}function O(Aj,Ak){return function(){try{return Ak.apply(this,Array.prototype.slice.call(arguments));
}catch(Al){w.push(Al);AB.push(Aj);AD.push(+new Date());throw Al;}};}function Z(Aj,Ak){try{O(Aj,Ak)();
}catch(Al){}}function Ac(Aq){if(!B){return;}if(!Aq.data){return;}if(window.blockingCooperation){return;
}var Ap=JSON.parse(Aq.data);if(Ap.type!="COLLABROOM"){return;}var Aj=Ap.data;if(Aj.type=="NEW_CHANGES"){var Am=Aj.newRev;
var Ar=Aj.changeset;var Ao=(Aj.author||"");var As=Aj.apool;if(Am!=(G+1)){s("bad message revision on NEW_CHANGES: "+Am+" not "+(G+1));
B.disconnect();return;}D.setIsNeedKeyData(!!Aj.need,Aj.subId);G=Am;D.applyChangesToBase(Ar,Ao,As,Aj.subId,Aj.head,Aj.revert);
if(Ao!=""){Z("onUserEdited",function(){A.onUserEdited(E[Ao],Ar);});}}else{if(Aj.type=="ACCEPT_COMMIT"){var Am=Aj.newRev;
if(Am!=(G+1)){s("bad message revision on ACCEPT_COMMIT: "+Am+" not "+(G+1));B.disconnect();return;}D.setIsNeedKeyData(!!Aj.need,Aj.subId);
G=Am;D.applyPreparedChangesetToBase(Am-R.baseRev,Aj.subId,Aj.head);AC();Z("onInternalAction",function(){A.onInternalAction("commitAcceptedByServer");
});Z("onConnectionTrouble",function(){A.onConnectionTrouble("OK");});X();}else{if(Aj.type=="NO_COMMIT_PENDING"){if(F=="COMMITTING"){AC();
X();}}else{if(Aj.type=="USER_NEWINFO"){var Ak=Aj.userInfo;var Al=Ak.userId;if(E[Al]){E[Al]=Ak;A.onUpdateUserInfo(Ak);
L();}else{E[Al]=Ak;A.onUserJoin(Ak);L();}c(Ak);}else{if(Aj.type=="USER_SITE_NEWINFO"){var Ak=Aj.userInfo;
var Al=Ak.userId;if(S[Al]){S[Al]=Ak;A.onUpdateUserSiteInfo(Ak);}else{S[Al]=Ak;A.onUserSiteJoin(Ak);}}else{if(Aj.type=="EDITOR_NEWINFO"){var Ak=Aj.userInfo;
var Al=Ak.userId;c(Ak);}else{if(Aj.type=="USER_LEAVE"){var Ak=Aj.userInfo;var Al=Ak.userId;if(E[Al]){delete E[Ak.userId];
AV(Ak);A.onUserLeave(Ak);L();}}else{if(Aj.type=="USER_SITE_LEAVE"){var Ak=Aj.userInfo;var Al=Ak.userId;
if(S[Al]){delete S[Ak.userId];A.onUserSiteLeave(Ak);}}else{if(Aj.type=="USER_KILL"){var Ak=Aj.userInfo;
delete E[Ak.userId];A.onUserKill(Ak);L();}else{if(Aj.type=="GROUP_REMOVEPAD"){var Ak=Aj.userInfo;var An=Ak.groupId;
if(V[An]){delete V[An];}A.onGroupRemove(Ak);L();}else{if(Aj.type=="GROUP_NEWINFO"){var Ak=Aj.userInfo;
var An=Ak.groupId;if(V[An]){V[An]=Ak;A.onUpdateGroupInfo(Ak);L();}else{V[An]=Ak;A.onGroupJoin(Ak);L();
}}else{if(Aj.type=="DISCONNECT_REASON"){Y=Aj.reason;switch(Y){case"unauth":modals.showModal("#page-login-box",0);
break;case"invalidrev":s("bad message revision on CLIENT_READY: "+G);break;default:break;}}else{if(Aj.type=="MODERATION_MESSAGE"){A.onModeratedPadEdited();
}else{if(Aj.type=="CLIENT_MESSAGE"){A.onClientMessage(Aj.payload);}else{if(Aj.type=="SERVER_MESSAGE"){A.onServerMessage(Aj.payload);
}else{if(Aj.type=="SITE_TO_CLIENT_MESSAGE"){A.onSiteToClientMessage(Aj.payload);}else{if(Aj.type=="SITE_MESSAGE"){A.onSiteMessage(Aj.payload);
}}}}}}}}}}}}}}}}}}function AO(Aj){Aj.userId=I;E[I]=Aj;c(Aj);if(!B){return;}Q({type:"USERINFO_UPDATE",userInfo:Aj});
}function c(Aj){u(Aj.userId,Aj.colorId,false,Aj.name,Aj.userLink);}function u(Al,Aj,Ao,Ak,An){if(Aj||(typeof Aj)=="number"){Aj=Number(Aj);
if(T&&T.colorPalette&&T.colorPalette[Aj%T.colorPalette.length]){var Am=T.colorPalette[Aj%T.colorPalette.length];
if(Ao){D.setAuthorInfo(Al,{bgcolor:Am,name:Ak,userLink:An});}else{D.setAuthorInfo(Al,{bgcolor:Am,name:Ak,userLink:An});
}}}}function AV(Aj){u(Aj.userId,Aj.colorId,true,Aj.name,Aj.userLink);}function AS(){return Af(E);}function AE(Al){for(var Aj in Al){var Ak=Al[Aj];
if(!E[Aj]){u(Aj,Ak.colorId,true,Ak.name,Ak.userLink);}}}function L(){}function AP(Ak){B.onmessage=function(){};
B.onclosed=function(){};B.onopen=function(){};B.onhiccup=function(){};B.onlogmessage=function(Ar){H("(closed) "+Ar);
};B=null;$.each(AR(E),function(){var Ar=String(this);if(Ar!=I){var As=E[Ar];delete E[Ar];A.onUserLeave(As);
L();}});var Aj=Y||Ak.reason;var Ap=Ak.reconnect;if(Ap){M.push(+new Date());var Am=8;var Ao=10000;if(M.length>=Am&&((+new Date())-M[M.length-Am])<Ao){K("DISCONNECTED","looping");
}else{K("RECONNECTING",Aj);a();}}else{M.push(+new Date());var An=100;if(f||!Ak.reconnectLite||h>An){K("DISCONNECTED",Aj);
}else{h+=1;K("RECONNECTING",Aj);var Al=Math.min(30000,1000*Math.pow(2,h+1));var Aq=o(Al,0.4*Al);setTimeout(function(){a(true);
},Aq);M=M.slice(0,50);}}}function K(Aj,Ak){H("Channel state being set to "+Aj);if(Aj!=J){J=Aj;A.onChannelStateChange(J,Ak);
}}function AR(Ak){var Aj=[];$.each(Ak,function(Al,Am){Aj.push(Al);});return Aj;}function Af(Ak){var Aj=[];
$.each(Ak,function(Am,Al){Aj.push(Al);});return Aj;}var g=[];function AZ(Ak,Aj){return function(){var An=this;
var Am=arguments;function Al(){Ak.apply(An,Am);}Al.tag=Aj;if(J=="CONNECTING"){g.push(Al);}else{Al();}};
}function AN(Am){var Al=[];for(var Ak=0;Ak<g.length;Ak++){var Aj=g[Ak];if((!Am)||(Am==Aj.tag)){Aj();}else{Al.push(Aj);
}}g=Al;}function Ae(Aj){Q({type:"CLIENT_MESSAGE",payload:Aj});}function AY(Aj){Q(Aj);}function AT(){return G;
}function AU(){return F=="COMMITTING"||F=="WAITING"||W;}function Ag(){var As=3;var Aq=3;var An=50;var Ar=500;
function Al(At){return String(At).substring(0,Ar);}var Aj={errors:{length:0}};function Ap(At,Ax,Aw){var Au={catcher:Ax};
if(Aw){Au.time=Aw;}try{if(At.description){Au.description=At.description;}}catch(Av){}try{if(At.fileName){Au.fileName=At.fileName;
}}catch(Av){}try{if(At.lineNumber){Au.lineNumber=At.lineNumber;}}catch(Av){}try{if(At.message){Au.message=At.message;
}}catch(Av){}try{if(At.name){Au.name=At.name;}}catch(Av){}try{if(At.number){Au.number=At.number;}}catch(Av){}try{if(At.stack){Au.stack=Al(At.stack);
}}catch(Av){}Aj.errors[Aj.errors.length]=Au;Aj.errors.length++;}for(var Ak=0;((Ak<w.length)&&(Ak<As));
Ak++){Ap(w[Ak],AB[Ak],AD[Ak]);}if(D){var Ao=D.getUnhandledErrors();for(var Ak=0;((Ak<Ao.length)&&(Ak<Aq));
Ak++){var Am=Ao[Ak];Ap(Am.error,"ACE",Am.time);}}Aj.time=+new Date();Aj.collabState=F;Aj.channelState=J;
Aj.lastCommitTime=P;Aj.numSocketReconnects=M.length;Aj.userId=I;Aj.currentRev=G;Aj.participants=(function(){var At=[];
for(var Au in E){At.push(Au);}return At.join(",");})();if(N.length>An){N=N.slice(N.length-An,N.length);
}Aj.debugMessages={length:0};for(var Ak=0;Ak<N.length;Ak++){Aj.debugMessages[Ak]=Al(N[Ak]);Aj.debugMessages.length++;
}return Aj;}function Ab(){var Aj={};Aj.userInfo=E[I];Aj.baseRev=G;if(F=="COMMITTING"&&R){Aj.committedChangeset=R.changeset;
Aj.committedChangesetAPool=R.apool;Aj.committedChangesetSocketId=AA;}var Ak=D.userChangesetForWire();
if(Ak.changeset){Aj.furtherChangeset=Ak.changeset;Aj.furtherChangesetAPool=Ak.apool;}return Aj;}function AC(){F="IDLE";
A.onInternalAction("newlyIdle");z();}function y(Aj){p.push(Aj);z();}var p=[];function z(){setTimeout(function(){if(F=="IDLE"){while(p.length>0){var Aj=p.shift();
Aj();}}},0);}function o(Ak,Aj){return Ak+Math.floor((Math.random()*(2*Aj+1))-Aj);}var b=o(1000*60*10,1000*60*2);
function AI(){var Aj=B&&B.getLastReceivedSeqNumber()||0;var Ak=+(new Date());if((Aj>q)&&((Ak-AF)>(b-1000))){y(function(){Q({type:"FLUSH_MESSAGE"});
q=Aj;});}b=o(1000*60*10,1000*60*2);window.setTimeout(AI,b);}window.setTimeout(AI,b);var Ad;return(Ad={setOnUserJoin:function(Aj){A.onUserJoin=Aj;
},setOnUserLeave:function(Aj){A.onUserLeave=Aj;},setOnUserKill:function(Aj){A.onUserKill=Aj;},setOnUpdateUserInfo:function(Aj){A.onUpdateUserInfo=Aj;
},setOnUserSiteJoin:function(Aj){A.onUserSiteJoin=Aj;},setOnUserSiteLeave:function(Aj){A.onUserSiteLeave=Aj;
},setOnUpdateUserSiteInfo:function(Aj){A.onUpdateUserSiteInfo=Aj;},setOnUserEdited:function(Aj){A.onUserEdited=Aj;
},setOnGroupJoin:function(Aj){A.onGroupJoin=Aj;},setOnGroupRemove:function(Aj){A.onGroupRemove=Aj;},setOnUpdateGroupInfo:function(Aj){A.onUpdateGroupInfo=Aj;
},setOnChannelStateChange:function(Aj){A.onChannelStateChange=Aj;},setOnClientMessage:function(Aj){A.onClientMessage=Aj;
},setOnModeratedPadEdited:function(Aj){A.onModeratedPadEdited=Aj;},setOnInternalAction:function(Aj){A.onInternalAction=Aj;
},setOnConnectionTrouble:function(Aj){A.onConnectionTrouble=Aj;},setOnServerMessage:function(Aj){A.onServerMessage=Aj;
},setOnSiteToClientMessage:function(Aj){A.onSiteToClientMessage=Aj;},setOnSiteMessage:function(Aj){A.onSiteMessage=Aj;
},updateUserInfo:AZ(AO),getConnectedUsers:AS,sendClientMessage:Ae,sendUserChangeMessage:AY,getCurrentRevisionNumber:AT,getDiagnosticInfo:Ag,hasUncommittedChanges:AU,getMissedChanges:Ab,callWhenNotCommitting:y,addHistoricalAuthors:AE,reconnect:AW,pause:function(){A.onChannelStateChange=function(){};
r("paused");},setPadId:Aa});}function selectElementContents(C){if($.browser.msie){var A=document.body.createTextRange();
A.moveToElementText(C);A.select();}else{if(window.getSelection){var B=window.getSelection();if(B){var A=document.createRange();
A.selectNodeContents(C);B.removeAllRanges();B.addRange(A);}}}}(function(A){A.fn.extend({customStyle:function(B){if(!A.browser.msie||(A.browser.msie&&A.browser.version>6)){return this.each(function(){var D=A(this).find(":selected");
A(this).after('<span class="customStyleSelectBox"><span class="customStyleSelectBoxInner">'+D.text()+"</span></span>").css({position:"absolute",opacity:0,fontSize:A(this).next().css("font-size")});
var C=A(this).next();var G=parseInt(A(this).width())-parseInt(C.css("padding-left"))-parseInt(C.css("padding-right"));
var F=C.find(":first-child");C.css({display:"inline-block"});var E=parseInt(C.height())+parseInt(C.css("padding-top"))+parseInt(C.css("padding-bottom"))+3;
A(this).height(E).change(function(){F.text(A(this).find(":selected").text()).parent().addClass("changed");
});});}}});})(jQuery);toISOString=function(A){function B(D){return D<10?"0"+D:D;}function C(D){if(D<100){D="0"+D;
}if(D<10){D="0"+D;}return D;}return A.getUTCFullYear()+"-"+B(A.getUTCMonth()+1)+"-"+B(A.getUTCDate())+"T"+B(A.getUTCHours())+":"+B(A.getUTCMinutes())+":"+B(A.getUTCSeconds())+"."+C(A.getUTCMilliseconds())+"Z";
};var hints=function(){function B(E,F,D){var C=D||2000;setTimeout(function(){A(E,F);},C);}function A(F,J){var D=$(F).offset();
if(!D){return;}var I='		  <div class="tip">		    <div class="arrow-top-left">		      <div class="arrow-up-border"></div>		      <div class="arrow-up"></div>		    </div>		    <div class="tip-box">'+J+"</div>		  </div>";
var C=$(I);$("body").append(C);var G=$(C).find(".arrow-top-left");C.css({top:D.top+$(F).height()+G.height()+2,left:D.left-G.position().left+5,display:"none"}).fadeIn();
function E(){H();}function H(){C.fadeOut(function(){C.remove();});$("body").unbind("click",E);}setTimeout(H,4000);
$("body").click(E);}return{showHint:B};}();(function(A){A.fn.invite=function(C){var B={target:"Pad",recentUsers:[],recentGroups:[],minChars:0,inviteItemHandlers:{},width:navigator.userAgent.match(/iPad/i)!=null?"120px":"177px",dataURL:"/ep/invite/autocomplete",prompt:undefined,createCollection:false};
return this.each(function(){if(C){A.extend(B,C);}var D=A(this);function E(H){if(!D.val()){var H=[];if(B.createCollection){this.resultsClass+=" ac-results-collections";
A("#collections-recent-list li").each(function(S,R){H.push({data:["<span>"+A(R).text()+"</span>","",A(R).attr("groupid"),"hpgroup"],result:"",value:""});
});}else{if(B.prompt){H=[{data:["<span style='font-style: italic; color: grey;' class='placeholder'>"+B.prompt+"</span>",null,null,null],value:"",result:""}];
}}if(B.recentUsers.length>0||B.recentGroups.length>0){H.push({data:["<hr class='placeholder'/>",null,null,null],value:"",result:""});
}H=H.concat(B.recentUsers.slice(0,3).map(function(R){return{data:["<span style=''>"+R.fullName+"</span>",null,R.id,"hp"],value:R.fullName,result:""};
}));var P=function(S,R){return R.timestamp-S.timestamp;};H=H.concat(B.recentGroups.sort(P).slice(0,3).map(function(R){return{data:["<span style=''>"+R.name+" <span style='color: grey;'>("+R.userCnt+")</span></span>",null,R.groupId,"hpgroup"],value:R.name,result:""};
}));return H;}else{if(D.val().indexOf("@")>-1){var I=[];var M=D.val().split(",");for(var K=0;K<M.length;
K++){var Q=/"?([^"]*)"?\s+<([A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,4})>/i;var J=M[K].match(Q);if(J){I.push(J[2]);
}else{var O=/\b([A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,4})\b/i;var J=M[K].match(O);if(J){I.push(J[1]);}}}var N=padutils.escapeHtml(D.val());
if(I.length>1){N=I.length+" people";}return[{data:["<img src='"+location.protocol+"//mail.google.com/favicon.ico' style='float: right;' width='16' height='16'/><span style=''>Invite "+N+"</span>",I.join(","),null,"typedemail"],value:D.val(),result:""}];
}else{if(B.createCollection){this.resultsClass+=" ac-results-collections";var L=D.val();var H=[];H.push({data:["<span><i class='icon-new ac-results-create-val-plus'></i> "+padutils.escapeHtml(L)+"</span>",L,null,"newgroup"],result:"",value:L});
return H;}}}return[];}function G(J){var L="";if(J.success){L=J.data;}else{modals.showHTMLModal(J.html);
A("input").blur();return[];}var I=[];var M=L.split("\n");var N={hp:"<img src='/favicon.ico' style='float: right;'/>",hpgroup:""};
for(var K=0;K<M.length;K++){var H=A.trim(M[K]);if(H){H=H.split("|");I[I.length]={data:[N[H[2]]+'<span style="overflow: hidden; display: block; text-overflow: ellipsis;">'+H[0]+"</span>"].concat(H),value:H[0],result:""};
}}I=I.concat(E(L));return I;}D.closest("form").submit(function(H){H.preventDefault();return false;});
function F(L,I){var J={fb:"fbinvite",hp:"hpinvite",hpgroup:"groupinvite",email:"emailinviteautocomplete",typedemail:"emailinvite"};
if(I[3] in J){var K=1;if(I[3]=="typedemail"){K=I[1].split(",").length;}trackEvent("invited",null,null,{type:J[I[3]],count:K,target:B.target});
}var H=B.inviteItemHandlers[I[3]]||B.inviteItemHandlers["*"];if(!H){return;}if(H.callback){H.callback(I);
}else{if(H.url){D.addClass("ac_loading");A.post(H.url,H.argsCallback(I),function(M){D.removeClass("ac_loading");
if(typeof(M)=="object"&&"success" in M&&M.success==false){if(H.onFailure){H.onFailure(M);}}else{if(H.onSuccess){H.onSuccess(M);
}}});}}}D.autocomplete(B.dataURL,{max:50,parse:G,noCache:true,preparse:E,alwaysPreparse:true,minChars:B.minChars,width:B.width,selectFirst:true,extraParams:B.extraParams}).result(F);
});};})(jQuery);(function(F){var C=F.ajax,E={},A=[],B=[],D=[];F.ajax=function(G){G=jQuery.extend(G,jQuery.extend({},jQuery.ajaxSettings,G));
var H=G.port;switch(G.mode){case"abort":if(E[H]){E[H].abort();}return E[H]=C.apply(this,arguments);case"queue":var J=G.complete;
G.complete=function(){if(J){J.apply(this,arguments);}if(jQuery([C]).queue("ajax"+H).length>0){jQuery([C]).dequeue("ajax"+H);
}else{D[H]=false;}};jQuery([C]).queue("ajax"+H,function(){C(G);});if(jQuery([C]).queue("ajax"+H).length==1&&!D[H]){D[H]=true;
jQuery([C]).dequeue("ajax"+H);}return;case"sync":var I=A.length;A[I]={error:G.error,success:G.success,complete:G.complete,done:false};
B[I]={error:[],success:[],complete:[]};G.error=function(){B[I].error=arguments;};G.success=function(){B[I].success=arguments;
};G.complete=function(){B[I].complete=arguments;A[I].done=true;if(I==0||!A[I-1]){for(var K=I;K<A.length&&A[K].done;
K++){if(A[K].error){A[K].error.apply(jQuery,B[K].error);}if(A[K].success){A[K].success.apply(jQuery,B[K].success);
}if(A[K].complete){A[K].complete.apply(jQuery,B[K].complete);}A[K]=null;B[K]=null;}}};}return C.apply(this,arguments);
};})(jQuery);
/*
 * jQuery Autocomplete plugin 1.1
 *
 * Copyright (c) 2009 Jörn Zaefferer
 *
 * Dual licensed under the MIT and GPL licenses:
 *   http://www.opensource.org/licenses/mit-license.php
 *   http://www.gnu.org/licenses/gpl.html
 *
 * Revision: $Id: jquery.autocomplete.js 15 2009-08-22 10:30:27Z joern.zaefferer $
 */
(function(A){A.fn.extend({autocomplete:function(C,B){var D=typeof C=="string";
B=A.extend({},A.Autocompleter.defaults,{url:D?C:null,data:D?null:C,noCache:false,delay:D?A.Autocompleter.defaults.delay:10,max:B&&!B.scroll?10:150},B);
B.highlight=B.highlight||function(E){return E;};B.formatMatch=B.formatMatch||B.formatItem;return this.each(function(){new A.Autocompleter(this,B);
});},result:function(B){return this.bind("result",B);},enter:function(B){return this.bind("enter",B);
},search:function(B){return this.trigger("search",[B]);},flushCache:function(){return this.trigger("flushCache");
},setOptions:function(B){return this.trigger("setOptions",[B]);},unautocomplete:function(){return this.trigger("unautocomplete");
}});A.Autocompleter=function(F,B){var E={UP:38,DOWN:40,DEL:46,TAB:9,RETURN:13,ESC:27,COMMA:188,PAGEUP:33,PAGEDOWN:34,BACKSPACE:8};
var D=A(F).attr("autocomplete","off").addClass(B.inputClass);var K;var I="";var M=A.Autocompleter.Cache(B);
var J=0;var Q;var U={mouseDownOnSelect:false};var C=A.Autocompleter.Select(B,F,S,U);var R;A.browser.opera&&A(F.form).bind("submit.autocomplete",function(){if(R){R=false;
return false;}});D.bind((A.browser.opera?"keypress":"keyup")+".autocomplete",function(Y){J=1;Q=Y.keyCode;
switch(Y.keyCode){case E.UP:Y.preventDefault();if(C.visible()){C.prev();}else{G(0,true);}break;case E.DOWN:Y.preventDefault();
if(C.visible()){C.next();}else{G(0,true);}break;case E.PAGEUP:Y.preventDefault();if(C.visible()){C.pageUp();
}else{G(0,true);}break;case E.PAGEDOWN:Y.preventDefault();if(C.visible()){C.pageDown();}else{G(0,true);
}break;case B.multiple&&A.trim(B.multipleSeparator)==","&&E.COMMA:case E.TAB:case E.RETURN:if(S()){Y.preventDefault();
R=true;return false;}else{D.trigger("enter",null);}break;case E.ESC:C.hide();break;default:clearTimeout(K);
if(B.preparse&&(!C.visible()||B.alwaysPreparse)){O(D.val(),B.preparse());}K=setTimeout(G,B.delay);break;
}}).focus(function(){J++;if(B.minChars==0){G(0,true);}}).blur(function(){J=0;if(!U.mouseDownOnSelect){X();
}}).click(function(){if(J++>1&&!C.visible()){G(0,true);}}).bind("search",function(){var Y=(arguments.length>1)?arguments[1]:null;
function Z(d,b){var a;if(b&&b.length){for(var c=0;c<b.length;c++){if(b[c].result.toLowerCase()==d.toLowerCase()){a=b[c];
break;}}}if(typeof Y=="function"){Y(a);}else{D.trigger("result",a&&[a.data,a.value]);}}A.each(H(D.val()),function(b,a){T(a,Z,Z);
});}).bind("flushCache",function(){M.flush();}).bind("setOptions",function(){A.extend(B,arguments[1]);
if("data" in arguments[1]){M.populate();}}).bind("unautocomplete",function(){C.unbind();D.unbind();A(F.form).unbind(".autocomplete");
});function S(h){var Y=C.selected();var f=Y.pos;var Y=Y.data;if(!Y){return false;}var Z=Y.result;I=Z;
if(B.multiple){var a=H(D.val());if(a.length>1){var d=B.multipleSeparator.length;var g=A(F).selection().start;
var c,b=0;A.each(a,function(j,l){b+=l.length;if(g<=b){c=j;return false;}b+=d;});a[c]=Z;Z=a.join(B.multipleSeparator);
}Z+=B.multipleSeparator;}D.val(Z);N();D.trigger("result",[Y.data,Y.value,f,h]);return true;}function G(a,Z){if(Q==E.DEL){C.hide();
return;}var Y=D.val();if(!Z&&Y==I){return;}I=Y;Y=L(Y);if(Y.length>=B.minChars){D.addClass(B.loadingClass);
if(!B.matchCase){Y=Y.toLowerCase();}if(B.preparse&&!C.visible()){O(Y,B.preparse());}T(Y,O,N);}else{P();
C.hide();}}function H(Y){if(!Y){return[""];}if(!B.multiple){return[A.trim(Y)];}return A.map(Y.split(B.multipleSeparator),function(Z){return A.trim(Y).length?A.trim(Z):null;
});}function L(Y){if(!B.multiple){return Y;}var Z=H(Y);if(Z.length==1){return Z[0];}var a=A(F).selection().start;
if(a==Y.length){Z=H(Y);}else{Z=H(Y.replace(Y.substring(a),""));}return Z[Z.length-1];}function W(Z,Y){if(B.autoFill&&(L(D.val()).toLowerCase()==Z.toLowerCase())&&Q!=E.BACKSPACE){D.val(D.val()+Y.substring(L(I).length));
A(F).selection(I.length,I.length+Y.length);}}function X(){clearTimeout(K);K=setTimeout(N,200);}function N(){var Y=C.visible();
C.hide();clearTimeout(K);P();if(B.mustMatch){D.search(function(a){if(!a){if(B.multiple){var Z=H(D.val()).slice(0,-1);
D.val(Z.join(B.multipleSeparator)+(Z.length?B.multipleSeparator:""));}else{D.val("");D.trigger("result",null);
}}});}}function O(Z,Y){if(Y&&Y.length&&J){P();C.display(Y,Z);W(Z,Y[0].value);C.show();}else{N();}}function T(Y,a,c){if(!Y){return;
}if(!B.matchCase){Y=Y.toLowerCase();}var Z=null;if(!B.noCache){Z=M.load(Y);}if(Z&&Z.length){a(Y,Z);}else{if((typeof B.url=="string")&&(B.url.length>0)){var b={timestamp:+new Date()};
A.each(B.extraParams,function(f,d){b[f]=typeof d=="function"?d():d;});A.ajax({mode:"abort",port:"autocomplete"+F.name,dataType:B.dataType,url:B.url,data:A.extend({q:L(Y),limit:B.max},b),success:function(f){var d=B.parse&&B.parse(f)||V(f);
M.add(Y,d);a(Y,d);}});}else{C.emptyList();c(Y);}}}function V(Z){if(Z.data){Z=Z.data;}var a=[];var c=Z.split("\n");
for(var b=0;b<c.length;b++){var Y=A.trim(c[b]);if(Y){Y=Y.split("|");a[a.length]={data:Y,value:Y[0],result:B.formatResult&&B.formatResult(Y,Y[0])||Y[0]};
}}return a;}function P(){D.removeClass(B.loadingClass);}};A.Autocompleter.defaults={inputClass:"ac_input",resultsClass:"ac_results",loadingClass:"ac_loading",minChars:1,delay:400,matchCase:false,minCountForSelect:1,matchSubset:true,matchContains:false,cacheLength:10,max:100,mustMatch:false,extraParams:{},selectFirst:true,formatItem:function(B){return B[0];
},formatMatch:null,autoFill:false,width:0,multiple:false,multipleSeparator:", ",highlight:function(C,B){return C.replace(new RegExp("(?![^&;]+;)(?!<[^<>]*)("+B.replace(/([\^\$\(\)\[\]\{\}\*\.\+\?\|\\])/gi,"\\$1")+")(?![^<>]*>)(?![^&;]+;)","gi"),"<strong>$1</strong>");
},scroll:true,scrollHeight:180};A.Autocompleter.Cache=function(B){var C={};var D=0;function I(J){return J.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&");
}function H(J,L){if(!B.matchCase){J=J.toLowerCase();}var K=J.indexOf(L);if(B.matchContains=="word"){var M=I(L.toLowerCase());
K=J.toLowerCase().search("\\b"+M);}if(K==-1){return false;}return K==0||B.matchContains;}function G(J,K){if(D>B.cacheLength){E();
}if(!C[J]){D++;}C[J]=K;}function F(){if(!B.data){return false;}var K={},P=0;if(!B.url){B.cacheLength=1;
}K[""]=[];for(var L=0,Q=B.data.length;L<Q;L++){var J=B.data[L];J=(typeof J=="string")?[J]:J;var M=B.formatMatch(J,L+1,B.data.length);
if(M===false){continue;}var N=M.charAt(0).toLowerCase();if(!K[N]){K[N]=[];}var O={value:M,data:J,result:B.formatResult&&B.formatResult(J)||M};
K[N].push(O);if(P++<B.max){K[""].push(O);}}A.each(K,function(R,S){B.cacheLength++;G(R,S);});}setTimeout(F,25);
function E(){C={};D=0;}return{flush:E,add:G,populate:F,load:function(J){if(!B.cacheLength||!D){return null;
}if(!B.url&&B.matchContains){var K=[];for(var N in C){if(N.length>0){var M=C[N];A.each(M,function(P,O){if(H(O.value,J)){K.push(O);
}});}}return K;}else{if(C[J]){return C[J];}else{if(B.matchSubset){for(var L=J.length-1;L>=B.minChars;
L--){var M=C[J.substr(0,L)];if(M){var K=[];A.each(M,function(P,O){if(H(O.value,J)){K[K.length]=O;}});
return K;}}}}}return null;}};};A.Autocompleter.Select=function(B,K,R,M){var G={ACTIVE:"ac_over"};var C,D=-1,J,L="",N=true,F,E;
function S(){if(!N){return;}F=A("<div/>").hide().addClass(B.resultsClass).css("position","absolute").appendTo(document.body);
E=A("<ul/>").appendTo(F).mouseover(function(T){if(I(T).nodeName&&I(T).nodeName.toUpperCase()=="LI"){D=A("li",E).removeClass(G.ACTIVE).index(I(T));
if(!A(I(T)).children(".placeholder").length){A(I(T)).addClass(G.ACTIVE);}}}).click(function(T){A(I(T)).addClass(G.ACTIVE);
R(T);K.focus();return false;}).mousedown(function(){M.mouseDownOnSelect=true;}).mouseup(function(){M.mouseDownOnSelect=false;
});if(B.width>0){F.css("width",B.width);}N=false;}function I(U){var T=U.target;while(T&&T.tagName!="LI"){T=T.parentNode;
}if(!T){return[];}return T;}function H(V){C.slice(D,D+1).removeClass(G.ACTIVE);Q(V);var U=C.slice(D,D+1);
if(!U.children(".placeholder").length){U.addClass(G.ACTIVE);}if(B.scroll){var T=0;C.slice(0,D).each(function(){T+=this.offsetHeight;
});if((T+U[0].offsetHeight-E.scrollTop())>E[0].clientHeight){E.scrollTop(T+U[0].offsetHeight-E.innerHeight());
}else{if(T<E.scrollTop()){E.scrollTop(T);}}}}function Q(T){D+=T;if(D<0){D=C.size()-1;}else{if(D>=C.size()){D=0;
}}}function O(T){return B.max&&B.max<T?B.max:T;}function P(){E.empty();var U=O(J.length);for(var T=0;
T<U;T++){if(!J[T]){continue;}function Z(b){var a=/[&<>'"]/g;/']/;if(!a.MAP){a.MAP={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;","'":"&#39;"};
}return b.replace(a,function(d){return a.MAP[d];});}var V=Z(L);var W=B.formatItem(J[T].data,T+1,U,J[T].value,V);
if(W===false){continue;}var Y=A("<li/>").html(B.highlight(W,V)).addClass(T%2==0?"ac_even":"ac_odd").appendTo(E)[0];
A.data(Y,"ac_data",J[T]);}C=E.find("li");if(B.selectFirst&&B.minCountForSelect<=C.length){var X=C.slice(0,1);
if(!X.children(".placeholder").length){X.addClass(G.ACTIVE);D=0;}}if(A.fn.bgiframe){E.bgiframe();}}return{display:function(U,T){S();
J=U;L=T;P();},next:function(){H(1);},prev:function(){H(-1);},pageUp:function(){if(D!=0&&D-8<0){H(-D);
}else{H(-8);}},pageDown:function(){if(D!=C.size()-1&&D+8>C.size()){H(C.size()-1-D);}else{H(8);}},hide:function(){F&&F.hide();
C&&C.removeClass(G.ACTIVE);D=-1;},visible:function(){return F&&F.is(":visible");},current:function(){return this.visible()&&(C.filter("."+G.ACTIVE)[0]||B.selectFirst&&C.length>=B.minCountForSelect&&C[0]);
},show:function(U,X){if(U==undefined){var W=A(K).offset();F.css({width:typeof B.width=="string"||B.width>0?B.width:A(K).width(),top:W.top+K.offsetHeight,left:W.left}).show();
}else{F.css({width:typeof B.width=="string"||B.width>0?B.width:"200px",top:X,left:U}).show();}if(B.scroll){E.scrollTop(0);
E.css({maxHeight:B.scrollHeight,overflow:"auto"});if(A.browser.msie&&typeof document.body.style.maxHeight==="undefined"){var T=0;
C.each(function(){T+=this.offsetHeight;});var V=T>B.scrollHeight;E.css("height",V?B.scrollHeight:T);if(!V){C.width(E.width()-parseInt(C.css("padding-left"))-parseInt(C.css("padding-right")));
}}}},selected:function(){var T=C&&C.filter("."+G.ACTIVE).removeClass(G.ACTIVE);var U=A(T).index();return T&&T.length&&{data:A.data(T[0],"ac_data"),pos:U};
},emptyList:function(){E&&E.empty();},unbind:function(){F&&F.remove();}};};A.fn.selection=function(C,D){if(C!==undefined){return this.each(function(){if(this.createTextRange){var J=this.createTextRange();
if(D===undefined||C==D){J.move("character",C);J.select();}else{J.collapse(true);J.moveStart("character",C);
J.moveEnd("character",D);J.select();}}else{if(this.setSelectionRange){this.setSelectionRange(C,D);}else{if(this.selectionStart){this.selectionStart=C;
this.selectionEnd=D;}}}});}var B=this[0];if(B.createTextRange){var F=document.selection.createRange(),I=B.value,H="<->",G=F.text.length;
F.text=H;var E=B.value.indexOf(H);B.value=I;this.selection(E,E+G);return{start:E,end:E+G};}else{if(B.selectionStart!==undefined){return{start:B.selectionStart,end:B.selectionEnd};
}}};})(jQuery);
/*
 * jQuery Color Animations v@VERSION
 * http://jquery.org/
 *
 * Copyright 2011 John Resig
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * Date: @DATE
 */
(function(A,F){var N="backgroundColor borderBottomColor borderLeftColor borderRightColor borderTopColor color outlineColor".split(" "),M=/^([\-+])=\s*(\d+\.?\d*)/,L=[{re:/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,parse:function(O){return[O[1],O[2],O[3],O[4]];
}},{re:/rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,parse:function(O){return[2.55*O[1],2.55*O[2],2.55*O[3],O[4]];
}},{re:/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/,parse:function(O){return[parseInt(O[1],16),parseInt(O[2],16),parseInt(O[3],16)];
}},{re:/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/,parse:function(O){return[parseInt(O[1]+O[1],16),parseInt(O[2]+O[2],16),parseInt(O[3]+O[3],16)];
}},{re:/hsla?\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,space:"hsla",parse:function(O){return[O[1],O[2]/100,O[3]/100,O[4]];
}}],B=A.Color=function(P,Q,O,R){return new A.Color.fn.parse(P,Q,O,R);},D={rgba:{cache:"_rgba",props:{red:{idx:0,type:"byte",empty:true},green:{idx:1,type:"byte",empty:true},blue:{idx:2,type:"byte",empty:true},alpha:{idx:3,type:"percent",def:1}}},hsla:{cache:"_hsla",props:{hue:{idx:0,type:"degrees",empty:true},saturation:{idx:1,type:"percent",empty:true},lightness:{idx:2,type:"percent",empty:true}}}},K={"byte":{floor:true,min:0,max:255},percent:{min:0,max:1},degrees:{mod:360,floor:true}},I=D.rgba.props,J=B.support={},E,C=A.each;
D.hsla.props.alpha=I.alpha;function G(O,Q,R){var P=K[Q.type]||{},S=Q.empty||R;if(S&&O==null){return null;
}if(Q.def&&O==null){return Q.def;}if(P.floor){O=~~O;}else{O=parseFloat(O);}if(O==null||isNaN(O)){return Q.def;
}if(P.mod){O=O%P.mod;return O<0?P.mod+O:O;}return P.min>O?P.min:P.max<O?P.max:O;}B.fn=B.prototype={constructor:B,parse:function(O,R,T,U){if(O===F){this._rgba=[null,null,null,null];
return this;}if(O instanceof A||O.nodeType){O=O instanceof A?O.css(R):A(O).css(R);R=F;}var P=this,S=A.type(O),Q=this._rgba=[],V;
if(R!==F){O=[O,R,T,U];S="array";}if(S==="string"){O=O.toLowerCase();C(L,function(c,X){var b=X.re.exec(O),a=b&&X.parse(b),W,Z=X.space||"rgba",Y=D[Z].cache;
if(a){W=P[Z](a);P[Y]=W[Y];Q=P._rgba=W._rgba;return false;}});if(Q.length!==0){if(Math.max.apply(Math,Q)===0){A.extend(Q,E.transparent);
}return this;}O=E[O]||E._default;return this.parse(O);}if(S==="array"){C(I,function(X,W){Q[W.idx]=G(O[W.idx],W);
});return this;}if(S==="object"){if(O instanceof B){C(D,function(X,W){if(O[W.cache]){P[W.cache]=O[W.cache].slice();
}});}else{C(D,function(X,W){C(W.props,function(Z,a){var Y=W.cache;if(!P[Y]&&W.to){if(O[Z]==null||Z==="alpha"){return;
}P[Y]=W.to(P._rgba);}P[Y][a.idx]=G(O[Z],a,true);});});}return this;}},is:function(R){var Q=B(R),O=true,P=this;
C(D,function(V,S){var T=Q[S.cache],U;if(T){U=P[S.cache]||S.to&&S.to(P._rgba)||[];C(S.props,function(X,W){if(T[W.idx]!=null){O=(T[W.idx]==U[W.idx]);
return O;}});}return O;});return O;},_space:function(){var O=[],P=this;C(D,function(Q,R){if(P[R.cache]){O.push(Q);
}});return O.pop();},transition:function(T,U){var O=B(T),R=O._space(),P=D[R],S=this[P.cache]||P.to(this._rgba),Q=S.slice();
O=O[P.cache];C(P.props,function(a,Y){var Z=Y.idx,V=S[Z],W=O[Z],X=K[Y.type]||{};if(W===null){return;}if(V===null){Q[Z]=W;
}else{if(X.mod){if(W-V>X.mod/2){V+=X.mod;}else{if(V-W>X.mod/2){V-=X.mod;}}}Q[Y.idx]=G((W-V)*U+V,Y);}});
return this[R](Q);},blend:function(R){if(this._rgba[3]===1){return this;}var P=this._rgba.slice(),O=P.pop(),Q=B(R)._rgba;
return B(A.map(P,function(S,T){return(1-O)*Q[T]+O*S;}));},toRgbaString:function(){var P="rgba(",O=A.map(this._rgba,function(Q,R){return Q==null?(R>2?1:0):Q;
});if(O[3]===1){O.pop();P="rgb(";}return P+O.join(",")+")";},toHslaString:function(){var P="hsla(",O=A.map(this.hsla(),function(Q,R){if(Q==null){Q=R>2?1:0;
}if(R&&R<3){Q=Math.round(Q*100)+"%";}return Q;});if(O[3]==1){O.pop();P="hsl(";}return P+O.join(",")+")";
},toHexString:function(P){var O=this._rgba.slice(),Q=O.pop();if(P){O.push(~~(Q*255));}return"#"+A.map(O,function(R,S){R=(R||0).toString(16);
return R.length==1?"0"+R:R;}).join("");},toString:function(){return this._rgba[3]===0?"transparent":this.toRgbaString();
}};B.fn.parse.prototype=B.fn;function H(P,Q,O){O=(O+1)%1;if(O*6<1){return P+(Q-P)*6*O;}if(O*2<1){return Q;
}if(O*3<2){return P+(Q-P)*((2/3)-O)*6;}return P;}D.hsla.to=function(O){if(O[0]==null||O[1]==null||O[2]==null){return[null,null,null,O[3]];
}var P=O[0]/255,S=O[1]/255,V=O[2]/255,Z=O[3],T=Math.max(P,S,V),X=Math.min(P,S,V),U=T-X,Y=T+X,Q=Y*0.5,R,W;
if(X===T){R=0;}else{if(P===T){R=(60*(S-V)/U)+360;}else{if(S===T){R=(60*(V-P)/U)+120;}else{R=(60*(P-S)/U)+240;
}}}if(Q===0||Q===1){W=Q;}else{if(Q<=0.5){W=U/Y;}else{W=U/(2-Y);}}return[Math.round(R)%360,W,Q,Z==null?1:Z];
};D.hsla.from=function(O){if(O[0]==null||O[1]==null||O[2]==null){return[null,null,null,O[3]];}var S=O[0]/360,T=O[1],P=O[2],U=O[3],Q=P<=0.5?P*(1+T):P+T-P*T,R=2*P-Q,V,W,X;
return[Math.round(H(R,Q,S+(1/3))*255),Math.round(H(R,Q,S)*255),Math.round(H(R,Q,S-(1/3))*255),U];};C(D,function(Q,P){var R=P.props,O=P.cache,T=P.to,S=P.from;
B.fn[Q]=function(X){if(T&&!this[O]){this[O]=T(this._rgba);}if(X===F){return this[O].slice();}var W=A.type(X),Y=(W==="array"||W==="object")?X:arguments,U=this[O].slice(),V;
C(R,function(b,Z){var a=Y[W==="object"?b:Z.idx];if(a==null){a=U[Z.idx];}U[Z.idx]=G(a,Z);});if(S){V=B(S(U));
V[O]=U;return V;}else{return B(U);}};C(R,function(U,V){if(B.fn[U]){return;}B.fn[U]=function(W){var Y=A.type(W),b=(U==="alpha"?(this._hsla?"hsla":"rgba"):Q),Z=this[b](),a=Z[V.idx],X;
if(Y==="undefined"){return a;}if(Y==="function"){W=W.call(this,a);Y=A.type(W);}if(W==null&&V.empty){return this;
}if(Y==="string"){X=M.exec(W);if(X){W=a+parseFloat(X[2])*(X[1]==="+"?1:-1);}}Z[V.idx]=W;return this[b](Z);
};});});C(N,function(P,O){A.cssHooks[O]={set:function(T,Q){Q=B(Q);if(!J.rgba&&Q._rgba[3]!==1){var R,S=O==="backgroundColor"?T.parentNode:T;
do{R=A.curCSS(S,"backgroundColor");}while((R===""||R==="transparent")&&(S=S.parentNode)&&S.style);Q=Q.blend(R&&R!=="transparent"?R:"_default");
}Q=Q.toRgbaString();T.style[O]=Q;}};A.fx.step[O]=function(Q){if(!Q.colorInit){Q.start=B(Q.elem,O);Q.end=B(Q.end);
Q.colorInit=true;}A.cssHooks[O].set(Q.elem,Q.start.transition(Q.end,Q.pos));};});A(function(){var P=document.createElement("div"),O=P.style;
O.cssText="background-color:rgba(1,1,1,.5)";J.rgba=O.backgroundColor.indexOf("rgba")>-1;});E=A.Color.names={aqua:"#00ffff",azure:"#f0ffff",beige:"#f5f5dc",black:"#000000",blue:"#0000ff",brown:"#a52a2a",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgrey:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkviolet:"#9400d3",fuchsia:"#ff00ff",gold:"#ffd700",green:"#008000",indigo:"#4b0082",khaki:"#f0e68c",lightblue:"#add8e6",lightcyan:"#e0ffff",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightyellow:"#ffffe0",lime:"#00ff00",magenta:"#ff00ff",maroon:"#800000",navy:"#000080",olive:"#808000",orange:"#ffa500",pink:"#ffc0cb",purple:"#800080",violet:"#800080",red:"#ff0000",silver:"#c0c0c0",white:"#ffffff",yellow:"#ffff00",transparent:[null,null,null,0],_default:"#ffffff"};
})(jQuery);var padautolink=(function(){var A=null;var B={init:function(){var C=$.extend({},$.Autocompleter.defaults,{width:"250px",formatMatch:function(w){return w[1];
},max:10,matchContains:"word",selectFirst:true,scroll:false,data:[],dataPeople:[],dataFiles:[],dataPads:[],dataTags:[]});
var L=null;var P={};var q=5;var N={};var T=null;var D=null;var I=null;var F=null;var O=null;var H=null;
var Y=null;var W=null;var b=pad.getPadId();var h=1000*60*60*1;var d=linestylefilter.REGEX_HASHTAG;var U=new RegExp(/:[-a-zA-Z0-9_+]+:?/g);
var E={AT:"at-linking",ATLESS:"atless-linking",HASHTAG:"hashtag",EMOJI:"emoji"};function M(){if(A&&F){A("finish");
}T=D=I=F=O=null;N={};P={};J.hide();}function R(y,x){var w;padeditor.ace.callWithAce(function(z){w=z.getTextInRange(y,x);
});return w;}function r(w,y){if($.browser.mozilla){var x=[w[0],w[1]+y.length];padeditor.ace.replaceRange(x,x," ");
}}function K(w,x,z,AA,y){if(y){var AB=R(w,x);if(AB!=y){return;}}padeditor.ace.replaceRange(w,x,z,AA);
r(w,z);}function V(w){$.ajax({mode:"abort",port:"preloadContacts",dataType:C.dataType,url:"/ep/invite/prefixes",data:{padid:b,excludefacebook:true},success:function(z){L=z.data;
var y=new Date().getTime();var x={timestamp:y,prefixDict:L};prefixDictJSON=JSON.stringify(x);if(localStorage){localStorage.setItem(w,prefixDictJSON);
}}});}function s(){var AB=clientVars.encryptedUserId;var w="tencent.user."+AB+".contactsPrefixes";var y=localStorage?localStorage.getItem(w):null;
if(y){var x=JSON.parse(y);L=x.prefixDict;var AA=x.timestamp;var z=new Date().getTime();if(z-AA>h){V(w);
}}else{V(w);}}function m(x,y){var y;if(y==undefined){var y=4;}var w=x;if(x.length>y){w=x.substr(0,y);
}w=w.split(" ")[0];return w;}function Q(w,AC){if(typeof w=="undefined"&&typeof AC=="undefined"||w.data==null){var AG=J.current();
w=$.data(AG,"ac_data");AC=$(AG).index();}if(!w.data[1]){return;}var x="padlink";var AA="";var AI={selectedIndex:AC};
if(w.data[2]=="dropbox"){x="dropboxlink";}else{if(w.data[2]=="__AUTOCREATE__"){x="newpad";}else{if(w.data[2].indexOf("/ep/profile")==0){x="mention";
AA="hp";}else{if(w.data[3]=="email"){x="mention";AA="google";}else{if(w.data[3]=="hashtag"){x="hashtag";
AA=w.data[1];}else{if(w.data[3]=="emoji"){x="emoji";AA=w.data[1];}}}}}}trackEvent("autocompleted",x,AA,AI);
if(w.data[3]=="emoji"){var AJ=w.data[1];K(D,I,":"+AJ+": ");}else{if(w.data[3]=="hashtag"){var AE=w.data[1];
var AK="/ep/search/search?q="+encodeURIComponent(AE);K(D,I,AE,[["link",AK]]);}else{if(w.data[2]=="dropbox"){var y=D;
var z=I;var AB=w.data[1];var AH=("/ep/dropbox/redirect2?uid="+clientVars.encryptedUserId+"&path="+encodeURIComponent(AB));
K(y,z,AB,[["link",AH]]);}else{if(w.data[2]=="__AUTOCREATE__"){var AD=w.data[1];var AM=AD.replace(/ /g,"-");
var y=D;var z=I;var AF=R(y,z);$.post("/ep/pad/ajax_create",{title:AD,content:"",sourcePadId:pad.getPadId()},function(AN){var AP="/"+AN;
var AO=w.data[1];K(y,z,AO,[["link",AP]],AF);});}else{if(w.data[3]=="email"){var AD=w.data[1];var AM=AD.replace(/ /g,"-");
var y=D;var z=I;var AF=R(y,z);$.post("/ep/pad/emailinvite",{padId:pad.getPadId(),toAddress:w.data[2]},function(AN){var AP=w.data[1].replace(/<.*>/g,"");
var AO=$.trim(AP);K(y,z,AO,[["link",AN]],AF);});}else{var AL=w.data[1].replace(/<.*>/g,"");var AB=$.trim(AL);
K(D,I,AB,[["link",w.data[2]]]);}}}}}M();}B.finish=Q;function a(AA,x,y,AC,AB){J.display(x,AA);if(A){A("autocomplete",x);
}else{var z=$("#editor").offset();var w={x:AB.x+z.left,y:AB.y+z.top};if(!D||y[0]!=D[0]||y[1]!=D[1]||!O||w.y!=O.y){J.show(w.x+"px",w.y+"px");
}}T=AA;D=y;I=AC;F=x&&x.length>0;O=w;}var J=$.Autocompleter.Select(C,padeditor.ace,Q,{});var G=$.Autocompleter.Cache(C);
s();function u(w){return"/ep/search/?q="+encodeURIComponent(w);}function g(w){if(!w.success||!w.data){return;
}w=w.data;var z=[];for(var x in w){var AB=u(x);var y=[x,x,AB,"hashtag"];y[0]='<div style="white-space: nowrap;  overflow: hidden; text-overflow: ellipsis;">'+y[0]+"</div>";
z.push(y);}var AA={};$.each(C.dataTags,function(AD,AC){AA[AC[0]]=true;});$.each(z,function(AD,AC){if(!AA[AC[0]]){C.dataTags.push(AC);
}});C.data=C.dataTags;G.populate();}function j(AC){var AA=[];for(var w=0;w<AC.length;++w){var y=AC[w];
var z=[y,y,"","emoji"];z[0]='<div style="white-space: nowrap;  overflow: hidden; text-overflow: ellipsis;"><span class="emoji-glyph" style="background-image:url('+clientVars.cdn+"/static/img/emoji/"+y+'.png)"></span>'+z[0]+"</div>";
AA.push(z);}var AB={};$.each(C.dataTags,function(AD,x){AB[x[0]]=true;});$.each(AA,function(AD,x){if(!AB[x[0]]){C.dataTags.push(x);
}});C.data=C.dataTags;G.populate();}function o(x,AD){if(!x.success||!x.data){return;}x=x.data;var AA={hp:"<img src='/static/favicon.png' style='float: left; padding-right: 4px;' width='16' height='16'/>"};
var AC=x.split("\n");var z=[];for(var y=0;y<AC.length;y++){var w=$.trim(AC[y]);if(w){w=w.split("|");if(w[2] in AA){w=[AA[w[2]]+w[0]].concat(w);
w[0]='<div style="white-space: nowrap;  overflow: hidden; text-overflow: ellipsis;">'+w[0]+"</div>";}z.push(w);
}}var AB={};$.each(C.dataPeople,function(AF,AE){AB[AE[0]]=true;});$.each(z,function(AF,AE){if(!AB[AE[0]]){C.dataPeople.push(AE);
}});C.data=C.dataPeople;if(AD==E.AT){C.data=C.data.concat(C.dataPads).concat(C.dataFiles);}G.populate();
}function n(AA,z){var y=[];var w=JSON.parse(AA);N[z]=w.length;for(var x=0;x<w.length;x++){y.push(["<img src='/static/img/dropbox.png' style='float: left; padding-right: 4px;' width='16' height='16'/>"+w[x].path,w[x].path,"dropbox"]);
}C.dataFiles=y;C.data=C.dataPeople.concat(C.dataPads).concat(C.dataFiles);G.populate();}function S(x){if(H){var w=H.query;
if(w&&x.indexOf(w)==0){var z=H.ajaxResults||H.numResults>0;if(z){var y=G.load(x.toLowerCase())||[];if(y.length==0){return true;
}}}}return false;}function X(w){d.lastIndex=0;return w=="#"||d.test(w);}function Z(w){U.lastIndex=0;return w==":"||U.test(w);
}function p(w,z){var y=w.data[1].toLowerCase();var x=y.indexOf(z);var AA=-x;w.score=AA;}function c(x){var w=x.data[3];
return(w=="hp"||w=="email"||w=="fb");}function l(w,x){w.forEach(function(y){p(y,x);});w.sort(function(z,y){var AC=c(z);
var AD=c(y);if(AC||AD){if(!AD){return -1;}if(!AC){return 1;}}if(z.score>y.score){return -1;}if(z.score<y.score){return 1;
}if(z.data[3]=="hp"&&y.data[3]!="hp"){return -1;}if(z.data[3]!="hp"&&y.data[3]=="hp"){return 1;}var AB=z.data[4]?parseInt(z.data[4]):null;
var AA=y.data[4]?parseInt(y.data[4]):null;if(AB||AA){if(!AA){return -1;}if(!AB){return 1;}if(AB>AA){return -1;
}if(AB<AA){return 1;}}var AF=z.data[1].toLowerCase();var AE=y.data[1].toLowerCase();return AF.localeCompare(AE);
});return w;}function v(w,x){if(!w){return false;}if(w[0]=="@"){return true;}if(X(w)||Z(w)){if(S(w.substr(1))){D=null;
return false;}D=x;return true;}var y=m(w);if(L){var z=y.length>3&&L[y];if(z){if(S(w)){D=null;return false;
}D=x;return true;}else{D=null;return false;}}if(w.length>3&&w[0].toUpperCase()==w[0]){if(S(w)){D=null;
return false;}D=x;return true;}return false;}function f(w,z,AB,AC,AA){if(!w||z=="cancel"||!AA){M();return F;
}var x;var AE;switch(w[0]){case"@":x=E.AT;AE="Link to Tencent Docs and People";break;case"#":x=E.HASHTAG;
if(!X(w)){M();return F;}break;case":":x=E.EMOJI;if(!Z(w)){M();return F;}break;default:x=E.ATLESS;}var AD=pad.getPadOptions().guestPolicy;
if((x!=Y)||(AD!=W)){G.flush();P={};}Y=x;W=AD;if(x==E.AT&&w.length==1){var AF=[{data:["<span style='font-style: italic; color: grey;' class='placeholder'>"+AE+"</span>"],result:null,value:null}];
a(w,AF,AB,AC,AA);return F;}if(x!=E.ATLESS){w=w.substr(1);}if(w==T){if(z=="up"){J.prev();return F;}else{if(z=="down"){J.next();
return F;}else{if(z=="enter"){if(A){M();return F;}var AH=F;Q();return AH;}}}}function y(AK){var AL=padutils.escapeHtml(AK);
var AJ=G.load(AK.toLowerCase())||[];if(x!=E.HASHTAG&&x!=E.EMOJI){AJ=l(AJ,AK.toLowerCase());}if(x==E.AT){AJ=AJ.slice(0,C.max-1);
AJ.push({data:["<span style='font-style: italic;'>Create pad "+AL+"</span>",AK,"__AUTOCREATE__"],result:null,value:null});
}if(AJ.length){a(AK,AJ,AB,AC,AA);}H={query:AK,numResults:AJ.length};}y(w);if(P[w.toLowerCase()]){return F;
}if(x==E.HASHTAG){$.ajax({mode:"abort",port:"autocompletehashtag",dataType:C.dataType,url:"/ep/search/hashtags",data:{q:w.toLowerCase()},success:function(AJ){if(D==null){return;
}g(AJ);y(w);H.ajaxResults=true;}});}else{if(x==E.EMOJI){if(D==null){return;}j(linestylefilter.EMOJI_LIST);
y(w);H.ajaxResults=true;}else{$.ajax({mode:"abort",port:"autocompletemention",dataType:C.dataType,url:"/ep/invite/autocomplete",data:{padid:b,ismention:true,userlink:true,q:w.toLowerCase(),limit:C.max-1,excludefacebook:true,isatless:(x==E.ATLESS)},success:function(AJ){if(D==null){return;
}o(AJ,x);y(w);H.ajaxResults=true;}});}}if(x==E.AT){function AG(AJ){AJ=AJ&&AJ.data;if(!AJ||!AJ.length){return;
}AJ=AJ.split("\n");var AM=[];for(var AK=0;AK<AJ.length;AK++){var AL=AJ[AK].split("|");AM.push([AL[0],AL[0],"/"+AL[1]]);
}C.dataPads=AM;C.data=C.dataPeople.concat(C.dataPads).concat(C.dataFiles);G.populate();}$.ajax({mode:"abort",port:"searchautocomplete",dataType:C.dataType,url:"/ep/search/autocomplete",data:{userlink:true,q:w.toLowerCase(),limit:C.max-1},success:function(AJ){if(D==null){return;
}AG(AJ);y(w);}});if(clientVars.dropboxConnected&&false){var AI=N[w.toLowerCase()]&&N[w.toLowerCase()]<q;
if(!AI){$.ajax({mode:"abort",port:"autocompletedropbox",url:"/ep/dropbox/files",data:{q:w.toLowerCase()},success:function(AJ){if(D==null){return;
}n(AJ,w.toLowerCase());y(w);}});}}}P[w.toLowerCase()]=true;return F;}padeditor.ace.setTriggerLink(v);
padeditor.ace.setAutocompleteCallback(f);},setAutocompleteHandler:function(C){A=C;}};return B;}());padcollections=(function(){var F;
var C;var D;var E;var G=false;function J(){C.on("click",".group-link",function(Q){return;});F.on("click",".group-link .remove-group-btn",function(Q){L($(Q.target));
return false;});$("#add-to-collection").click(function(){$("#collection-picker").val("").focus();A(true);
trackEvent("collection.add_from_pad");});var P=false;$("#collection-picker").focus(function(Q){$("#collections-div").addClass("sticky");
}).click(function(Q){$("#collections-div").addClass("sticky");return false;});$("#collection-picker").blur(function(Q){if(!P){A(false);
$("#collections-div").removeClass("sticky");}});$("#collection-invite-list-item").on("click",function(){return false;
});E.on("mousedown",".add-group",function(R){P=true;var Q=R.target;$(window).one("mouseup",function(S){P=false;
if(S.target==Q){O($(Q));var T={selectedIndex:$(Q).index()};trackEvent("collection.add_from_list","","",T);
}else{A(false);}});});}function B(P){alert(P);}function O(Q){var P=Q;var R=P.attr("groupId");var S=pad.getPadId();
$.ajax({type:"post",url:"/ep/group/add-pad",data:{padId:pad.getPadId(),groupId:R},success:function(T){if(T.success){A(false);
P.remove();if(!E.find(".add-group").length){$("#collections-recent-label").hide();}}else{B(T.message);
}}}).fail(function(T,U){B("An error has occurred. We're looking into it.");});}function L(Q){var P=Q.parents(".group-link");
var R=P.attr("groupId");var S=pad.getPadId();$.ajax({type:"post",url:"/ep/group/removepad",data:{padId:pad.getPadId(),groupId:R},success:function(T){if(T.success){P.remove();
}else{B(T.error);}}}).fail(function(T,U){B("An error has occurred. Please contact support if this error persists.");
});}function A(P){return;if(P){$("#add-to-collection").hide();$("#collection-picker-div").fadeIn(100);
$("#collection-picker").focus();}else{$("#collection-picker-div").fadeOut(150,function(){$("#add-to-collection").show();
});}}function H(){return clientVars.invitedGroupInfos.map(function(P){return P.groupId;}).join(",");}function K(){$("#collection-picker").invite({target:"Pad",minChars:0,createCollection:true,width:263,inviteItemHandlers:{hpgroup:{url:"/ep/group/add-pad",argsCallback:function(P){return{padId:pad.getPadId(),groupId:P[2]};
},onSuccess:function(){A(false);trackEvent("collection.add_autocompleted");},onFailure:function(P){B(P.message);
}},newgroup:{url:"/ep/group/create-with-pad",argsCallback:function(P){A(false);return{padId:pad.getPadId(),groupName:P[1]};
},onSuccess:function(){A(false);trackEvent("collection.create_with_pad");},onFailure:function(P){B(P.error);
trackEvent("collection.duplicate_alert");}}},dataURL:"/ep/invite/group_autocomplete",prompt:"Enter a collection name",noCache:true,extraParams:{excludeIds:H()}});
}function N(){D.toggle();}function I(){return;$.ajax({type:"get",url:"/ep/invite/recent-groups",data:{excludeIds:H()},success:function(Q){if(Q.success){var P=Q.html.replace(/^\s+|\s+$/g,"");
$("#collections-recent-list").empty().append(P);if($(P).length){$("#collections-recent-label").show();
}}}});}var M={init:function(Q){if(G){return;}var P=$.extend({$collectionsDivEl:$("#collections-div"),$collectionsListEl:$("#collection-list-div"),$collectionsListOverflowEl:$("#collection-list-overflow"),$recentCollectionsEl:$("#collections-recent-list-wrapper")},Q);
F=P.$collectionsDivEl;C=P.$collectionsListEl;D=P.$collectionsListOverflowEl;E=P.$recentCollectionsEl;
J();K();I();G=true;},renderPadCollections:function(){F.find("div.group-link").remove();for(var P=0;P<clientVars.invitedGroupInfos.length;
P++){var Q=clientVars.invitedGroupInfos[P];var R=$("<div/>").addClass("group-link").attr("groupId",Q.groupId);
var T=$("<a/>").attr("href","/ep/group/"+Q.groupId).attr("title",Q.name).append(Q.name).appendTo(R);var S=$("<div/>").addClass("remove-group-btn").attr("title","Remove this pad from this collection.").append($('<i class="icon-x">')).appendTo(R);
if(P==2){C.append($("<div>").addClass("group-link").addClass("group-link-overflow").append($("<a>").on("click",N).text("...")));
}if(P>1){D.append(R);}else{C.append(R);}}$("#add-to-collection").toggleClass("no-collections",clientVars.invitedGroupInfos.length==0);
buttonCloseMenu($("#add-to-collection"));},loadCandidateCollections:I};return M;})();
/*
 * Copyright 2009 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS-IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var padconnectionstatus=(function(){var A={what:"connecting"};
var C;var B={init:function(){$(".reconnect").click(function(){return pad.forceReconnect();});$(".refresh").click(function(){window.location.reload(true);
});$("#connectionbox .dialog-cancel-x").on("click",function(){$("#modaloverlay").hide();$("#connectionbox").addClass("compact");
$(".connection-status").hide();});$("#freakout-copy-first").on("click",function(){$("#modaloverlay").hide();
$("#freakout-dialog").addClass("compact");$("#freakout-copy-first").hide();$(".connection-status").hide();
});},connected:function(){B.clearReconnectTimer();A={what:"connected"};$("#connectionbox").removeClass("compact");
$(".connection-status").hide();$("#modaloverlay").hide();$("#connectionbox").hide();if(!clientVars.isMobile&&window.isTimApp){try{external.setNetworkEnable("1");
}catch(D){console.log("setNetworkEnable fail");}}},reconnecting:function(){B.clearReconnectTimer();A={what:"reconnecting"};
C=setTimeout(function(){padmodals.showModal("#connectionbox",500,true);record_change.onDisconnect();if(!clientVars.isMobile&&window.isTimApp){try{external.setNetworkEnable("0");
}catch(D){console.log("setNetworkEnable fail");}}},30000);},disconnected:function(E){B.clearReconnectTimer();
A={what:"disconnected",why:E};var D=String(E).toLowerCase();if(!(D=="userdup"||D=="looping"||D=="slowcommit"||D=="initsocketfail"||D=="unauth")){D="unknown";
}var F="modaldialog cboxdisconnected cboxdisconnected_"+D;$("#connectionbox").get(0).className=F;if(!clientVars.isMobile&&window.isTimApp){try{external.setNetworkEnable("0");
}catch(G){console.log("setNetworkEnable fail");}}padmodals.showModal("#connectionbox",500,true);record_change.onDisconnect();
},isFullyConnected:function(){return A.what=="connected";},getStatus:function(){return A;},clearReconnectTimer:function(){clearTimeout(C);
C=null;}};return B;}());var padinputbox={};padinputbox.box=function(){var B={coords:{row:0,col:0}},H=null,E;
var C={row:0,col:0};var I=clientVars.collab_client_vars.rev;var D=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"];
var A={isInputFocuse:false,init:function(){window.isExistIOSWebview=false;window.SupportAdvancedFeature={sheetnativekeyboard:0,setWebviewNaviTitle:0,enableScrollView:0,setSharedDocNativeKeyboardEnable:0,setSharedDocNativeKeyboardActive:0,setKeyboardHeight:0,sharedDocSheetCommitCellValue:0,docnativekeyboarduploadimage:0};
A.bindEvents();if(!clientVars.isMobile&&$("#padeditor").hasClass("sheet-style")){$("#inputboxwithpc").show();
$(".cell-input").on("keydown",function(K){if(K.keyCode==13){K.preventDefault();if(K.altKey){var J=F(this),L=this.value;
var M=L.slice(0,J).split("\n").length;console.log(M);var N=$(this).css("line-height");var P=M*parseInt(N);
var O=L.slice(0,J)+"\n"+L.slice(J);this.value=O;G(this,J+1);$(this).scrollTop(P);}else{A.coordDataToSheet();
return;}}});$(".cell-input").on("keyup",function(K){var J=this.value;J=J.replace(/ /g,String.fromCharCode(160));
$("td.current",window.frames.sheet.document).text(J);$(".handsontableInput",window.frames.sheet.document).val(J);
});$(".cell-input").blur(function(){A.isInputFocuse=false;A.coordDataToSheet();});$(".cell-input").focus(function(){A.isInputFocuse=true;
top.setAutoSaveTips();});$(window).on("TextEditorFocus",function(J){top.setAutoSaveTips();});$(window).on("SheetMouseDown",function(J){if(A.isInputFocuse){$(".cell-input").blur();
}});$("#editor").css("padding-top",73);}if(clientVars.isMobile){mqq.invoke("ui","detectSharedDocAdvancedFeature",{},function(J){window.SupportAdvancedFeature.sheetnativekeyboard=!!parseInt(J.sheetnativekeyboard);
window.SupportAdvancedFeature.setWebviewNaviTitle=!!parseInt(J.setWebviewNaviTitle);window.SupportAdvancedFeature.enableScrollView=!!parseInt(J.enableScrollView);
window.SupportAdvancedFeature.setSharedDocNativeKeyboardEnable=!!parseInt(J.setSharedDocNativeKeyboardEnable);
window.SupportAdvancedFeature.setSharedDocNativeKeyboardActive=!!parseInt(J.setSharedDocNativeKeyboardActive);
window.SupportAdvancedFeature.setKeyboardHeight=!!parseInt(J.setKeyboardHeight);window.SupportAdvancedFeature.sharedDocSheetCommitCellValue=!!parseInt(J.sharedDocSheetCommitCellValue);
window.SupportAdvancedFeature.docnativekeyboarduploadimage=!!parseInt(J.docnativekeyboarduploadimage);
var K="detectSharedDocAdvancedFeatureFinished";var L="setDefaultCellValue";A.distribute(K);});}window.setCellValue=function(J){window.isExistIOSWebview=true;
if(J.row&&J.col){window.sheetNode.setDataAtCell(J.row,J.col,J.value);}else{var M=window.sheetNode.getHotInstance();
var K=M.getActiveEditor();if(K){if(K.exsitEditor){window.sheetNode.setDataAtCell(K.row,K.col,J.value);
}}else{var L=M.getSelected();window.sheetNode.setDataAtCell(L[0],L[1],J.value);}}};},setcell:function(J){H=B;
B=J;var K=A.numToCol(B.coords.col);$(".cell-head").text(K+(B.coords.row+1));},setvalue:function(J){E=J;
},coordDataToSheet:function(){if(B.coords.row<0||B.coords.col<0){return;}var L=[B.coords.row,B.coords.col,E,$(".cell-input").val()];
var J=[L];var K=window.sheetNode;K.handleChange(J,"edit");},setFirstCellValue:function(J){$(".cell-input").val(J);
},numToCol:function(J){var K="";for(var L=0;L<Math.ceil((J+1)/26);L++){if(Math.ceil((J+1)/26)>1){if(L==Math.ceil((J+1)/26)-1){K+=D[J%26];
}else{K+=D[L];}}else{K=D[J%26];}}return K;},setCoordToIOS:function(){if(!window.SupportAdvancedFeature.sheetnativekeyboard){return;
}var L=window.sheetNode.getHotInstance();var K=L.getSelected();if(!K){return;}var J=L.getValue();var N=A.numToCol(K[1]);
if(!J){J="";}var M={placeholder:N+(K[0]+1),value:J};mqq.invoke("ui","setSharedDocInputBarCellValue",M,function(){});
},activeKeyBorad:function(M,J){if(window.gEditable&&(UA_Util.MTIMLargerOrEqual("1.0.2"))){J=J||M.target;
var K=new SheetLinkBubble();if($(J).hasClass("current")&&!K.curCellIsTemplateLink()){var L={active:1};
mqq.invoke("ui","setSharedDocNativeKeyboardEnable",{enable:1},function(){});mqq.invoke("ui","setSharedDocNativeKeyboardActive",L,function(){});
}else{if(K.curCellIsTemplateLink()){var L={active:0};mqq.invoke("ui","setSharedDocNativeKeyboardActive",L,function(){});
mqq.invoke("ui","setSharedDocNativeKeyboardEnable",{enable:0},function(){});}}}},setOldCoords:function(J){if(J){C=J;
}},setValueToOldCoords:function(M){if(UA_Util.MTIMLargerOrEqual("1.0.2")||UA_Util.MQQLargerOrEqual("6.7.0")){var L=window.sheetNode.getHotInstance();
var J=L.getActiveEditor();if(J){if(!J.exsitEditor){return;}C.row=J.row;C.col=J.col;}var K=L.getSelected();
if(C.row==K[0]&&C.col==K[1]){return;}mqq.invoke("ui","sharedDocSheetCommitCellValue",C,function(){});
}},bindEvents:function(){$(window).bind("setDefaultCellValue",function(J){A.setCoordToIOS();});},distribute:function(J){pad_compatible.padDispatchEvent(window,J);
}};function F(J){if(J.selectionStart){return J.selectionStart;}else{if(document.selection){J.focus();
var L=document.selection.createRange();if(L==null){return 0;}var K=J.createTextRange();var M=K.duplicate();
K.moveToBookmark(L.getBookmark());M.setEndPoint("EndToStart",K);return M.text.length;}}return 0;}function G(J,M,K){if(K===void 0){K=M;
}if(J.setSelectionRange){J.focus();try{J.setSelectionRange(M,K);}catch(P){var N=J.parentNode;var O=N.style.display;
N.style.display="block";J.setSelectionRange(M,K);N.style.display=O;}}else{if(J.createTextRange){var L=J.createTextRange();
L.collapse(true);L.moveEnd("character",K);L.moveStart("character",M);L.select();}}}return A;};var attrNameToOrder={bold:"bold",italic:"italic",underline:"underline",strikethrough:"strikethrough",color:"foreColor",subscript:"subscript",superscript:"superscript",};
attrNameToOrder["background-color"]="backColor";attrNameToOrder["font-size"]="fontSize";attrNameToOrder["font-family"]="fontName";
var fontSizeToOrder={1:"10pt",2:"12pt",3:"14pt",4:"16pt",5:"18pt",6:"24pt",7:"30pt",8:"36pt"};var docContentAttr={bold:true,italic:true,underline:true,strikethrough:true,subscript:true,superscript:true,};
docContentAttr["font-family"]=["Microsoft YaHei","STFangsong","STKaiti","STSong","Arial","Comic Sans MS","Courier New","Georgia","Impact","Times New Roman","Trebuchet MS","Verdana"];
docContentAttr["font-size"]=["10pt","12pt","14pt","16pt","18pt","24pt","30pt","36pt"];docContentAttr["background-color"]=["#ffffff"];
docContentAttr.color=["#000000"];docContentAttr["text-align"]=["left","right","center"];var attrQueue=(function(){var A=[];
function G(H){H&&A.push(H);}function C(H,I){A.splice(H,I);}function B(){A=[];}function E(){return A.length;
}function F(J){for(var H=this.size()-1;H>=0;H--){if(A[H]){var I=A[H].split("&");if(I[0]&&(I[0]==J)){return I[1];
}}}return null;}function D(J){for(var H=this.size()-1;H>=0;H--){if(A[H]){var I=A[H].split("&");if(I[0]&&(I[0]==J)){this.remove(H,1);
break;}}}}return{add:G,remove:C,clear:B,size:E,reverseList:F,recycleAttr:D,};}());$.cookie={get:function(B){var A=document.cookie.match(new RegExp("(^| )"+B+"=([^;]*)(;|$)"));
return !A?"":decodeURIComponent(A[2]);},set:function(E,F,C,D,B){var A=new Date();A.setTime(A.getTime()+(B?3600000*B:30*24*60*60*1000));
document.cookie=E+"="+F+"; expires="+A.toGMTString()+"; path="+(D?D:"/")+"; "+(C?("domain="+C+";"):"");
},del:function(C,A,B){document.cookie=C+"=; expires=Mon, 26 Jul 1997 05:00:00 GMT; path="+(B?B:"/")+"; "+(A?("domain="+A+";"):"");
},clear:function(){var A=document.cookie.match(new RegExp("([^ ;][^;]*)(?=(=[^;]*)(;|$))","gi"));for(var B in A){document.cookie=A[B]+"=;expires=Mon, 26 Jul 1997 05:00:00 GMT; path=/; ";
}},uin:function(){var A=$.cookie.get("uin");return !A?null:parseInt(A.substring(1,A.length),10);}};var userAgent=navigator.userAgent.toLowerCase();
$.getPlatform=function(){if(/(android)/.test(userAgent)){return"4";}else{if(/(iphone|ipad|ipod)/.test(userAgent)){return"5";
}}if(/(windows phone)/.test(userAgent)){return"6";}else{if(/(win)/.test(userAgent)){return"8";}else{if(/(mac)/.test(userAgent)){return"9";
}else{return"7";}}}};$.getClientAppType=function(){var A=$.getPlatform();if("4"==A||"5"==A){if($.genMTIMVer()>0){return"1";
}else{if($.genMQQVer()>0){return"2";}}}return"0";};$.report=function(A){var F="";if(A.stringext_1!=null&&A.stringext_1!=undefined){F=A.stringext_1;
}var C=window.location.host;C=C.slice(0,C.indexOf("."));var E="";try{if(clientVars!=undefined&&clientVars.padId!=undefined){E=clientVars.padId;
}}catch(G){}var D=0;if($("#padbody").find(".sheet-style").length){D=2;}else{D=1;}var B={shareType:A.shareType||"0",actType:A.act_type||"0",actResult:A.actResult||"0",actExtent:A.actExtent||"0",platform:A.platform||$.getPlatform()||"0",intext_2:A.intext_2||A.RESERVED_DOCTYPE||D||"0",intext_3:A.intext_3||A.RESERVED_INT_1||"0",intext_4:A.intext_4||"0",intext_5:A.intext_5||$.getClientAppType()||"0",stringext_1:F,stringext_2:E,stringext_3:C};
$.ajax({type:"POST",dataType:"json",url:"/cgi-bin/appstage/mstats_batch_report",data:'--3i2ndDfv2rTHiSisAbouNdArYfORhtTPEefj3q2f\r\nContent-Disposition: form-data; name="data"\r\n\r\n'+JSON.stringify({data:[{via:"2",platform:B.platform+"",to_type:"2",report_type:"101",login_status:"1",uin:$.cookie.get("tim_uin").replace(/o/g,"")||$.cookie.get("p_uin").replace(/o/g,""),type:B.shareType+"",act_type:B.actType+"",result:B.actResult+"",intext_1:B.actExtent+"",intext_2:B.intext_2+"",intext_3:B.intext_3+"",intext_4:B.intext_4+"",intext_5:B.intext_5+"",stringext_1:B.stringext_1+"",stringext_2:B.stringext_2+"",stringext_3:B.stringext_3+""}]})+'\r\nContent-Disposition: form-data; name="method"\r\n\r\nPOST\r\n--3i2ndDfv2rTHiSisAbouNdArYfORhtTPEefj3q2f--\r\n',beforeSend:function(H){H.setRequestHeader("Content-Type","multipart/form-data; boundary=3i2ndDfv2rTHiSisAbouNdArYfORhtTPEefj3q2f");
},success:function(H){}});};var agent=navigator.userAgent;$.getVersion=function(){if(!agent){return null;
}if(UA_Util.MQQLargerOrEqual("6.7.0")){return true;}if(UA_Util.MTIMLargerOrEqual("1.0.2")){return true;
}return false;};$.getAgent={isMobile:function(){return/(mobile)/.test(userAgent);},isAndroid:function(){return/(android)/.test(userAgent);
},isIOS:function(){return/(iphone|ipad|ipod)/.test(userAgent);}};$.getType=function(){if($("#padbody").find(".sheet-style").length){return"excel";
}else{return"word";}};Array.prototype.contains=function(C){var B=this.length;for(var A=0;A<B;A++){if(this[A]==C){return true;
}}return false;};$.getObjAttribute=function(A){var C=[];if(A){for(var B in A){if(B&&A[B]){C.push(B);}}return C;
}else{return null;}};$.attrNameTurnOrder=function(A){return A&&attrNameToOrder[A];};$.setCursorPosition=function(C,D){var A=document.createRange();
A.setStart(C,D);A.setEnd(C,D);var B=window.getSelection();B.removeAllRanges();B.addRange(A);};$.isMobilePhone=function(){var A=$.getPlatform();
if(A==4||A==5||A==6){return true;}else{return false;}};$.genMTIMVer=function(){if($.getAgent.isMobile()){var B=new RegExp("TIM[0-9].{1}[0-9]/{1}[0-9].{1}[0-9].{1}[0-9]","i");
var A=B.exec(userAgent);if(!A||!A[0]){return 0;}var C=B.exec(userAgent)[0];return versionToNum(C.split("/")[1]);
}return 0;};$.genMQQVer=function(){if($.getAgent.isMobile()&&(userAgent.indexOf("TIM")==-1)&&(userAgent.indexOf("tim")==-1)){var C=new RegExp("QQ/{1}[0-9].{1}[0-9].{1}[0-9]","i");
var A=C.exec(userAgent);if(!A||!A[0]){return 0;}var B=A[0];return versionToNum(B.split("/")[1]);}return 0;
};$.bom={query:function(B){var A=window.location.search.match(new RegExp("(\\?|&)"+B+"=([^&]*)(&|$)"));
return !A?"":decodeURIComponent(A[2]);},getHash:function(B){var A=window.location.hash.match(new RegExp("(#|&)"+B+"=([^&]*)(&|$)"));
return !A?"":decodeURIComponent(A[2]);}};$.showSupportPage=function(){if(window.isMac){window.open("http://support.qq.com/write.shtml?fid=1212&ADPUBNO=");
}else{window.open("http://support.qq.com/write.shtml?fid=1207&ADPUBNO=");}};Date.prototype.Format=function(A){var C={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};
if(/(y+)/.test(A)){A=A.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length));}for(var B in C){if(new RegExp("("+B+")").test(A)){A=A.replace(RegExp.$1,(RegExp.$1.length==1)?(C[B]):(("00"+C[B]).substr((""+C[B]).length)));
}}return A;};var formatDate=new Date();$.localstringFromTime=function(A){formatDate.setTime(A);return formatDate.Format("yyyy/MM/dd hh:mm:ss");
};function versionToNum(C){var A=C.split(".");var B=0;if(A.length>=1){B=parseInt(A[0])*10000;if(A.length>=2){B+=parseInt(A[1])*100;
if(A.length>=3){B+=parseInt(A[2]);}}}return B;}UA_Util=(function(){var E=navigator.userAgent;var B=0;
var A=0;function C(H){var F=H.split(".");var G=0;if(F.length>=1){G=parseInt(F[0])*10000;if(F.length>=2){G+=parseInt(F[1])*100;
if(F.length>=3){G+=parseInt(F[2]);}}}return G;}var D={init:function(){A=$.genMTIMVer();B=$.genMQQVer();
},MQQLargerOrEqual:function(F){return B==0?false:B>=(C(F));},MTIMLargerOrEqual:function(F){return A==0?false:A>=(C(F));
}};return D;}());UA_Util.init();jQuery.cachedScript=function(B,A){A=$.extend(A||{},{dataType:"script",cache:true,url:B});
return jQuery.ajax(A);};$.monitorLazyReport=function(A,B){setTimeout(function(){$.monitorReport(A,B);
},0);};$.monitorReport=function(B,H){if(typeof B!="object"){return;}var C={flag1:21558,flag2:1,flag3:H};
for(var F in B){C[F]=B[F];}var I=$.stringifyFormat(C);var D,E,A;A=$.getMonitorDevicePlatform();D=A[0];
E=A[1];var G={appid:20201,speedparams:I,device:D,platform:E};$.ajax({url:"//report.huatuo.qq.com/report.cgi",type:"GET",dataType:"jsonp",data:G});
};var _monitorDevicePlatform=null;$.getMonitorDevicePlatform=function(){if(_monitorDevicePlatform){return _monitorDevicePlatform;
}if(/(android)/.test(userAgent)){_monitorDevicePlatform=["android","android"];}else{if(/(iphone)/.test(userAgent)){_monitorDevicePlatform=["iphone","ios"];
}else{if(/(ipad)/.test(userAgent)){_monitorDevicePlatform=["ipad","ios"];}else{if(/(ipod)/.test(userAgent)){_monitorDevicePlatform=["ipod","ios"];
}else{if(/(windows phone)/.test(userAgent)){_monitorDevicePlatform=["windows phone","unknown"];}else{if(/(win)/.test(userAgent)){_monitorDevicePlatform=["pc","pc"];
}else{if(/(mac)/.test(userAgent)){_monitorDevicePlatform=["mac","pc"];}else{_monitorDevicePlatform=["unknown","unknown"];
}}}}}}}return _monitorDevicePlatform;};$.stringifyFormat=function(C,D,A){if(typeof C!="object"){return;
}var B="";if(!D){D="=";}if(!A){A="&";}var E=true;for(var F in C){if(!E){B+=A;}else{E=false;}B+=F+D+C[F];
}return B;};$.monitorContentReportWithDate=function(C,F,D){var A=top.performance.timing;var G=C.getTime()-A.navigationStart;
var E=F.getTime()-A.navigationStart;var B={};(A.responseStart-A.requestStart>0)&&(B["1"]=A.responseStart-A.requestStart);
(A.responseStart-A.navigationStart>0)&&(B["2"]=A.responseStart-A.navigationStart);(A.responseEnd-A.navigationStart>0)&&(B["3"]=A.responseEnd-A.navigationStart);
B["4"]=G;B["5"]=E;top.$.monitorReport(B,D);};$.monitorListReportWithDate=function(A,B){$.monitorContentReportWithDate(A,B,4);
};$.mHtmlEncode=function(B){var A=document.createElement("div");(A.textContent!=null)?(A.textContent=B):(A.innerText=B);
var C=A.innerHTML;A=null;return C;};var pad_locate=(function(){var B=true;if(!$.getVersion()||$.getType()=="excel"){B=false;
}var A={locateRefresh:function(){setTimeout(function(){if(!A.getSwitchLoacate()){return;}var D=window.getSelection();
if(!D.focusNode){return;}var C=D.focusNode;if(!C||C.id=="editor"){return;}if(!C.offsetHeight||!C.offsetTop){if(C.parentNode&&C.parentNode.id!="editor"){var E=C.parentNode;
A.locateRefreshByRollRange(E);return;}}A.locateRefreshByRollRange(C);},500);},locateRefreshAtCursor:function(F){if(!B){return;
}var C=pad_locate.getOffsetByRange();if(!C){return;}var D=C.top-window.innerHeight+C.height;var E=C.top+C.height;
if($.getAgent.isIOS()){if(A.cursorIsInView(E)){return;}}if(!D||D<0){return;}if($.getAgent.isAndroid()){D+=50;
}A.startScrollAnimation(D,F);},cursorIsInView:function(C){var D=$("body.embed")[0].scrollTop;var E=$("body.embed")[0].scrollTop+window.innerHeight;
if(D<0||E<0||C<0){return true;}if((D<C)&&(C<E)){return true;}else{return false;}},locateRefreshByEle:function(D){if(!D||!A.getSwitchLoacate()){return;
}var E=D.offsetHeight;var F=D.offsetTop;var G=F+E;var C=G-window.innerHeight;if(!C||C<0){return;}if($.getAgent.isAndroid()){C+=50;
}$("body.embed")[0].scrollTop=C;},locateRefreshByRollRange:function(D){if(!D||!A.getSwitchLoacate()){return;
}var C=A.isElementInViewport(D);if(C&&!C.roll&&C.rollRange>0){$("body.embed")[0].scrollTop+=C.rollRange;
}},getOffsetByRange:function(){var C,E,F,D,G;if(window.getSelection&&(F=A.range())){if(F.endOffset-1>0){C=F.cloneRange();
C.setStart(F.endContainer,F.endOffset-1);C.setEnd(F.endContainer,F.endOffset);D=C.getBoundingClientRect();
E={height:D.height,left:D.left+D.width,top:D.top};C.detach();}if(!E||(E!=null?E.height:void 0)===0){C=F.cloneRange();
G=$(document.createTextNode("|"));C.insertNode(G[0]);C.selectNode(G[0]);D=C.getBoundingClientRect();E={height:D.height,left:D.left,top:D.top};
G.remove();C.detach();}}if(E){E.top+=$("body.embed")[0].scrollTop;E.left+=$("body.embed")[0].scrollLeft;
}return E;},range:function(){var C;if(!window.getSelection){return;}C=window.getSelection();if(C.rangeCount>0){return C.getRangeAt(0);
}else{return null;}},getSwitchLoacate:function(){return B;},setSwitchLoacate:function(C){B=C;},isElementInViewport:function(D){var C=D.getBoundingClientRect();
rollRange=C.bottom-window.innerHeight;return{roll:(C.top>=0&&C.left>=0&&C.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&C.right<=(window.innerWidth||document.documentElement.clientWidth)),rollRange:rollRange};
},startScrollAnimation:function(C,D){if(C&&C>0){if(!D){$("body.embed")[0].scrollTop=C+5;return;}$("html, body").animate({scrollTop:C+5},100);
}}};return A;}());$(window).resize(function(A){A.preventDefault();pad_locate.locateRefreshAtCursor(false);
});SheetLinkBubble.prototype.defaultdata={container:"#linkbubble-template",template:"#template-sheetlinkbubble-wrapper",name:"linkbubble",box:".sheet-linkbubble-bubble"};
function SheetLinkBubble(B){var A=$.extend({},this.defaultdata,B);this.opts=A;this.show=function(){if(!this.isExist()){var C=window.sheetNode.getHotInstance();
var D=C.getSelectedRange();if(A.name=="linkbubble"){if(D&&(D.isSingle()||(C.mergeCells&&C.mergeCells.isSingleMergeCell(D)))){C.destroyEditor();
var F=C.getDataAtCell(D.from.row,D.from.col);var E=C.getCellMeta(D.from.row,D.from.col);$(A.container).append($(A.template).html());
if(this.curCellIsTemplateLink()){$(".sheet-link-urlinput-url").val(E.rendererTemplateInfo.prop.linkurl);
}if(F&&F!=""){$(".sheet-link-insertlinkbubble-text").val(F);$(".sheet-link-urlinput-url").focus();$(".sheet-link-urlinput-url").select();
}else{$(".sheet-link-insertlinkbubble-text").focus();}if(C.getPlugin("contextMenu").menu&&C.getPlugin("contextMenu").menu.hotMenu){C.getPlugin("contextMenu").menu.close();
}C.destroyEditor();this.bindEvent();this.position();}}else{if(A.name=="linkfloatbar"){if(D&&(D.isSingle()||(C.mergeCells&&C.mergeCells.isSingleMergeCell(D)))){var E=C.getCellMeta(D.from.row,D.from.col);
if(E&&E.rendererTemplate&&E.rendererTemplateInfo&&E.rendererTemplateInfo.type=="link"){$(A.container).append($(A.template).html());
if(!window.gEditable){$(".sheet-link-floatbar-delete").hide();$(".sheet-link-floatbar-change").hide();
$(".sheet-link-floatbar-link").css("margin-right","20px");}$(".sheet-link-floatbar-link").text(E.rendererTemplateInfo.prop.linkurl);
this.bindEvent(E);this.position();}}}}}};this.isExist=function(){return !!$(A.box)[0];};this.bindEvent=function(D){var C=this;
$(A.container).off("mousedown mouseup keyup").on("mousedown mouseup keyup",function(E){E.stopPropagation();
if(E.type=="keyup"&&A.name=="linkbubble"&&E.keyCode==13){C.done(C);}});if(A.name=="linkbubble"){$(".sheet-link-insertlinkbubble-done").on("click",function(){C.done(C);
});$(".sheet-link-urlinput-url").on("keyup",function(E){var F=E.target.value;if(F==""){$(".sheet-link-insertlinkbubble-done").addClass("sheet-link-insertlinkbubble-disable");
}else{$(".sheet-link-insertlinkbubble-done").removeClass("sheet-link-insertlinkbubble-disable");}});}else{if(A.name=="linkfloatbar"){$(".sheet-link-floatbar-link").on("click",function(){window.open(D.rendererTemplateInfo.prop.linkurl);
});$(".sheet-link-floatbar-delete").on("click",function(){var E=window.sheetNode;E.sendCmd("cleanlink");
C.remove();});$(".sheet-link-floatbar-change").on("click",function(){C.remove();var E=new SheetLinkBubble();
E.show();});}}};this.done=function(H){var D=$(".sheet-link-insertlinkbubble-text").val();var C=$(".sheet-link-urlinput-url").val();
var G=window.sheetNode.getHotInstance();if(C==""){return;}else{if(C.substring(0,7)!="http://"&&C.substring(0,8)!="https://"){C="http://"+C;
}}if(D==""){D=C;}var F=window.sheetNode;var E={linkvalue:D,linkurl:C,minType:"link",};G.destroyEditor();
F.sendCmd("sheet-insert-link",E);H.remove();};this.remove=function(){if(this.isExist){$(A.box).remove();
}};this.position=function(){var I=window.sheetNode.getHotInstance();var H=I.getSelectedRange();if(H&&(H.isSingle()||(I.mergeCells&&I.mergeCells.isSingleMergeCell(H)))){var D=I.getCell(H.from.row,H.from.col,true);
if(D){var C=D.getBoundingClientRect();var G=parseInt((/[0-9]+/i).exec($("#editor").css("padding-top"))[0]);
var F=$(A.box).outerHeight();var E=$(A.box).outerWidth();if(A.name=="linkbubble"){if(C.top+D.clientHeight+9+F>window.sheetNode.clientHeight&&C.top-9-F<0){if(C.right+E-18>window.sheetNode.clientWidth){if(C.left-18+E>window.sheetNode.clientWidth){$(".sheet-linkbubble-arrowup").css("left",E-36);
$(A.box).css("left",C.left+18-E);$(A.box).css("top",C.top+D.clientHeight/2);$(".sheet-linkbubble-arrowup").show();
}else{$(A.box).css("left",C.left-18);$(A.box).css("top",C.top+D.clientHeight/2);$(".sheet-linkbubble-arrowup").show();
}}else{$(A.box).css("left",C.left+D.clientWidth-18);$(A.box).css("top",C.top+D.clientHeight/2);$(".sheet-linkbubble-arrowup").show();
}}else{if((C.top+D.clientHeight+9+F>window.sheetNode.clientHeight)&&(C.left+D.clientWidth/2-18+E>window.sheetNode.clientWidth)){$(".sheet-linkbubble-arrowdown").css("top",F);
$(".sheet-linkbubble-arrowdown").css("left",E-36);$(A.box).css("left",C.left+D.clientWidth/2+18-E);$(A.box).css("top",C.top+G-9-F);
$(".sheet-linkbubble-arrowdown").show();}else{if(C.top+D.clientHeight+9+F>window.sheetNode.clientHeight){$(".sheet-linkbubble-arrowdown").css("top",F);
$(A.box).css("left",C.left+D.clientWidth/2-18);$(A.box).css("top",C.top+G-9-F);$(".sheet-linkbubble-arrowdown").show();
}else{if(C.left+D.clientWidth/2-18+E>window.sheetNode.clientWidth){$(".sheet-linkbubble-arrowup").css("left",E-36);
$(A.box).css("left",C.left+D.clientWidth/2+18-E);$(A.box).css("top",C.top+G+D.clientHeight+9);$(".sheet-linkbubble-arrowup").show();
}else{$(A.box).css("left",C.left+D.clientWidth/2-18);$(A.box).css("top",C.top+G+D.clientHeight+9);$(".sheet-linkbubble-arrowup").show();
}}}}}else{if(A.name=="linkfloatbar"){if(C.top-9-F<0&&(C.left+D.clientWidth/2-18+E>window.sheetNode.clientWidth)){$(".sheet-linkbubble-arrowup").css("left",E-36);
$(A.box).css("left",C.left+D.clientWidth/2+18-E);$(A.box).css("top",C.top+G+D.clientHeight+9);$(".sheet-linkbubble-arrowup").show();
}else{if(C.top-9-F<0){$(A.box).css("left",C.left+D.clientWidth/2-18);$(A.box).css("top",C.top+G+D.clientHeight+9);
$(".sheet-linkbubble-arrowup").show();}else{if(C.left+D.clientWidth/2-18+E>window.sheetNode.clientWidth){$(".sheet-linkbubble-arrowdown").css("top",F);
$(".sheet-linkbubble-arrowdown").css("left",E-36);$(A.box).css("left",C.left+D.clientWidth/2+18-E);$(A.box).css("top",C.top+G-9-F);
$(".sheet-linkbubble-arrowdown").show();}else{$(".sheet-linkbubble-arrowdown").css("top",F);$(A.box).css("left",C.left+D.clientWidth/2-18);
$(A.box).css("top",C.top+G-9-F);$(".sheet-linkbubble-arrowdown").show();}}}}}}}};}SheetLinkBubble.prototype.validUrl=function(A){return/^(?:(?:(?:https?|ftp):)?\/\/)(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,})).?)(?::\d{2,5})?(?:[/?#]\S*)?$/i.test(A);
};SheetLinkBubble.prototype.activeCellInput=function(A){if(this.curCellIsTemplateLink()){$(".cell-input").attr("readonly","readonly");
}else{if($(".cell-input",window.parent.document).attr("readonly")=="readonly"){$(".cell-input",window.parent.document).removeAttr("readonly");
}}};SheetLinkBubble.prototype.curCellIsTemplateLink=function(){var C=window.sheetNode.getHotInstance();
var A=C.getSelectedRange();if(A&&(A.isSingle()||(C.mergeCells&&C.mergeCells.isSingleMergeCell(A)))){var B=C.getCellMeta(A.from.row,A.from.col);
if(B&&B.rendererTemplate&&B.rendererTemplateInfo&&B.rendererTemplateInfo.type=="link"){return true;}}return false;
}
/*
 * Copyright 2009 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS-IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
;
var padeditbar=(function(){var A={closeDropDown:function(C){var B=document.createEvent("CustomEvent");
B.initCustomEvent("closedropdown",true,true,{});C.target.dispatchEvent(B);},jugeIsInsertReturn:function(E){var B=padeditor.ace.getRep();
var C=[B.selStart[0],B.selStart[1]];var D=[B.selEnd[0],B.selEnd[1]];if(C[0]==D[0]&&C[1]==D[1]){var F=B.lines.atIndex(C[0]);
switch(E){case"start":if(C[1]==0){return;}padeditor.ace.performDocumentReplaceSelection("\n",true);break;
case"end":if(C[1]==F.text.length){return;}padeditor.ace.performDocumentReplaceSelection("\n",true);break;
}}else{padeditor.ace.performDocumentReplaceSelection("\n",true);}},init:function(){function B(C){return function(D){if(D.preventDefault){D.preventDefault();
}else{D.returnValue=false;}A.closeDropDown(D);A.toolbarClick(C,D);return false;};}$("#toolbar").mousedown(function(C){if(C.preventDefault){C.preventDefault();
}else{C.returnValue=false;}});$("#sheet-undobutton").click(B("sheet-undo"));$("#sheet-redobutton").click(B("sheet-redo"));
$("#sheet-format-painter").click(B("sheet-format-painter"));$("#sheet-clear-format").click(B("sheet-clear-format"));
$("#sheet-exportbutton").click(B("sheet-export"));$("#sheet-border").click(B("sheet-border"));$("#sheet-boldbutton").click(B("sheet-bold"));
$("#sheet-italicsbutton").click(B("sheet-italic"));$("#sheet-underlinebutton").click(B("sheet-underline"));
$("#sheet-strikebutton").click(B("sheet-strike"));$("#sheet-horizontal-align").click(B("sheet-horizontal-align"));
$("#sheet-vertical-align").click(B("sheet-vertical-align"));$("#sheet-font-size").click(B("sheet-font-size"));
$("#sheet-font-family").click(B("sheet-font-family"));$("#sheet-sort").click(B("sheet-sort"));$("#sheet-merge-cell").click(B("sheet-merge"));
$("#sheet-insert-link").click(B("sheet-insert-link"));$("#undobutton").mousedown(B("undo"));$("#redobutton").mousedown(B("redo"));
$("#formatPainterButton").mousedown(B("formatpainter"));$("#clearFormattingButton").mousedown(B("clearformatting"));
$("#boldbutton").mousedown(B("bold"));$("#italicsbutton").mousedown(B("italic"));$("#underlinebutton").mousedown(B("underline"));
$("#strikebutton").mousedown(B("strikethrough"));$("#font-family").mousedown(B("font-family"));$("#font-size").mousedown(B("font-size"));
$("#horizontal-align").mousedown(B("horizontal-align"));$("#listbutton").mousedown(B("insertunorderedlist"));
$("#numberedlistbutton").mousedown(B("insertorderedlist"));$("#taskbutton").mousedown(B("inserttasklist"));
$("#commentbutton").mousedown(B("insertcomment"));$("#indentbutton").mousedown(B("indent"));$("#outdentbutton").mousedown(B("outdent"));
$("#codebutton").click(B("code"));$("#insert").mousedown(B("insert"));$("#attachbutton").click(function(){});
$("#editbutton").click(function(){$("#toolbar").toggleClass("open");$("#editbutton").toggleClass("open");
$("body").toggleClass("edit-mode");});$("body").on("click",A.editMode);$("#createpadentry").on("focus",function(){$("body").addClass("search-focused");
});$("#createpadentry").on("blur",function(){setTimeout(function(){$("body").removeClass("search-focused");
},100);});$(".toolbar-main").on("click",function(C){$("#toolbar [data-type!="+$(C.currentTarget).attr("data-type")+"]").removeClass("toolbar-show");
$("#toolbar [data-type="+$(C.currentTarget).attr("data-type")+"]").toggleClass("toolbar-show");});$("#editbar .editbarbutton").attr("unselectable","on");
$("#editbar").removeClass("disabledtoolbar").addClass("enabledtoolbar");window.insertImageForNativeJSBridge=function(F,E,C){if(!C||!E){alert("attachmentId or filename is null");
return;}try{A.insertImageWithIOSUrl(F,E,C);}catch(D){alert(JSON.stringify(D));}};window.readyToInsertImageForNativeJSBridge=function(E){padeditor.ace.inCallStackIfNecessary("dropImageData",function(){A.jugeIsInsertReturn("start");
});setStatusTips("",null);var C=A.readyToInsertImage();var D=navigator.userAgent.toLowerCase();if(/android/.test(D)){mqq.invoke("docx","readyToInsertImageCallBack",{attachmentId:C,localpath:E,},function(){});
}return C;};padeditor.aceObserver.on("create-page",padeditbar.displayPageCreationDialog);},dataURLToBlob:function(C){var B;
if(C.split(",")[0].indexOf("base64")>=0){B=atob(C.split(",")[1]);}else{B=unescape(C.split(",")[1]);}var F=C.split(",")[0].split(":")[1].split(";")[0];
var E=new ArrayBuffer(B.length);var G=new Uint8Array(E);for(var D=0;D<B.length;D++){G[D]=B.charCodeAt(D);
}return new Blob([E],{type:F});},isEnabled:function(){return toolbarController.isEnable();},hide:function(){try{toolbarController.hide();
}catch(B){$("#toolbar").css("display","none");}},show:function(){try{toolbarController.show();}catch(B){$("#toolbar").css("display","inline-block");
}},disable:function(){toolbarController.disable();},enable:function(){toolbarController.enable();},dataReport:function(E){var D={"sheet-undo":42,"sheet-redo":43,"sheet-export":44,"sheet-bold":45,"sheet-italic":46,"sheet-underline":47,"sheet-strike":48,undo:85,redo:86,"export":87,bold:88,italic:89,underline:90,strikethrough:91};
var B=D[E];if(B){var C={act_type:B};$.report(C);}},toolbarClick:function(B,C){if(!toolbarController.isToolBarButtonEnable(B)){return false;
}trackEvent("toolbarClick",null,null,{command:B});if(A.isEnabled()){if(B=="save"){}else{padeditor.ace.callWithAce(function(D){if(B=="font-family"){toolbarController.toolbarbuttons.fontfamilybutton.handle(C);
}else{if(B=="font-size"){toolbarController.toolbarbuttons.fontsizebutton.handle(C);}else{if(B=="insert"){toolbarController.toolbarbuttons.insertbutton.handle(C);
}else{if(A.forEachAttr(docContentAttr,B)){D.toggleAttributeOnSelection(B,docContentAttr[B]);}else{if(B=="undo"||B=="redo"){D.doUndoRedo(B);
}else{if(B=="formatpainter"){C.stopPropagation();D.getCursorNodeFormat();}else{if(B=="clearformatting"){D.clearAllNodeFormat();
}else{if(B=="export"){D.doExport2();}else{if(B=="horizontal-align"){toolbarController.toolbarbuttons.horizontalalign.handle(C);
}else{if(B=="insertunorderedlist"){D.doInsertUnorderedList();}else{if(B=="insertorderedlist"){D.doInsertOrderedList();
}else{if(B=="inserttasklist"){D.doInsertTaskList();}else{if(B=="code"){D.doInsertCodeList();}else{if(B=="insertcomment"){D.doInsertComment();
}else{if(B=="indent"){if(!D.doIndentOutdent(false)){D.doInsertUnorderedList();}}else{if(B=="outdent"){D.doIndentOutdent(true);
}else{if(B=="sheet-horizontal-align"){toolbarController.toolbarbuttons.sheethorizontalalign.handle(C);
}else{if(B=="sheet-vertical-align"){toolbarController.toolbarbuttons.sheetverticalalign.handle(C);}else{if(B=="sheet-font-size"){toolbarController.toolbarbuttons.sheetfontsize.handle(C);
}else{if(B=="sheet-font-family"){toolbarController.toolbarbuttons.sheetfontfamily.handle(C);}else{if(B=="sheet-sort"){toolbarController.toolbarbuttons.sheetsort.handle(C);
}else{if(B=="sheet-insert-link"){var F=new SheetLinkBubble();F.show();}else{if(B=="sheet-border"){toolbarController.toolbarbuttons.sheetborder.handle(C);
}else{if(B=="clearauthorship"){if((!(D.getRep().selStart&&D.getRep().selEnd))||D.isCaret()){if(window.confirm("Clear authorship colors on entire document?")){var E=D.getRep().lines;
D.performDocumentApplyAttributesToRange([0,0],[E.length,E[E.length-1]],[["author",""]]);}}else{D.setAttributeOnSelection("author","");
}}else{if(B=="header-1"||B=="header-2"){D.doSetHeadingLevel(B.split("-")[1]);}else{if(B=="sheet-bold"||B=="sheet-italic"||B=="sheet-underline"||B=="sheet-strike"||B=="sheet-undo"||B=="sheet-redo"||B=="sheet-merge"||B=="sheet-fix-row-col"||B=="sheet-format-painter"||B=="sheet-clear-format"){padeditbar_utils.sheetButtonClick(B);
}}}}}}}}}}}}}}}}}}}}}}}}}}if(B!="font-size"){A.setSelectionState(B);}A.dataReport(B);},B,true);}}},forEachAttr:function(C,B){for(var D in C){if(D==B){return true;
}}return false;},setSelectionState:function(B){if(!clientVars.isMobile){$(window).trigger("getselectionstate");
}},editMode:function(B){if((!$(B.target).parents("body > header").length&&!$(B.target).parents("#padeditor").length&&!$(B.target).parents("#padsidebar").length&&!$(B.target).parents("#mainmodals").length&&!$(B.target).is("#modaloverlay")&&!$(B.target).parents("#modaloverlay").length&&!$(B.target).is(".lightbox-container")&&!$(B.target).parents(".lightbox-container").length)||$(B.target).is("#padeditor")||$(B.target).is("#createpadform2")||$(B.target).parents("#createpadform2").length){$("body").removeClass("edit-mode");
}else{if($(B.target).is("#editor")||$(B.target).parents("#editor").length){$("body").addClass("edit-mode");
}}},readyToInsertImage:function(){var B=padeditor.aceObserver.insertpixelImage();A.insertLoading(B);return B;
},insertLoading:function(B){$("<style>.placeholder-"+B+" .inline-img{width: 22px;background: url('/static/img/insertimagload.png') no-repeat;background-size: 22px 22px;background-position:center;height:30pxanimation:  loadingAnimation 2s linear infinite; -webkit-animation: loadingAnimation 2s linear infinite; -moz-animation: loadingAnimation 2s linear infinite;}</style>").appendTo("head");
},insertImageWithIOSUrl:function(B,C,D){if(!B||B==""){A.insertImageFail(C);return;}var E=location.hostname+"_"+pad.getPadId()+"_"+clientVars.userId+"_"+(+new Date())+"_"+D;
if(C){setTimeout(function(){padeditor.aceObserver.attachmentUrl(C,B,E);},500);}},insertImageFail:function(C){var D={node:$(".placeholder-"+C).children(".inline-img")[0],index:0,maxIndex:0};
var B=window.globalEditor.getLineAndCharForPoint(D);window.globalEditor.inCallStack("removeMedia",function(){window.globalEditor.performDocumentReplaceRange([B[0],B[1]],[B[0],B[1]+1],"");
setTimeout(function(){setStatusTips("图片上传失败",null,"#ff0000");},800);});},insertImageWithDataUrl:function(C){if(!A.isEnabled()){return false;
}var B=document.createElement("input");B.setAttribute("id","hideImgSelector");B.setAttribute("type","file");
B.setAttribute("accept","image/*");B.setAttribute("style","display:none");document.body.appendChild(B);
if(!!window.FileReader){$(document).off("change").on("change","#hideImgSelector",function(){for(var D=0;
D<this.files.length;++D){padeditor.aceObserver.trigger("insert-image",A.dataURLToBlob(C));}});}B.click();
},setSyncStatus:function(B){if(B=="done"){$("#last-saved-timestamp").attr("time",dateFormat(new Date()));
}},_insertLink:function(B,C){padeditor.ace.callWithAce(function(E){var F=E.getRep();var D=F.selStart;
var H=[D[0],D[1]+B.length];E.replaceRange(F.selStart,F.selEnd,B);E.performDocumentApplyAttributesToRange(D,H,[["link",C]]);
if($.browser.mozilla){var G=[D[0],D[1]+B.length];E.replaceRange(G,G," ");}},"linkinsert",true);},displayPageCreationDialog:function(F,C,E,D){var B=C.text;
trackEvent("pageCreateDialogShow",null,null,{selection:B.length,lines:B.split("\n").length});var G=D.replace(/ /g,"-");
$.post("/ep/pad/ajax_create",{title:D,text:C.text,attribs:C.attribs,apool:JSON.stringify(E),sourcePadId:pad.getPadId()},function(I){var H="/"+I;
A._insertLink(D,H);trackEvent("pageCreateDialogDone",null,null,{selection:B,padUrl:H});});}};return A;
}());var padeditbar_utils=(function(){var A={sheetButtonClick:function(B,E){var D=window.sheetNode;if(!D){return;
}var F=D.getHotInstance();F.clearSelectCopy();if(B=="sheet-bold"||B=="sheet-italic"||B=="sheet-underline"||B=="sheet-strike"||B=="sheet-merge"){var C=A.getSheetStyleState();
if(B=="sheet-bold"){if(C&&C.bold==="bold"){B="sheet-bold-normal";}else{B="sheet-bold-bold";}}else{if(B=="sheet-italic"){if(C&&C.italic==="italic"){B="sheet-italic-normal";
}else{B="sheet-italic-italic";}}else{if(B=="sheet-underline"){if(C&&C.underline==="underline"){B="sheet-underline-none";
}else{B="sheet-underline-underline";}}else{if(B=="sheet-strike"){if(C&&C.strikeline==="strikeline"){B="sheet-strike-none";
}else{B="sheet-strike-strike";}}}}}}if(B=="sheet-merge"){if(A.isSingleMergeCell()||!A.isMergeCellsContainsMultiData()){D.sendCmd(B);
}else{$.Custom_Dialog("合并后的单元格将只保留左上角单元格中的值，继续合并吗？",{type:$.Custom_Dialog.Type.Question,title:"合并单元格",overlay_close:false,onClose:function(G){if(G===$.Custom_Dialog.DefaultButtons.OK){D.sendCmd(B);
}}});}}else{D.sendCmd(B,E);}},sheetSortButtonClick:function(C){var D=true,B=false;var E=window.sheetNode;
if(!E){return;}var G=E.getHotInstance();G.clearSelectCopy();if(C=="sheet-ascending-sort"){}else{if(C=="sheet-descending-sort"){D=false;
}else{if(C=="sheet-ascending-range-sort"){B=true;}else{if(C=="sheet-descending-range-sort"){D=false;B=true;
}}}}var F=padeditbar_utils.hasMergeCellsInSelectedRange(B);if(F==padeditbar_utils.noInstance){return;
}else{if(F==padeditbar_utils.hasMerge){$.Custom_Dialog("不能对包含合并单元格的行进行排序。",{type:"confirmation",title:"无法排序"});
}else{padeditbar_utils.sheetSort(D,B);}}},sheetSort:function(F,E){var C=window.sheetNode;if(C){var D=C.getHotInstance();
var B=D.getSelectedRange().highlight;if(!B){return;}D.sort(B.col,F,E);}},sheetButtonClickWidthData:function(D,C){var B=window.sheetNode;
if(B){var E=B.getHotInstance();E.clearSelectCopy();B.sendCmdWithData(D,C);}},getSheetStyleState:function(){var C=window.sheetNode;
if(!C){return null;}var D=C.getHotInstance();var B=D.getSelectedRange().highlight;if(!B){return null;
}return D.getCellMeta(B.row,B.col).style;},noInstance:0,hasMerge:1,hasNotMerge:-1,hasMergeCellsInSelectedRange:function(K){var G=window.sheetNode;
if(!G){return this.noInstance;}var D=G.getHotInstance();var H=D.getSelectedRange();var C;if(D.mergeCells){C=D.mergeCells.mergedCellInfoCollection;
}if(!C){return this.hasNotMerge;}if(!K){if(C.length>0){var B,E;var L=D.countRows();var M=D.countCols();
for(B=0,E=C.length;B<E;B++){if(C[B].row>=0&&C[B].row<L&&C[B].col>=0&&C[B].col<M){return this.hasMerge;
}}return this.hasNotMerge;}else{return this.hasNotMerge;}}else{var J=H.getTopLeftCorner();var I=H.getBottomRightCorner();
var B,E;for(B=0,E=C.length;B<E;B++){var F=C[B];if(F.row>=J.row&&F.row<=I.row&&F.col>=J.col&&F.col<=I.col){return this.hasMerge;
}}return this.hasNotMerge;}},isSingleCell:function(){var C=window.sheetNode;var B=C.getHotInstance().getSelectedRange();
if(B){return B.isSingle();}else{return true;}},isSingleMergeCell:function(){var G=window.sheetNode;var F=G.getHotInstance();
var C=G.getHotInstance().getSelectedRange();var D=(F.mergeCells&&F.mergeCells.mergedCellInfoCollection)||null;
if(!D||!D.length){return false;}for(var E=0,H=D.length;E<H;E++){var B=D[E];if(C.from.row==B.row&&C.from.col==B.col&&C.to.row==B.row+B.rowspan-1&&C.to.col==B.col+B.colspan-1){return true;
}}return false;},isMergeCellsContainsMultiData:function(){var H=window.sheetNode;var F=H.getHotInstance();
var B=H.getHotInstance().getSelectedRange();var E=F.getData();if(!E||!F||!B){return false;}var G=0;for(var C=B.from.row;
C<=B.to.row;C++){for(var D=B.from.col;D<=B.to.col;D++){if(E[C]&&E[C][D]){G++;if(G>1){return true;}}}}return false;
},getSelectedCol:function(){var E=window.sheetNode;if(E){var B=E.getHotInstance();if(B){var C=B.getSelectedRange();
if(C){var D=C.getTopLeftCorner().col;var F=B.getColHeader(D);return[D,F];}}}return[-1,null];},isSelectedSingleRow:function(){var D=window.sheetNode;
if(D){var C=D.getHotInstance();if(C){var B=C.getSelectedRange();if(B){if(B.from.row==B.to.row){return true;
}}}}return false;}};return A;}());
/*
 * Copyright 2009 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS-IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var padeditor=(function(){var A={ace:null,aceObserver:null,shareInfoHasInit:false,init:function(E,H){A.aceObserver=new ace.observer();
A.ace=new ace.editor("#editor",A.aceObserver);$("#editorloadingbox").hide();$("#padeditor").addClass("loaded");
if($("#padeditor").hasClass("doc-style")&&!window.isTimApp&&!clientVars.isMobile){$("#padeditor").scroll(function(){var I=$(this).scrollTop();
if(I<5){$("#web_header_bottom").removeClass("scroll");$("#web_header_top").removeClass("scroll");}else{$("#web_header_top").addClass("scroll");
$("#web_header_bottom").addClass("scroll");}});}if(clientVars.isTimDomain){C();$(window).resize(C);$(window).on("resetHeightForTim",C);
}else{if(clientVars.isEmbed){A.ace.setProperty("min-height",360);}else{D();$(window).resize(D);}}if(E){E();
}if(clientVars.isEmbed||!padutils.getIsMobile()){$("#editorbottombox").show();}A.ace.setProperty("notitle",pad.getTitleIsReadOnly());
if(clientVars.isTimDomain){A.ace.setProperty("notitle",true);}function G(I,J,L){var K={Forbidden:"图片上传失败\n无上传图片权限","Request Entity Too Large":"图片上传失败\n单张图片大小超出上限"};
if(J==413){I="上传失败，图片大小超过上传限制。";}centertips.init(K[I]||I);setTimeout(function(){centertips.remove();},L);
}function F(K,J,I){if(!I.success){G(I.error,I.request.status,3000);}}A.aceObserver.on("track",function(M,J,L,K,I){I=I||{};
I.isEmbed=!!clientVars.isEmbed;trackEvent("ace_"+J,L,K,I);if(J=="file-attach"){F(L,K,I);}});if(navigator.userAgent.toLowerCase().indexOf("iphone")!=-1||navigator.userAgent.toLowerCase().indexOf("android")!=-1){A.ace.setShortNames("initials");
}else{if(navigator.userAgent.toLowerCase().indexOf("ipad")!=-1){A.ace.setShortNames("firstname-lastinitial");
}}if(!padutils.getIsMobile()){if($("body").hasClass("embed")){A.ace.setShortNames("fullname");}else{if(clientVars.isDesktopApp){A.ace.setShortNames("initials");
}else{A.ace.setShortNames("firstname-lastinitial");}}}A.aceObserver.on("height-change",function(J,I){if(clientVars.isEmbed){top.postMessage("docx-"+encodeURIComponent(pad.getPadId())+":height:"+I,"*");
}});var B=-1;function D(){var I=$(window).height()-$("#editor").offset().top;if($("#padeditor").hasClass("sheet-style")){I-=59;
}else{if(padutils.getIsMobile()){I=Math.max(I,$(window).height()-$("#padbar").height()+45);}else{I-=46;
}}if(clientVars.isDesktopApp){I-=5;}if(I!=B){A.ace.setProperty("min-height",I);B=I;}}function C(){var I=window.innerHeight;
if($("#padeditor").hasClass("sheet-style")){I-=$("header").outerHeight();if($(".mHandsontableInput").css("display")=="block"){I-=$(".mHandsontableInput").outerHeight();
}if(!padutils.getIsMobile()){I-=$("#inputboxwithpc").outerHeight();I-=50;}else{if(!UA_Util.MTIMLargerOrEqual("1.0.2")){I-=44;
}}}else{if(padutils.getIsMobile()){I=Math.max(I,$(window).height()+45);}else{I-=parseInt($("#editor").css("padding-top"));
I-=parseInt($("#editor").css("padding-bottom"));}}if($(".mHandsontableInput").css("display")=="block"){if($("#padBanner").length){}else{$(".mHandsontableInput").css("top",(window.innerHeight-$(".mHandsontableInput").outerHeight())+"px");
}}if(window.isTimApp||clientVars.isMobile){$("body.embed #editor-last-changed").css("bottom","10px");
$("body.embed #editor-last-state").addClass("editor-last-state");}else{$("body.embed #editor-last-changed").css("display","inline-block");
$("body.embed #editor-last-changed").css("left","35px");$("body.embed #editor-last-changed").css("top","10px");
$("body.embed #editor-last-changed").css("position","relative");$("body.embed #editor-last-state").addClass("editor-last-state-web");
}if(!clientVars.isMobile&&$("#padeditor").hasClass("doc-style")){if(window.isTimApp){$("#padeditor").css("height",$(window).height()-$("header").outerHeight()-30+"px");
$("#padpage").css("height",$("padeditor").height()+"px");$("#padpage").css("top",$("header").outerHeight()+"px");
}else{$("#padpage").css("height",$(window).height()-$("header").height());$("#padeditor").css("height",$("#padpage").height());
}}else{if(I!=B){if(!$("#padeditor").hasClass("sheet-style")&&!padutils.getIsMobile()){A.ace.setProperty("max-height",I);
}A.ace.setProperty("min-height",I);B=I;}}if(typeof(window.notifySheetResize)==="function"){window.notifySheetResize();
}}if(pad.getIsDebugEnabled()){A.ace.setProperty("dmesg",pad.dmesg);}A.setViewOptions(H);A.aceObserver.on("missing-authors",function(J,I){$.ajax({url:"/ep/pad/add-authors",type:"post",data:{list:I.join("|"),padId:pad.getPadId()},success:function(K){pad.addHistoricalAuthors(K);
}});});A.setShareInfo();$("#editor").on("focus",function(){if(A.ace.getIsEditable()){top.setAutoSaveTips();
}});},setViewOptions:function(D){function C(G,F){var E=String(D[G]);if(E=="true"){return true;}if(E=="false"){return false;
}return F;}var B;B=C("showLineNumbers",false);A.ace.setProperty("showslinenumbers",B);B=C("showAuthorColors",true);
A.ace.setProperty("showsauthorcolors",B);B=C("useMonospaceFont",false);A.ace.setProperty("textface",(B?"monospace":clientVars.isDesktopApp?"'Microsoft YaHei', Verdana, sans-serif":"'Microsoft YaHei', Verdana, sans-serif"));
A.ace.setProperty("textsize",(B?"12":"14"));},dispose:function(){if(A.ace){A.ace.dispose();}},disable:function(){if(A.ace){A.ace.setProperty("grayedOut",true);
A.ace.setEditable(false);}},restoreRevNum:function(B){$.post("/ep/pad/saverevision",{padId:pad.getPadId(),savedBy:pad.getUserName()||"unnamed",savedById:pad.getUserId(),revNum:B},function(D){console.log(D);
for(var C=0;C<D.length;C++){if(D[C].revNum==String(B)){padeditor.restoreRevisionId(D[C].id);break;}}});
},restoreRevisionId:function(D){$.ajax({type:"get",url:"/ep/pad/getrevisionatext",data:{padId:pad.getPadId(),revId:D},success:C,error:B});
function C(F){var E=JSON.parse(F);padeditor.restoreRevisionText(E);}function B(E){alert("Oops!  There was an error retreiving the text (revNum= "+rev.revNum+"; padId="+pad.getPadId());
}},restoreRevisionText:function(B){pad.addHistoricalAuthors(B.historicalAuthorData);A.ace.importAText(B.atext,B.apool,true);
},setVisibleHeight:function(B){if(!B){return;}A.ace.setVisibleHeight(B);A.ace.callWithAce(function(C){if(C.scrollSelectionIntoView){C.scrollSelectionIntoView();
}});},setShareInfo:function(){window.setDocxShareInfo=function(){var B={};B.share_url=window.location.href.split("#")[0];
if(A.shareInfoHasInit){B.title=$("#padAloneTitle").val();}else{B.title=clientVars.padTitle;}B.desc="TIM在线文档";
if($("#padeditor").hasClass("sheet-style")){B.image_url="http://p.qpic.cn/txdocpic/0/647e1a26-d950-4281-927b-8fd64fa3c4a3/0";
B.type="sheet";}else{B.image_url="http://p.qpic.cn/txdocpic/0/1207eece-6903-42b6-a5fb-60d457aeca4b/0";
B.type="docx";}B.rightFlag=clientVars.rightFlag;B.policy=clientVars.policy;mqq.invoke("data","setShareInfo",B,function(){});
};window.setDocxShareInfo();A.shareInfoHasInit=true;}};return A;}());var pad_imageprocessor=(function(){window.requestAnimationFrame=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame;
var V=$(".docs-squarehandleselectionbox-border");var M=$(".docs-ui-unprintable");var R=$(".docx-selection-topleft");
var S=$(".docx-selection-topright");var T=$(".docx-selection-bottomleft");var U=$(".docx-selection-bottomright");
var E=false,L=true,G=false;var A;var H,F;var I,O,N,J;var K=null;var Q,P,C,B;var D={eventMap:{"mousedown .docs-squarehandleselectionbox-handle":"startImageResize","mousemove body":"doingImageResize","mouseup body":"doneImageResize","mouseup .docs-ui-unprintable":"onBoxClick"},startImageResize:function(W){E=true;
Q=W.pageX;P=W.pageY;K=W.target;$("#editor").css("user-select","none").css("-moz-user-select","none").css("-webkit-user-select","none").css("-ms-user-select","none");
},draw:function(){L=true;},setImageTextAlign:function(X){if(G){try{D.replaceImgTextAlign(X);}catch(W){console.log("replace img textalign error = "+W.toString());
}}},replaceImgTextAlign:function(X){var Y={node:$(A)[0],index:0,maxIndex:0};var W=padeditor.ace.getLineAndCharForPoint(Y);
padeditor.ace.inCallStack("replaceImg",function(){padeditor.ace.performDocumentApplyAttributesToRange([W[0],W[1]],[W[0],W[1]+1],[["img",A.src],["image-width",H],["image-height",F],["image-textalign",X]]);
});D.refreshImgBarPosition(A);},replaceImg:function(Y,X){var Z={node:$(A)[0],index:0,maxIndex:0};var W=padeditor.ace.getLineAndCharForPoint(Z);
padeditor.ace.inCallStack("replaceImg",function(){padeditor.ace.performDocumentApplyAttributesToRange([W[0],W[1]],[W[0],W[1]+1],[["img",A.src],["image-width",Y],["image-height",X]]);
});},deleteImg:function(){if(G){var X={node:$(A)[0],index:0,maxIndex:0};var W=padeditor.ace.getLineAndCharForPoint(X);
padeditor.ace.inCallStack("deleteImg",function(){padeditor.ace.performDocumentReplaceRange([W[0],W[1]],[W[0],W[1]+1],"");
});M.hide();$("#editor").css("user-select","auto").css("-moz-user-select","auto").css("-webkit-user-select","auto").css("-ms-user-select","auto");
padeditor.ace.setEditable(true);E=false;G=false;}},doingImageResize:function(b){if(E&&L){var W,Y,X,a,Z;
C=b.pageX-Q;B=b.pageY-P;if(K==R[0]){C=-(C);B=-(B);}else{if(K==S[0]){C=C;B=-(B);}else{if(K==T[0]){C=-(C);
B=B;}}}X=Math.abs(C/H)>Math.abs(B/F)?(C/H):(B/F);a=$(A).parent().width()||680;Z=(/[0-9]+/i).exec($(A).css("max-height"))[0]||773;
W=Math.floor(H*(1+X));Y=Math.floor(F*(1+X));if(W<=50||W>=a||Y>=Z){return;}$(A).css("width",(W));$(A).css("height",(Y));
D.refreshImgBarPosition(A);requestAnimationFrame(D.draw);L=false;}},doneImageResize:function(W){if($(W.target).parents().hasClass("toolbar-shown")){return;
}if(A&&E){H=A.clientWidth;F=A.clientHeight;try{D.replaceImg(H,F);}catch(W){console.log("replace img error = "+W.toString());
}}if(!E){M.hide();}$("#editor").css("user-select","auto").css("-moz-user-select","auto").css("-webkit-user-select","auto").css("-ms-user-select","auto");
padeditor.ace.setEditable(true);E=false;if(W.target.nodeName!="IMG"){G=false;}},refreshImgBarPosition:function(W){W=W||A;
if(!W){return;}var X=W.getBoundingClientRect();var Y=$("#padpage")[0].offsetTop;I=X.top+$("#padeditor")[0].scrollTop-Y;
O=I+A.clientHeight;J=X.left+$("#padeditor")[0].scrollLeft;N=J+A.clientWidth;V.css("top",I).css("left",J).css("width",A.clientWidth).css("height",A.clientHeight);
R.css("top",I-4).css("left",J-4);S.css("top",I-4).css("left",N-4);T.css("top",O-4).css("left",J-4);U.css("top",O-4).css("left",N-4);
},updateRep:function(){if(A){var X={node:$(A)[0],index:0,maxIndex:0};var W=padeditor.ace.getLineAndCharForPoint(X);
padeditor.ace.inCallStack("updateRep",function(){padeditor.ace.performSelectionChange([W[0],W[1]+1],[W[0],W[1]+1],false);
});}},getCurrentDropImg:function(){return A;},setCurrentDropImg:function(W){A=W;},getSelectImg:function(){return G;
},onImageClick:function(W){if(W.target.nodeName=="IMG"){G=true;A=W.target;H=A.clientWidth;F=A.clientHeight;
D.refreshImgBarPosition(W.target);if(!(/MSIE 10/).test(navigator.userAgent)){padeditor.ace.setEditable(false);
}M.show();}},listenWindowResize:function(){window.onresize=function(){if(G){D.refreshImgBarPosition();
}};},onBoxClick:function(){if(E){return;}padeditor.aceObserver.trigger("startzoom");},bindEvent:function(W,X,Y){$(X).on(W,this[Y]);
},eachMap:function(){for(var W in this.eventMap){var X=W.split(" ")[0];var Y=W.split(" ")[1];var Z=this.eventMap[W];
this.bindEvent(X,Y,Z);}},init:function(){if(window.gEditable){this.eachMap();this.listenWindowResize();
}},};return D;}());var pad_alonetitle=(function(){var H=0;var E=false;var D=false;var A=$("#padAloneTitle");
var C=$("#padAloneTitleFake");var G="";var F="";var B={registerListeners:function(){if(clientVars.isMobile||window.isTimWeb){A.focus(function(){A.data("tooltip","");
$("#tooltip").remove();if(A.attr("readonly")){return;}D=true;if(window.SupportAdvancedFeature.setSharedDocNativeKeyboardEnable){var K={enable:0,source:0};
mqq.invoke("ui","setSharedDocNativeKeyboardEnable",K,function(){});}B.cleanUntitled();top.setAutoSaveTips();
if(sheetHot){sheetHot.runHooks("clearMatchProp");}});A.blur(function(){if(A.attr("readonly")){return;
}if(window.SupportAdvancedFeature.setSharedDocNativeKeyboardEnable){var M={enable:1,source:1};mqq.invoke("ui","setSharedDocNativeKeyboardEnable",M,function(){});
}D=false;H=0;A.toggleClass("force-redraw");if(G==B.getRealTitle(A.val())){B.setTitle(A.val());return true;
}B.setTitle(A.val());var L="ep/api/changetitle?localPadId="+pad.getPadId()+"&newTitle="+encodeURIComponent(A.val(),"UTF-8");
$.post(L,{},function(O,N){if(N=="success"&&O.retcode==0){setStatusTips("保存成功",3000);}else{setStatusTips("保存失败",3000);
}});var K={act_type:21};$.report(K);});var J=0;var I=0;A.on("touchstart",function(K){J=A[0].scrollLeft;
I=window.event.changedTouches[0].pageX;E=false;});A.on("touchmove",function(L){if(!A.is(":focus")){L.preventDefault();
return;}E=true;if(J==A[0].scrollLeft){var K=I-window.event.changedTouches[0].pageX;if(A[0].scrollLeft+K<0){A[0].scrollLeft=0;
}else{if(A[0].scrollLeft+K>A[0].scrollWidth){A[0].scrollLeft=A[0].scrollWidth;}else{A[0].scrollLeft=A[0].scrollLeft+K;
}}J=A[0].scrollLeft;I=window.event.changedTouches[0].pageX;A.toggleClass("force-redraw");}L.preventDefault();
});A.on("touchend",function(){if(H==1&&!E){A.click();}});$(window).keypress(function(K){if(A[0]==K.target){var L=K.which||K.keyCode;
if(L===13){A.blur();}}});$(window).bind("padTitleBlur",function(){if(D){A.blur();}});B.registerUserJoinOrLeaveListeners();
}},registerUserJoinOrLeaveListeners:function(){if(clientVars.isMobile){$(window).on("UserHeadPositionChanged",function(){var K=$(".tim-userline-wrapper").find(".user-facepile-inline-wrapper");
var J=$(window).width();for(var I=0;I<K.length;I++){var L=K[I]&&$(K[I]).offset().left;if(L<J){J=L;}}var M=J-40;
$("#padAloneTitle").css("width",M+"px");});}},init:function(){if(clientVars.isMobile||window.isTimWeb){if((!window.gEditable)&&(!window.isTimAD)){A.attr({readonly:true});
A.addClass("tim-web-unlogin");}B.setTitle(clientVars.padTitle);padutils.tooltip("#padAloneTitle");A.attr("maxlength","128");
if(!clientVars.isMobile&&!clientVars.isTimApp){B.makeFakeSpan();}}else{var I=window.location.protocol+"//"+window.location.host+"/ep/api/changetitle?localPadId="+pad.getPadId();
if(typeof(external.setChangeTitleUrl)==="function"){external.setChangeTitleUrl(I);}else{}A.attr({readonly:true});
}B.registerListeners();},setTitle:function(I){F=I;I=B.getRealTitle(I);G=I;if(clientVars.isMobile||window.isTimWeb){if(!clientVars.isMobile&&!clientVars.isTimApp){B.setToolTip(I);
C.text(I);A.width(C.width()+2);}A.val(I);}else{if(typeof(external.setDocTitle)==="function"){external.setDocTitle(I);
}else{}}},getRealTitle:function(I){if(!I){if($("#padbody").find(".sheet-style").length){I="无标题表格";}else{I="无标题文档";
}}return I;},cleanUntitled:function(){if(!F){A.val("");}},focusAndSelect:function(){if(A.attr("readonly")){return;
}A.focus();A.select();},setToolTip:function(I){if(A.width()>=C.width()){A.data("tooltip","");return;}A.data("tooltip",I);
},titleBlur:function(){A.blur();},makeFakeSpan:function(){var I={"font-family":"'Microsoft YaHei',Verdana,sans-serif","font-size":"18px","letter-spacing":"normal"};
C.css(I);A.on("input propertychange change",function(){C.text(A.val());A.width(C.width()+2);});}};return B;
}());var pad_aloneinput=(function(){var A={init:function(){var E=document.createElement("INPUT");document.body.appendChild(E);
var B=$(E);B.attr("class","mHandsontableInput");var G={display:"none",width:($(window).width()-16)};B.css(G);
if(navigator.userAgent.toLowerCase().indexOf("iphone")>-1){var D=0;var C=0;B.on("touchstart",function(H){D=B[0].scrollLeft;
C=window.event.changedTouches[0].pageX;});B.on("touchmove",function(I){if(D==B[0].scrollLeft){var H=C-window.event.changedTouches[0].pageX;
if(B[0].scrollLeft+H<0){B[0].scrollLeft=0;}else{if(B[0].scrollLeft+H>B[0].scrollWidth){B[0].scrollLeft=B[0].scrollWidth;
}else{B[0].scrollLeft=B[0].scrollLeft+H;}}D=B[0].scrollLeft;C=window.event.changedTouches[0].pageX;}I.preventDefault();
});}B.on("click focus",function(H){top.setAutoSaveTips();});$(window).keypress(function(H){if(B[0]==H.target){var I=H.which||H.keyCode;
if(I===13){window.onTabKeyDown();window.event?window.event.returnValue=false:H.preventDefault();window.event?window.event.cancelBubble=true:H.stopPropagation();
}}});window.onTabKeyDown=function(){setTimeout(function(){var H=window.sheetNode.getHotInstance();H.selection.transformStart(1,0,true);
var J=H.getSelected();var K=H.getCell(J[0],J[1]);var I=document.createEvent("HTMLEvents");I.initEvent("touchend",true,true);
K.dispatchEvent(I);},0);};B.focusout(F);function F(){var H=window.frames.sheet;if(H){pad_compatible.padDispatchEvent(H,"mHandsontableInput_enter");
}}}};return A;}());function dragTab(A,O,N,E,M){var B=null;var C=null;var P=0;var F=false;var K=-1;var G=false;
function T(){A.bind("mousedown",Q);}function Q(X){if(X.button!=0){return;}var Y=A.children();for(index=0;
index<Y.length;index++){var W=Y[index];if(R(X,W)){B=$(W);P=X.clientX+A.scrollLeft()-W.offsetLeft;break;
}}if(B&&B.length!=0){A.bind("mouseup",I);A.bind("mousemove",L);A.bind("mouseleave",D);K=J(B[0]);}}function I(W){if(F&&O){O(K,J(B[0]));
}D();}function L(W){if(!G&&W.offsetX>5){G=true;N&&N("beginDrag");H(B);}if(V(W)){F=true;H(B);}B.css("left",U(W.clientX-P));
}function V(Y){var X=B.prev();var W=B.next();if(X.length&&Y.clientX+A.scrollLeft()<X[0].offsetLeft+X[0].offsetWidth/2){B.after(X);
C.css({"margin-left":"0px","margin-right":"0px"});C.removeClass(E);C=$(X);return true;}else{if(W.length&&Y.clientX+A.scrollLeft()>W[0].offsetLeft+W[0].offsetWidth/2){B.before(W);
C.css({"margin-left":"0px","margin-right":"0px"});C.removeClass(E);C=$(W);return true;}}return false;
}function H(W){var X=W[0].offsetLeft-A.scrollLeft();if(W.prev().length){C=W.prev();C.css("margin-right",W[0].offsetWidth);
C.addClass(E);}else{if(W.next().length){C=W.next();C.css("margin-left",W[0].offsetWidth);}}W.addClass(M);
W.css({position:"absolute","float":"left",left:X+"px","z-index":999});}function U(X){var W=A[0];return Math.min(Math.max(X,W.offsetLeft),W.offsetLeft+W.offsetWidth);
}function R(X,W){if(X.clientX+A.scrollLeft()>=W.offsetLeft&&X.clientX+A.scrollLeft()<=W.offsetLeft+W.offsetWidth){return true;
}return false;}function J(X){var W=A.children();for(index in W){var Y=W[index];if(Y==X){return index;
}}return -1;}function D(){A.unbind("mouseup",I);A.unbind("mousemove",L);A.unbind("mouseleave",D);if(C){C.css({"margin-left":"0px","margin-right":"0px"});
C.removeClass(E);C=null;}if(B){B.css({position:"relative","float":"none",left:"0px","z-index":"auto"});
B.removeClass(M);B=null;}G=false;F=false;}T();var S={clearDragTab:function(){D();}};return S;}var pad_banner=(function(){var C="tim";
var I="com.tencent.tim";var E=navigator.userAgent.toLocaleLowerCase();var B=$.getAgent.isIOS();var F=$.getAgent.isAndroid();
var H=(E.indexOf("mac")>=0);var D=(E.indexOf("windows")>=0);var G=200;var A={init:function(R,V,Y,X,P,W,T){var J=document.createElement("div");
Y.appendChild(J);var M=document.createElement("div");J.appendChild(M);var S=document.createElement("div");
J.appendChild(S);var U=document.createElement("div");M.appendChild(U);var Q=document.createElement("div");
M.appendChild(Q);var O=document.createElement("div");M.appendChild(O);var N=document.createElement("span");
O.appendChild(N);var K=document.createElement("span");O.appendChild(K);var L=document.createElement("div");
M.appendChild(L);$(J).attr("id","padBanner");if(T){$(J).css("bottom",T);}$(O).attr("id","bannerContent");
$(S).attr("id","bannerClose");$(Q).attr("id","bannerVerticalline");$(U).attr("id","bannerIcon");$(L).attr("id","bannerButton");
$(N).attr("id","bannerTopSpan");$(K).attr("id","bannerBottomSpan");$(N).text(R);$(K).text(V?V:"多人实时编辑的免费云端office");
$(L).text(X?X:"立即体验");if(W){$.each(W,function(a,Z){$("#"+Z,J).hide();});}if(!R||R.length==0){$(N).hide();
$(K).css("max-width","12.5em");$(K).css("margin-top",($(K).outerHeight()-$(Q).outerHeight())/2);}$(J).css("z-index",G);
G++;$(L).click(function(){if(P){P(A,false);return;}if(clientVars.isMobile){if(mqq.QQVersion!=="0"){var Z=B?C:I;
mqq.app.isAppInstalled(Z,function(a){if(a){A.openApp();}else{A.openURL(0);}});}else{if(B){A.openApp();
A.openURL(1000);}else{A.openApp();A.openURL(1000);}}}else{A.openURL(1000);A.openApp();}});$(L).on("touchstart",function(){});
$(S).on("click",function(){$(J).remove();if(P){P(A,true);return;}});},openURL:function(K,J){var M=Date.now();
var L={act_type:103};$.report(L);if(!J){if(B){J="https://itunes.apple.com/app/id1175213887";}else{if(F){J="https://eim.connect.qq.com/guide/install.html?install=1";
}else{if(H){J="https://eim.connect.qq.com/down/tim.dmg";}else{if(D){J="https://eim.connect.qq.com/down/tim.exe";
}else{J="http://office.qq.com";}}}}}setTimeout(function(){var N=Date.now();if(N-M<K+100){location.href=J;
}},K);},openApp:function(){if(B){var K=encodeURIComponent(location.href);location.href=C+"://teamwork/opendocx?url_prefix="+K;
}else{if(F){var K=encodeURIComponent(location.href);var J=document.createElement("iframe");J.style.display="none";
J.src=C+"://teamwork/opendocx?url_prefix="+K;J.onload=function(){};document.body.appendChild(J);}else{if(D){location.href="TIM://Docx/OpenDocxMgrService?url="+location.href;
}}}},initBannerBox:function(){var J=document.createElement("div");$(J).addClass("banner-box");var M=document.createElement("img");
M.src="static/img/logo.png";$(M).addClass("banner-logo");J.appendChild(M);var K=document.createElement("div");
$(K).addClass("banner-text");J.appendChild(K);var O=document.createElement("span");$(O).addClass("banner-title");
K.appendChild(O);var P=document.createElement("span");$(P).addClass("banner-tips");K.appendChild(P);var N=document.createElement("span");
$(N).addClass("banner-update-button");J.appendChild(N);var L=document.createElement("div");$(L).addClass("banner-close-button");
$(L).click(function(Q){Q.preventDefault();A.closeBanner();});J.appendChild(L);document.body.appendChild(J);
},setMultiSheetBanner:function(L,J,K){$(".banner-box").addClass("multi-sheet-banner");$(".banner-title").html(L);
$(".banner-tips").html(J);$(".banner-update-button").html(K).click(function(){var M=$.getAgent.isIOS();
var N=$.getAgent.isAndroid();if(M){location.href="https://itunes.apple.com/app/id1175213887";}else{if(N){location.href="https://eim.connect.qq.com/guide/install.html?install=1";
}}});},closeBanner:function(){var K=$(".banner-box");if(K.length>0){var J=K.get(0);J.parentNode.removeChild(J);
}},};return A;}());var PadMultiSheet=function(){var b=this;var D=$("#sheetbox");var I=$(D.find(".sheet-head"));
var K=$(D.find(".sheet-content"));var G=$(D.find(".sheet-content-inner"));var N=$(D.find(".sheet-scroll"));
var P=$(D.find(".sheet-scroll-left"));var R=$(D.find(".sheet-scroll-right"));var F=$(D.find(".sheet-menu"));
var E={};var C;var Z=0;var d;var A=0;var B=0;var L=100;var H=clientVars.cdn?clientVars.cdn:"";var Q=null;
c();Y();O();g();if(window.gEditable){Q=dragTab($(".sheet-content-inner"),function(j,h){window.changeSheetIndex(j,h);
},W,"sheet-tab-placeItem","sheet-tab-dragItem");}$(window).on("resize",function(){O();U();});this.addTab=function(l){var h=l.id;
if(!E[h]){E[h]=X(h);}var j=E[h];V(h,l.name,j);G.append(j);a(j,l.name);};this.delTab=function(l){var h=l.id;
if(E[h]){var j=E[h];$(j).remove();E[h]=null;}};this.updateTabs=function(h,m){if(window.gEditable&&I.hasClass("nohead")){f();
O();}d=h;G.empty();Z=h.length;for(var j=0;j<h.length;j++){var l=h[j];b.addTab(l);}S(m);U();};this.openRenameInput=function(){$(".sheet-menu-rename").click();
};function c(){if(!$.isMobilePhone()){D.css("visibility","visible");}}function Y(){var l=["删除","重命名","创建副本"];
var m=["del","rename","copy"];for(var h=0;h<l.length;h++){var j=document.createElement("div");$(j).addClass("sheet-menu-"+m[h]);
$(j).text(l[h]);F.append(j);}$(".sheet-menu-del").click(function(){window.delSheet(C);});$(".sheet-menu-rename").click(function(){var n=$(E[C]).children("input").get(0);
$(n).attr("readonly",false);$(n).addClass("renaming");$(n).select();});$(".sheet-menu-copy").click(function(){window.copySheet(C);
});$(window).click(function(n){if(n.target.className!=="sheet-tab-dropdown"){J();}});$(window).bind("SheetMouseDown",function(){if(!window.manualTriggerClick){J();
}});}function J(){if(F.css("display")!=="node"){F.css("display","none");}}function f(){I.removeClass("nohead");
var h=document.createElement("img");h.src=H+"/static/img/sheet-add.png";I[0].appendChild(h);I.click(function(){window.addNewSheet();
if(B>0){A+=B;B=0;$(".normal.sheet-tab:first-child").animate({"margin-left":(0-A)},"fast");}M();});}function X(n){var h=document.createElement("div");
$(h).addClass("normal sheet-tab sheet-tab-blur");$(h).attr("data-id",n);var j=document.createElement("input");
$(j).addClass("sheet-tab-name");$(j).attr("readonly",true);$(j).attr("maxlength","32");h.appendChild(j);
var m=document.createElement("span");$(m).addClass("sheet-tab-faker");h.appendChild(m);var l=document.createElement("img");
$(l).addClass("sheet-tab-dropdown");l.src=H+"/static/img/sheet-dropdown.png";h.appendChild(l);return h;
}function a(l,h){var j=$($(l).children("input"));var m=$($(l).children("span"));j.val(h);m.text(h);j.width(m.width()+2);
}function V(j,q,m){var n=$(m);var l=$(m).children("img");var h=$(m).children("input");var p=$(m).children("span");
var o=q;l.click(function(){if(j!==C){return;}if(!window.isLogin){return;}if(F.css("display")==="none"){var u=n.prevAll();
var r=0;for(var s=0;s<u.length;s++){var v=u[s];r=r+parseFloat($(v).css("width"))+1;}r-=A;if(r<0){r=0;
}r+=83;F.css("left",r);F.css("display","block");}else{F.css("display","none");}});l.hover(function(){if(j===C){l.get(0).src=H+"/static/img/sheet-dropdown-hover.png";
}},function(){if(j===C){l.get(0).src=H+"/static/img/sheet-dropdown.png";}});h.blur(function(){if(!h.attr("readonly")){h.attr("readonly",true);
h.removeClass("renaming");var r=h.val();if(o!==r){window.renameSheet(C,r);}}});h.on("keydown",function(r){if(r.keyCode===13){h.blur();
}else{if(r.keyCode===27){h.val(o);h.change();h.blur();}}});h.on("input propertychange change",function(){p.text(h.val());
h.width(p.width()+2);});h.dblclick(function(){$(".sheet-menu-rename").click();Q.clearDragTab();});n.mousedown(function(r){if(r.button===2){if(C!==j){J();
}T(j);l.click();}else{if(r.button===0){T(j);}}});m.oncontextmenu=function(){return false;};}function S(l){if(C===l){return;
}var h=E[C];if(h){$(h).removeClass("sheet-tab-focus");$(h).addClass("sheet-tab-blur");}var j=E[l];if(j){$(j).removeClass("sheet-tab-blur");
$(j).addClass("sheet-tab-focus");}C=l;}function T(h){if(h===C){return;}S(h);window.setDisplayedSheetID(C);
}function O(){var h=I.outerWidth(true);var l=N.outerWidth(true);var m=D.outerWidth();var j=m-h-l;K.width(j);
}function g(){$($(R).find("img")).get(0).src=H+"/static/img/sheet-scroll-right.png";$($(P).find("img")).get(0).src=H+"/static/img/sheet-scroll-left.png";
R.click(function(){var h;if(B>=L){h=L;}else{if(B>0){h=B;}else{h=0;}}if(h!==0){A+=h;B-=h;$(".normal.sheet-tab:first-child").animate({"margin-left":(0-A)},"fast");
}M();});P.click(function(){var h;if(A>=L){h=L;}else{if(A>0){h=A;}else{h=0;}}if(h!==0){A-=h;B+=h;$(".normal.sheet-tab:first-child").animate({"margin-left":(0-A)},"fast");
}M();});}function U(){var l=G.children(".sheet-tab");var h=0;for(var j=0;j<l.length;j++){var m=l[j];h+=parseFloat($(m).css("width"));
h+=1;if($(m).children("img").width()===0){h+=7;}}h+=1;var n=parseFloat(K.css("width"));B=h-A-n;if(B<0||A>0){if((A+B)>=0){A+=B;
B=0;}else{B+=A;A=0;}$(".normal.sheet-tab:first-child").css("margin-left",(0-A));}if(A===0&&B<=0){N.css("visibility","hidden");
}else{N.css("visibility","visible");}M();}function M(){K.removeClass("sheet-left-border");G.removeClass("sheet-right-border");
if(A>0){K.addClass("sheet-left-border");}if(B>0){G.addClass("sheet-right-border");}}function W(h){if(h=="beginDrag"){J();
G.find(".sheet-tab-name.renaming").blur();}}};var MobileMultiSheet=function(){var N=this;var D=$("#mobile-sheetbox");
var G=$(D.find(".sheet-content"));var F=$(D.find(".sheet-content-inner"));var E={};var C;var L=0;var Q;
var A=0;var B=0;var H=0;var S=0;O();R();this.addTab=function(V){var T=V.id;if(!E[T]){E[T]=K(T);}var U=E[T];
J(T,V.name,U);F.append(U);M(U,V.name);};this.updateTabs=function(T,W){Q=T;F.empty();L=T.length;for(var U=0;
U<T.length;U++){var V=T[U];N.addTab(V);}I(W);P();};function O(){if($.isMobilePhone()){D.css("visibility","visible");
D.css("z-index","12");}}this.closeSheetBox=function(){if($.isMobilePhone()){D.css("z-index","0");}};function K(W){var T=document.createElement("div");
$(T).addClass("mobile sheet-tab sheet-tab-blur");var V=document.createElement("span");$(V).addClass("sheet-tab-name");
T.appendChild(V);var U=document.createElement("span");$(U).addClass("sheet-tab-faker");T.appendChild(U);
return T;}function M(V,T){var U=$($(V).children("span"));var W=$($(V).children("span"));U.text(T);W.text(T);
U.width(W.width()+2);}function J(T,W,U){var V=$(U);V.click(function(){if(T===C){return;}I(T);window.setDisplayedSheetID(C);
});}function I(V){if(C===V){return;}var T=E[C];if(T){$(T).removeClass("sheet-tab-focus");$(T).addClass("sheet-tab-blur");
}var U=E[V];if(U){$(U).removeClass("sheet-tab-blur");$(U).addClass("sheet-tab-focus");}C=V;}function R(){G.on("touchstart",function(T){var U=T.originalEvent.targetTouches[0];
H=U.clientX;});G.on("touchmove",function(W){W.preventDefault();var X=W.originalEvent.targetTouches[0];
var T=(X.clientX-H);T=(T/3);if(T>0){var V;if(A>=T){V=T;}else{if(A>0){V=A;}else{V=0;}}if(V!==0){A-=V;B+=V;
}}else{T=-T;var U;if(B>=T){U=T;}else{if(B>0){U=B;}else{U=0;}}if(U!==0){B-=U;A+=U;}}$(".mobile.sheet-tab:first-child").css("margin-left",(0-A));
});}function P(){var V=F.children(".sheet-tab");var T=0;for(var U=0;U<V.length;U++){var X=V[U];T+=parseFloat($(X).css("width"));
T+=1;}T+=1;var W=parseFloat(G.css("width"));B=T-A-W;if(B<0||A>0){if((A+B)>=0){A+=B;B=0;}else{B+=A;A=0;
}$(".mobile.sheet-tab:first-child").css("margin-left",(0-A));}}};var HistoryMultiSheet=function(){var V=this;
var C=$("#history-sheetbox");var S=$(C.find(".sheet-head"));var F=$(C.find(".sheet-content"));var D=$(C.find(".sheet-content-inner"));
var I=$(C.find(".sheet-scroll"));var K=$(C.find(".sheet-scroll-left"));var N=$(C.find(".sheet-scroll-right"));
var Z=$(C.find(".sheet-menu"));var E={};var G;var T=0;var X;var A=0;var B=0;var H=100;var L=clientVars.cdn?clientVars.cdn:"";
W();M();Y();$(window).on("resize",function(){M();P();});this.addTab=function(c){var a=c.id;if(!E[a]){E[a]=R(a);
}var b=E[a];Q(a,c.name,b);D.append(b);U(b,c.name);};this.updateTabs=function(a,d){X=a;D.empty();T=a.length;
for(var b=0;b<a.length;b++){var c=a[b];V.addTab(c);}O(d);P();};function W(){if(!$.isMobilePhone()){C.css("visibility","visible");
C.css("z-index","12");}}this.closeSheetBox=function(){if(!$.isMobilePhone()){C.css("z-index","0");}};
function R(d){var a=document.createElement("div");$(a).addClass("history sheet-tab sheet-tab-blur");var b=document.createElement("input");
$(b).addClass("sheet-tab-name");$(b).attr("readonly",true);a.appendChild(b);var c=document.createElement("span");
$(c).addClass("sheet-tab-faker");a.appendChild(c);return a;}function U(c,a){var b=$($(c).children("input"));
var d=$($(c).children("span"));b.val(a);d.text(a);b.width(d.width()+2);}function Q(b,d,c){var a=$(c);
a.click(function(){if(b===G){return;}O(b);if(window.reRenderTableInRecord){window.reRenderTableInRecord(b);
}});a.mousedown(function(f){if(f.button===2){a.click();}});c.oncontextmenu=function(){return false;};
}function O(c){if(G===c){return;}var a=E[G];if(a){$(a).removeClass("sheet-tab-focus");$(a).addClass("sheet-tab-blur");
}var b=E[c];if(b){$(b).removeClass("sheet-tab-blur");$(b).addClass("sheet-tab-focus");}G=c;}function M(){var c=S.outerWidth(true);
var d=I.outerWidth(true);var f=C.outerWidth();var a=f-c-d;var b=$("#recordbar").outerWidth(true);if(b){a-=b;
}a=Math.max(a,100);F.width(a);}function Y(){$($(N).find("img")).get(0).src=L+"/static/img/sheet-scroll-right.png";
$($(K).find("img")).get(0).src=L+"/static/img/sheet-scroll-left.png";N.click(function(){var a;if(B>=H){a=H;
}else{if(B>0){a=B;}else{a=0;}}if(a!==0){A+=a;B-=a;$(".history.sheet-tab:first-child").animate({"margin-left":(0-A)},"fast");
}J();});K.click(function(){var a;if(A>=H){a=H;}else{if(A>0){a=A;}else{a=0;}}if(a!==0){A-=a;B+=a;$(".history.sheet-tab:first-child").animate({"margin-left":(0-A)},"fast");
}J();});}function P(){var c=D.children(".sheet-tab");var a=0;for(var b=0;b<c.length;b++){var f=c[b];a+=parseFloat($(f).css("width"));
a+=1;}a+=1;var d=parseFloat(F.css("width"));B=a-A-d;if(B<0||A>0){if((A+B)>=0){A+=B;B=0;}else{B+=A;A=0;
}$(".history.sheet-tab:first-child").css("margin-left",(0-A));}if(A===0&&B<=0){I.css("visibility","hidden");
}else{I.css("visibility","visible");}J();}function J(){F.removeClass("sheet-left-border");D.removeClass("sheet-right-border");
if(A>0){F.addClass("sheet-left-border");}if(B>0){D.addClass("sheet-right-border");}}};var padguestpolicy=(function(){var A=false;
function B(D){$("#padaccesslogo").removeClass().addClass(D);if(clientVars.isProPad&&clientVars.isPadAdmin){$("#padaccess-menu").removeAttr("disabled");
$("#padaccess-menu").parent().removeAttr("data-tooltip");}$("#fb-share-container").show();$("#padusers").addClass("owner");
}var C={init:function(){function D(E){var F=false;if(!E&&!F){return false;}if(F){pad.changePadOption("groupId",F);
}else{if(pad.getPadOptions().guestPolicy!=E){pad.changePadOption("guestPolicy",E);}}if(E=="allow"||E=="friends"||E=="link"){$("#network-share-box").show();
}else{if(F){}else{$("#network-share-box").hide();}}$("select.padaccess").blur();}padutils.tooltip("#padaccess-menu");
$("#padaccess-menu li a").on("click",function(F){var E=$(F.currentTarget).attr("id").split("-")[1];$("#padaccess-menu li a.selected").removeClass("selected");
$("#padaccess-menu li #padaccess-"+E).addClass("selected");$("#padaccess-menu .hp-ui-button-content").html($("#padaccess-menu li a.selected i").clone());
$("#padaccess-menu").attr("data-tooltip",$("#padaccess-menu li a.selected").text());D(E);return false;
});},setGuestPolicy:function(D){if(A){return;}A=true;$("#padaccess-menu li a.selected").removeClass("selected");
$("#padaccess-menu li #padaccess-"+D).addClass("selected");$("#padaccess-menu .hp-ui-button-content").html($("#padaccess-menu li a.selected i").clone());
$("#padaccess-menu").attr("data-tooltip",$("#padaccess-menu li a.selected").text());B(D);A=false;},setGroupId:function(D){$('select.padaccess option[groupId="'+D+'"]').attr("selected","selected");
B("group");}};return C;}());var padguestprompt=(function(){var B={};var A=0;var D=padutils.makeAnimationScheduler(function(){var E=$("#guestprompts .guestprompt");
if(E.length==0){return false;}A=1-A;if(A){E.css("background","#ffa");}else{E.css("background","#ffe");
}return true;},1000);var C={showGuestPrompt:function(H,G){if(B[H]){return;}var E=padutils.encodeUserId(H);
var I="hide-guest-prompt-"+E;padutils.cancelActions(I);var F=$("#guestprompt-"+E);if(F.length==0){F=$('<div id="guestprompt-'+E+'" class="guestprompt"><div class="choices"><a class="deny" href="javascript:void(padguestprompt.answerGuestPrompt(\''+E+"',false))\"> </a> <a href=\"javascript:void(padguestprompt.answerGuestPrompt('"+E+'\',true))">Allow</a></div><div class="guestname">'+padutils.escapeHtml(G)+"</div></div>");
$("#guestprompts").append(F);}else{F.find(".guestname").text(G);}D.scheduleAnimation();},removeGuestPrompt:function(E){var F=$("#guestprompt-"+padutils.encodeUserId(E));
F.removeAttr("id").fadeOut("fast",function(){F.remove();});B[E]=true;window.setTimeout(function(){delete B[E];
},5000);},answerGuestPrompt:function(F,G){var E=padutils.decodeUserId(F);var H={type:"guestanswer",authId:pad.getUserId(),guestId:E,answer:(G?"approved":"denied")};
pad.sendClientMessage(H);C.removeGuestPrompt(E);}};return C;}());var padrelated=(function(){var A={init:function(){if(!$("#related-pads-div").length){return;
}$.get("/ep/pad/related",{padId:pad.getPadId()},function(H){var E=false;var C=H.split("\n");for(var D=0;
D<C.length;D++){var G=C[D];var B=G.split("|");if(B.length<2){return;}var F=$("<li>");var I=$("<a/>").attr("href","/"+B[1]).attr("title",B[0]).append(B[0]).appendTo(F);
$("#related-pads-menu .hp-ui-button-list-ul").append(F);E=true;}if(E){$("#related-pads-menu .hp-ui-button-content").text(C.length+" "+$("#related-pads-menu .hp-ui-button-content").text());
if(!$("#related-pads-menu .icon-privacy-link").length){$("#related-pads-menu .hp-ui-button-content").append($("<i>").addClass("icon-privacy-link"));
}$("#related-pads-div").show();}else{$("#related-pads-div").hide();}});}};return A;}());
/*
 * Copyright 2009 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS-IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var pad={collabClient:null,myUserInfo:null,diagnosticInfo:{},initTime:0,clientTimeOffset:(+new Date())-clientVars.serverTimestamp,padOptions:{},title:clientVars.initialTitle,monospace:false,unsavedPromptDisabled:false,welcomePadId:"AWELCOMEPAD",pad_box:null,getPadId:function(){return clientVars.padId;
},getClientIp:function(){return clientVars.clientIp;},getIsProPad:function(){return clientVars.isProPad;
},getColorPalette:function(){return clientVars.colorPalette;},getDisplayUserAgent:function(){return padutils.uaDisplay(clientVars.userAgent);
},getIsDebugEnabled:function(){return clientVars.debugEnabled;},getPrivilege:function(A){return clientVars.accountPrivs[A];
},getUserIsGuest:function(){return clientVars.userIsGuest;},getTitleIsReadOnly:function(){return clientVars.titleIsReadOnly;
},getTitle:function(){return pad.title;},getUserId:function(){return pad.myUserInfo.userId;},getUserName:function(){return pad.myUserInfo.name;
},sendClientMessage:function(A){pad.collabClient.sendClientMessage(A);},sendUserChangeMessage:function(A){pad.collabClient.sendUserChangeMessage(A);
},init:function(){top.trigger=function(N){$(top).trigger(N);};pad.diagnosticInfo.uniqueId=padutils.uniqueId();
pad.initTime=+(new Date());pad.padOptions=clientVars.initialOptions||{};clientVars.siteUserInfos={};setTimeout(function(){$("#padeditor")[0].scrollTop=0;
},500);if($.browser.msie){try{doc.execCommand("BackgroundImageCache",false,true);}catch(C){}}var F=null;
var D=document.location.toString().split("#")[1];if(D&&D.split(":").length>1){var G=D.split(":")[D.split(":").length-1];
if(G!=clientVars.padTitle.split(":")[clientVars.padTitle.split(":").length-1]){F=G;}}window.isTimApp=clientVars.isTim;
window.isTimWeb=(!clientVars.isTim&&clientVars.isTimDomain);window.isLogin=clientVars.isLogin;window.gEditable=(clientVars.rightFlag&2)!=0;
window.isTimAD=(typeof(clientVars.isTimAD)=="undefined")?false:clientVars.isTimAD;window.isMac=clientVars.isMac;
window.isSheet=$("#padbody").find(".sheet-style").length;window.isIESpace=false;pad_compatible.padDispatchEvent(window,"WindowFlagSetDone");
padeditor.init(J,pad.padOptions.view||{});pad.pad_box=new padinputbox.box();pad.pad_box.init();if(clientVars.isTimDomain){pad_alonetitle.init();
}padconnectionstatus.init();padmodals.init();padguestpolicy.init();pad_aloneinput.init();if(!$.getAgent.isMobile()&&$.getType()=="word"){pad_imageprocessor.init();
}pad.addClientVars({});function K(N){N.preventDefault();window.event.returnValue=false;}document.body.addEventListener("mscontrolselect",K);
var A="0";if($("#padbody").find(".sheet-style").length){A="2";}else{A="1";}if(!clientVars.isMobile&&window.isTimApp){try{external.setDocType(A);
}catch(C){console.log("setDocType fail! doctype = "+A+"\n"+C);}}else{if(clientVars.isMobile){try{mqq.invoke("ui","setTeamWorkEditType",{editType:parseInt(A)});
}catch(C){console.log("setTeamWorkEditType fail! doctype = "+A+"\n"+C);}}}if(clientVars.chatEnabled&&window.padchat){padchat.init(clientVars.chatHistory,pad.myUserInfo);
}$("input[placeholder]").placeholder();pad.initInviteControl();pad.initFollowControl();pad.initModerationModeControl();
pad.initLocateThread();$(window).bind("message",pad.receiveMessage,false);function J(){padeditbar.init();
$(".hide-before-pad-load").removeClass("hide-before-pad-load");clientVars.demoMode=clientVars.padId==pad.welcomePadId&&clientVars.userIsGuest;
if(clientVars.newPad||F){}if(!clientVars.isMobile&&!$("#padbody").find(".sheet-style").length&&(window.isTimApp||window.gEditable)){setTimeout(function(){padeditor.ace.focus();
},0);}if(clientVars.userIsGuest&&!pad.isPadPublic()&&!pad.isEmbed()&&(clientVars.padId!=pad.welcomePadId)&&!clientVars.isMobile){if(allCookies.getItem("inhibitLoginDialog")!="T"&&clientVars.padId!=pad.welcomePadId){modals.showModal("#page-login-box",0,true);
allCookies.setItem("inhibitLoginDialog","T",new Date(new Date().getTime()+(1000*60*5)));}}if(clientVars.demoMode&&window.paddemo){setTimeout(paddemo.start,0);
}}if(!clientVars.isMobile){var I=new SheetLinkBubble();var L=new SheetLinkBubble({container:"#linkbubble-template",template:"#template-sheetlinkfloatbar-wrapper",name:"linkfloatbar",box:".sheet-link-floatbar"});
$("body").on("mousedown",function(N){if(window.isSheet){I.remove();L.remove();}else{padeditor.ace.removeLinkBubble();
}});}window.addEventListener("detectSharedDocAdvancedFeatureFinished",function(O){$("#last-saved-timestamp").prettyDate();
resetPrettyDateTimer();if(UA_Util.MTIMLargerOrEqual("1.0.2")){var N={enable:window.gEditable?1:0,source:1};
mqq.invoke("ui","setSharedDocNativeKeyboardEnable",N,function(){});}else{if(UA_Util.MQQLargerOrEqual("6.7.0")){var N={enable:0,source:0};
mqq.invoke("ui","setSharedDocNativeKeyboardEnable",N,function(){});}}});$("#last-saved-timestamp").prettyDate();
resetPrettyDateTimer();pad.handleOptionsChange(pad.padOptions);$(".padaccess").customStyle();padutils.tooltip("#padsidebar [data-tooltip]");
$("#submit-changes").click(function(){var O="/ep/pad/request-merge?padId="+clientVars.padId;var N=$("#submit-changes").attr("value");
$("#submit-changes").attr("value","Submitting...").attr("disabled",true);$.post(O,{},function(P){if(P&&P.success){alert("Your changes have been sent for review");
document.location=P.padURL;return;}else{alert("Oops, an error has occured.  Please try again.");}$("#submit-changes").attr("value",N).removeAttr("disabled");
});});if(!clientVars.isMobile){var E=[["#friend-picker","Invite a collaborator!"],["#padaccess-menu","Change privacy settings"]];
for(var B=0;B<E.length;B++){if(allCookies.getItem("teach")==B){allCookies.setItem("teach",B+1);hints.showHint($(E[B][0]),E[B][1]);
break;}}}$(window).keydown(function(N){if((N.metaKey?!N.ctrlKey:N.ctrlKey)&&N.keyCode==65&&document.activeElement.nodeName=="BODY"){N.preventDefault();
padeditor.ace.focus();padeditor.ace.callWithAce(function(P){var Q=P.getRep();var O=Q.lines.length();var R=Q.lines.atIndex(O-1).text.length;
P.performSelectionChange([0,0],[O-1,R],false);},true,true);return false;}if((N.metaKey?!N.ctrlKey:N.ctrlKey)&&N.keyCode==191&&document.activeElement.nodeName=="BODY"){N.preventDefault();
$("#createpadentry").focus();return false;}if(N.keyCode==27){pad_alonetitle.setTitle(pad.title);pad_alonetitle.titleBlur();
}});if($.isMobilePhone()){padeditor.ace.setEditable(false);}$(window).on("keyboardHide",function(){if($.getAgent.isAndroid()){padeditor.ace.setEditable(false);
}});if(!window.gEditable&&window.isTimWeb){padeditor.ace.setEditable(false);window.sheetReadOnly=true;
$(".cell-input").attr("disabled","disabled");var M={act_type:102};$.report(M);}if(!$.genMTIMVer()&&$.getAgent.isMobile()){pad_banner.openApp();
pad_banner.init("TIM在线文档","多人实时编辑的免费云端office",document.body);padeditor.ace.setEditable(false);window.sheetReadOnly=true;
$("#padAloneTitle").attr("disabled","disabled");}if(!clientVars.isMobile){padeditbar.show();}else{padeditbar.hide();
}pad_compatible.padDispatchEvent(window,"resetKeyboardStatus");trackEvent("pad-visit",null,null,{padId:clientVars.isPublicPad?clientVars.padId:"private",userIsGuest:clientVars.userIsGuest,isEmbed:pad.isEmbed()});
if(!window.isSheet){pad.onContentFinish();}$.report({act_type:window.isLogin?(window.isSheet?111:110):(window.isSheet?109:108)});
if(!window.isSheet){$("#padpage").removeClass("hidePadPage");}var H=new Date();setTimeout(function(){if(!window.isSheet){setTimeout(function(){var N=H;
top.$.monitorContentReportWithDate(H,N,2);},500);}$(window).trigger("afterPadInit");},0);setTimeout(function(){$(window).trigger("getselectionstate");
},0);},initTimWeb:function(){if(clientVars.isMobile||window.isTimApp){return;}if(!clientVars.isMobile){if($("#padbody").find(".sheet-style").length){$("#editor").css("padding-top",25);
$("#editor").css("padding-bottom",50);}else{$("#editor").css("padding-top",96);$("#padeditor").addClass("web-doc-style");
}}pad.initFunctionMoreButton();},initTimPC:function(){if(!clientVars.isMobile&&window.isTimApp){$("#padeditor").addClass("pctim-doc-style");
}},addClientVars:function(A){$.extend(true,clientVars,A);$.extend(true,pad.padOptions,A.initialOptions);
pad.myUserInfo={userId:clientVars.userId,name:clientVars.userName,ip:pad.getClientIp(),colorId:clientVars.userColor||0,userAgent:pad.getDisplayUserAgent(),status:"connected",userLink:clientVars.userLink,userPic:clientVars.userPic,uin:clientVars.uin};
if(!pad.initTime||!clientVars.collab_client_vars){return;}else{if(pad.collabClient){if(A.padId){padrelated.init();
pad.collabClient.setPadId(clientVars.padId,clientVars.globalPadId);$("#follow-container").attr("src","/ep/pad/pad-follow-button?"+$.param({padId:clientVars.padId}));
}if(A.padTitle){pad.handleNewTitle(clientVars.padTitle);}return;}}if(clientVars.specialKey){pad.myUserInfo.specialKey=clientVars.specialKey;
if(clientVars.specialKeyTranslation){$("#specialkeyarea").text("mode: "+String(clientVars.specialKeyTranslation).toUpperCase());
}}window.paduserlist&&paduserlist.init(pad.myUserInfo,clientVars.invitedUserInfos||[],[]);window.paduserline&&paduserline.init(pad.myUserInfo,clientVars.invitedUserInfos||[],[]);
if(!clientVars.isMobile&&window.share){if(window.isTimApp){share.init();share.completeHeandler=function(I,J){var D=null;
var C=null;if($("#padbody").find(".sheet-style").length){D="2";C="http://p.qpic.cn/txdocpic/0/647e1a26-d950-4281-927b-8fd64fa3c4a3/0";
}else{D="1";C="http://p.qpic.cn/txdocpic/0/1207eece-6903-42b6-a5fb-60d457aeca4b/0";}var H=window.location.href.split("#")[0];
var G=pad.title;var F="在线文档";sharebox.init($("#padeditor"),"分享链接已复制到剪贴板，你可以粘贴发送给其他人。");sharebox.show();
if(typeof(external.share)==="function"){external.share(D,G,F,H,C);}var E={act_type:66};$.report(E);};
}else{if(window.isTimWeb){share.init($("#padeditor"),null,"分享链接已复制到剪贴板，你可以粘贴发送给其他人。",true);share.setCopyContent('我分享了来自TIM的在线文档"'+pad.title+'"，点击查看：\n'+share.getShareUrl()+" ");
share.completeHeandler=function(){var C={act_type:66};$.report(C);};}}}pad.initTimWeb();pad.initTimPC();
padcollections.init();padcollections.renderPadCollections();if(pad.getPadId()){padrelated.init();if(typeof(padinvitelog)!="undefined"){}$("[name=padId]").val(pad.getPadId());
}var B=((clientVars.padId==pad.welcomePadId||clientVars.padId==pad.newWelcomePadId||clientVars.padId=="m1Fne5A6Lzn"||clientVars.padId=="clJetHSqs4T")&&clientVars.userIsGuest)||clientVars.padId=="m1Fne5A6Lzn";
pad.collabClient=getCollabClient(padeditor.ace,clientVars.collab_client_vars,pad.myUserInfo,{colorPalette:pad.getColorPalette()},B);
pad.collabClient.setOnUserJoin(pad.handleUserJoin);pad.collabClient.setOnUpdateUserInfo(pad.handleUserUpdate);
pad.collabClient.setOnUserLeave(pad.handleUserLeave);pad.collabClient.setOnUserKill(pad.handleUserKill);
pad.collabClient.setOnUpdateUserSiteInfo(pad.handleUserSiteUpdate);pad.collabClient.setOnUserSiteJoin(pad.handleUserSiteJoin);
pad.collabClient.setOnUserSiteLeave(pad.handleUserSiteLeave);pad.collabClient.setOnGroupJoin(pad.handleGroupJoin);
pad.collabClient.setOnGroupRemove(pad.handleGroupRemove);pad.collabClient.setOnUpdateGroupInfo(pad.handleGroupUpdate);
pad.collabClient.setOnClientMessage(pad.handleClientMessage);pad.collabClient.setOnModeratedPadEdited(pad.handleModeratedPadEdited);
pad.collabClient.setOnServerMessage(pad.handleServerMessage);pad.collabClient.setOnSiteToClientMessage(pad.handleSiteToClientMessage);
pad.collabClient.setOnSiteMessage(pad.handleSiteMessage);pad.collabClient.setOnChannelStateChange(pad.handleChannelStateChange);
pad.collabClient.setOnInternalAction(pad.handleCollabAction);pad.handleNewTitle(clientVars.padTitle||"");
$("#pause-collab").on("click",function(){if(!$("#pause-collab").hasClass("paused")){pad.collabClient.pause();
$("#pause-collab").text("Resume collab").addClass("paused");}else{pad.collabClient.reconnect();$("#pause-collab").text("Pause collab").removeClass("paused");
}});},toggleFollow:function(B){$("#tooltip").remove();var A={followPref:$(B).hasClass("padfollow")?"2":"1",ajax:true};
$.post("/ep/pad/follow/"+clientVars.padId+"/",A,function(C){if(C&&!C.success){modals.showHTMLModal(C.html);
return;}$("#follow-container").refresh(function(){if($("#follow-container .padunfollow").is(":visible")){if(pad.isPadPublic()){}}padutils.tooltip("#follow-container [data-tooltip]");
});trackEvent("toggleFollow",null,null,{followPref:A.followPref});});},dispose:function(){padeditor.dispose();
},onbeforeunload:function(){if(pad.collabClient&&pad.collabClient.hasUncommittedChanges()&&!pad.unsavedPromptDisabled){return;
}this.unloading=true;},disableUnsavedPrompt:function(){pad.unsavedPromptDisabled=true;},initDocIScroll:function(){var A=new IScroll("#padpage",{scrollbars:true,mouseWheel:true,interactiveScrollbars:true,shrinkScrollbars:"scale",bounce:false,scrollX:true,click:true,fadeScrollbar:false,probeType:3});
document.addEventListener("touchmove",function(B){B.preventDefault();},false);},initLocateThread:function(){},initModerationModeControl:function(){if(clientVars.isPadAdmin){var D=pad.padOptions.isModerated?"closed":"open";
var A=$("#toggle-readonly-button");A.attr("class",A.data("src"+D));A.attr("title",A.data("title"+D));
var C=$("#toggle-readonly-link");C.text(pad.padOptions.isModerated?"解锁":"锁定");$([C[0]]).unbind("click").click(function(){if(pad.padOptions.isModerated){pad.changePadOption("isModerated",false);
}else{pad.changePadOption("isModerated",true);}return false;});}else{if(pad.padOptions.isModerated){for(var E in clientVars.invitedUserInfos){var B=clientVars.invitedUserInfos[E];
if(B.userId=="p."+clientVars.creatorId){$("#pad-moderator-link").attr("href",B.userLink).text("Moderated by "+B.name);
$("#pad-moderator").show();$("#pad-moderator-link").css("display","inline-block");break;}}}}},initInviteControl:function(){var A=$("#friend-picker");
var B={fb:{callback:function(C){}},hp:{url:"/ep/pad/hackpadinvite",argsCallback:function(C){return{padId:pad.getPadId(),userId:C[2]};
}},email:{url:"/ep/pad/emailinvite",argsCallback:function(C){return{padId:pad.getPadId(),toAddress:C[2]};
}},typedemail:{callback:function(E){var D="/ep/pad/emailinvite";var C={padId:pad.getPadId(),toAddress:E[1]};
if(!C.toAddress){alert("This does not look like a valid email address.");return;}A.addClass("ac_loading");
$.post(D,C,function(F){A.removeClass("ac_loading");});}}};A.invite({target:"Pad",inviteItemHandlers:B});
},initFollowControl:function(){$("#mainbar").on("click","#follow-container .padfollow, #follow-container .padunfollow",function(){pad.toggleFollow(this);
});},receiveMessage:function(C){if(C.data=="wpSave"){var A=padeditor.ace.getAuthorNames().join(", ");
var B={comment:"Edited collaboratively by "+A+" using "+location.hostname,content:padeditor.ace.exportText()};
window.parent.postMessage(JSON.stringify(B),"*");}},notifyUserCaretUpdate:function(A){pad.collabClient&&pad.collabClient.sendClientMessage({type:"caret",caret:A,changedBy:pad.myUserInfo.userId});
},changePadOption:function(B,C){var A={};A[B]=C;pad.handleOptionsChange(A);pad.collabClient.sendClientMessage({type:"padoptions",options:A,changedBy:pad.myUserInfo.name||"unnamed"});
},changeViewOption:function(B,C){var A={view:{}};A.view[B]=C;pad.handleOptionsChange(A);pad.collabClient.sendClientMessage({type:"padoptions",options:A,changedBy:pad.myUserInfo.name||"unnamed"});
},handleOptionsChange:function(A){if(A.view){if(!pad.padOptions.view){pad.padOptions.view={};}for(var B in A.view){pad.padOptions.view[B]=A.view[B];
}padeditor.setViewOptions(pad.padOptions.view);}if(A.guestPolicy){pad.padOptions.guestPolicy=A.guestPolicy;
delete pad.padOptions.groupId;padguestpolicy.setGuestPolicy(A.guestPolicy);}if(A.groupId){pad.padOptions.guestPolicy="deny";
pad.padOptions.groupId=A.groupId;padguestpolicy.setGroupId(A.groupId);}if("isModerated" in A){pad.padOptions.isModerated=A.isModerated;
pad.initModerationModeControl();}},getPadOptions:function(){return pad.padOptions;},isPadPublic:function(){return(!pad.getIsProPad())||(pad.getPadOptions().guestPolicy=="allow");
},isEmbed:function(){return clientVars.isEmbed;},isDesktopApp:function(){return clientVars.isDesktopApp;
},isMobileApp:function(){return clientVars.isMobileApp;},handleUserJoin:function(A){clientVars.invitedUserInfos.push(A);
window.paduserlist&&paduserlist.userJoinOrUpdate(A);window.paduserline&&paduserline.userJoinOrUpdate(A);
if(clientVars.chatEnabled&&window.padchat){padchat.handleUserJoinOrUpdate(A);}},handleUserUpdate:function(A){window.paduserlist&&paduserlist.userJoinOrUpdate(A);
window.paduserline&&paduserline.userJoinOrUpdate(A);if(clientVars.chatEnabled&&window.padchat){padchat.handleUserJoinOrUpdate(A);
}},handleUserSiteJoin:function(A){if(clientVars.chatEnabled&&window.padchat){clientVars.siteUserInfos[A.userId]=A;
padchat.handleUserSiteJoinOrUpdate(A);}},handleUserSiteUpdate:function(A){if(clientVars.chatEnabled&&window.padchat){padchat.handleUserSiteJoinOrUpdate(A);
}},handleUserLeave:function(A){window.paduserlist&&paduserlist.userLeave(A);window.paduserline&&paduserline.userLeave(A);
if(clientVars.chatEnabled&&window.padchat){padchat.handleUserLeave(A);}padeditor.aceObserver.trigger("remove-user-caret",[A]);
},handleUserSiteLeave:function(A){if(clientVars.chatEnabled&&window.padchat){padchat.handleUserSiteLeave(A);
}},handleUserKill:function(A){window.paduserlist&&paduserlist.userKill(A);window.paduserline&&paduserline.userKill(A);
padeditor.aceObserver.trigger("remove-user-caret",[A]);},handleGroupJoin:function(A){clientVars.invitedGroupInfos.push(A);
padcollections.renderPadCollections();if(clientVars.chatEnabled&&window.padchat){padchat.handleUserJoinOrUpdate(A);
}},handleGroupRemove:function(A){var B=A.groupId;clientVars.invitedGroupInfos=clientVars.invitedGroupInfos.filter(function(C){return B!=C.groupId;
});padcollections.renderPadCollections();padcollections.loadCandidateCollections();},handleGroupUpdate:function(A){if(clientVars.chatEnabled&&window.padchat){padchat.handleUserJoinOrUpdate(A);
}},handleNewTitle:function(A){pad.title=A;var D=["js","c","cpp","cxx","h","hpp","cs","vb","m","java","py","rb","css","html","htm","php","coffee","lua","pl","pm","r","sh","tcl","xml","sql","go","scala","textile","md","markdown","tex","json","txt"];
if(A&&A.indexOf(".")>-1&&D.indexOf($.trim(A).split(".").pop().toLowerCase())>-1){pad.monospace=true;padeditor.setViewOptions({useMonospaceFont:pad.monospace});
$.ajax({url:"/static/js/tok/require_all.js",dataType:"script",cache:true,success:function(){require(["helper"],function(E){padeditor.ace.setProperty("tokenizer",E(pad.title));
});}});}else{if(pad.monospace){pad.monospace=false;padeditor.setViewOptions({useMonospaceFont:pad.monospace});
padeditor.ace.setProperty("tokenizer",null);}}document.title=A+" - TIM在线文档";share.setCopyContent('我分享了来自TIM的在线文档"'+pad.title+'"，点击查看：\n'+share.getShareUrl()+" ");
if(clientVars.isTimDomain){pad_alonetitle.setTitle(A);}var C=A.replace(/[^\w\s-\.]/g,"").replace(/[\s-]+/g,"-");
if(pad.getPadId().length==11&&window.history&&window.history.replaceState&&!pad.isEmbed()&&(document.location.toString().indexOf("/ep/pad/summary/")==-1)){var B="#"+document.location.toString().split("#")[1];
if(B.indexOf("#:h")!=0){B="";}window.history.replaceState({},document.title,(C?C+"-"+pad.getPadId():pad.getPadId())+B);
}window.padchat&&padchat.handleNewTitle(A);padeditor.setShareInfo();},handleModeratedPadEdited:function(){modals.showHTMLModal($("#moderated-modal"),0,true);
},handleClientMessage:function(A){if(A.type=="caret"){padeditor.aceObserver.trigger("update-user-caret",[A]);
}else{if(A.type=="chat"){if(!clientVars.chatEnabled||!window.padchat){return;}padchat.receiveChat(A);
}else{if(A.type=="padtitle"){pad.handleNewTitle(A.title);pad.handleUserChange();}else{if(A.type=="padoptions"){var B=A.options;
pad.handleOptionsChange(B);}else{if(A.type=="guestanswer"){padguestprompt.removeGuestPrompt(A.guestId);
}else{if(A.type=="padright"){padmodals.showModal("#auth-change-dialog",500,true);$("#editor").blur();
$("#padeditor,#editor,#padpage,#padbody,#editor,html").css("cssText","overflow:hidden !important");$("#padeditor,#editor,#padpage,#padbody,#editor,html").css("height",window.innerHeight);
}}}}}}},handleUserChange:function(){if(clientVars.isMobile||(!clientVars.isTim)||(typeof(external.notifyInfoForList)!=="function")){return;
}var A={globalpadid:clientVars.globalPadId,headurl:pad.myUserInfo.userPic,time:new Date(),username:pad.myUserInfo.name,padname:pad.title};
external.notifyInfoForList(A);},editbarClick:function(A){if(padeditbar){padeditbar.toolbarClick(A);}},dmesg:function(B){if(pad.getIsDebugEnabled()){var A=$("#djs").get(0);
var C=(A.scrollTop-(A.scrollHeight-$(A).height())>=-20);$("#djs").append("<p>"+B+"</p>");if(C){A.scrollTop=A.scrollHeight;
}}},handleServerMessage:function(A){if(A.type==="HANDLE_DELETE"){pad.handleDelete();}else{if(A.type==="RELOAD"){if(A.padUrl&&document.location==A.padUrl){document.location.reload(true);
}}else{if(A.type=="NOTICE"){if(A.text){alertBar.displayMessage(function(B){B.find("#servermsgdate").text(" ("+padutils.simpleDateTime(new Date)+")");
B.find("#servermsgtext").text(A.text);});}}else{if(A.type=="GUEST_PROMPT"){padguestprompt.showGuestPrompt(A.userId,A.displayName);
}}}}},handleSiteToClientMessage:function(A){if(!clientVars.chatEnabled||!window.padchat){return;}if(A.type=="mention"){padchat.receiveMention(A);
}else{if(A.type=="invite"){padchat.receiveInvite(A);}}},handleSiteMessage:function(A){if(!clientVars.chatEnabled){return;
}pad.handleClientMessage(A);},handleChannelStateChange:function(B,A){$("body").trigger("connetStatueChangeEvent",[B,A]);
var E=!!padconnectionstatus.isFullyConnected();var D=(padconnectionstatus.getStatus().what=="connecting");
if(B=="CONNECTED"){padconnectionstatus.connected();}else{if(B=="RECONNECTING"){if(this.unloading){return;
}padconnectionstatus.reconnecting();}else{if(B=="DISCONNECTED"){pad.diagnosticInfo.disconnectedMessage=A;
pad.diagnosticInfo.padInitTime=pad.initTime;pad.asyncSendDiagnosticInfo();if(typeof window.ajlog=="string"){window.ajlog+=("Disconnected: "+A+"\n");
}padeditor.disable();padeditbar.disable();padconnectionstatus.disconnected(A);}}}var C=!!padconnectionstatus.isFullyConnected();
if(C!=E){pad.handleIsFullyConnected(C,D);}},handleIsFullyConnected:function(B,A){},handleCollabAction:function(A){if(A=="commitPerformed"){padeditbar.setSyncStatus("syncing");
if(pad.isPadPublic()){}etherpad.doOnce("trackeditstarted",function(){trackEvent("editstarted",clientVars.padId,null,{});
});}else{if(A=="commitAcceptedByServer"){etherpad.doOnce("trackedited",function(){trackEvent("edited",clientVars.padId,null,{});
setTimeout(function(){$("#follow-container").refresh();},1000);});}else{if(A=="newlyIdle"){padeditbar.setSyncStatus("done");
}}}},hideServerMessage:function(){alertBar.hideMessage();},asyncSendDiagnosticInfo:function(){pad.diagnosticInfo.collabDiagnosticInfo=pad.collabClient.getDiagnosticInfo();
window.setTimeout(function(){$.ajax({type:"post",url:"/ep/pad/connection-diagnostic-info",data:{padId:pad.getPadId(),diagnosticInfo:JSON.stringify(pad.diagnosticInfo)},success:function(){},error:function(){}});
},0);},forceReconnect:function(){if(!$("form#reconnectform input.padId").val()){$("form#reconnectform input.padId").val(pad.getPadId());
pad.diagnosticInfo.collabDiagnosticInfo=pad.collabClient.getDiagnosticInfo();$("form#reconnectform input.diagnosticInfo").val(JSON.stringify(pad.diagnosticInfo));
$("form#reconnectform input.missedChanges").val(JSON.stringify(pad.collabClient.getMissedChanges()));
}$("#connectionbox .loading-connect").show();$("#connectionbox .connect-fail").hide();$("#connectionbox .disconnected").hide();
var A=$("form #reconnectform").serialize();$.post($("form #reconnectform").attr("action"),A,function(B,C){$(window).unbind("beforeunload");
document.location.reload(true);}).error(function(){$("#connectionbox .loading-connect").hide();$("#connectionbox .connect-fail").show();
});return false;},handleImportExportFrameCall:function(B,A){},callWhenNotCommitting:function(A){pad.collabClient.callWhenNotCommitting(A);
},getCollabRevisionNumber:function(){return pad.collabClient.getCurrentRevisionNumber();},isFullyConnected:function(){return padconnectionstatus.isFullyConnected();
},addHistoricalAuthors:function(A){if(!pad.collabClient){window.setTimeout(function(){pad.addHistoricalAuthors(A);
},1000);}else{pad.collabClient.addHistoricalAuthors(A);}},deletePad:function(){if(!confirm('Are you sure you want to delete the pad "'+pad.getTitle()+'"?')){return;
}pad.collabClient.setOnServerMessage(function(){});$.post("/ep/padlist/delete",{padIdToDelete:pad.getPadId(),returnPath:"/"},function(){if(history&&history.length>1){history.back();
}else{location.href="/";}});},handleDelete:function(){window.location=window.location;window.location.reload(true);
},updateEmbedCode:function(){var A=location.protocol+"//"+location.host+"/"+encodeURIComponent(pad.getPadId());
var B=A+".js";if($("#embedpad-type").val()){B+="?format="+$("#embedpad-type").val();}var C='\x3cscript src="'+B+'">\x3c/script><noscript><div>View <a href="'+A+'">'+this.getTitle()+"</a> on Tencent Docs.</div></noscript>";
$("#embedpad-code").val(C).select();},showEmbedDialog:function(){},onContentFinish:function(){pad.handleUserOrFileFlag();
if(!clientVars.isMobile){if(pad.getUserIsGuest()){padeditbar.disable();}else{padeditbar.enable();}if(!window.isTimApp){login.init($("header"),!window.isLogin);
$("#web_header_editor_img").css("display",window.gEditable?"inline-block":"none");$(".web_header_readonly_tip").css("display",window.gEditable?"none":"inline-block");
if(window.gEditable){$("#web_header_editor_img").click(function(){pad_alonetitle.focusAndSelect();});
}}if(clientVars.rightFlag&4){function B(C){switch(C){case 0:return"仅自己可用";case 1:return"对特定成员公开";case 2:case 3:return"所有人公开";
default:return"";}}$(".toolbar-auth-btn").css("display","inline-block");$(".toolbar-auth-btn").attr("data-tooltip",B(clientVars.policy));
padutils.tooltip(".toolbar-auth-btn");var A=function(){$.report({act_type:164});$("#auth-container").show();
AuthModule.showAuth(document.getElementById("auth-container"),{padId:pad.getPadId(),editable:clientVars.rightFlag&4,isSheet:window.isSheet,padTitle:$("#padAloneTitle").val(),callBack:function(C){$("#auth-container").hide();
$(".toolbar-auth-btn").attr("data-tooltip",B(C.svrPolicy));}});};$(".toolbar-auth-btn").click(function(){if("undefined"!=typeof AuthModule){A();
}else{$.cachedScript(lazySrc.authUrl).done(function(C,D){A();});}});}this.initFunctionMoreButton();$(".toolbar-more-btn-container").css("display","inline-block");
}},handleUserOrFileFlag:function(){$.ajax({type:"get",url:"/ep/api/getalltipflag",data:{globalPadId:clientVars.globalPadId},success:function(A){if(A.retcode!=100){return;
}if(!A.newUserTip&&((!clientVars.isMobile&&navigator.appVersion.indexOf("Win")!=-1)||window.isTimApp)){beginneGuidePage.init($("body"),clientVars.isMobile);
}if(clientVars.isMobile){if(!window.gEditable&&!A.readOnlyTip&&UA_Util.MTIMLargerOrEqual("1.1.0")){pad_banner.init("文档权限为“只读”","由于作者设置权限，您无法编辑此文档。",document.body,undefined,function(C,B){if(B){$.ajax({type:"get",url:"/ep/api/settipflag",data:{type:4,flag:1},success:function(D){}});
}},["bannerIcon","bannerButton","bannerVerticalline"],window.isSheet?44:null);}}else{if(!A.importTip){padutils.toolToast("格式复杂的"+(clientVars.padType=="doc"?"文档":"表格")+"转换后可能存在内容不完整。",{top:5,"max-width":500},{toolToastCloseTime:3000,isNeedReflush:true,toolToastRemoveCallBack:function(){$.ajax({type:"get",url:"/ep/api/settipflag",data:{type:32,flag:1,globalPadId:clientVars.globalPadId},success:function(B){}});
}});$("body").on("connetStatueChangeEvent",function(C,B){if(B=="RECONNECTING"||B=="DISCONNECTED"){padutils.hideToolToast();
}});}if(!clientVars.isOpendocxfromTim&&!A.adverTip&&navigator.appVersion.indexOf("Win")!=-1){diversionBarPage.init($("body"),function(){$.ajax({type:"get",url:"/ep/api/settipflag",data:{type:33,flag:1,globalPadId:clientVars.globalPadId},success:function(B){}});
});}}}});},initFunctionMoreButton:function(){var B=[{content:"查看修订记录",disable:!window.gEditable,clickcallback:function(){record_change.showRecordChange();
$.report({act_type:172});}},{content:"导出",clickcallback:function(){padeditor.ace.callWithAce(function(C){if(window.isSheet){padeditbar_utils.sheetButtonClickWidthData("sheet-export",{title:pad.title,url:window.location.href});
}else{C.doExport2();}$.report({act_type:44});});}}];var A=new DropDown(B,$(".toolbar-more-btn-container"));
$(window).bind("SheetMouseDown",function(C){A.hide();});$(window).bind("SheetScroll",function(C){A.hide();
});$(".toolbar-more-btn").click(function(C){A.toggleDropDown();if(C.preventDefault){C.preventDefault();
}else{C.returnValue=false;}return false;});$(".sharebutton,.toolbar-more-btn,.toolbar-auth-btn").mousedown(function(C){$(this).addClass("header-function-btn-selected");
$(this).removeClass("header-function-btn-hover");});$(".sharebutton,.toolbar-more-btn,.toolbar-auth-btn").mouseup(function(C){$(this).removeClass("header-function-btn-selected");
$(this).addClass("header-function-btn-hover");});$(".sharebutton,.toolbar-more-btn,.toolbar-auth-btn").mouseenter(function(C){$(this).addClass("header-function-btn-hover");
});$(".sharebutton,.toolbar-more-btn,.toolbar-auth-btn").mouseleave(function(C){$(this).removeClass("header-function-btn-hover header-function-btn-selected");
});}};var alertBar=(function(){var A=padutils.makeShowHideAnimator(C,false,25,400);function C(D){if(D==-1){$("#alertbar").css("opacity",0).css("display","block");
}else{if(D==0){$("#alertbar").css("opacity",1);}else{if(D==1){$("#alertbar").css("opacity",0).css("display","none");
}else{if(D<0){$("#alertbar").css("opacity",D+1);}else{if(D>0){$("#alertbar").css("opacity",1-D);}}}}}}var B={displayMessage:function(D){A.show();
D($("#alertbar"));},hideMessage:function(){A.hide();}};return B;}());$(document).ready(function(){setTimeout(pad.init,0);
});$(window).unload(function(){pad.dispose();});$(window).bind("beforeunload",function(){return pad.onbeforeunload();
});top.setKeyboardHeight=function(A){$(window).trigger("setKeyboardHeight",A);};
/*
 * JavaScript Pretty Date
 * Copyright (c) 2008 John Resig (jquery.com)
 * Licensed under the MIT license.
 */
function prettyDate(E){var C=E.replace(/\s+/,"").split(/[^0-9]/);
var A=null;if(C.length>=5){A=E?new Date(C[0],C[1]-1,C[2],C[3],C[4]):new Date();}else{A=E?new Date(E):new Date();
}var B=new Date();var D="";var H=A.getHours();var G=A.getMinutes();var F=(H>9?H:"0"+H)+":"+(G>9?G:"0"+G);
var J=new Date(B.getFullYear(),B.getMonth(),B.getDate());var I=J-A;if(I>0&&I<24*60*60*1000){D="昨天 "+F;
}else{if(A.getFullYear()<B.getFullYear()){D=A.getFullYear()+"/"+(A.getMonth()+1)+"/"+A.getDate()+" "+F;
}else{if(A.getMonth()<B.getMonth()||A.getDate()<B.getDate()){D=(A.getMonth()+1)+"/"+A.getDate()+" "+F;
}else{D=F;}}}return D;}function dateFormat(A){if(A instanceof Date){return[A.getFullYear(),"年",A.getMonth()+1,"月",A.getDate(),"日 ",A.getHours()>9?A.getHours():("0"+A.getHours()),":",A.getMinutes()>9?A.getMinutes():("0"+A.getMinutes())].join("");
}else{if(A.toString()){return A.toString();}else{return"";}}}var timerTipsHidden=null;function showWeakTips(B,A,C){destoryTimerTipsHidden();
destroyTimerLastState();$("#editor-last-state").text(B);$("#editor-last-changed").hide();$("#editor-last-state").show();
if(A){timerTipsHidden=setTimeout(function(){$("#last-saved-timestamp").prettyDate();hideWeakTips();},A);
}if(C){resetPrettyDateTimer();}}function hideWeakTips(){$("#editor-last-changed").show();$("#editor-last-state").hide();
destoryTimerTipsHidden();destroyTimerLastState();}function destoryTimerTipsHidden(){if(timerTipsHidden){clearTimeout(timerTipsHidden);
timerTipsHidden=null;}}var timerPrettyDate=null;function resetPrettyDateTimer(){if(timerPrettyDate){clearInterval(timerPrettyDate);
timerPrettyDate=null;}timerPrettyDate=setInterval(function(){$("#last-saved-timestamp").prettyDate();
},60*1000);}var timerLastState=null;function showWeakTipsLoading(A,C,D,E){destoryTimerTipsHidden();destroyTimerLastState();
$("#editor-last-state").text(A);$("#editor-last-changed").hide();$("#editor-last-state").show();if(C){var B=0;
timerLastState=setInterval(function(){var G="";var F=0;for(;F<(B%3)+1;F++){G+=".";}for(;F<3;F++){G+="&nbsp;";
}B++;$("#editor-last-state")[0].innerHTML=A+G;},C);}if(D){timerTipsHidden=setTimeout(function(){hideWeakTips();
},D);}if(E){resetPrettyDateTimer();}}function destroyTimerLastState(){if(timerLastState){clearInterval(timerLastState);
timerLastState=null;}}function setDateTipsHover(A){if(typeof A=="string"){var B=A.replace(/\s+/,"").split(/[^0-9]/);
if(B.length>=5){A=A?new Date(B[0],B[1]-1,B[2],B[3],B[4]):new Date();}else{A=A?new Date(A):new Date();
}}var C=dateFormat(A);$("#editor-last-changed").attr("title","最近更新: "+C);}function setMobileDateTips(A){var B="最近更新: "+A;
setMobileTips(B);}function setMobileTips(E,A,C,B){if($.genMQQVer()){return;}destoryTimerTipsHidden();
destroyTimerLastState();try{mqq.invoke("ui","setWebviewNaviTitle",{title:E,color:B});}catch(D){console.log("setWebviewNaviTitle fail");
}if(A){timerTipsHidden=setTimeout(function(){hideMobileTips();},A);}if(C){resetPrettyDateTimer();}}function hideMobileTips(){try{mqq.invoke("ui","setWebviewNaviTitle",{title:""});
}catch(A){console.log("setWebviewNaviTitle fail");}}function setStatusTips(A,B,C){destoryTimerTipsHidden();
destroyTimerLastState();if(clientVars.isMobile&&window.SupportAdvancedFeature.setWebviewNaviTitle){setMobileTips(A,B,true,C);
}else{showWeakTips(A,B,true);}}var isShowAutoSaveTips=false;function setAutoSaveTips(B){if(!isShowAutoSaveTips||!!B){var A="编辑内容将实时保存";
setStatusTips(A);isShowAutoSaveTips=true;}}if(typeof jQuery!="undefined"){jQuery.fn.prettyDate=function(){return this.each(function(){destoryTimerTipsHidden();
var A=prettyDate(this.getAttribute("time"));if(clientVars.isMobile&&window.SupportAdvancedFeature.setWebviewNaviTitle){setMobileDateTips(A||"刚刚");
}else{hideWeakTips();setDateTipsHover(this.getAttribute("time"));jQuery(this).text(A||"刚刚");}});};}var KeyboardStatusListener=function(){var B=null;
var A={initWindowHeight:0,isKeyboardShown:false,init:function(){if(/ipad|iphone|ipod|android/i.test(navigator.userAgent.toLowerCase())){A.registerResetKeyboardStatusListeners();
A.resetKeyboardStatus();}},registerCheckKeyboardStatusListeners:function(){if(/ipad|iphone|ipod/i.test(navigator.userAgent.toLowerCase())){if(B){clearInterval(B);
}B=setInterval(function(){A.checkKeyboardStatus();},100);}else{if(/android/i.test(navigator.userAgent.toLowerCase())){$(window).unbind("resize",A.checkKeyboardStatus);
$(window).bind("resize",A.checkKeyboardStatus);}}},registerResetKeyboardStatusListeners:function(){$(window).unbind("resetKeyboardStatus",A.resetKeyboardStatus);
$(window).bind("resetKeyboardStatus",A.resetKeyboardStatus);},resetKeyboardStatus:function(){setTimeout(function(){A.initWindowHeight=window.innerHeight;
A.registerCheckKeyboardStatusListeners();},0);},checkKeyboardStatus:function(){if(Math.abs(window.innerHeight-A.initWindowHeight)<100){if(A.isKeyboardShown){pad_compatible.padDispatchEvent(window,"keyboardHide");
}A.isKeyboardShown=false;}else{if(!A.isKeyboardShown){pad_compatible.padDispatchEvent(window,"keyboardShow");
}A.isKeyboardShown=true;}}};A.init();return A;};var keyboardStatusListener=new KeyboardStatusListener();
var beginneGuidePage=(function(){var A={init:function(B,C){A.isMobile=false;if(C){A.isMobile=C;}if(!B){B=$("body");
}if(!$("#beginne-guide-wrapper").length){$("<div id='beginne-guide-shadow-mask' onselectstart='return false;' style='-moz-user-select:none;'/>").prependTo(B);
$("<div id='beginne-guide-wrapper' onselectstart='return false;' style='-moz-user-select:none;'> <div class='beginne-guide-wrapper-close'/> <div class='beginne-guide-wrapper-button'>立即体验</div></div>").prependTo(B);
if(C){$("#beginne-guide-wrapper").addClass("mobile-beginne-guide");}$("#beginne-guide-shadow-mask").on("click",function(E){E.preventDefault();
E.stopPropagation();return false;});if(A.isMobile){document.addEventListener("touchmove",function(E){if($("#beginne-guide-wrapper").is(":visible")){E.preventDefault();
E.stopPropagation();return false;}},false);}$(".beginne-guide-wrapper-button").hover(function(){$(this).removeClass("beginne-guide-wrapper-button-down");
$(this).addClass("beginne-guide-wrapper-button-hover");},function(){$(this).removeClass("beginne-guide-wrapper-button-hover");
$(this).removeClass("beginne-guide-wrapper-button-down");});$(".beginne-guide-wrapper-button").on("mousedown",function(){$(this).removeClass("beginne-guide-wrapper-button-hover");
$(this).addClass("beginne-guide-wrapper-button-down");}).on("mouseup",function(){$(this).removeClass("beginne-guide-wrapper-button-down");
$(this).addClass("beginne-guide-wrapper-button-hover");});$("#beginne-guide-wrapper div").on("click",function(){if($(this).hasClass("beginne-guide-wrapper-close")){$.report({act_type:143});
}else{if($(this).hasClass("beginne-guide-wrapper-button")){$.report({act_type:142});}}A.close();});$(window).on("resize",function(){A.fitPosition(B);
});}else{if($("#beginne-guide-wrapper").parent().length){var D=$("#beginne-guide-wrapper").detach();B.append(D);
var D=$("#beginne-guide-shadow-mask").detach();B.append(D);}}A.fitPosition(B);A.show();},fitPosition:function(B){$("#beginne-guide-wrapper").css("left",Math.floor((Math.min(B.width(),$(window).width())-$("#beginne-guide-wrapper").outerWidth())/2));
$("#beginne-guide-wrapper").css("top",Math.floor((Math.min(B.height(),$(window).height())-$("#beginne-guide-wrapper").outerHeight())*0.4));
},close:function(){A.hide();if(A.isMobile){if(window.SupportAdvancedFeature.setSharedDocNativeKeyboardEnable){mqq.invoke("ui","setSharedDocNativeKeyboardEnable",{enable:1},function(){});
}}$.ajax({type:"get",url:"/ep/api/settipflag",data:{type:2,flag:1},success:function(B){}});},show:function(){$.report({act_type:141});
$("#beginne-guide-wrapper").hide().fadeIn(200);$("#beginne-guide-shadow-mask").hide().fadeIn();if(A.isMobile){if(window.SupportAdvancedFeature.setSharedDocNativeKeyboardEnable){mqq.invoke("ui","setSharedDocNativeKeyboardEnable",{enable:0},function(){});
}}},hide:function(){$("#beginne-guide-wrapper").show().fadeOut(200);$("#beginne-guide-shadow-mask").show().fadeOut(200);
}};return A;}());var diversionBarPage=(function(){var A={init:function(B,C){if(!B){B=$("body");}if($("#diversion-bar-wrapper").length){$("#diversion-bar-wrapper").remove();
}$("<div id='diversion-bar-wrapper'> <div class='diversion-bar-icon'/> <div class='diversion-bar-division-line'/><div class='diversion-bar-content'><div class='diversion-bar-title'>TIM</div><div class='diversion-bar-description'>轻聊的QQ，轻松管理你的所有在线文档。</div></div>  <div class='diversion-bar-button'>立即体验</div><div class='diversion-bar-close'/> </div>").prependTo(B);
$(".diversion-bar-button").hover(function(){$(this).removeClass("diversion-bar-button-down");$(this).addClass("diversion-bar-button-hover");
},function(){$(this).removeClass("diversion-bar-button-hover");$(this).removeClass("diversion-bar-button-down");
});$(".diversion-bar-close").hover(function(){$(this).addClass("diversion-bar-close-hover");},function(){$(this).removeClass("diversion-bar-close-hover");
});$(".diversion-bar-button").on("mousedown",function(){$(this).removeClass("diversion-bar-button-hover");
$(this).addClass("diversion-bar-button-down");}).on("mouseup",function(){$(this).removeClass("diversion-bar-button-down");
$(this).addClass("diversion-bar-button-hover");});$("#diversion-bar-wrapper .diversion-bar-button").on("click",function(){$.report({act_type:192});
window.open("http://office.qq.com/");A.hide();});$("#diversion-bar-wrapper .diversion-bar-close").on("click",function(){$.report({act_type:193});
A.hide();if(C){C();}});A.show();$.report({act_type:191});},show:function(){$("#diversion-bar-wrapper").show();
},hide:function(){$("#diversion-bar-wrapper").hide();}};return A;}());(function(A){var D,B,K=0,F={control:A('<div id="toolbar-colorPicker-picker-wrapper" data-tooltip="字体颜色" class="hp-ui-button toolbar-menu-button-wrapper toolbar-colorPicker-menu-button-wrapper"><div id="toolbar-colorPicker-picker-outer-container" class="toolbar-menu-button-outer-container toolbar-menu-button-colorPicker-outer-container toolbar-inline-block" style="user-select: none;"><div id="toolbar-colorPicker-picker-inner-container" class="toolbar-button-inner-container toolbar-inline-block" style="user-select;none;"><div id="toolbar-colorPicker-picker-caption" class="toolbar-colorPicker-picker-caption toolbar-inline-block" style="user-select: none;"> <div id="toolbar-colorPicker-picker-text-outer" class="toolbar-colorPicker-picker-text-outer" style="user-select: none;"> <div id="toolbar-colorPicker-picker-text-bg" class="toolbar-colorPicker-picker-text-background" style="user-select: none;"> <div id="toolbar-colorPicker-picker-text-char" class="toolbar-colorPicker-picker-text-char toolbar-inline-block" style="user-select: none;">A</div></div></div></div><div id="toolbar-colorPicker-picker-icon-outer" class="toolbar-colorPicker-picker-icon-outer" style="user-select: none;"><div id="toolbar-colorPicker-picker-icon" class="toolbar-colorPicker-picker-icon toolbar-inline-block" style="user-select: none;"></div> </div></div></div></div>'),paintBrushControl:A('<div id="toolbar-colorPicker-picker-paint-wrapper" data-tooltip="填充颜色" class="hp-ui-button toolbar-menu-button-wrapper toolbar-colorPicker-menu-button-wrapper"><div id="toolbar-colorPicker-picker-paint-outer-container" class="toolbar-menu-button-outer-container toolbar-menu-button-colorPicker-outer-container toolbar-inline-block" style="user-select: none;"><div id="toolbar-colorPicker-picker-paint-inner-container" class="toolbar-button-inner-container toolbar-inline-block" style="user-select;none;"><div id="toolbar-colorPicker-picker-paint-caption" class="toolbar-colorPicker-picker-caption toolbar-inline-block" style="user-select: none;"> <div id="toolbar-colorPicker-picker-paint-text-outer" class="toolbar-colorPicker-picker-text-outer" style="user-select: none;"> <div id="toolbar-colorPicker-picker-paint-text-bg" class="toolbar-colorPicker-picker-text-background" style="user-select: none;"> <div id="toolbar-colorPicker-picker-paint-text-char" class="toolbar-colorPicker-picker-text-char docx-icon-common toolbar-colorPicker-picker-paint-brush toolbar-inline-block" style="user-select: none;"></div></div></div></div><div id="toolbar-colorPicker-picker-paint-icon-outer" class="toolbar-colorPicker-picker-icon-outer" style="user-select: none;"><div id="toolbar-colorPicker-picker-paint-icon" class="toolbar-colorPicker-picker-icon toolbar-inline-block" style="user-select: none;"></div> </div></div></div></div>'),paintDocBrushControl:A('<div id="toolbar-colorPicker-picker-paint-wrapper" data-tooltip="突出显示" class="hp-ui-button toolbar-menu-button-wrapper toolbar-colorPicker-menu-button-wrapper"><div id="toolbar-colorPicker-picker-paint-outer-container" class="toolbar-menu-button-outer-container toolbar-menu-button-colorPicker-outer-container toolbar-inline-block" style="user-select: none;"><div id="toolbar-colorPicker-picker-paint-inner-container" class="toolbar-button-inner-container toolbar-inline-block" style="user-select;none;"><div id="toolbar-colorPicker-picker-paint-caption" class="toolbar-colorPicker-picker-caption toolbar-inline-block" style="user-select: none;"> <div id="toolbar-colorPicker-picker-paint-text-outer" class="toolbar-colorPicker-picker-text-outer" style="user-select: none;"> <div id="toolbar-colorPicker-picker-paint-text-bg" class="toolbar-colorPicker-picker-text-background" style="user-select: none;"> <div id="toolbar-colorPicker-picker-paint-text-char" class="toolbar-colorPicker-picker-text-char docx-icon-common toolbar-colorPicker-picker-doc-paint-brush toolbar-inline-block" style="user-select: none;"></div></div></div></div><div id="toolbar-colorPicker-picker-paint-icon-outer" class="toolbar-colorPicker-picker-icon-outer" style="user-select: none;"><div id="toolbar-colorPicker-picker-paint-icon" class="toolbar-colorPicker-picker-icon toolbar-inline-block" style="user-select: none;"></div> </div></div></div></div>'),palette:A('<div id="colorPicker_palette"  class="colorPicker-palette" />'),swatch:A('<div class="colorPicker-swatch" data-tooltip="">&nbsp;</div>'),},J="transparent",C="#000000",E="#ffffff",H,I,G={};
colorsId={};paintBrushColorsId={};A.fn.colorPicker=function(L){A.fn.colorPicker.initColorPicker(L);this.each(function(){var Q=A(this),M=A.extend({},A.fn.colorPicker.defaults,L),U=A.fn.colorPicker.toHex(M.pickerDefault),V=A.fn.colorPicker.toHex(M.brushPickerDefault),O=(M.pickerType==1?F.control.clone():M.isDoc?F.paintDocBrushControl.clone():F.paintBrushControl.clone()),P=F.palette.clone().attr("id","colorPicker_palette-"+K),S=P[0].id,N,T,R;
G[S]=M.pickerType;if(L.colorButton){if(M.pickerType==1){H=L.colorButton;}else{if(M.pickerType==2){I=L.colorButton;
}}}A.each(M.colors,function(W){N=F.swatch.clone();var Y=M.colorsTips[W];N.attr("data-tooltip",Y);var X="#"+this;
if(M.pickerType==1){N.attr("id","colorPicker-swatch-"+W);colorsId[X]="#"+N.attr("id");}else{if(M.pickerType==2){N.attr("id","colorPicker-swatch-paint-"+W);
paintBrushColorsId[X]="#"+N.attr("id");}}if(M.colors[W]===J){N.addClass(J).text("X");A.fn.colorPicker.bindPalette(N,J);
}else{N.css("background-color",X);A.fn.colorPicker.bindPalette(N);}N.appendTo(P);});A("body").append(P);
P.hide();Q.after(O);if(M.pickerType==1){C=U;A("#toolbar-colorPicker-picker-text-outer").css("border-bottom-color",U);
}else{if(M.pickerType==2){E=V;A("#toolbar-colorPicker-picker-paint-text-outer").css("border-bottom-color",V);
}}T=O.find(".toolbar-colorPicker-picker-caption");R=O.find(".toolbar-colorPicker-picker-icon-outer");
if(T){T.bind("click",function(){if(Q.is(":not(:disabled)")){A.fn.colorPicker.applyColor(A("#"+S),O);}});
}if(R){R.bind("click",function(){if(Q.is(":not(:disabled)")){A.fn.colorPicker.togglePalette(A("#"+S),O);
}});}if(L&&L.onColorChange){O.data("onColorChange",L.onColorChange);}else{O.data("onColorChange",function(){});
}K++;});padutils.tooltip("[data-tooltip]");return this;};A.extend(true,A.fn.colorPicker,{initColorPicker:function(L){if(L.colorPickerClass){F.control.addClass(L.colorPickerClass);
}window.addEventListener("SheetMouseDown",function(M){A.fn.colorPicker.hidePalette();});window.addEventListener("SheetScroll",function(M){A.fn.colorPicker.hidePalette();
});window.addEventListener("closedropdown",function(M){A.fn.colorPicker.hidePalette();});},toHex:function(L){if(L.match(/[0-9A-F]{6}|[0-9A-F]{3}$/i)){L=L.toLowerCase();
return(L.charAt(0)==="#")?L:("#"+L);}else{if(L.match(/^rgb\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*\)$/)){var M=([parseInt(RegExp.$1,10),parseInt(RegExp.$2,10),parseInt(RegExp.$3,10)]),N=function(R){if(R.length<2){for(var S=0,T=2-R.length;
S<T;S++){R="0"+R;}}return R;};if(M.length===3){var Q=N(M[0].toString(16)),P=N(M[1].toString(16)),O=N(M[2].toString(16));
return"#"+Q+P+O;}}else{return false;}}},checkMouse:function(L,Q){L.preventDefault();var O=B,P=A(L.target).parents("#"+O.attr("id")).length;
if(L.target===D[0]||P>0){return;}var M=false;var N=L.target.id;if(N.length>0&&N.indexOf("toolbar-colorPicker-picker")>=0){M=true;
}if(M){return;}A.fn.colorPicker.hidePalette();},hidePalette:function(){if(B){B.unbind("mousedown",A.fn.colorPicker.checkMouse);
A(document).unbind("mousedown",A.fn.colorPicker.checkMouse);B.removeClass("open");B.hide();}},showPalette:function(L){var M=A.fn.colorPicker.getCurrentPickerType();
if(M==1){if(!(H.isEnable())){return;}A.fn.colorPicker.addSwatchDownClass(1,C);}else{if(M==2){if(!(I.isEnable())){return;
}A.fn.colorPicker.addSwatchDownClass(2,E);}}A("#tooltip").remove();L.css({top:D.offset().top+(D.outerHeight())+14,left:D.offset().left+((D.outerWidth())/2)-((L.outerWidth())/2)});
if(L){L.addClass("open");L.show();L.bind("mousedown",A.fn.colorPicker.checkMouse);A(document).bind("mousedown",A.fn.colorPicker.checkMouse);
}},togglePalette:function(M,N){if(N){D=N;}B=M;var O=B.attr("id");for(var L in G){if(O!==L){A("#"+L).unbind("mousedown",A.fn.colorPicker.checkMouse);
A("#"+L).removeClass("open");A("#"+L).hide();}}if(B.hasClass("open")){A.fn.colorPicker.hidePalette();
}else{A.fn.colorPicker.showPalette(M);}},applyColor:function(O,N){var L=A.fn.colorPicker.getCurrentPickerType();
if(L==1){if(!(H.isEnable())){return;}A.fn.colorPicker.addSwatchDownClass(1,C);}else{if(L==2){if(!(I.isEnable())){return;
}A.fn.colorPicker.addSwatchDownClass(2,E);}}A.fn.colorPicker.hidePalette();if(N){D=N;}B=O;L=A.fn.colorPicker.getCurrentPickerType();
var M;if(L==1){M=C;}else{if(L==2){M=E;}}A.fn.colorPicker.hidePalette();if(M&&D){D.data("onColorChange").call(D,M);
}},changeColor:function(L){var M=A.fn.colorPicker.getCurrentPickerType();if(M==1){A("#toolbar-colorPicker-picker-text-outer").css("border-bottom-color",L);
}else{if(M==2){A("#toolbar-colorPicker-picker-paint-text-outer").css("border-bottom-color",L);}}A.fn.colorPicker.hidePalette();
D.data("onColorChange").call(D,L);},getCurrentPickerType:function(){if(B&&G){var L=B.attr("id");var M=G[L];
return M;}return 0;},removeSwatchDownClass:function(M,L){if(L){if(M==1){if(colorsId[L]&&(A(colorsId[L]).hasClass("colorPicker-swatch-down"))){A(colorsId[L]).removeClass("colorPicker-swatch-down");
}}else{if(paintBrushColorsId[L]&&(A(paintBrushColorsId[L]).hasClass("colorPicker-swatch-down"))){A(paintBrushColorsId[L]).removeClass("colorPicker-swatch-down");
}}}},addSwatchDownClass:function(M,L){if(L){L=A.fn.colorPicker.toHex(L);if(M==1){if(colorsId[L]&&(!(A(colorsId[L]).hasClass("colorPicker-swatch-down")))){A(colorsId[L]).addClass("colorPicker-swatch-down");
}}else{if(M==2){if(paintBrushColorsId[L]&&(!(A(paintBrushColorsId[L]).hasClass("colorPicker-swatch-down")))){A(paintBrushColorsId[L]).addClass("colorPicker-swatch-down");
}}}}},bindPalette:function(M,L){L=L?L:A.fn.colorPicker.toHex(M.css("background-color"));M.bind({click:function(O){var N=A.fn.colorPicker.getCurrentPickerType();
if(N==1){A.fn.colorPicker.removeSwatchDownClass(1,C);C=L;}else{if(N==2){A.fn.colorPicker.removeSwatchDownClass(2,E);
E=L;}}A.fn.colorPicker.changeColor(L);},mouseover:function(N){if(!(A(this).hasClass("colorPicker-swatch-down"))){A(this).addClass("colorPicker-swatch-hover");
}},mouseout:function(N){if(A(this).hasClass("colorPicker-swatch-hover")){A(this).removeClass("colorPicker-swatch-hover");
}}});}});A.fn.colorPicker.changePickerColor=function(N,Q,O){if(N){var L=A.fn.colorPicker.toHex(N);if(Q){var R=A.fn.colorPicker.toHex(A.fn.colorPicker.defaults.pickerDefault);
A.fn.colorPicker.removeSwatchDownClass(1,C);C=R;A.fn.colorPicker.addSwatchDownClass(1,C);A("#toolbar-colorPicker-picker-text-outer").css("border-bottom-width","0");
}else{if(L){A.fn.colorPicker.removeSwatchDownClass(1,C);C=L;A.fn.colorPicker.addSwatchDownClass(1,C);
A("#toolbar-colorPicker-picker-text-outer").css("border-bottom-color",L);var P=A("#toolbar-colorPicker-picker-text-outer").css("border-bottom-width");
if(P==="0px"){A("#toolbar-colorPicker-picker-text-outer").css("border-bottom-width","4px");}}}}if(O){var M=A.fn.colorPicker.toHex(O);
if(M){A.fn.colorPicker.removeSwatchDownClass(2,E);E=M;A.fn.colorPicker.addSwatchDownClass(2,E);A("#toolbar-colorPicker-picker-paint-text-outer").css("border-bottom-color",M);
}}};A.fn.colorPicker.isColorPaletteShow=function(M){var L=false;if(M==A.fn.colorPicker.getCurrentPickerType()){if(B&&B.hasClass("open")){L=true;
}}return L;};A.fn.colorPicker.defaults={pickerDefault:"#000000",brushPickerDefault:"#ffffff",colors:["ffffff","000000","ff0000","ff9a00","ffff00","00ff00","00ffff","4784eb","9b00ff","f3f3f1","949495","f6bfbc","fde8d0","ebe1a9","d6e9ca","ebf6f7","cfe1ef","e7e7eb","dcdddd","595857","ee827c","f9c89b","e6b422","93b69c","83ccd2","698aab","867ba9","c0c6c9","40464a","e83929","cf760a","8d6449","47885e","00a3af","507ea4","765c83","adadad","0d0015","ba2636","8a3b00","583822","00552e","00767a","1e50a2","522f60"],colorsTips:["白","黑","红","橙","黄","葱绿","湖蓝","天色","紫","白练","鼠","虹","薄卵","蒸栗","白绿","蓝白","天空","紫水晶","白鼠","墨","甚三红","雄黄","金子","薄青","白群","薄花","紫苑","灰青","石墨","红绯","红金","枯茶","绿青","浅葱","薄缥","紫霞","薄纯","漆黑","朱绯","褐","黑茶","深绿","苍蓝","琉璃","葡萄"],colorPickerClass:"",pickerType:1};
})(jQuery);var BorderMenu=function(E,D){var F=["toolbar-icon-sheet-border-all","toolbar-icon-sheet-border-inner","toolbar-icon-sheet-border-horizontal","toolbar-icon-sheet-border-vertical","toolbar-icon-sheet-border-outer","toolbar-icon-sheet-border-left","toolbar-icon-sheet-border-top","toolbar-icon-sheet-border-right","toolbar-icon-sheet-border-bottom","toolbar-icon-sheet-border-clear"];
var H=["所有边框","内部边框","水平边框","垂直边框","外部边框","左侧边框","顶部边框","右侧边框","底部边框","无边框"];var G=["border-all","border-inner","border-horizontal","border-vertical","border-outer","border-left","border-top","border-right","border-bottom","border-clear"];
var B=null;var C={palette:$('<div id="toolbar_border_palette"  class="toolbar-border-palette" />'),tableCell:$('<td class="toolbar-border-palette-table-td toolbar-inline-block" data-tooltip="" style="user-select: none;"> <div class="toolbar-border-palette-icon-outer toolbar-inline-block"  style="user-select: none;"> <div class="toolbar-border-palette-icon-container" style="user-select: none;">&nbsp;</div> </div></td>'),tableRow:$('<tr class="toolbar-border-palette-table-row" style="user-select: none;"></tr>'),paletteTable:$('<div style="user-select;none;" > <table class="toolbar-border-palette-table" cellspacing="0" cellpadding="0" style="user-select: none;" ><tbody class="toolbar-border-palette-table-body" id="tableBody" style="user-select: none;"></tbody> </table></div>'),borderColorPicker:$('<div id = "toolbar-border-palette-color-picker" class="toolbar-border-palette-color-picker-outer" style="user-select:none"><div id="toolbar-border-palette-color-picker-caption" class="toolbar-border-palette-colorPicker-picker-caption toolbar-inline-block" style="user-select: none;"> <div id="toolbar-border-palette-color-picker-text-outer" class="toolbar-border-palette-colorPicker-picker-text-outer" style="user-select: none;"> <div id="toolbar-border-palette-color-picker-text-bg" class="toolbar-border-palette-colorPicker-picker-text-background" style="user-select: none;"> <div id="toolbar-border-palette-color-picker-text-char" class="docx-icon-common toolbar-border-palette-colorPicker-picker-border-color toolbar-inline-block" style="user-select: none;"></div></div></div></div><div class="toolbar-border-palette-color-picker-text toolbar-inline-block">边框颜色</div><div class="toolbar-border-palette-colorPicker-icon toolbar-inline-block"></div></div>')};
var A={isSetColorCallback:false,borderColorPickerPalette:null,lastSelectedColor:"#000000",togglePalette:function(I){if($("#toolbar_border_palette").hasClass("open")){A.hidePalette(I);
}else{A.showPalette(I);}},checkMouse:function(I){if(I){I.preventDefault();if(I.currentTarget&&I.currentTarget.id){var L=I.currentTarget.id;
if(L.length>0&&L=="toolbar_border_palette"){return;}}var J=$(I.target).parents("#toolbar-sheet-border-group");
if(J&&J.attr("id")=="toolbar-sheet-border-group"){return;}var K=$(I.target).parents("#common-color-picker-palette");
if((K&&K.attr("id")=="common-color-picker-palette")||$(I.target).attr("id")=="common-color-picker-palette"){return;
}}A.hidePalette(I);},hidePalette:function(I){$(document).unbind("mousedown",A.checkMouse);$("#toolbar_border_palette").removeClass("open");
$("#toolbar_border_palette").hide();},showPalette:function(J){var I=$("#toolbar_border_palette");if(E){I.css({left:((E.outerWidth()-I.outerWidth())/2),top:(E.outerHeight())+14});
}if(B!=null){$("#border-palette-swatch-"+B).removeClass("toolbar-border-palette-icon-selected");}if(A.lastSelectedColor){$("#toolbar-border-palette-color-picker-text-outer").css("border-bottom-color",A.lastSelectedColor);
}B=null;$("#toolbar_border_palette").addClass("open");$("#toolbar_border_palette").show();$(document).bind("mousedown",A.checkMouse);
},bindColorPicker:function(I){if(I){I.bind("click",function(M){if(!A.isSetColorCallback){A.isSetColorCallback=true;
CommonColorPicker.getInstance().setColorSelectedCallback("toolbar-border-menu",function(N){A.hidePalette();
if(N){A.lastSelectedColor=N;$("#toolbar-border-palette-color-picker-text-outer").css("border-bottom-color",N);
}if(D!=null){if(B!=null){D(G[B],A.lastSelectedColor);}else{D("border-change",A.lastSelectedColor);}}});
}var J=$("#toolbar_border_palette").offset();var L=J.top+$("#toolbar_border_palette").outerHeight();var K=J.left+$("#toolbar_border_palette").outerWidth();
CommonColorPicker.getInstance().toggleColorPalette(A.lastSelectedColor,L-25,K+2,"toolbar-border-menu",M,true);
});}},bindCell:function(J,I){J.bind({click:function(K){if(B!=null){$("#border-palette-swatch-"+B).removeClass("toolbar-border-palette-icon-selected");
}$(this).addClass("toolbar-border-palette-icon-selected");B=I;D(G[I],A.lastSelectedColor);},mouseover:function(K){if(!$(this).hasClass("toolbar-border-palette-icon-selected")){$(this).addClass("toolbar-border-palette-icon-hover");
}},mouseout:function(K){if($(this).hasClass("toolbar-border-palette-icon-hover")){$(this).removeClass("toolbar-border-palette-icon-hover");
}}});},init:function(N){var M=C.palette.clone(),O=C.paletteTable.clone(),P=C.borderColorPicker.clone(),K,J,L;
for(var I=0;I<F.length;I++){if(I%5==0){if(K){L=O.find("#tableBody");K.appendTo(L);}K=C.tableRow.clone();
}J=C.tableCell.clone();J.find(".toolbar-border-palette-icon-container").addClass("docx-icon-common "+F[I]);
var Q=H[I];J.attr("data-tooltip",Q);J.children().first().attr("id","border-palette-swatch-"+I);A.bindCell(J.children().first(),I);
J.appendTo(K);}K.appendTo(L);O.appendTo(M);A.bindColorPicker(P);P.appendTo(M);if(N){N.append(M);window.addEventListener("SheetMouseDown",function(R){A.hidePalette(R);
},false);window.addEventListener("SheetScroll",function(R){A.hidePalette(R);},false);}padutils.tooltip("[data-tooltip]");
}};A.init(E);return A;};(function($){$.Custom_Dialog=function(){var defaults={animation_speed_hide:250,animation_speed_show:0,auto_close:false,buttons:true,center_buttons:false,custom_class:false,keyboard:true,max_height:0,message:"",modal:true,overlay_close:true,overlay_opacity:".9",position:"center",reposition_speed:500,show_close_button:true,source:false,title:"",type:"information",show_icon:false,vcenter_short_message:true,width:0,onClose:null};
var plugin=this,options={},timeout;plugin.settings={};if(typeof arguments[0]=="string"){options.message=arguments[0];
}if(typeof arguments[0]=="object"||typeof arguments[1]=="object"){options=$.extend(options,(typeof arguments[0]=="object"?arguments[0]:arguments[1]));
}plugin.init=function(){var $title;plugin.settings=$.extend({},defaults,options);plugin.isIE6=(browser.name=="explorer"&&browser.version==6)||false;
if(plugin.settings.modal){plugin.overlay=$("<div>",{"class":"CustomDialogOverlay"}).css({position:(plugin.isIE6?"absolute":"fixed"),left:0,top:0,opacity:plugin.settings.overlay_opacity});
if(plugin.settings.overlay_close){plugin.overlay.bind("click",function(){plugin.close();});}plugin.overlay.appendTo("body");
}plugin.dialog=$("<div>",{"class":"CustomDialog"+(plugin.settings.custom_class?" "+plugin.settings.custom_class:"")}).css({position:(plugin.isIE6?"absolute":"fixed"),left:0,top:0,visibility:"hidden"});
if(!plugin.settings.buttons&&plugin.settings.auto_close){plugin.dialog.attr("id","CustomDialog_"+Math.floor(Math.random()*9999));
}var tmp=parseInt(plugin.settings.width,10);if(!isNaN(tmp)&&tmp==plugin.settings.width&&tmp.toString()==plugin.settings.width.toString()&&tmp>0){plugin.dialog.css({width:plugin.settings.width});
}if(plugin.settings.title){$title=$("<h3>",{"class":"CustomDialog_Title"}).html(plugin.settings.title).appendTo(plugin.dialog);
}var buttons=get_buttons();var body_container=$("<div>",{"class":"CustomDialog_BodyOuter"+(!plugin.settings.title?" CustomDialog_NoTitle":"")+(!buttons?" CustomDialog_NoButtons":"")}).appendTo(plugin.dialog);
plugin.message=$("<div>",{"class":"CustomDialog_Body"+(plugin.settings.show_icon!==false?" CustomDialog_Icon CustomDialog_"+get_type():"")});
if(plugin.settings.max_height>0){plugin.message.css("max-height",plugin.settings.max_height);if(plugin.isIE6){plugin.message.attr("style","height: expression(this.scrollHeight > "+plugin.settings.max_height+' ? "'+plugin.settings.max_height+'px" : "85px")');
}}if(plugin.settings.vcenter_short_message){$("<div>").html(plugin.settings.message).appendTo(plugin.message);
}else{plugin.message.html(plugin.settings.message);}if(plugin.settings.source&&typeof plugin.settings.source=="object"){var canvas=(plugin.settings.vcenter_short_message?$("div:first",plugin.message):plugin.message);
for(var type in plugin.settings.source){switch(type){case"ajax":var ajax_options=typeof plugin.settings.source[type]=="string"?{url:plugin.settings.source[type]}:plugin.settings.source[type],preloader=$("<div>").attr("class","CustomDialog_Preloader").appendTo(canvas);
ajax_options.success=function(result){preloader.remove();canvas.append(result);draw(false);};$.ajax(ajax_options);
break;case"iframe":var default_options={width:"100%",height:"100%",marginheight:"0",marginwidth:"0",frameborder:"0"},iframe_options=$.extend(default_options,typeof plugin.settings.source[type]=="string"?{src:plugin.settings.source[type]}:plugin.settings.source[type]);
canvas.append($("<iframe>").attr(iframe_options));break;case"inline":canvas.append(plugin.settings.source[type]);
break;}}}plugin.message.appendTo(body_container);if(buttons){buttons.reverse();var button_bar=$("<div>",{"class":"CustomDialog_Buttons"}).appendTo(plugin.dialog);
$.each(buttons,function(index,value){var button=$("<button>",{type:"button","class":"CustomDialog_Button_"+index});
if($.isPlainObject(value)){button.html(value.caption);}else{button.html(value);}if(plugin.settings.custom_class){}else{if(button.html()===$.Custom_Dialog.DefaultButtons.Cancel){button.addClass("ZebraDialog_Buttons_Cancel");
}}button.bind("click",function(){var close=true;if(undefined!==value.callback){close=value.callback(plugin.dialog);
}if(close!==false){plugin.close(undefined!==value.caption?value.caption:value);}});button.appendTo(button_bar);
});button_bar.wrap($("<div>").addClass("CustomDialog_ButtonsOuter"+(plugin.settings.center_buttons?" CustomDialog_Buttons_Centered":"")));
}plugin.dialog.appendTo("body");if(plugin.settings.show_close_button){var $close=$('<span class="CustomDialog_Close">&times;</span>').bind("click",function(e){e.preventDefault();
plugin.close();}).appendTo($title?$title:plugin.message);if($title){$close.css({right:parseInt($title.css("paddingRight"),10),top:(parseInt($title.css("height"),10)+parseInt($title.css("paddingTop"),10)+parseInt($title.css("paddingBottom"),10)-$close.height())/2});
}}$(window).bind("resize.Custom_Dialog",function(){clearTimeout(timeout);timeout=setTimeout(function(){draw();
},100);});if(plugin.settings.keyboard){$(document).bind("keyup.Custom_Dialog",function(e){if(e.which==27){plugin.close();
}return true;});}if(plugin.isIE6){$(window).bind("scroll.Custom_Dialog",function(){emulate_fixed_position();
});}if(plugin.settings.auto_close!==false){plugin.dialog.bind("click",function(){clearTimeout(plugin.timeout);
plugin.close();});plugin.timeout=setTimeout(plugin.close,plugin.settings.auto_close);}draw(false);return plugin;
};plugin.close=function(caption){$(document).unbind(".Custom_Dialog");$(window).unbind(".Custom_Dialog");
if(plugin.overlay){plugin.overlay.animate({opacity:0},plugin.settings.animation_speed_hide,function(){plugin.overlay.remove();
});}plugin.dialog.animate({opacity:0},plugin.settings.animation_speed_hide,function(){plugin.dialog.remove();
if(plugin.settings.onClose&&typeof plugin.settings.onClose=="function"){plugin.settings.onClose(undefined!==caption?caption:"");
}});};var draw=function(){var viewport_width=$(window).width(),viewport_height=$(window).height(),dialog_width=plugin.dialog.width(),dialog_height=plugin.dialog.height(),values={left:0,top:0,right:viewport_width-dialog_width,bottom:viewport_height-dialog_height,center:(viewport_width-dialog_width)/2,middle:(viewport_height-dialog_height)/2};
plugin.dialog_left=undefined;plugin.dialog_top=undefined;if($.isArray(plugin.settings.position)&&plugin.settings.position.length==2&&typeof plugin.settings.position[0]=="string"&&plugin.settings.position[0].match(/^(left|right|center)[\s0-9\+\-]*$/)&&typeof plugin.settings.position[1]=="string"&&plugin.settings.position[1].match(/^(top|bottom|middle)[\s0-9\+\-]*$/)){plugin.settings.position[0]=plugin.settings.position[0].toLowerCase();
plugin.settings.position[1]=plugin.settings.position[1].toLowerCase();$.each(values,function(index,value){for(var i=0;
i<2;i++){var tmp=plugin.settings.position[i].replace(index,value);if(tmp!=plugin.settings.position[i]){if(i===0){plugin.dialog_left=eval(tmp);
}else{plugin.dialog_top=eval(tmp);}}}});}if(undefined===plugin.dialog_left||undefined===plugin.dialog_top){plugin.dialog_left=values.center;
plugin.dialog_top=values.middle;}if(plugin.settings.vcenter_short_message){var message=plugin.message.find("div:first"),message_height=message.height(),container_height=plugin.message.height();
if(message_height<container_height){message.css({"padding-top":(container_height-message_height)/2});
}}if((typeof arguments[0]=="boolean"&&arguments[0]===false)||plugin.settings.reposition_speed===0){plugin.dialog.css({left:plugin.dialog_left,top:plugin.dialog_top,visibility:"visible",opacity:0}).animate({opacity:1},plugin.settings.animation_speed_show);
}else{plugin.dialog.stop(true);plugin.dialog.css("visibility","visible").animate({left:plugin.dialog_left,top:plugin.dialog_top},plugin.settings.reposition_speed);
}plugin.dialog.find("a[class^=CustomDialog_Button]:first").focus();if(plugin.isIE6){setTimeout(emulate_fixed_position,500);
}};var emulate_fixed_position=function(){var scroll_top=$(window).scrollTop(),scroll_left=$(window).scrollLeft();
if(plugin.settings.modal){plugin.overlay.css({top:scroll_top,left:scroll_left});}plugin.dialog.css({left:plugin.dialog_left+scroll_left,top:plugin.dialog_top+scroll_top});
};var get_buttons=function(){if(plugin.settings.buttons!==true&&!$.isArray(plugin.settings.buttons)){return false;
}if(plugin.settings.buttons===true){switch(plugin.settings.type){case"question":plugin.settings.buttons=[$.Custom_Dialog.DefaultButtons.OK,$.Custom_Dialog.DefaultButtons.Cancel];
break;default:plugin.settings.buttons=[$.Custom_Dialog.DefaultButtons.OK];}}return plugin.settings.buttons;
};var get_type=function(){var type=plugin.settings.type;switch(type){case"confirmation":case"error":case"information":case"question":case"warning":break;
default:type="confirmation";}return type.charAt(0).toUpperCase()+type.slice(1).toLowerCase();};var browser={init:function(){this.name=this.searchString(this.dataBrowser)||"";
this.version=this.searchVersion(navigator.userAgent)||this.searchVersion(navigator.appVersion)||"";},searchString:function(data){for(var i=0;
i<data.length;i++){var dataString=data[i].string;var dataProp=data[i].prop;this.versionSearchString=data[i].versionSearch||data[i].identity;
if(dataString){if(dataString.indexOf(data[i].subString)!=-1){return data[i].identity;}}else{if(dataProp){return data[i].identity;
}}}},searchVersion:function(dataString){var index=dataString.indexOf(this.versionSearchString);if(index==-1){return;
}return parseFloat(dataString.substring(index+this.versionSearchString.length+1));},dataBrowser:[{string:navigator.userAgent,subString:"MSIE",identity:"explorer",versionSearch:"MSIE"}]};
browser.init();return plugin.init();};$.Custom_Dialog.DefaultButtons={OK:"确定",Cancel:"取消"};$.Custom_Dialog.Type={Confirmation:"confirmation",Error:"error",Question:"question",Information:"information",Warning:"warning"};
})(jQuery);var CommonColorPicker=(function(){var L=false;var E=["toolbar-border-palette-color-picker"];
var H=["ffffff","000000","ff0000","ff9a00","ffff00","00ff00","00ffff","4784eb","9b00ff","f3f3f1","949495","f6bfbc","fde8d0","ebe1a9","d6e9ca","ebf6f7","cfe1ef","e7e7eb","dcdddd","595857","ee827c","f9c89b","e6b422","93b69c","83ccd2","698aab","867ba9","c0c6c9","40464a","e83929","cf760a","8d6449","47885e","00a3af","507ea4","765c83","adadad","0d0015","ba2636","8a3b00","583822","00552e","00767a","1e50a2","522f60"];
var M=["白","黑","红","橙","黄","葱绿","湖蓝","天色","紫","白练","鼠","虹","薄卵","蒸栗","白绿","蓝白","天空","紫水晶","白鼠","墨","甚三红","雄黄","金子","薄青","白群","薄花","紫苑","灰青","石墨","红绯","红金","枯茶","绿青","浅葱","薄缥","紫霞","薄纯","漆黑","朱绯","褐","黑茶","深绿","苍蓝","琉璃","葡萄"];
var D="#000000";var K={};var A;var G={};var F;var C="common-color-picker-palette";var J={palette:$('<div id="common-color-picker-palette"  class="common-color-picker-palette" />'),swatch:$('<div class="colorPicker-swatch" data-tooltip="">&nbsp;</div>'),};
function I(N){if(N.match(/[0-9A-F]{6}|[0-9A-F]{3}$/i)){N=N.toLowerCase();return(N.charAt(0)==="#")?N:("#"+N);
}else{if(N.match(/^rgb\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*\)$/)){var O=([parseInt(RegExp.$1,10),parseInt(RegExp.$2,10),parseInt(RegExp.$3,10)]),P=function(T){if(T.length<2){for(var U=0,V=2-T.length;
U<V;U++){T="0"+T;}}return T;};if(O.length===3){var S=P(O[0].toString(16)),R=P(O[1].toString(16)),Q=P(O[2].toString(16));
return"#"+S+R+Q;}}else{return false;}}}var B={setColorSelectedCallback:function(N,O){if(G[N]==undefined){G[N]=O;
return true;}else{return false;}},toggleColorPalette:function(P,R,O,Q,N,S){if(A){F=Q;if(S){C="common-color-picker-palette";
}else{C="colorPicker-palette";}if(A.hasClass("open")){B.hideColorPalette(N);}else{B.showColorPalette(P,R,O,N);
}}},checkMouse:function(O){var P=$(O.target).parents("#common-color-picker-palette");if(P&&P.attr("id")=="common-color-picker-palette"){return;
}for(var N=0;N<E.length;N++){if(O.target.id==E[N]||$(O.target).parents("#"+E[N]).attr("id")==E[N]){return;
}}B.hideColorPalette(O);},hideColorPalette:function(N){if(A){A.unbind("mousedown",B.checkMouse);$(document).unbind("mousedown",B.checkMouse);
A.removeClass("open");A.hide();}},showColorPalette:function(O,P,N,Q){if(A){B.updateSwatchSelectedClass(2,D);
B.updateSwatchSelectedClass(1,O);A.css({top:P,left:N});if(C&&!(A.hasClass(C))){A.removeClass("common-color-picker-palette");
A.removeClass("colorPicker-palette");A.addClass(C);}A.bind("mousedown",B.checkMouse);$(document).bind("mousedown",B.checkMouse);
A.addClass("open");A.show();}},updateSwatchSelectedClass:function(Q,O){O=I(O);if(O){var P=K[O];if(A&&P!=undefined){var R=A.children();
var N=$(R[P]);if(N){if(Q==1){if(!(N.hasClass("colorPicker-swatch-down"))){N.addClass("colorPicker-swatch-down");
}}else{if(Q==2){if(N.hasClass("colorPicker-swatch-down")){N.removeClass("colorPicker-swatch-down");}}}}}}},bindSwatch:function(O,N){N=N?N:I(O.css("background-color"));
O.bind({click:function(Q){if(N&&N!==D){B.updateSwatchSelectedClass(2,D);D=N;if(F){var P=G[F];if(P){P(N);
}}B.hideColorPalette(Q);}},mouseover:function(P){if(!($(this).hasClass("colorPicker-swatch-down"))){$(this).addClass("colorPicker-swatch-hover");
}},mouseout:function(P){if($(this).hasClass("colorPicker-swatch-hover")){$(this).removeClass("colorPicker-swatch-hover");
}}});},init:function(){A=J.palette.clone();var O=null;for(var N=0;N<H.length;N++){O=J.swatch.clone();
var Q=M[N];O.attr("data-tooltip",Q);var P="#"+H[N];K[P]=N;O.css("background-color",P);B.bindSwatch(O,P);
O.appendTo(A);}$("body").append(A);A.hide();padutils.tooltip("[data-tooltip]");window.addEventListener("SheetMouseDown",function(R){B.hideColorPalette();
});window.addEventListener("SheetScroll",function(R){B.hideColorPalette();});L=true;}};return{getInstance:function(){if(!L){B.init();
}return B;}};})();var record_change=(function(){var V=false;var C=0;var F=0;var E=0;var W=0;var A={version:0,revision:0,time:0,isBigVersion:0};
var D=null;var G=null;function c(){var f="确定将"+(window.isSheet?"表格":"文档")+"恢复到";if(A.isBigVersion){f+="第"+A.version+"版吗?";
$.report({act_type:168});}else{f+=$(".preview-header-title").text()+"时的内容吗?";$.report({act_type:170});
}D=$.Custom_Dialog(f,{type:$.Custom_Dialog.Type.Question,title:"恢复"+(window.isSheet?"表格":"文档"),overlay_close:false,onClose:function(g){if(g===$.Custom_Dialog.DefaultButtons.OK){J(false);
padmodals.showHistoryRevertTipBox();a(A.version,A.revision);}D=null;}});}function P(f){C=f.history.page;
F=f.history.pages;if(V){var g=f.history["items"];historylist.appendItems(g,f.authors,C<F);}}function M(j,h,f){var g="ep/pad/revision/"+pad.getPadId()+"?p="+h;
$.get(g,{},function(m,l){f&&f(l=="success",m);});}function N(f){$(".preview-body-title-load-wrap").show();
var g="ep/pad/revision/"+pad.getPadId()+"?r="+f+(window.isSheet?"&h=1":"");$.get(g,{},function(h,j){if(f!=A.revision){return;
}if(j=="success"&&h.retcode==0){h.version=f;h.padID=pad.getPadId();X(f,h);setTimeout(function(){if(f!=A.revision){return;
}$(".preview-body-title-load-wrap").hide();},1000);}else{padutils.toolToast("拉取失败。",{top:"5px"},{toolToastCloseTime:2000});
$(".preview-body-title-load-wrap").hide();}});}function X(g,f){H(f,true);}function a(f,h){var g="ep/pad/"+pad.getPadId()+"/revert-to/"+h;
if(f){g+="?v="+f;}$.post(g,{},function(l,j){setTimeout(padmodals.hideModal(0,"#history-revert-dialog"),2000);
if(G){clearTimeout(G);}G=null;if(j=="success"&&l.retcode==0){$("#last-saved-timestamp").attr("time",dateFormat(new Date()));
padutils.toolToast("还原成功。",{top:"5px"},{toolToastCloseTime:2000});$.report({act_type:(A.isBigVersion?169:171)});
}else{T();}});G=setTimeout(function(){padmodals.hideModal(0,"#history-revert-dialog");T();},30000);}var K=false;
var Q=false;var B=null;var d=null;function H(j,f){if(window.isSheet){var g=window.sheetNode;if(g){g.showSheetRecordPreview(f,j);
}$("#editor").css("padding-top",f?0:30);var l="";var h=$("#editor").height();if(!$("#padbody").hasClass("tim")){h-=59;
}l=("height = '"+h+"px'");}else{if(f){Y(j);}else{B=null;}}}function Y(f){if(!B){B=new ace.editor("#doc-preview-container",null,true);
B.setSheet(false);B.setEditable(false);}B.setSheetPosition(f.pos);B.setBaseAttributedText({text:unescape(f.atext.text),attribs:f.atext.attribs},f.apool);
if(f.title){$(".preview-body-title").text(f.title);}}function R(){$("#doc-preview-container-outer").css("height",$(window).height()-$("#preview-page-header").outerHeight()-$(".preview-body-title").outerHeight());
}function L(g){if(g){var f="<div id='preview-page' class='preview-page'><div class='history-modal-overlay'></div><div id='preview-page-header' class='preview-page-header'><div id='preview-page-back' class='preview-page-back'><div class='preview-back-icon' data-tooltip='返回'></div></div><div class='preview-title-common preview-header-title'>版本信息</div><div class='preview-header-revert preview-header-revert-disabled'>恢复</div></div><div id='preview-page-body' class='preview-page-body'><div class='preview-body-title-container'><div class='preview-title-common preview-body-title'></div><div class='preview-body-title-load-wrap'><div class='preview-body-title-load'></div></div></div>"+(window.isSheet?"":"<div id='doc-preview-container-outer'><div id='doc-preview-container'></div></div>")+"</div><div id='recordbar' class='recordbar'><div id='recordbar-header' class='recordbar-header'><div id='recordbar-header-title' class='preview-title-common recordbar-header-title'>修订记录</div></div><div id='recordbar-body' class='recordbar-body'></div></div></div> ";
window.isSheet?$(f).insertBefore($("#padpage")):$("body").append(f);$("#preview-body-title").text(pad.title);
K=true;Q=true;}else{historylist.dismiss();H(null,false);$("#preview-page").remove();K=false;Q=false;}}function J(f){if(f){L(f);
if(window.isSheet){S(f);}else{O(f);}padutils.tooltip(".preview-back-icon");historylist.prepareContainer($("#recordbar"),window.isSheet,function(l,h,n,j){A.version=l;
A.revision=h;A.isBigVersion=j;A.time=n;U();var m=!(j&&l==E||h==W);I(m,m);N(h);if(j){$.report({act_type:166});
}else{$.report({act_type:167});}},function(h){M(false,C+1,function(l,j){if(!l||j.retcode!=0){return;}P(j);
if(h){h(j&&(j.retcode==0),C<F);}});});$("#preview-page-back").click(function(){J(false);});I(false,false);
var g=$(".preview-header-revert");M(true,1,function(l,j){if(!l||j.retcode!=0){}var h=j.history["items"];
A.revision=h[0]["i"];A.version=h[0]["v"];A.time=h[0]["t"];A.isBigVersion=true;E=A.version;W=A.revision;
historylist.setLatestVersion(E);P(j);U();I(false,false);h.length!=0&&N(A.revision);});}else{historylist.dismiss();
if(window.isSheet){S(f);}else{O(f);}L(f);C=0;F=0;}V=f;}function O(f){if(f){$("header").hide();$("#padpage").hide();
R();$(window).resize(R());}else{$("header").show();$("#padpage").show();$(window).unbind("resize");}}function S(f){if(f){H(null,true);
$("header").hide();$("#inputboxwithpc").hide();$("body").addClass("sheet-history-mode");}else{H(null,false);
$("#inputboxwithpc").show();$("header").show();$("body").removeClass("sheet-history-mode");}}function Z(){var f=$.localstringFromTime(A.time);
if(A.isBigVersion){f+=" 第"+A.version+"版";if(A.version==E){f+=" (当前版本)";}}return f;}function U(){$(".preview-header-title").text(Z());
}function I(h,g){var f=$(".preview-header-revert");if(h){if(f.hasClass("preview-header-revert-disabled")){f.removeClass("preview-header-revert-disabled");
f.click(function(){c();});}}else{if(!f.hasClass("preview-header-revert-disabled")){f.addClass("preview-header-revert-disabled");
f.unbind("click");}}if(g){f.show();}else{f.hide();}}function T(){$.Custom_Dialog("恢复失败，请稍候重试。",{type:$.Custom_Dialog.Type.Question,title:"提示",overlay_close:false,buttons:[{caption:"我要反馈",callback:function(){$.showSupportPage();
return true;}},{caption:"确定",callback:function(){return true;}}]});}var b={showRecordChange:function(){J(true);
},onDisconnect:function(){if(D){D.close();D=null;}}};return b;})();function ToolBarButton(A){this.toolbarbutton=null;
this.icon=null;this.initToolBarButton(A);}ToolBarButton.prototype.isEnable=function(){if(this.toolbarbutton.hasClass("toolbar-button-wrapper-disabled")){return false;
}else{return true;}};ToolBarButton.prototype.toggleCheck=function(){if(this.toolbarbutton.hasClass("toolbar-button-wrapper-checked")){this.toolbarbutton.removeClass("toolbar-button-wrapper-checked");
}else{this.toolbarbutton.addClass("toolbar-button-wrapper-checked");}};ToolBarButton.prototype.check=function(){if(!this.toolbarbutton.hasClass("toolbar-button-wrapper-checked")){this.toolbarbutton.addClass("toolbar-button-wrapper-checked");
}};ToolBarButton.prototype.uncheck=function(){if(this.toolbarbutton.hasClass("toolbar-button-wrapper-checked")){this.toolbarbutton.removeClass("toolbar-button-wrapper-checked");
}};ToolBarButton.prototype.isChecked=function(){if(this.toolbarbutton.hasClass("toolbar-button-wrapper-checked")){return true;
}return false;};ToolBarButton.prototype.disable=function(){if(!this.toolbarbutton.hasClass("toolbar-button-wrapper-disabled")){this.toolbarbutton.addClass("toolbar-button-wrapper-disabled");
}};ToolBarButton.prototype.enable=function(){if(this.toolbarbutton.hasClass("toolbar-button-wrapper-disabled")){this.toolbarbutton.removeClass("toolbar-button-wrapper-disabled");
}};ToolBarButton.prototype.isHidden=function(){if(!this.toolbarbutton.hasClass("toolbar-button-wrapper-hidden")){return true;
}else{return false;}};ToolBarButton.prototype.hide=function(){if(!this.toolbarbutton.hasClass("toolbar-button-wrapper-hidden")){this.toolbarbutton.addClass("toolbar-button-wrapper-hidden");
}};ToolBarButton.prototype.show=function(){if(this.toolbarbutton.hasClass("toolbar-button-wrapper-hidden")){this.toolbarbutton.removeClass("toolbar-button-wrapper-hidden");
}};ToolBarButton.prototype.removeIconClassName=function(A){this.icon.removeClass(A);};ToolBarButton.prototype.addIconClassName=function(A){this.icon.addClass(A);
};ToolBarButton.prototype.resetIconClassName=function(){this.icon.attr("class","");this.icon.addClass("docx-icon-container docx-icon-img-container");
};ToolBarButton.prototype.initToolBarButton=function(A){if(!A||!A.find){return null;}this.toolbarbutton=$(A);
this.icon=$(this.toolbarbutton.find(".docx-icon-container")[0]);};ToolBarButton.prototype.registerSelectionState=function(A){if(!A.key){A.key=this.toolbarbutton.attr("id");
}try{selectionState.registerSelectionState(A);}catch(B){$(window).bind("SelectionStateInitFinished",function(){selectionState.registerSelectionState(A);
});}};function ToolBarMenuButton(A,C,B){this.data=null;this.dropdown=null;this.container=null;this.isSeparation=false;
this.initToolBarMenuButton(A,C,B);}ToolBarMenuButton.prototype=new ToolBarButton();ToolBarMenuButton.prototype.initToolBarMenuButton=function(A,C,B){this.data=C;
this.container=B;this.initToolBarButton(A);};ToolBarMenuButton.prototype.toggleIcon=function(A){};ToolBarMenuButton.prototype.dropdownClickHandler=function(A){var B=this;
return function(C){B.toggleIcon(A);B.toolbarbutton.attr("identity",A.identity);B.dropdown&&B.dropdown.hide();
if(typeof A.rowclickcallback=="function"){A.rowclickcallback(C);}else{if(typeof A.clickcallback=="function"){A.clickcallback(C);
}}};};ToolBarMenuButton.prototype.prepareDropDownData=function(A){};ToolBarMenuButton.prototype.initDropDown=function(C,B){this.dropdown=new DropDown(C,B);
var A=this;$(window).bind("SheetMouseDown",function(D){A.dropdown.hide();});$(window).bind("SheetScroll",function(D){A.dropdown.hide();
});};ToolBarMenuButton.prototype.handle=function(A){if((!this.isSeparation)||(!$(A.target).parents(".toolbar-menu-button-icon").length&&(A.target!=this.toolbarbutton.find(".toolbar-menu-button-icon")[0])&&(A.target!=this.toolbarbutton[0]||(A.target==this.toolbarbutton[0]&&A.offsetX>22)))){$("#tooltip").remove();
if(!this.dropdown){var I=this.prepareDropDownData(this.data);this.initDropDown(I,this.container);}if(this.toolbarbutton.attr("id")=="sheet-sort"){var D=this.dropdown.getLastStatus();
var C=padeditbar_utils.isSelectedSingleRow();if(!D||(C&&D=="multi")||(!C&&D=="single")){var F=["sheet-ascending-range-sort","sheet-descending-range-sort"];
var G={"sheet-ascending-range-sort":"'将选中范围按' + padeditbar_utils.getSelectedCol()[1] + '列升序'","sheet-descending-range-sort":"'将选中范围按' + padeditbar_utils.getSelectedCol()[1] + '列降序'"};
var H="single";if(C){G={"sheet-ascending-range-sort":"选中多行后可用","sheet-descending-range-sort":"选中多行后可用"};
this.dropdown.disable(F);}else{this.dropdown.enable(F);H="multi";}this.dropdown.updateToolTip(G);this.dropdown.setLastStatus(H);
}}this.dropdown.toggleDropDown();}else{this.dropdown&&this.dropdown.hide();for(var E=0;E<this.data.length;
E++){var B=this.data[E];if(this.toolbarbutton.attr("identity")==B.identity){if(typeof B.iconclickcallback=="function"){B.iconclickcallback();
break;}else{if(typeof B.clickcallback=="function"){B.clickcallback();break;}}}}}};ToolBarMenuButton.prototype.check=function(C){var A=null;
for(var B=0;B<this.data.length;B++){A=this.data[B];if(C==A.identity){this.toggleIcon(A);this.toolbarbutton.attr("identity",A.identity);
return A;}A=null;}this.resetIconClassName();this.toolbarbutton.attr("identity","");return null;};function ToolBarImageMenuButton(C,B,A){this.initToolBarImageMenuButton(C,B,A);
}ToolBarImageMenuButton.prototype=new ToolBarMenuButton();ToolBarImageMenuButton.prototype.initToolBarImageMenuButton=function(C,B,A){this.initToolBarMenuButton(C,B,A);
};ToolBarImageMenuButton.prototype.prepareDropDownData=function(D){var C=[];for(var B=0;B<D.length;B++){var A=D[B];
var E={iconClsName:A.rowIconClsName,image:A.image,content:A.content,fontFamily:A.fontFamily,hover:A.hover,clickcallback:this.dropdownClickHandler(A),identity:A.identity};
C.push(E);}return C;};ToolBarImageMenuButton.prototype.toggleIcon=function(A){this.resetIconClassName();
this.addIconClassName(A.iconClassName);};function ToolBarContentMenuButton(C,B,A){this.initToolBatContentMenuButton(C,B,A);
}ToolBarContentMenuButton.prototype=new ToolBarMenuButton();ToolBarContentMenuButton.prototype.initToolBatContentMenuButton=function(C,B,A){this.initToolBarMenuButton(C,B,A);
};ToolBarContentMenuButton.prototype.prepareDropDownData=function(D){var C=[];for(var B=0;B<D.length;
B++){var A=D[B];var E={iconClsName:A.rowIconClsName,image:A.image,content:A.content,hover:A.hover,fontFamily:A.fontFamily,disable:A.disable,clickcallback:this.dropdownClickHandler(A)};
C.push(E);}return C;};ToolBarContentMenuButton.prototype.toggleIcon=function(A){this.resetIconContent();
this.setIconContent(A);};ToolBarContentMenuButton.prototype.resetIconClassName=function(){};ToolBarContentMenuButton.prototype.resetIconContent=function(){this.icon[0].innerText="";
};ToolBarContentMenuButton.prototype.setIconContent=function(A){this.icon[0].innerText=A.iconContent||A.content||"";
};ToolBarContentMenuButton.prototype.check=function(B){var A=ToolBarMenuButton.prototype.check.call(this,B);
if(!A){this.resetIconContent();}return A;};function ToolBarFontColorButton(A){this.initToolBarFontColorMenuButton(A);
}ToolBarFontColorButton.prototype=new ToolBarButton();ToolBarFontColorButton.prototype.initToolBarFontColorMenuButton=function(A){this.initToolBarButton(A);
};ToolBarFontColorButton.prototype.check=function(A){A=A||"transparent";};function ToolBarFontBgColorButton(A){this.initToolBarFontBgColorMenuButton(A);
}ToolBarFontBgColorButton.prototype=new ToolBarButton();ToolBarFontBgColorButton.prototype.initToolBarFontBgColorMenuButton=function(A){this.initToolBarButton(A);
};ToolBarFontBgColorButton.prototype.check=function(A){A=A||"transparent";};function ToolBarPaintBrushColorButton(A){this.initToolBarPaintBrushColorMenuButton(A);
}ToolBarPaintBrushColorButton.prototype=new ToolBarButton();ToolBarPaintBrushColorButton.prototype.initToolBarPaintBrushColorMenuButton=function(A){this.initToolBarButton(A);
};ToolBarPaintBrushColorButton.prototype.check=function(A){A=A||"transparent";};function ToolBarBorderButton(C,B,A){this.container=B;
this.onItemClickCallback=A;this.initToolBarBorderButton(C,A);}ToolBarBorderButton.prototype=new ToolBarButton();
ToolBarBorderButton.prototype.initToolBarBorderButton=function(A){this.initToolBarButton(A);};ToolBarBorderButton.prototype.initBorderMenu=function(A){this.borderMenu=new BorderMenu(A,this.onItemClickCallback);
};ToolBarBorderButton.prototype.check=function(A){};ToolBarBorderButton.prototype.handle=function(A){if(!this.borderMenu){this.initBorderMenu(this.container);
this.borderMenu.showPalette();}else{this.borderMenu.togglePalette(A);}};var ToolBar=function(){this.toolbarbuttons={};
self.toolbar=$("#toolbar");function A(B,E){var D=false;if(B&&B.length&&E){for(var C=0;C<B.length;C++){if(E==B[C]){D=true;
break;}}}return D;}this.iteratethrough=function(E,F){var D=Object.getOwnPropertyNames(this.toolbarbuttons);
for(var C=0;C<D.length;C++){var B=this.toolbarbuttons[D[C]];if(B&&B[E]&&typeof B[E]=="function"&&!A(F,D[C])){B[E]();
}}};this.disable=function(){this.iteratethrough("disable");};this.enable=function(){this.iteratethrough("enable");
};this.hide=function(){self.toolbar.removeClass("toolbar-shown").addClass("toolbar-hidden");this.iteratethrough("hide");
};this.show=function(){self.toolbar.removeClass("toolbar-hidden").addClass("toolbar-shown");this.iteratethrough("show");
};this.isEnable=function(){var D=Object.getOwnPropertyNames(this.toolbarbuttons);for(var C=0;C<D.length;
C++){var B=this.toolbarbuttons[D[C]];if(B&&B.isEnable&&B.isHidden){if(!B.isEnable()&&!B.isHidden()){return false;
}}}return true;};this.checkSingle=function(D,E){for(var B=0;B<E.length;B++){var C=this.toolbarbuttons[E[B]];
if(C&&D.indexOf(C.toolbarbutton.attr("id"))!=-1){if(C.check){C.check(D.split("&")[1]);}return B;}}return -1;
};this.uncheck=function(B){this.iteratethrough("uncheck",B);};this.setDefaultCheck=function(B,D){if(B instanceof Array||typeof B=="string"){B=[].concat(B);
for(var E=0;E<B.length;E++){var F=B[E];for(var C=0;C<D.length;C++){if(F.indexOf(D[C])!=-1){D.splice(C,1);
break;}}}return B.concat(D);}return B;};this.addIgnoreCheckItem=function(B){if(!this.ignoreCheckList){this.ignoreCheckList=[];
}this.ignoreCheckList.push(B);};this.check=function(B){this.uncheck(this.ignoreCheckList);var C=Object.getOwnPropertyNames(this.toolbarbuttons);
if(!window.isSheet){B=this.setDefaultCheck(B,["font-family","font-size","toolbar-font-color-group","horizontal-align"]);
}if(B instanceof Array){for(var D=0;D<B.length;D++){var E=this.checkSingle(B[D],C);if(E!=-1){C.splice(E,1);
}}}else{if(typeof B=="string"){this.checkSingle(B,C);}else{this.iteratethrough("check");}}};this.registerBaseListeners=function(){var B=this;
$(window).bind("AfterSelectionState",function(D){var C=D.detail["state"];C=C?C:[];B.check(C);});};};var ToolBarDocx=function(){var B={undo:"undobutton",redo:"redubutton","font-family":"fontfamilybutton","font-size":"fontsizebutton",bold:"boldbutton",italic:"italicsbutton",underline:"underlinebutton",strikethrough:"strikebutton",insertorderedlist:"numberedlistbutton",insertunorderedlist:"listbutton",inserttasklist:"taskbutton","horizontal-align":"horizontalalign",indent:"indentbutton",outdent:"outdentbutton",insertimage:"insertimage",};
var A={init:function(){A.inhert();A.initToolBarButtons();A.registerBaseListeners();},inhert:function(){this.temp=ToolBar;
this.temp();delete this.temp;},initToolBarButtons:function(){A.toolbarbuttons.undobutton=new ToolBarButton($("#undobutton"));
A.toolbarbuttons.redubutton=new ToolBarButton($("#redobutton"));A.initFormatPainterButton();A.initClearFormattingButton();
A.initHorizontalAlignButton();A.initBoldButton();A.initItalicsButton();A.initUnderlineButton();A.initStrikeButton();
A.initFontFamilyButton();A.initFontSizeButton();A.initFontColorButton();A.initFontBgColorButton();A.initNumberedListButton();
A.initListButton();A.initTaskButton();A.initInsertButton();A.toolbarbuttons.indentbutton=new ToolBarButton($("#indentbutton"));
A.toolbarbuttons.outdentbutton=new ToolBarButton($("#outdentbutton"));A.toolbarbuttons.insertimage=new ToolBarButton($("#insertimage"));
},initFormatPainterButton:function(){A.toolbarbuttons.formatpainterbutton=new ToolBarButton($("#formatPainterButton"));
A.addIgnoreCheckItem("formatpainterbutton");},initClearFormattingButton:function(){A.toolbarbuttons.clearformattingbutton=new ToolBarButton($("#clearFormattingButton"));
A.addIgnoreCheckItem("clearformattingbutton");$(window).on("mouseup",function(C){if($(C.target).parents("#clearFormattingButton").length==0){A.toolbarbuttons.clearformattingbutton.uncheck();
}});},initHorizontalAlignButton:function(){A.toolbarbuttons.horizontalalign=new ToolBarImageMenuButton($("#horizontal-align"),[{rowIconClsName:"docx-icon-common toolbar-icon-sheet-left-align-row",identity:"text-align-type-left",hover:"左对齐",iconClassName:"docx-icon-common toolbar-icon-sheet-left-align",clickcallback:function(){padeditor.ace.callWithAce(function(C){C.focus();
C.doTextAlign("left");},"horizontal-align",true);}},{rowIconClsName:"docx-icon-common toolbar-icon-sheet-center-align-row",identity:"text-align-type-center",hover:"居中对齐",iconClassName:"docx-icon-common toolbar-icon-sheet-center-align",clickcallback:function(){padeditor.ace.callWithAce(function(C){C.focus();
C.doTextAlign("center");},"horizontal-align",true);}},{rowIconClsName:"docx-icon-common toolbar-icon-sheet-right-align-row",identity:"text-align-type-right",hover:"右对齐",iconClassName:"docx-icon-common toolbar-icon-sheet-right-align",clickcallback:function(){padeditor.ace.callWithAce(function(C){C.focus();
C.doTextAlign("right");},"horizontal-align",true);}}],$("#toolbar-horizontal-align-group"));A.toolbarbuttons.horizontalalign.registerSelectionState({type:"line",judge:function(F,D){var E="text-align-type-left";
for(var C=0;D&&C<D.length;C++){if(["text-align-type-left","text-align-type-center","text-align-type-right"].contains(D[C])){E=D[C];
break;}}return["horizontal-align",E].join("&");}});},initBoldButton:function(){A.toolbarbuttons.boldbutton=new ToolBarButton($("#boldbutton"));
A.toolbarbuttons.boldbutton.registerSelectionState({type:"word",judge:function(C,D){return document.queryCommandState("bold");
}});},initItalicsButton:function(){A.toolbarbuttons.italicsbutton=new ToolBarButton($("#italicsbutton"));
A.toolbarbuttons.italicsbutton.registerSelectionState({type:"word",judge:function(C,D){return document.queryCommandState("italic");
}});},initUnderlineButton:function(){A.toolbarbuttons.underlinebutton=new ToolBarButton($("#underlinebutton"));
A.toolbarbuttons.underlinebutton.registerSelectionState({type:"word",judge:function(C,D){return document.queryCommandState("underline");
}});},initStrikeButton:function(){A.toolbarbuttons.strikebutton=new ToolBarButton($("#strikebutton"));
A.toolbarbuttons.strikebutton.registerSelectionState({type:"word",judge:function(C,D){return document.queryCommandState("strikethrough");
}});},initSuperScript:function(){A.toolbarbuttons.superscriptbutton=new ToolBarButton($("#superscriptbutton"));
A.toolbarbuttons.superscriptbutton.registerSelectionState({type:"word",judge:function(C,D){if(selectionState.isCaret){return document.queryCommandState("superscript");
}else{if(C&&C.style&&C.style.verticalAlign=="super"){return true;}else{return false;}}}});},initSubScript:function(){A.toolbarbuttons.subscriptbutton=new ToolBarButton($("#subscriptbutton"));
A.toolbarbuttons.subscriptbutton.registerSelectionState({type:"word",judge:function(C,D){if(selectionState.isCaret){return document.queryCommandState("subscript");
}else{if(C&&C.style&&C.style.verticalAlign=="sub"){return true;}else{return false;}}}});},initInsertButton:function(){A.toolbarbuttons.insertbutton=new ToolBarContentMenuButton($("#insert"),[{rowIconClsName:"docx-icon-common toolbar-insert-image",content:"图片",identity:"insert-image",iconContent:"插入",fontFamily:"Microsoft YaHei",clickcallback:function(C){if(!toolbarController.isToolBarButtonEnable("insertimage")){return false;
}C.preventDefault();padeditbar.closeDropDown(C);padeditor.ace.insertImage();return false;}},{rowIconClsName:"docx-icon-common toolbar-insert-line",content:"分隔线",identity:"insert-line",iconContent:"插入",fontFamily:"Microsoft YaHei",clickcallback:function(C){C.preventDefault();
padeditbar.closeDropDown(C);padeditor.ace.insertline();return false;}}],$("#toolbar-insert-group"));},initFontFamilyButton:function(){A.toolbarbuttons.fontfamilybutton=new ToolBarContentMenuButton($("#font-family"),[{content:"微软雅黑",identity:"font-family-Microsoft YaHei",iconContent:"微软雅黑",fontFamily:"Microsoft YaHei",clickcallback:function(){padeditor.ace.callWithAce(function(E){E.toggleAttributeOnSelection("font-family","Microsoft YaHei");
},"font-family",true);}},{content:"华文仿宋",identity:"font-family-STFangsong",iconContent:"华文仿宋",fontFamily:"STFangsong",clickcallback:function(){padeditor.ace.callWithAce(function(E){E.toggleAttributeOnSelection("font-family","STFangsong");
},"font-family",true);}},{content:"华文楷体",identity:"font-family-STKaiti",iconContent:"华文楷体",fontFamily:"STKaiti",clickcallback:function(){padeditor.ace.callWithAce(function(E){E.toggleAttributeOnSelection("font-family","STKaiti");
},"font-family",true);}},{content:"华文宋体",identity:"font-family-STSong",iconContent:"华文宋体",fontFamily:"STSong",clickcallback:function(){padeditor.ace.callWithAce(function(E){E.toggleAttributeOnSelection("font-family","STSong");
},"font-family",true);}},{content:"Arial",identity:"font-family-Arial",iconContent:"Arial",fontFamily:"Arial",clickcallback:function(){padeditor.ace.callWithAce(function(E){E.toggleAttributeOnSelection("font-family","Arial");
},"font-family",true);}},{content:"Comic Sans MS",identity:"font-family-Comic Sans MS",iconContent:"Comic Sans MS",fontFamily:"Comic Sans MS",clickcallback:function(){padeditor.ace.callWithAce(function(E){E.toggleAttributeOnSelection("font-family","Comic Sans MS");
},"font-family",true);}},{content:"Courier New",identity:"font-family-Courier New",iconContent:"Courier New",fontFamily:"Courier New",clickcallback:function(){padeditor.ace.callWithAce(function(E){E.toggleAttributeOnSelection("font-family","Courier New");
},"font-family",true);}},{content:"Georgia",identity:"font-family-Georgia",iconContent:"Georgia",fontFamily:"Georgia",clickcallback:function(){padeditor.ace.callWithAce(function(E){E.toggleAttributeOnSelection("font-family","Georgia");
},"font-family",true);}},{content:"Impact",identity:"font-family-Impact",iconContent:"Impact",fontFamily:"Impact",clickcallback:function(){padeditor.ace.callWithAce(function(E){E.toggleAttributeOnSelection("font-family","Impact");
},"font-family",true);}},{content:"Times New Roman",identity:"font-family-Times New Roman",iconContent:"Times New Roman",fontFamily:"Times New Roman",clickcallback:function(){padeditor.ace.callWithAce(function(E){E.toggleAttributeOnSelection("font-family","Times New Roman");
},"font-family",true);}},{content:"Trebuchet MS",identity:"font-family-Trebuchet MS",iconContent:"Trebuchet MS",fontFamily:"Trebuchet MS",clickcallback:function(){padeditor.ace.callWithAce(function(E){E.toggleAttributeOnSelection("font-family","Trebuchet MS");
},"font-family",true);}},{content:"Verdana",identity:"font-family-Verdana",iconContent:"Verdana",fontFamily:"Verdana",clickcallback:function(){padeditor.ace.callWithAce(function(E){E.toggleAttributeOnSelection("font-family","Verdana");
},"font-family",true);}}],$("#toolbar-font-family-group"));var D=[["Microsoft YaHei","微软雅黑"],["STFangsong","华文仿宋"],["STKaiti","华文楷体"],["STSong","华文宋体"],"Arial","Comic Sans MS","Courier New","Georgia","Impact","Times New Roman","Trebuchet MS","Verdana"];
A.toolbarbuttons.fontfamilybutton.registerSelectionState({type:"word",judge:function(I,H){var G,F,E;if(selectionState.isCaret){F=document.queryCommandValue("fontname");
F=F.replace(/\"/g,"");E=C(F);if(E){return"font-family&font-family-"+E;}return"font-family";}else{for(G=0;
H&&G<H.length;G++){if(H[G].indexOf("font-family:")!=-1){F=H[G].replace(/font-family:/g,"");E=C(F);if(E){return"font-family&font-family-"+E;
}}}if(I){E=C($(I).css("font-family"));}if(E){return"font-family&font-family-"+E;}else{return"font-family";
}}}});function C(G){G=G.replace(/\"/g,"");var K=G.split(",");for(var J=0;J<K.length;J++){var F=K[J];if(!F){continue;
}for(var I=0;I<D.length;I++){var E=D[I];if(Array.isArray(E)){for(var H=0;H<E.length;H++){var L=E[H];if(F.indexOf(L)>-1||L.indexOf(F)>-1){return E[0];
}}}else{if(F.indexOf(E)>-1||E.indexOf(F)>-1){return E;}}}}return null;}},initFontSizeButton:function(){A.toolbarbuttons.fontsizebutton=new ToolBarContentMenuButton($("#font-size"),[{content:"10",identity:"font-size-10pt",iconContent:"10",clickcallback:function(){padeditor.ace.callWithAce(function(D){D.toggleAttributeOnSelection("font-size","10pt");
},"font-size",true);}},{content:"12",identity:"font-size-12pt",iconContent:"12",clickcallback:function(){padeditor.ace.callWithAce(function(D){D.toggleAttributeOnSelection("font-size","12pt");
},"font-size",true);}},{content:"14",identity:"font-size-14pt",iconContent:"14",clickcallback:function(){padeditor.ace.callWithAce(function(D){D.toggleAttributeOnSelection("font-size","14pt");
},"font-size",true);}},{content:"16",identity:"font-size-16pt",iconContent:"16",clickcallback:function(){padeditor.ace.callWithAce(function(D){D.toggleAttributeOnSelection("font-size","16pt");
},"font-size",true);}},{content:"18",identity:"font-size-18pt",iconContent:"18",clickcallback:function(){padeditor.ace.callWithAce(function(D){D.toggleAttributeOnSelection("font-size","18pt");
},"font-size",true);}},{content:"24",identity:"font-size-24pt",iconContent:"24",clickcallback:function(){padeditor.ace.callWithAce(function(D){D.toggleAttributeOnSelection("font-size","24pt");
},"font-size",true);}},{content:"30",identity:"font-size-30pt",iconContent:"30",clickcallback:function(){padeditor.ace.callWithAce(function(D){D.toggleAttributeOnSelection("font-size","30pt");
},"font-size",true);}},{content:"36",identity:"font-size-36pt",iconContent:"36",clickcallback:function(){padeditor.ace.callWithAce(function(D){D.toggleAttributeOnSelection("font-size","36pt");
},"font-size",true);}}],$("#toolbar-font-size-group"));A.toolbarbuttons.fontsizebutton.registerSelectionState({type:"word",judge:function(G,E){for(var D=0;
E&&D<E.length;D++){if(E[D].indexOf("font-size:")!=-1){return"font-size&font-size-"+E[D].replace(/font-size:/g,"");
}}var F=C(G);if(F){return F;}return"font-size&font-size-12pt";}});function C(F){if(!F){return null;}var D=$(F)[0];
while(D&&D!=window){var E=D.style.fontSize;if(E){if(E&&E.indexOf("pt")>-1){return"font-size&font-size-"+E;
}else{return null;}}D=D.parentElement;}return null;}},initFontColorButton:function(){A.toolbarbuttons.fontcolorbutton=new ToolBarFontColorButton($("#toolbar-font-color-group"));
$("#fontcolor-button").colorPicker({colorButton:A.toolbarbuttons.fontcolorbutton,onColorChange:function(C){padeditor.ace.callWithAce(function(D){D.toggleAttributeOnSelection("color",C);
},"font-size",true);}});$("#toolbar-colorPicker-picker-wrapper").on("mousedown",function(C){C.preventDefault();
});},initFontBgColorButton:function(){A.toolbarbuttons.fontbgcolorbutton=new ToolBarFontBgColorButton($("#toolbar-font-bgcolor-group"));
$("#fontbgcolor-button").colorPicker({colorButton:A.toolbarbuttons.fontbgcolorbutton,pickerType:2,isDoc:true,onColorChange:function(C){padeditor.ace.callWithAce(function(D){D.toggleAttributeOnSelection("background-color",C);
},"background-color",true);}});$("#toolbar-colorPicker-picker-paint-wrapper").on("mousedown",function(C){C.preventDefault();
});},initNumberedListButton:function(){A.toolbarbuttons.numberedlistbutton=new ToolBarButton($("#numberedlistbutton"));
A.toolbarbuttons.numberedlistbutton.registerSelectionState({type:"line",classes:"line-list-type-number"});
},initListButton:function(){A.toolbarbuttons.listbutton=new ToolBarButton($("#listbutton"));A.toolbarbuttons.listbutton.registerSelectionState({type:"line",classes:"line-list-type-bullet"});
},initTaskButton:function(){A.toolbarbuttons.taskbutton=new ToolBarButton($("#taskbutton"));A.toolbarbuttons.taskbutton.registerSelectionState({type:"line",classes:["line-list-type-taskdone","line-list-type-task"]});
},isToolBarButtonEnable:function(C){if(B[C]){return A.toolbarbuttons[B[C]].isEnable();}return true;}};
A.init();return A;};var ToolBarSheet=function(){var B={"sheet-undo":"sheetundobutton","sheet-redo":"sheetredobutton","sheet-font-family":"sheetfontfamily","sheet-font-size":"sheetfontsize","sheet-bold":"sheetboldbutton","sheet-italic":"sheetitalicsbutton","sheet-underline":"sheetunderlinebutton","sheet-strike":"sheetstrikebutton","sheet-horizontal-align":"sheethorizontalalign","sheet-vertical-align":"sheetverticalalign","sheet-merge":"sheetmergecell","sheet-sort":"sheetsort","sheet-border":"sheetborder","sheet-insert-link":"sheetinsertlink"};
var A={init:function(){A.inhert();A.initToolBarButtons();A.registerBaseListeners();},inhert:function(){this.temp=ToolBar;
this.temp();delete this.temp;},initToolBarButtons:function(){A.toolbarbuttons.sheetundobutton=new ToolBarButton($("#sheet-undobutton"));
A.toolbarbuttons.sheetredobutton=new ToolBarButton($("#sheet-redobutton"));A.initFormatPainterButton();
A.initClearFormatButton();A.initBoldButton();A.initItalicsButton();A.initUnderlineButton();A.initStrikeButton();
A.initHorizontalAlign();A.initVerticalAlign();A.initFontColorButton();A.initPaintBrushButton();A.initFontSizeButton();
A.initFontFamilyButton();A.initMergeCellButton();A.initSortButton();A.initBorderButton();A.toolbarbuttons.sheetinsertlink=new ToolBarButton($("#sheet-insert-link"));
},initFormatPainterButton:function(){var C=$("#sheet-format-painter");A.toolbarbuttons.sheetformatpainterbutton=new ToolBarButton(C);
A.addIgnoreCheckItem("sheetformatpainterbutton");$(window).on("click",function(E){if($(E.target).parents("#sheet-format-painter").length==0){A.toolbarbuttons.sheetformatpainterbutton.uncheck();
}});if(window.frames.sheet){D();}else{$(top).bind("SheetDocumentLoadFinished",function(){D();});}function D(){$(top).bind("clearMatchProp",function(){A.toolbarbuttons.sheetformatpainterbutton.uncheck();
});}C.on("click",function(){A.toolbarbuttons.sheetformatpainterbutton.check();});},initClearFormatButton:function(){A.toolbarbuttons.sheetclearformatbutton=new ToolBarButton($("#sheet-clear-format"));
A.addIgnoreCheckItem("sheetclearformatbutton");},initBoldButton:function(){A.toolbarbuttons.sheetboldbutton=new ToolBarButton($("#sheet-boldbutton"));
A.toolbarbuttons.sheetboldbutton.registerSelectionState({judge:function(D){var C=$(D).css("font-weight");
if(C=="bold"){return"sheet-boldbutton";}else{if(parseInt(C)&&parseInt(C)>=700){return"sheet-boldbutton";
}}}});},initItalicsButton:function(){A.toolbarbuttons.sheetitalicsbutton=new ToolBarButton($("#sheet-italicsbutton"));
A.toolbarbuttons.sheetitalicsbutton.registerSelectionState({judge:function(C){if($(C).css("font-style")=="italic"){return"sheet-italicsbutton";
}}});},initUnderlineButton:function(){A.toolbarbuttons.sheetunderlinebutton=new ToolBarButton($("#sheet-underlinebutton"));
A.toolbarbuttons.sheetunderlinebutton.registerSelectionState({judge:function(C){if($(C).css("text-decoration").indexOf("underline")!=-1){return"sheet-underlinebutton";
}}});},initStrikeButton:function(){A.toolbarbuttons.sheetstrikebutton=new ToolBarButton($("#sheet-strikebutton"));
A.toolbarbuttons.sheetstrikebutton.registerSelectionState({judge:function(C){if($(C).css("text-decoration").indexOf("line-through")!=-1){return"sheet-strikebutton";
}}});},initBorderButton:function(){A.toolbarbuttons.sheetborder=new ToolBarBorderButton($("#sheet-border"),$("#toolbar-sheet-border-group"),function(C,D){if(C&&D){var E="sheetborder:"+C+":"+D;
padeditbar_utils.sheetButtonClick(E);}else{console.log("setborder error borderCmd or selectedColor is null");
}});},initHorizontalAlign:function(){A.toolbarbuttons.sheethorizontalalign=new ToolBarImageMenuButton($("#sheet-horizontal-align"),[{rowIconClsName:"docx-icon-common toolbar-icon-sheet-left-align-row",hover:"左对齐",identity:"sheet-horizontal-align-left",iconClassName:"docx-icon-common toolbar-icon-sheet-left-align",clickcallback:function(){padeditbar_utils.sheetButtonClick("sheet-left-align");
}},{rowIconClsName:"docx-icon-common toolbar-icon-sheet-center-align-row",hover:"居中对齐",identity:"sheet-horizontal-align-center",iconClassName:"docx-icon-common toolbar-icon-sheet-center-align",clickcallback:function(){padeditbar_utils.sheetButtonClick("sheet-center-align");
}},{rowIconClsName:"docx-icon-common toolbar-icon-sheet-right-align-row",hover:"右对齐",identity:"sheet-horizontal-align-right",iconClassName:"docx-icon-common toolbar-icon-sheet-right-align",clickcallback:function(){padeditbar_utils.sheetButtonClick("sheet-right-align");
}}],$("#toolbar-sheet-horizontal-align-group"));A.toolbarbuttons.sheethorizontalalign.registerSelectionState({judge:function(C){if(["left","center","right"].contains($(C).css("text-align"))){return"sheet-horizontal-align&sheet-horizontal-align-"+$(C).css("text-align");
}else{return"sheet-horizontal-align&sheet-horizontal-align-left";}}});},initVerticalAlign:function(){A.toolbarbuttons.sheetverticalalign=new ToolBarImageMenuButton($("#sheet-vertical-align"),[{rowIconClsName:"docx-icon-common toolbar-icon-sheet-top-align-row",hover:"顶端对齐",identity:"sheet-vertical-align-top",iconClassName:"docx-icon-common toolbar-icon-sheet-top-align",clickcallback:function(){padeditbar_utils.sheetButtonClick("sheet-top-align");
}},{rowIconClsName:"docx-icon-common toolbar-icon-sheet-middle-align-row",hover:"居中对齐",identity:"sheet-vertical-align-middle",iconClassName:"docx-icon-common toolbar-icon-sheet-middle-align",clickcallback:function(){padeditbar_utils.sheetButtonClick("sheet-middle-align");
}},{rowIconClsName:"docx-icon-common toolbar-icon-sheet-bottom-align-row",hover:"底端对齐",identity:"sheet-vertical-align-bottom",iconClassName:"docx-icon-common toolbar-icon-sheet-bottom-align",clickcallback:function(){padeditbar_utils.sheetButtonClick("sheet-bottom-align");
}}],$("#toolbar-sheet-vertical-align-group"));A.toolbarbuttons.sheetverticalalign.registerSelectionState({judge:function(C){if(["top","middle","bottom"].contains($(C).css("vertical-align"))){return"sheet-vertical-align&sheet-vertical-align-"+$(C).css("vertical-align");
}else{return"sheet-vertical-align&sheet-vertical-align-middle";}}});},initFontColorButton:function(){A.toolbarbuttons.sheetfontcolorbutton=new ToolBarFontColorButton($("#toolbar-sheet-font-color-group"));
var C=$("#sheet-fontcolor-button").colorPicker({colorButton:A.toolbarbuttons.sheetfontcolorbutton,onColorChange:function(D){var E="fontcolor:"+D;
padeditbar_utils.sheetButtonClick(E);}});$("#toolbar-colorPicker-picker-wrapper").on("mousedown",function(D){D.preventDefault();
});},initPaintBrushButton:function(){A.toolbarbuttons.sheetpaintbrushcolorbutton=new ToolBarPaintBrushColorButton($("#toolbar-sheet-paint-brush-color-group"));
var C=$("#sheet-paint-brush-color-button").colorPicker({colorButton:A.toolbarbuttons.sheetpaintbrushcolorbutton,pickerType:2,onColorChange:function(D){var E="cellcolor:"+D;
padeditbar_utils.sheetButtonClick(E);}});$("#toolbar-colorPicker-picker-paint-wrapper").on("mousedown",function(D){D.preventDefault();
});},initFontSizeButton:function(){A.toolbarbuttons.sheetfontsize=new ToolBarContentMenuButton($("#sheet-font-size"),[{content:"6",identity:"sheet-font-size-6",iconContent:"6",iconClassName:"docx-icon-common toolbar-icon-sheet-middle-align",clickcallback:function(){padeditbar_utils.sheetButtonClick("fontsize:6");
}},{content:"8",identity:"sheet-font-size-8",iconContent:"8",iconClassName:"docx-icon-common toolbar-icon-sheet-middle-align",clickcallback:function(){padeditbar_utils.sheetButtonClick("fontsize:8");
}},{content:"10",identity:"sheet-font-size-10",iconContent:"10",iconClassName:"docx-icon-common toolbar-icon-sheet-middle-align",clickcallback:function(){padeditbar_utils.sheetButtonClick("fontsize:10");
}},{content:"12",identity:"sheet-font-size-12",iconContent:"12",iconClassName:"docx-icon-common toolbar-icon-sheet-top-align",clickcallback:function(){padeditbar_utils.sheetButtonClick("fontsize:12");
}},{content:"14",identity:"sheet-font-size-14",iconContent:"14",iconClassName:"docx-icon-common toolbar-icon-sheet-middle-align",clickcallback:function(){padeditbar_utils.sheetButtonClick("fontsize:14");
}},{content:"16",identity:"sheet-font-size-16",iconContent:"16",iconClassName:"docx-icon-common toolbar-icon-sheet-bottom-align",clickcallback:function(){padeditbar_utils.sheetButtonClick("fontsize:16");
}},{content:"18",identity:"sheet-font-size-18",iconContent:"18",iconClassName:"docx-icon-common toolbar-icon-sheet-middle-align",clickcallback:function(){padeditbar_utils.sheetButtonClick("fontsize:18");
}},{content:"20",identity:"sheet-font-size-20",iconContent:"20",iconClassName:"docx-icon-common toolbar-icon-sheet-middle-align",clickcallback:function(){padeditbar_utils.sheetButtonClick("fontsize:20");
}},{content:"24",identity:"sheet-font-size-24",iconContent:"24",iconClassName:"docx-icon-common toolbar-icon-sheet-middle-align",clickcallback:function(){padeditbar_utils.sheetButtonClick("fontsize:24");
}},{content:"30",identity:"sheet-font-size-30",iconContent:"30",iconClassName:"docx-icon-common toolbar-icon-sheet-middle-align",clickcallback:function(){padeditbar_utils.sheetButtonClick("fontsize:30");
}},{content:"36",identity:"sheet-font-size-36",iconContent:"36",iconClassName:"docx-icon-common toolbar-icon-sheet-middle-align",clickcallback:function(){padeditbar_utils.sheetButtonClick("fontsize:36");
}}],$("#toolbar-sheet-font-size-group"));A.toolbarbuttons.sheetfontsize.registerSelectionState({judge:function(E){var D=sheetHot.getSelectedRange();
var C;if(D){C=sheetHot.getCellMeta(D.highlight.row,D.highlight.col);if(C.style&&C.style.fontsize){return"sheet-font-size&sheet-font-size-"+(parseInt(C.style.fontsize));
}}if($(E).css("font-size")){return"sheet-font-size&sheet-font-size-"+(parseInt($(E).css("font-size"))-4);
}}});},initFontFamilyButton:function(){A.toolbarbuttons.sheetfontfamily=new ToolBarContentMenuButton($("#sheet-font-family"),[{content:"微软雅黑",identity:"sheet-font-family-Microsoft YaHei",iconClassName:"docx-icon-common toolbar-icon-sheet-top-align",fontFamily:"Microsoft YaHei",clickcallback:function(){padeditbar_utils.sheetButtonClick("fontfamily:1");
}},{content:"华文仿宋",identity:"sheet-font-family-STFangsong",fontFamily:"STFangsong",iconClassName:"docx-icon-common toolbar-icon-sheet-top-align",clickcallback:function(){padeditbar_utils.sheetButtonClick("fontfamily:2");
}},{content:"华文楷体",identity:"sheet-font-family-STKaiti",fontFamily:"STKaiti",iconClassName:"docx-icon-common toolbar-icon-sheet-top-align",clickcallback:function(){padeditbar_utils.sheetButtonClick("fontfamily:3");
}},{content:"华文宋体",identity:"sheet-font-family-STSong",fontFamily:"STSong",iconClassName:"docx-icon-common toolbar-icon-sheet-top-align",clickcallback:function(){padeditbar_utils.sheetButtonClick("fontfamily:4");
}},{content:"Arial",identity:"sheet-font-family-Arial",fontFamily:"Arial",iconClassName:"docx-icon-common toolbar-icon-sheet-top-align",clickcallback:function(){padeditbar_utils.sheetButtonClick("fontfamily:5");
}},{content:"Comic Sans MS",identity:"sheet-font-family-Comic Sans MS",fontFamily:"Comic Sans MS",iconClassName:"docx-icon-common toolbar-icon-sheet-top-align",clickcallback:function(){padeditbar_utils.sheetButtonClick("fontfamily:6");
}},{content:"Courier New",identity:"sheet-font-family-Courier New",fontFamily:"Courier New",iconClassName:"docx-icon-common toolbar-icon-sheet-top-align",clickcallback:function(){padeditbar_utils.sheetButtonClick("fontfamily:7");
}},{content:"Georgia",identity:"sheet-font-family-Georgia",fontFamily:"Georgia",iconClassName:"docx-icon-common toolbar-icon-sheet-top-align",clickcallback:function(){padeditbar_utils.sheetButtonClick("fontfamily:8");
}},{content:"Impact",identity:"sheet-font-family-Impact",fontFamily:"Impact",iconClassName:"docx-icon-common toolbar-icon-sheet-top-align",clickcallback:function(){padeditbar_utils.sheetButtonClick("fontfamily:9");
}},{content:"Times New Roman",identity:"sheet-font-family-Times New Roman",fontFamily:"Times New Roman",iconClassName:"docx-icon-common toolbar-icon-sheet-top-align",clickcallback:function(){padeditbar_utils.sheetButtonClick("fontfamily:10");
}},{content:"Trebuchet MS",identity:"sheet-font-family-Trebuchet MS",fontFamily:"Trebuchet MS",iconClassName:"docx-icon-common toolbar-icon-sheet-top-align",clickcallback:function(){padeditbar_utils.sheetButtonClick("fontfamily:11");
}},{content:"Verdana",identity:"sheet-font-family-Verdana",fontFamily:"Verdana",iconClassName:"docx-icon-common toolbar-icon-sheet-top-align",clickcallback:function(){padeditbar_utils.sheetButtonClick("fontfamily:12");
}}],$("#toolbar-sheet-font-family-group"));var C=["Microsoft YaHei","STFangsong","STKaiti","STSong","Arial","Comic Sans MS","Courier New","Georgia","Impact","Times New Roman","Trebuchet MS","Verdana"];
A.toolbarbuttons.sheetfontfamily.registerSelectionState({judge:function(F){for(var D=0;D<C.length;D++){var E=$(F).css("font-family");
E=E.replace(/\"/g,"");if(E.indexOf(C[D])!=-1){return"sheet-font-family&sheet-font-family-"+C[D];}}return"sheet-font-family&sheet-font-family-Microsoft YaHei";
}});},initMergeCellButton:function(){A.toolbarbuttons.sheetmergecell=new ToolBarButton($("#sheet-merge-cell"));
if(window.frames.sheet){C();}else{$(top).bind("SheetDocumentLoadFinished",function(){C();});}A.toolbarbuttons.sheetmergecell.registerSelectionState({judge:function(D){if(padeditbar_utils.isSingleMergeCell()){return"sheet-merge-cell";
}}});function C(){$(window.frames.sheet).bind("mouseup",function(E){D();});$(window).bind("mouseup",function(E){D();
});function D(){if(padeditbar_utils.isSingleCell()){A.toolbarbuttons.sheetmergecell.disable();}else{if(window.gEditable){A.toolbarbuttons.sheetmergecell.enable();
}}}}},initSortButton:function(){A.toolbarbuttons.sheetsort=new ToolBarImageMenuButton($("#sheet-sort"),[{content:"升序",identity:"sheet-ascending-sort",hover:"'将表格按' + padeditbar_utils.getSelectedCol()[1] + '列升序'",iconClassName:"docx-icon-common toolbar-icon-sort",clickcallback:function(){padeditbar_utils.sheetSortButtonClick("sheet-ascending-sort");
}},{content:"降序",identity:"sheet-descending-sort",hover:"'将表格按' + padeditbar_utils.getSelectedCol()[1] + '列降序'",iconClassName:"docx-icon-common toolbar-icon-sort",clickcallback:function(){padeditbar_utils.sheetSortButtonClick("sheet-descending-sort");
}},{content:"按范围升序",identity:"sheet-ascending-range-sort",hover:"'将选中范围按' + padeditbar_utils.getSelectedCol()[1] + '列升序'",iconClassName:"docx-icon-common toolbar-icon-sort",clickcallback:function(){padeditbar_utils.sheetSortButtonClick("sheet-ascending-range-sort");
}},{content:"按范围降序",identity:"sheet-descending-range-sort",hover:"'将选中范围按' + padeditbar_utils.getSelectedCol()[1] + '列降序'",iconClassName:"docx-icon-common toolbar-icon-sort",clickcallback:function(){padeditbar_utils.sheetSortButtonClick("sheet-descending-range-sort");
}}],$("#toolbar-sheet-sort-group"));},isToolBarButtonEnable:function(C){if(B[C]){return A.toolbarbuttons[B[C]].isEnable();
}return true;}};A.init();return A;};$(window).bind("FlagBind",function(){});var toolbarController=null;
if(!clientVars.isMobile&&$("#padbody").find(".sheet-style").length){toolbarController=new ToolBarSheet();
}else{toolbarController=new ToolBarDocx();}var historylist=(function(){var D=null;var B=null;var J=0;
var I=false;var H=null;var A=null;var C=null;var M=null;var K=null;var F=false;var E=null;var N=0;var L=false;
function G(a,b){if(b){a.removeClass("history-item-arrow-icon-right");a.addClass("history-item-arrow-icon-down");
a.attr("data-tooltip","收起详细记录");}else{a.removeClass("history-item-arrow-icon-down");a.addClass("history-item-arrow-icon-right");
a.attr("data-tooltip","展开详细记录");}$("#tooltip").text(C.attr("data-tooltip"));}function Q(){padutils.tooltip(".history-item-arrow-icon");
$(".history-item-arrow-icon").unbind("mousedown");$(".history-item-arrow-icon").mousedown(function(a){if(B){if(B.is($(this).parent().parent().next())){B.toggle();
B=null;G(C,false);C=null;}else{B.toggle();B=$(this).parent().parent().next();B.toggle();G(C,false);C=$(this);
G(C,true);}}else{B=$(this).parent().parent().next();B.toggle();C=$(this);G(C,true);}a.stopPropagation();
});$(".history-subitem,.history-item-header").unbind("mousedown");$(".history-subitem,.history-item-header").mousedown(function(){if(A){A.removeClass("history-item-common-selected");
A.addClass("history-item-common");}A=$(this);A.addClass("history-item-common-selected");A.removeClass("history-item-common");
if(H){H(A.attr("version"),A.attr("revision"),A.attr("time"),A.hasClass("history-item-header"));}});}function V(){if(!L){A=$($(".history-item-header")[0]);
A.addClass("history-item-common-selected");A.removeClass("history-item-common");L=true;}}function U(){D.scroll(function(){var a=$(this).scrollTop();
var b=$(this)[0].scrollHeight;if(F&&!I&&a>J&&(b-a-($(this).height())<60)){I=true;M(function(d,c){I=false;
F=c;});}J=a;});}function P(a,h){var b=null;if(a.a instanceof Array){b=O(a.a);}else{b=O([a.a]);}if(b.length>30){b=b.substring(0,29)+"...";
if(a.a instanceof Array&&a.a.length>1){b+="等"+a.a.length+"人";}}if(a.i==1||a.v==1||a.isCreate==true){return b+"创建了"+E;
}else{if(a.r){var f=a.r;var g=0;var c=0;if(typeof f=="string"){var d=f.split("_");g=parseInt(d[0]);if(d[1]){c=parseInt(d[1]);
}}else{g=f;}return b+"将"+E+"恢复到"+(c==0?($.localstringFromTime(a.r)+"时的内容"):("第"+c+"版"));}else{return b+(h?("编辑了"+E):(a.tt==1?"修改了标题":"修改了内容"));
}}}function T(a){var b="<div class='history-subitem history-item-common' revision='"+a.i+"' time='"+a.t+"'><div class='history-subitem-content'><div class='history-subitem-time'>"+$.localstringFromTime(a.t)+"</div><div class='history-subitem-change'>"+P(a,false)+"</div></div></div>";
return b;}function X(b,f){var d=b.i;var a=b.v;var c=b.t;return"<div class='history-item-header history-item-common' revision='"+d+"' version='"+a+"' time='"+c+"'>"+(f?"<div class='history-item-arrow-icon-outer'><div class='history-item-arrow-icon history-item-arrow-icon-right' data-tooltip='展开详细记录'></div></div>":"")+"<div class='history-item-version"+(a==N?" history-item-version-max":"")+"'>第"+a+"版"+(a==N?"(当前)":"")+"</div><div class='history-item-header-content'><div class='history-item-time'>"+$.localstringFromTime(c)+"</div><div class='history-item-change'>"+P(b,true)+"</div></div></div>";
}function S(c){var a=c.l;if(c.v==1&&a&&a.length>=1){a[a.length-1].isCreate=true;}var b="<div class='history-item'>";
b+=X(c,a&&a.length>1);b+="<div class='history-item-body'> ";a&&a.forEach(function(d){b+=T(d);});b+="</div></div>";
return b;}function W(a){if(!a){return"";}var b="";a.forEach(function(c){b+=S(c);});return b;}function Z(){D=null;
B=null;J=0;I=false;H=null;A=null;C=null;M=null;K=null;F=false;E=null;}function R(a){return K[a];}function O(b){var a=[];
b.forEach(function(c){a.push(R(c).name);});return a.join("、");}var Y={appendItems:function(b,a,c){K=a;
F=c;$(W(b)).appendTo(D);Q();V();},prepareContainer:function(b,c,f,d){var a="<div class='history-list' id='history-list'>";
a+="</div>";$(a).appendTo(b);D=$("#history-list");Q();U();H=f;M=d;E=c?"表格":"文档";L=false;},dismiss:function(){if(D){D.remove();
}Z();},setLatestVersion:function(a){N=a;}};return Y;})();var login=(function(){var B=false;var A={init:function(D,C){A.appendTemplates(D,C);
A.registerListeners(C);A.checkAuth(C);},appendTemplates:function(C,E){C=C||$("header");var D=null;if(E){D=A.getUnloginStatusTemplate();
}else{D=A.getLoginStatusTemplate();}C.append($(D));},getUnloginStatusTemplate:function(){var C=$("#template-unlogin-status").html();
setTimeout(function(){if(!$("#login-fraime-container").length||!$(".login-frame-overlay").length){A.initLoginFrame();
}},100);return C;},getLoginStatusTemplate:function(){var C=$("#template-login-status").html();if(clientVars&&clientVars.userName){setTimeout(function(){$(".user-info-nick").html(clientVars.userName);
},0);}A.includeLogoutJS();return C;},registerListeners:function(C){if(C){$(".login-button").on("click",function(D){A.showLoginFrame();
A.setLoginFrameSrc();});A.registerLoginListeners();}else{A.registerLogoutListeners();A.registerFeedbackListeners();
}},setLoginFrameSrc:function(){var C=top.location.href.split("#")[0];var E=1600000752;var D=445;if(C.indexOf("docs")>=0){E=1600000931;
D=536;}C=C.split(":").join("%3A").split("/").join("%2F").split("#").join("%23");$("#login_frame").attr("src",document.location.protocol+"//xui.ptlogin2.qq.com/cgi-bin/xlogin?appid="+E+"&daid="+D+"&s_url="+C);
},registerLoginListeners:function(){if(B){return;}B=true;if(typeof window.postMessage!=="undefined"){window.onmessage=function(H){var G=H||window.event;
var F;if(typeof JSON!=="undefined"){try{F=JSON.parse(G.data);}catch(I){console.log("JSON.parse fail in login : ["+G.data+"]");
return;}}else{F=E(G.data);}switch(F.action){case"close":C();break;case"resize":D(F.width,F.height);break;
default:break;}};}else{navigator.ptlogin_callback=function(G){var F=E(G);switch(F.action){case"close":C();
break;case"resize":D(F.width,F.height);break;default:break;}};}function E(F){var G=/^[\],:{}\s]*$/,J=/(?:^|:|,)(?:\s*\[)+/g,H=/\\(?:["\\\/bfnrt]|u[\da-fA-F]{4})/g,I=/"[^"\\\r\n]*"|true|false|null|-?(?:\d+\.|)\d+(?:[eE][+-]?\d+|)/g;
if(G.test(F.replace(H,"@").replace(I,"]").replace(J,""))){return(new Function("return "+F))();}return{};
}function C(){A.hideLoginFrame();}function D(G,F){}},registerLogoutListeners:function(){$("#logout-button").on("click",function(){if(pt_logout){pt_logout.logout(function(C){if(C=="2"){location.href="/ep/account/sign-out?stay=1";
}});}});},registerFeedbackListeners:function(){$("#feedback-button").on("click",function(){$.showSupportPage();
});},cleanCookies:function(){var H=document.cookie.split(";");var C=location.hostname.match(/\w*\.(cc|com|cn|com\.cn)$/);
C=C?C[0]:"";var D=location.hostname.match(/\w+(\.\w+)\.(cc|com|cn|com\.cn)$/);D=D?D[0]:"";"qq.com"!=C&&(D=C);
for(var F=0;F<H.length;F++){var E=H[F];var I=E.indexOf("=");var G=I>-1?E.substr(0,I):E;A.deleteCookie(G,C);
A.deleteCookie(G,D);}},deleteCookie:function(E,C,D){document.cookie=E+"=; expires=Mon, 26 Jul 1997 05:00:00 GMT; path="+(D?D:"/")+"; "+(C?"domain="+C+";":"");
},includeLogoutJS:function(){if(document.location.protocol=="https:"){$.getScript("https://ui.ptlogin2.qq.com/js/ptloginout.js");
}else{$.getScript("http://imgcache.qq.com/ptlogin/ac/v9/js/ptloginout.js");}},initLoginFrame:function(){$("#login-fraime-container").remove();
$(".login-frame-overlay").remove();$("body").append($($("#template-login-frame").html()));},showLoginFrame:function(){if(!$("#login-fraime-container").length||!$(".login-frame-overlay").length){A.initLoginFrame();
}if(!$("#login_frame").attr("src")){A.registerLoginListeners();A.setLoginFrameSrc();}$("#login-fraime-container").css("display","block");
$(".login-frame-overlay").css("display","block");},hideLoginFrame:function(){$("#login-fraime-container").css("display","none");
$(".login-frame-overlay").css("display","none");},checkAuth:function(C){if(!C){setInterval(function(){$.get("/sdc/checkauth",{},function(E,D){});
},30*60*1000);}}};return A;})();var indexDropdown=0;var DropDown=function(H,D){var E=0;var G=0;var B=null;
var C={};var F=null;var A={getMyId:function(I){return I+"-"+E;},setMyRowId:function(K,I){var J="li-dropdown-"+E+"-"+(G++);
K.attr("id",J);if(I){C[I]="#"+J;}},initMyId:function(){E=(indexDropdown++);B.attr("id",A.getMyId("dropdown-wrapper"));
},isNoemalImageContentTemplate:function(I){if(I=="template-dropdown-image-content-row"||I=="template-dropdown-image-row"||I=="template-dropdown-content-row"){return true;
}else{return false;}},getNormalImageContentRowHtml:function(J,L){if(L=="template-dropdown-image-content-row"||L=="template-dropdown-image-row"||L=="template-dropdown-content-row"){var I=$($("#"+L).html());
var M=J.image;var N=J.content;var Q=J.fontFamily;var K=J.clickcallback;var R=J.hover;var O=J.disable;
var P=J.iconClsName;if(!M&&!N&&!K){return;}if(J.drawviewcallback){J.drawviewcallback(I,J);}else{if(M){$(I).find(".dropdown-img").css("background-image","url("+M+")");
}else{$(I).find(".dropdown-img img").hide();}if(N){$(I).find(".dropdown-content").append(N);}else{$(I).find(".dropdown-content").hide();
}if(Q){$(I).find(".dropdown-content").css("font-family",Q);}if(O){$(I).find(".dropdown-content").css("opacity",0.3);
}if(R){$(I).first("li.li-dropdown").attr("data-tooltip",R);padutils.horizontalTooltip($(I).first("li.li-dropdown"),{"min-width":66,left:-15});
}if(P){$(I).find(".dropdown-img").addClass(P);}}if(!O&&K&&typeof K=="function"){$(I).on("click",function(S){K(S);
});}padutils.btnState($(I),"li-dropdown-hover","li-dropdown-clicked");A.setMyRowId($(I),J.identity);return I;
}return null;},getRowTemplate:function(I){var J=I.template||((I.image||I.iconClsName)&&I.content&&"template-dropdown-image-content-row")||((I.image||I.iconClsName)&&!I.content&&"template-dropdown-image-row")||(!(I.image||I.iconClsName)&&I.content&&"template-dropdown-content-row")||"template-dropdown-image-content-row";
return J;},getRowHtml:function(J){var I=A.getRowTemplate(J);var K=null;if(A.isNoemalImageContentTemplate(I)){K=A.getNormalImageContentRowHtml(J,I);
}return K;},updateDropDown:function(I){B.append($(I));},disable:function(J){if(J){for(var I=0;I<J.length;
I++){var K=J[I];if(C[K]){if(!($(C[K])).hasClass("disabled")){($(C[K])).addClass("disabled");}}}}},enable:function(J){if(J){for(var I=0;
I<J.length;I++){var K=J[I];if(C[K]){if(($(C[K])).hasClass("disabled")){($(C[K])).removeClass("disabled");
}}}}},getLastStatus:function(){return F;},setLastStatus:function(I){F=I;},updateToolTip:function(I){if(I){for(var J in I){if(C[J]){($(C[J])).attr("data-tooltip",I[J]);
}}}},hide:function(){B.removeClass("open");B.children("li").each(function(){$(this).removeClass("li-dropdown-selected");
});},show:function(){B.addClass("open");if(D){B.css("left",(D.children().first().width()-B.width())/2);
var I=D.children().first().text().trim();if(!I){I=D.children().first().attr("identity");if(I&&I.indexOf("left")!=-1){I="左对齐";
}else{if(I&&I.indexOf("right")!=-1){I="右对齐";}else{if(I&&I.indexOf("center")!=-1){I="居中对齐";}}}}if(I){B.children("li").each(function(){if($(this).text().trim()==I){$(this).addClass("li-dropdown-selected");
}if($(this).attr("data-tooltip")==I){$(this).addClass("li-dropdown-selected");}});}}},toggleDropDown:function(){if(B.hasClass("open")){A.hide();
}else{A.show();}},bodyclickhandler:function(I,J){if($(I.target).is("#"+J.attr("id"))||($(I.target).parents("#"+J.attr("id")).length&&$(I.target).parents(B.attr("id")).length==0)){return;
}A.hide();},registerEventListeners:function(){$("body").on("click",function(I){A.bodyclickhandler(I,D);
});window.addEventListener("closedropdown",function(I){A.bodyclickhandler(I,D);});B.on("mousedown",function(I){I.preventDefault();
});},init:function(I,J){B=$($("#template-dropdown-wrapper").html());A.initMyId();J.append(B);for(var K in I){var L=A.getRowHtml(I[K]);
A.updateDropDown(L);}A.registerEventListeners();}};A.init(H,D);return A;};
/*
 * Copyright 2009 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS-IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var index=0;
var paduserline=(function(){var E={};var I=false;var G={};var J={};var B={};var K=false;function F(N){return"user"+N.userId.replace(".","-")+"_Row";
}function M(O,P){var Q=O.name||"Guest";var N=$($("#template-user-list").html());$(N).attr({id:F(O),title:""});
$(N).find("figure .user-image img").attr({"data-src":O.userPic||"/static/img/nophoto.png",alt:""});var R=parseInt($("#otheruserstable-wrapper").css("width"))-54;
$(N).find("figcaption").css({width:R+"px"});$(N).find("figcaption span").text(Q);if(typeof P=="function"){$(N).on("click",function(){P();
});}return N;}function H(N){return"user"+N.userId.replace(".","-")+"_Block";}function L(O,P){var Q=O.name||"Guest";
var N=$($("#template-user-inline").html());$(N).attr({id:H(O),title:""});$(N).find("img").attr({src:O.userPic||"/static/img/nophoto.png",alt:"","data-tooltip":Q});
if(typeof P=="function"){$(N).on("click",function(R){P();return false;});}return N;}var C={init:function(N){$(A.getMyId("#more")).addClass("ready");
$(A.getMyId("#more-wrapper")).on("click",function(P){if(!Object.getOwnPropertyNames(B).length){return;
}if(typeof N=="function"){N();}C.toggle();var O={act_type:62};$.report(O);return false;});$(A.getMyId("#more")+".ready").css({"margin-top":((parseInt($(A.getMyId("#more-wrapper")).css("height"))-parseInt($(A.getMyId("#more")+".ready").css("border-left")))/2)+"px"});
$(A.getMyId("#more")+".showing").css({"margin-top":((parseInt($(A.getMyId("#more-wrapper")).css("height"))-parseInt($(A.getMyId("#more")+".showing").css("border-left")))/2)+"px"});
},show:function(){$(A.getMyId("#more-wrapper")).show();},hide:function(){$(A.getMyId("#more-wrapper")).hide();
},ready:function(){$(A.getMyId("#more-wrapper")).hide();$(A.getMyId("#more")).removeClass("showing");
$(A.getMyId("#more")).addClass("ready");$(A.getMyId("#more")).css({"margin-top":((parseInt($(A.getMyId("#otherusersline-wrapper")).css("height"))-2*parseInt($(A.getMyId("#more")).css("border-left")))/2)+"px"});
$(A.getMyId("#more-wrapper")).show();},showing:function(){$(A.getMyId("#more-wrapper")).hide();$(A.getMyId("#more")).removeClass("ready");
$(A.getMyId("#more")).addClass("showing");$(A.getMyId("#more")).css({"margin-top":((parseInt($(A.getMyId("#otherusersline-wrapper")).css("height"))-parseInt($(A.getMyId("#more")).css("border-left")))/2)+"px"});
$(A.getMyId("#more-wrapper")).show();},reset:function(){if($(A.getMyId("#more")).hasClass("showing")){C.ready();
}},toggle:function(){if($(A.getMyId("#more")).hasClass("ready")){C.showing();}else{C.ready();}}};var D={init:function(N){$(A.getMyId("#more")).addClass("ready");
$(A.getMyId("#more-wrapper")).on("click",function(P){if(!Object.getOwnPropertyNames(B).length){return;
}if(typeof N=="function"){N();}D.toggle();var O={act_type:62};$.report(O);return false;});},ready:function(){$(A.getMyId("#more-wrapper")).hide();
$(A.getMyId("#more")).removeClass("showing");$(A.getMyId("#more")).addClass("ready");$(A.getMyId("#more-wrapper")).show();
},showing:function(){$(A.getMyId("#more-wrapper")).hide();$(A.getMyId("#more")).removeClass("ready");
$(A.getMyId("#more")).addClass("showing");$(A.getMyId("#more-wrapper")).show();},show:function(){$(A.getMyId("#more-wrapper")).show();
},reset:function(){if($(A.getMyId("#more")).hasClass("showing")){D.ready();}},hide:function(){$(A.getMyId("#more-wrapper")).hide();
},toggle:function(){if($(A.getMyId("#more")).hasClass("ready")){D.showing();}else{D.ready();}}};var A={maxShowUserCount:5,isNeedMore:true,index:0,userSize:20,padding:0,space:6,more:C,getMyId:function(N){return N+"-"+A.index;
},setMyUserLineId:function(){$("#otherusers").attr({id:A.getMyId("otherusers")});$("#otherusersline-wrapper").attr({id:A.getMyId("otherusersline-wrapper")});
$("#otherusersline").attr({id:A.getMyId("otherusersline")});$("#more-wrapper").attr({id:A.getMyId("more-wrapper")});
$("#more").attr({id:A.getMyId("more")});},initUserLineSize:function(){$(A.getMyId("#otherusersline")).css({height:(A.userSize+2*A.padding)+"px",width:(A.maxShowUserCount*(A.userSize+2*A.padding+A.space)-A.space)+"px"});
$(A.getMyId("#otherusersline-wrapper")).css({height:(A.userSize+2*A.padding)+"px"});if(A.isNeedMore){$(A.getMyId("#otherusersline-wrapper")).css({width:(parseInt($(A.getMyId("#otherusersline")).css("width"))+parseInt($(A.getMyId("#more-wrapper")).css("width")))+"px"});
}else{$(A.getMyId("#otherusersline-wrapper")).css({width:$(A.getMyId("#otherusersline")).css("width")});
}},initUserTableSize:function(){$("#otheruserstable-wrapper").css({top:((parseInt($(A.getMyId("#otherusers")).parent().css("height"))+parseInt($(A.getMyId("#otherusersline-wrapper")).css("height")))/2+7)+"px"});
$(A.getMyId("#otherusers")).css({height:parseInt($(A.getMyId("#otherusersline-wrapper")).css("height")),width:parseInt($(A.getMyId("#otherusersline-wrapper")).css("width"))});
},initUserTableInMobileSize:function(){$("#otheruserstable-wrapper").css({top:"40px",right:(-parseInt($(".tim-userline-wrapper").css("right")))+"px",width:document.body.clientWidth+"px",height:document.body.clientHeight+"px"});
$(A.getMyId("#otherusers")).css({height:parseInt($(A.getMyId("#otherusersline-wrapper")).css("height")),width:parseInt($(A.getMyId("#otherusersline-wrapper")).css("width"))});
},initSize:function(){$(A.getMyId("#otherusers")).hide();A.initUserLineSize();if(clientVars.isMobile){A.initUserTableInMobileSize();
}else{A.initUserTableSize();}$(A.getMyId("#otherusers")).show();},setFacepilePosition:function(){if(clientVars.isMobile){A.padding=1;
A.space=-12;A.userSize=24;}},initFacepileCss:function(){$(".user-facepile-inline").css({height:A.userSize+"px",width:A.userSize+"px","border-radius":A.userSize+"px",padding:A.padding+"px"});
$(".user-facepile-inline-wrapper").css({position:"absolute",top:"0"});},fitFacepilePosition:function(){$(A.getMyId("#otherusersline")).hide();
var O=$(A.getMyId("#otherusersline")+" .user-facepile-inline-wrapper");var N=O.length;if(N>A.maxShowUserCount){N=A.maxShowUserCount;
}O.each(function(P){if(P<N){$(this).css({right:((N-P-1)*(A.userSize+2*A.padding+A.space))+"px","z-index":(N-P),display:"block"});
}else{$(this).css({display:"none"});}});$(A.getMyId("#otherusersline")).show();$(window).trigger("UserHeadPositionChanged");
},toggleShareList:function(){if($("#otheruserstable").hasClass("open")){$("#otheruserstable, #otheruserstable-wrapper, #otheruserstable-bg, #otheruserstable-title-wrapper, #otheruserstable-title").removeClass("open").scrollTop(0);
A.updateUserSummary();}else{$("#otheruserstable, #otheruserstable-wrapper, #otheruserstable-bg, #otheruserstable-title-wrapper, #otheruserstable-title").addClass("open");
$("#otheruserstable-title").attr({value:"另有"+Object.getOwnPropertyNames(B).length+"人正在查看"});A.loadImg();
}},loadImg:function(){$("#otheruserstable img[data-src]").each(function(N){$(this).attr("src",$(this).attr("data-src")).removeAttr("data-src");
});},hideUsersTable:function(){$("#otheruserstable, #otheruserstable-wrapper, #otheruserstable-bg, #otheruserstable-title-wrapper, #otheruserstable-title").removeClass("open").scrollTop(0);
if(Object.getOwnPropertyNames(B).length){A.more.reset();}},registerListeners:function(){$("body, #otheruserstable-bg").on("click",function(O){if($(O.target).is(A.getMyId("#otherusers"))||$(O.target).is("#killuser")||$(O.target).parents("#killuser").length){return;
}A.hideUsersTable();});if(clientVars.isMobile){var N=2;$(A.getMyId("#otherusersline")).on("click",function(O){if(Object.getOwnPropertyNames(B).length&&Object.getOwnPropertyNames(B).length<N&&O.offsetX>(A.maxShowUserCount-2)*(A.userSize+A.padding+A.space)){A.toggleShareList();
A.more.toggle();O.stopPropagation();}});$("header").on("click",function(O){if(!Object.getOwnPropertyNames(B).length){$("#padAloneTitle").focus();
}});}$(window).bind("SheetMouseDown",function(O){A.hideUsersTable();});$(window).bind("SheetScroll",function(O){A.hideUsersTable();
});$(window).bind("setKeyboardHeight",function(O){A.hideUsersTable();});},init:function(O,Q,P,R){A.index=(index++);
if(index==Number.MAX_VALUE){index=0;}A.setMyUserLineId();A.setFacepilePosition();if(clientVars.isMobile){A.more=D;
}A.more.hide();A.setMyUserInfo(O);I=R;$("#otheruserstable li").remove();$(A.getMyId("#otherusersline")+" div").remove();
A.initSize();for(var N=0;N<P.length;N++){A.groupJoinOrUpdate(P[N]);}for(var N=0;N<Q.length;N++){A.userJoinOrUpdate(Q[N]);
}A.userJoinOrUpdate(O);K=true;A.updateUserList();window.setInterval(A.updateUserList,1000);A.more.init(A.toggleShareList);
A.registerListeners();$(window).trigger("UserHeadPositionChanged");},setMyUserInfo:function(N){E=$.extend({},N);
},userEdited:function(N){if(N&&N!=E.userId){G[N]=new Date();}},userListQueue:[],userJoinOrUpdate:function(N){if(!$("#otheruserstable").length){return;
}if(N.status=="connected"&&(N.userId.indexOf("g.")!=0)&&(!E||N.userId!=E.userId)){if(!B[N.userId]){A.notifyUserJoin(N);
}B[N.userId]=N;}else{return;}if(N.status=="editor"||N.status=="invited"||N.status=="creator"){G[N.userId]=true;
}A.updateUserSummary();function U(W,X){if(typeof(W)=="object"){for(var V=0;V<W.length;V++){if(W[V]<X[V]){return true;
}else{if(W[V]>X[V]){return false;}}}}else{return W<X;}return false;}function O(Y){var W=(Y.attr("id").split("_"))[0].slice(4).replace("-",".");
var V=B[W];if(!V){return[true,true,true,true,""];}var X=clientVars.friendUserIds.indexOf(parseInt(W.slice(2)))>-1;
return[V.status!="connected",W!=clientVars.userId,V.userPic==null,!X,V.name?V.name.toLowerCase():""];
}function T(V,W){P(V,W,"li");}function R(V,W){P(V,W,"div");}function P(X,V,a){V=$(V);var Z=X.find(a);
for(var W=0;W<Z.length;W++){var Y=$(Z[W]);if(U(O(V),O(Y))){Y.before(V);return;}}X.append(V);}function Q(){var V=null;
if(clientVars.isMobile){V=function(){var X={uin:N.uin};try{mqq.invoke("ui","openUserSummaryView",X,function(Z){console.log("openUserSummaryView = "+Z);
});}catch(Y){console.log("open profile fail!");}var W={act_type:23};$.report(W);};}else{V=function(){try{external.showProfile(N.uin);
}catch(X){console.log("open profile fail!");}var W={act_type:63};$.report(W);};}return V;}function S(){var V=null;
if(clientVars.isMobile){V=function(){A.toggleShareList();A.more.toggle();var W={act_type:22};$.report(W);
};}else{V=function(){try{external.showProfile(N.uin);}catch(X){console.log("open profile fail!");}var W={act_type:61};
$.report(W);};}return V;}A.userListQueue.push(function(){$("#otheruserstable #"+F(N)).remove();var Y=Q();
var X=M(N,Y);T($("#otheruserstable"),X);$(A.getMyId("#otherusersline")+" #"+H(N)).remove();var W=S();
var V=L(N,W);R($(A.getMyId("#otherusersline")),V);padutils.tooltip(A.getMyId("#otherusers")+" [data-tooltip]");
if(A.isNeedMore&&(Object.getOwnPropertyNames(B).length>A.maxShowUserCount||(clientVars.isMobile&&Object.getOwnPropertyNames(B).length))){A.more.show();
}else{A.more.hide();}A.initFacepileCss();A.fitFacepilePosition();$("#otheruserstable-title").attr({value:"另有"+Object.getOwnPropertyNames(B).length+"人正在查看"});
window.setTimeout(function(){if($("#otheruserstable").hasClass("open")){A.loadImg();}},0);});},updateUserList:function(){if(!A.userListQueue.length||!$("#otheruserstable").length){return;
}$("#otheruserstable").hide();for(var N=0;N<A.userListQueue.length;++N){A.userListQueue[N]();}$("#otheruserstable").show();
A.userListQueue=[];A.updateUserSummary();},userLeave:function(N){if(N.userId==E.userId){return;}$("#"+F(N)).remove();
$("#"+H(N)).remove();delete B[N.userId];$("#otheruserstable-title").attr({value:"另有"+Object.getOwnPropertyNames(B).length+"人正在查看"});
if(A.isNeedMore&&(Object.getOwnPropertyNames(B).length>A.maxShowUserCount||clientVars.isMobile)&&Object.getOwnPropertyNames(B).length){A.more.show();
}else{A.more.hide();}A.fitFacepilePosition();},userKill:function(N){delete G[N.userId];delete B[N.userId];
$("#"+F(N)).remove();A.updateUserSummary();},updateUserSummary:function(){window.setTimeout(function(){var N=$("#otheruserstable");
if($("#otheruserstable").hasClass("open")){return;}N.find("li").each(function(Q,P){P=$(P);var O=P.find("img[data-src]");
if(O.length&&O.offset().top-N.offset().top<N.height()){O.attr("src",O.attr("data-src")).removeAttr("data-src");
}else{if(O.length){return false;}}});},0);},notifyUserJoin:function(N){if(N.existingUser){return;}window.setTimeout(function(){var O="用户"+(N.name.length>36?N.name.substring(0,35)+"...":N.name)+"正在查看"+($.getType()=="word"?"文档":"表格");
setStatusTips(O);});},groupJoinOrUpdate:function(N){J[N.groupId]=N;A.updateUserSummary();},getUserInfos:function(){return B;
}};return A;}());var sharebox={container:null,fitPosition:function(A){$("#sharebox-wrapper").css("left",Math.floor((Math.min(A.width(),$(window).width())-$("#sharebox-wrapper").outerWidth())/2));
$("#sharebox-wrapper").css("top",Math.floor((Math.min(A.height(),$(window).height())-$("#sharebox-wrapper").outerHeight())*0.4));
},init:function(A,H,G,I,F,C,E,D,B){if($("#sharebox-wrapper").parent().length){$("#sharebox-wrapper").remove();
$("#sharebox-wrapper-shadow-mask").remove();}if(A.append){sharebox.container=A;var E=E||"#template-sharebox";
A.append($($(E).html()));$("<div id='sharebox-wrapper-shadow-mask'>").prependTo(A);sharebox.hide();sharebox.fitPosition(A);
if(D){switch(D){case"doc":$("#deletebox-confirm").text("删除文档");break;case"sheet":$("#deletebox-confirm").text("删除表格");
break;case"record":$("#deletebox-confirm").text("删除");break;}}$("#sharebox-content").attr({value:H});
$("#sharebox-close").on("click",function(J){sharebox.hide();});$("#deletebox-cancel").on("click",function(J){sharebox.hide();
});$("#sharebox-confirm").on("click",function(J){sharebox.hide();});$(window).resize(function(){sharebox.fitPosition(sharebox.container);
});$("#deletebox-confirm").on("click",function(J){if(G){if(C){$.ajax({type:"post",url:C,success:function(K){if(K.retcode==0){if(B){B();
}else{location.reload(true);}}else{alert(K.msg);}},error:function(){}});}else{$.ajax({type:"post",url:"/ep/padlist/delete",data:{padIdToDelete:F},success:function(K){console.log("delete");
if(K.retcode==0){if(B){B();}else{location.reload(true);}}else{alert(K.msg);}},error:function(){}});}}else{sharebox.hide();
}});}sharebox.hide();},show:function(A){$("#sharebox-wrapper").removeClass("sharebox-wrapper-above-shadow");
$("#sharebox-wrapper").show();if(A){if(!$("#sharebox-wrapper").hasClass("sharebox-wrapper-above-shadow")){$("#sharebox-wrapper").addClass("sharebox-wrapper-above-shadow");
}$("#sharebox-wrapper-shadow-mask").show();}},hide:function(){$("#sharebox-wrapper").hide();$("#sharebox-wrapper-shadow-mask").hide();
}};var centertips=(function(){var A={init:function(D,B){if(!D){return;}if($("#centertips-wrapper").parent().length){$("#centertips-wrapper").remove();
}B=B||$("body");if(B.append){B.append($($("#template-centertips").html()));$("#centertips-wrapper").css("visibility","hidden");
$("#centertips").attr({value:D});$("#centertips-wrapper").css("left",Math.floor((Math.min(B.width(),screen.width)-$("#centertips-wrapper").outerWidth())/2));
$("#centertips-wrapper").css("top",Math.floor((Math.min(B.height(),screen.height)-$("#centertips-wrapper").outerHeight())*0.4));
$("#centertips").css("height","0");var C=parseInt($("#centertips").css("line-height"));if(C){var E=Math.floor($("#centertips")[0].scrollHeight/C);
$("#centertips").css("height",(E*C)+"px");$("#centertips-wrapper").css("visibility","visible");}}},hide:function(){$("#centertips-wrapper").hide();
},remove:function(){$("#centertips-wrapper").remove();}};return A;})();var share=(function(){var A={clipboard:null,completeHeandler:null,button:null,init:function(C,B,D,E){if(B){$("#sharebutton").css({visibility:"hidden"});
}else{$("#sharebutton").css({visibility:"visible"});B=$(".sharebutton");}A.button=B;if(E){A.clipboard=new Clipboard(".sharebutton");
A.clipboard.on("success",function(F){F.clearSelection();if(!A.button.hasClass("sharebutton-disabled")){sharebox.init(C,D);
sharebox.show();if(A.completeHeandler){A.completeHeandler();}}});}else{B.on("click",function(F){if(A.completeHeandler&&!A.button.hasClass("sharebutton-disabled")){A.completeHeandler();
}});}},setCopyContent:function(B){if(!A.button){return;}A.button.attr("data-clipboard-text",B);},destoryClipboard:function(){A.clipboard.destroy();
A.clipboard=null;A.mouseouthandler=null;A.mouseoverhandler=null;A.button=null;},disable:function(){A.button.addClass("sharebutton-disabled");
},enable:function(){A.button.removeClass("sharebutton-disabled");},getShareUrl:function(){var B=window.location.href.split("#")[0];
if(B.indexOf("?")==-1){return B;}var F=B.split("?")[1];var E=B.split("?")[0];if(!F){return B;}var I="ADUIN ADPUBNO ADSESSION ADTAG client";
var G=[];E+="?";strs=F.split("&");for(var C=0;C<strs.length;C++){var D=strs[C].split("=")[0];var H=strs[C].split("=")[1];
if(D&&H&&I.indexOf(D)==-1){G.push(D+"="+H);}}E+=G.join("&");return E;}};return A;}());(function(A,B){if(typeof define==="function"&&(define.amd||define.cmd)){define(function(E,D,C){C.exports=B(A,{});
});}else{A.reportSpeed=B(A,{});}})(window,function(AG,AF){var y=1;var O="";var F="";var N="";var J="";
var A=0;var E=0;var D=0;var B=0;var l=0;var x=0;var AA=0;var f=0;var w=0;var s=0;var g=0;var L=0;var Y=0;
var r=0;var b=0;var T=0;var m=0;var R=0;var V="";var C=0;var M=false;var K=false;var U=null;var p=null;
var d=false;var z=null;var c=null;var S=null;var q=0;var h=0;var G=true;var H="";var AH=false;var I=false;
var W=Date.now();var u=/(iPad|iPhone|iPod).*? (IPad)?QQ\/([\d\.]+)/;var j=/\bV1_AND_SQI?_([\d\.]+)(.*? QQ\/([\d\.]+))?/;
var AC=function(){if(j.test(window.navigator.userAgent)){var n=window.navigator.userAgent.match(j);return n&&(n[3]||n[1])||0;
}else{var n=window.navigator.userAgent.match(u);return n&&(n[3]||n[1])||0;}};var Z="";try{var a=location.search.substr(1).split("&");
for(var P=0;P<a.length;++P){var v=a[P].split("=");if(v[0].toLowerCase()=="adtag"){Z=v[1];}}}catch(AE){}var Q=Q||{};
Q.report=function(n,AI){n=n||{};AI=AI||{};if(!n||!n.buzId||!n.siteId||!n.pageId){if(!AI||!AI.appId||!AI.buzId||!AI.siteId||!AI.pageId){console.log("param error ");
return;}}var AO=n.delay||AI.delay||3;var AK=n.gray||AI.gray;if(!AK||AK<1){AK=1;}else{AK=Math.floor(AK);
}I=n.allowNoFirstRequest||AI.allowNoFirstRequest||false;var AM=0;var AJ=function(){AM++;if(AM>=4){var AP=Math.floor(Math.random()*1000000);
if(0==AP%(AK||1)){setTimeout(function(){X(n,1);for(key in n){if(!AI[key]){AI[key]=n[key];}}X(AI,2);AB(n);
AD(n);},AO*1000);}}};if(window.mqq&&mqq.support&&mqq.support("mqq.data.getPerformance")){setTimeout(function(){mqq.data.getPerformance(function(AP){if(AP&&0==AP.result&&AP.data){A=AP.data.clickStart||0;
E=AP.data.webviewStart||0;D=AP.data.pageStart||0;B=AP.data.isFirstRequest||0;R=AP.data.isUseLocalSrc||0;
M=AP.data.isPreloadWebProcess||0;K=AP.data.isWebViewCache||false;l=AP.data.onCreate||0;x=AP.data.viewInflate||0;
AA=AP.data.getWebView||0;f=AP.data.initBrowser||0;w=AP.data.init||0;s=AP.data.initTBS||0;g=AP.data.isX5||0;
L=AP.data.webCoreType||0;Y=AP.data.X5_dns||0;r=AP.data.X5_sslHandeShake||0;b=AP.data.X5_connect||0;T=AP.data.X5_receive||0;
m=AP.data.X5_websiteRender||0;U=AP.data.packageCheckFinish||0;p=AP.data.firstInterset||0;d=AP.data.isReloadUrl?1:0;
z=AP.data.redirect302Time||0;c=AP.data.readIndexTime||0;S=AP.data.pluginFinished||0;q=AP.data.pid||0;
h=AP.data.isabnormalstart||0;}AJ();});},0);}else{var AL=(window.webkitPerformance?window.webkitPerformance:window.msPerformance);
AL=(AL?AL:window.performance);if(AL){t=AL.timing;A=t.navigationStart;E=t.navigationStart;D=t.requestStart;
B=true;}AJ();}var AN={0:"unknown",1:"wifi",2:"2g",3:"3g",4:"4g"};if(window.mqq&&mqq.support&&mqq.support("mqq.device.getNetworkType")){mqq.device.getNetworkType(function(AP){if(AP){J=AN[AP]||"unknown";
}AJ();});}else{J="wifi";AJ();}if(window.mqq&&mqq.support&&mqq.support("mqq.device.getClientInfo")){mqq.device.getClientInfo(function(AP){if(AP&&AP.qqVersion){O=AP.qqVersion||"";
V=AP.qqBuild||"";y=0;}AJ();});}else{AJ();}if(window.mqq&&mqq.support&&mqq.support("mqq.device.getDeviceInfo")){mqq.device.getDeviceInfo(function(AP){if(AP){F=AP.modelVersion||AP.model||"";
N=AP.systemVersion||"";}AJ();});}else{F="pc";AJ();}if(u.test(window.navigator.userAgent)){C=2;}else{C=1;
}};var X=function(n,AL){n=n||{};if(!n||!n.buzId||!n.siteId||!n.pageId){return;}if(AL===2&&!n.appId){return;
}var AI=n.speedPoints||{};var AR=n.commPoints.head||0;var AP=n.commPoints.domready||0;var AN=n.commPoints.active||0;
if(A&&AR&&AP&&AN&&G&&(B||(!B&&I))){AI[1]=E-A;AI[2]=D-A;AI[3]=AR-A;AI[4]=AP-A;AI[5]=AN-A;}if(!B&&!I){H="firstload_false";
}else{if(!A){H="no_clickStart";}else{if(!G){H="already_visible";}}}for(var AJ in n.expoints){if(isNaN(AJ)||AJ*1<7){continue;
}AI[AJ]=n.expoints[AJ];}var AK=[];var AQ=false;for(var AJ in AI){if(AI[AJ]>=0){AK.push(AJ+"="+AI[AJ]);
AQ=true;}}AK.push("error="+H);if(AQ){if(AL===1){var AM="//huatuospeed.huatuo.qq.com/cgi-bin/r.cgi?flag1="+n.buzId+"&flag2="+n.siteId+"&flag3="+n.pageId+"&"+AK.join("&");
var AO=new Image();AO.src=AM;}else{if(AL===2){var AS="flag1="+n.buzId+"&flag2="+n.siteId+"&flag3="+n.pageId+"&"+AK.join("&");
var AM="//report.huatuo.qq.com/report.cgi?appid="+n.appId+"&speedparams="+encodeURIComponent(AS)+"&platform="+(C==2?"ios":C==1?"android":"unknown");
var AO=new Image();AO.src=AM;}}}};var AB=function(AI){AI=AI||{};if(!AI||!AI.buzId||!AI.siteId||!AI.pageId){return;
}var AK=AI.compassPoints||{};var AN=AI.commPoints.head instanceof Date?AI.commPoints.head.getTime():AI.commPoints.head;
var AM=AI.commPoints.domready instanceof Date?AI.commPoints.domready.getTime():AI.commPoints.domready;
var AL=AI.commPoints.active instanceof Date?AI.commPoints.active.getTime():AI.commPoints.active;var AP="";
try{var AS=location.search.substr(1).split("&");for(var AO=0;AO<AS.length;++AO){var AT=AS[AO].split("=");
if(AT[0].toLowerCase()=="adtag"){AP=AT[1];}}}catch(AW){}var AQ={buzId:AI.buzId,siteId:AI.siteId,pageId:AI.pageId,net_type:J||"",is_offline:R?1:0,logtime:W,sq_ver:O||AC()||"",device_type:F||"",plat:C==2?2:1,clickStart:A||0,webviewStart:E||0,loadUrl:D||0,head:AN||0,domready:AM||0,active:AL||0,isPreloadWebProcess:!K&&M?1:0,system_ver:N||"",time_point_30:g||0,userIp:"{ip}",ext1:K?1:0,ext2:M?1:0,ext3:V||"",ext4:l||0,ext5:x||0,ext6:AA||0,ext7:f||0,ext8:w||0,ext9:s||0,ext10:y||"",ext14:A+E+D+AN+AM+AL,ext15:AI.ext15||"",strategy:AI.strategy||"",packageCheckFinish:U,firstInterset:p,isReloadUrl:d,redirect302Time:z,readIndexTime:c,pluginFinished:S,webCoreType:L,dns:Y,sslHandeShake:r,connect:b,receive:T,websiteRender:m,adtag:AI.adtag||AP,pid:q,isabnormalstart:h,adtag:AP,ext11:location.protocol,ext12:location.href.split("?")[0],ext13:encodeURIComponent(location.search.replace(/&/g,"*"))};
if(A&&AN&&AM&&AL&&G&&(B||(!B&&I))){AK["time_point_"+1]=E-A;AK["time_point_"+2]=D-A;AK["time_point_"+3]=AN-A;
AK["time_point_"+4]=AM-A;AK["time_point_"+5]=AL-A;}else{return;}for(var AJ in AI.expoints){if(isNaN(AJ)||AJ*1<7){continue;
}AK["time_point_"+AJ]=AI.expoints[AJ];}for(var AJ in AK){if(AK[AJ]>=0){AQ[AJ]=AK[AJ];}}var AR=[];for(var AJ in AQ){AR.push(AJ+"="+AQ[AJ]);
}var AU="//report.vip.qq.com/cgi-bin/report?r=reportData/doReport&tbName=dc00433&t="+Math.random()+"&"+AR.join("&");
var AV=new Image();AV.src=AU;};var AD=function(AI){var n={buzId:AI.buzId,siteId:AI.siteId,pageId:AI.pageId,net_type:J||"",is_offline:R?1:0,logtime:W,sq_ver:O||"",device_type:F||"",plat:C==2?2:1,system_ver:N||"",webcoretype:L,userIp:"{ip}",strategy:AI.strategy||"",adtag:Z,url:location.href.split("?")[0],urlSearch:encodeURIComponent(location.search.replace(/&/g,"*"))};
if(window.performance){if(window.performance.timing){for(key in window.performance.timing){n[key]=window.performance.timing[key];
}}if(window.performance.memory){for(key in window.performance.memory){n[key]=window.performance.memory[key];
}}}var AK=[];for(var AJ in n){AK.push(AJ+"="+n[AJ]);}var AM="//report.vip.qq.com/cgi-bin/report?r=reportData/doReport&tbName=dc01336&t="+Math.random()+"&"+AK.join("&");
var AL=new Image();AL.src=AM;};var o=0;$(document).bind("qbrowserVisibilityChange",function(n){if(o>=2){G=false;
}o++;});return Q;});/*! jquery-textcomplete - v0.1.0 - 2013-11-22
 * https://github.com/yuku-t/jquery-textcomplete
 * Copyright (c) 2013-2014 Yuku Takahashi
 * Available via the MIT license.
 */
!function(a){"use strict";var b=function(a){var b,d;return b=function(){d=!1},function(){var e;d||(d=!0,e=c(arguments),e.unshift(b),a.apply(this,e))}},c=function(a){var b;return b=Array.prototype.slice.call(a)},d=function(a,b){return a.bind?a.bind(b):function(){a.apply(b,arguments)}},e=function(){var b;return b=a("<div></div>").css(["color"]).color,"undefined"!=typeof b?function(a,b){return a.css(b)}:function(b,c){var d;return d={},a.each(c,function(a,c){d[c]=b.css(c)}),d}}(),f=function(a){return a},g=function(a){var b={};return function(c,d){b[c]?d(b[c]):a.call(this,c,function(a){b[c]=(b[c]||[]).concat(a),d.apply(null,arguments)})}},h=function(a,b){var c,d;if(a.indexOf)return-1!=a.indexOf(b);for(c=0,d=a.length;d>c;c++)if(a[c]===b)return!0;return!1},i=function(){function c(b,c){var e,f,g;f=i.clone(),this.el=b.get(0),this.$el=b,e=k(this.$el),g=this.el===document.activeElement,this.$el.wrap(e).before(f),g&&this.el.focus(),this.listView=new j(f,this),this.strategies=c,this.$el.on("keyup",d(this.onKeyup,this)),this.$el.on("keydown",d(this.listView.onKeydown,this.listView)),a(document).on("click",d(function(a){a.originalEvent&&!a.originalEvent.keepTextCompleteDropdown&&this.listView.deactivate()},this))}var f,g,h,i;f={wrapper:'<div class="textcomplete-wrapper"></div>',list:'<ul class="dropdown-menu"></ul>'},g={wrapper:{position:"relative"},list:{position:"absolute",top:0,left:0,zIndex:"100",display:"none"}},h=a(f.wrapper).css(g.wrapper),i=a(f.list).css(g.list),a.extend(c.prototype,{renderList:function(a){this.clearAtNext&&(this.listView.clear(),this.clearAtNext=!1),a.length&&(this.listView.shown||(this.listView.setPosition(this.getCaretPosition()).clear().activate(),this.listView.strategy=this.strategy),a=a.slice(0,this.strategy.maxCount),this.listView.render(a)),!this.listView.data.length&&this.listView.shown&&this.listView.deactivate()},searchCallbackFactory:function(a){var b=this;return function(c,d){b.renderList(c),d||(a(),b.clearAtNext=!0)}},onKeyup:function(){var a,b;if(a=this.extractSearchQuery(this.getTextFromHeadToCaret()),a.length){if(b=a[1],this.term===b)return;this.term=b,this.search(a)}else this.term=null,this.listView.deactivate()},onSelect:function(b){var c,d,e;c=this.getTextFromHeadToCaret(),d=this.el.value.substring(this.el.selectionEnd),e=this.strategy.replace(b),a.isArray(e)&&(d=e[1]+d,e=e[0]),c=c.replace(this.strategy.match,e),this.$el.val(c+d),this.el.focus(),this.el.selectionStart=this.el.selectionEnd=c.length},getCaretPosition:function(){if(0!==this.el.selectionEnd){var b,c,d,f,g;return b=["border-width","font-family","font-size","font-style","font-variant","font-weight","height","letter-spacing","word-spacing","line-height","text-decoration","text-align","width","padding-top","padding-right","padding-bottom","padding-left","margin-top","margin-right","margin-bottom","margin-left"],c=a.extend({position:"absolute",overflow:"auto","white-space":"pre-wrap",top:0,left:-9999},e(this.$el,b)),d=a("<div></div>").css(c).text(this.getTextFromHeadToCaret()),f=a("<span></span>").text("&nbsp;").appendTo(d),this.$el.before(d),g=f.position(),g.top+=f.height()-this.$el.scrollTop(),d.remove(),g}},getTextFromHeadToCaret:function(){var a,b,c;return b=this.el.selectionEnd,"number"==typeof b?a=this.el.value.substring(0,b):document.selection&&(c=this.el.createTextRange(),c.moveStart("character",0),c.moveEnd("textedit"),a=c.text),a},extractSearchQuery:function(a){var b,c,d,e;for(b=0,c=this.strategies.length;c>b;b++)if(d=this.strategies[b],e=a.match(d.match))return[d,e[d.index]];return[]},search:b(function(a,b){var c;this.strategy=b[0],c=b[1],this.strategy.search(c,this.searchCallbackFactory(a))})});var k=function(a){return h.clone().css("display",a.css("display"))};return c}(),j=function(){function b(a,b){this.$el=a,this.index=0,this.completer=b,this.$el.on("click","li.textcomplete-item",d(this.onClick,this))}return a.extend(b.prototype,{shown:!1,render:function(a){var b,c,d,e,f;for(b="",c=0,d=a.length;d>c&&(f=a[c],h(this.data,f)||(e=this.data.length,this.data.push(f),b+='<li class="textcomplete-item" data-index="'+e+'"><a>',b+=this.strategy.template(f),b+="</a></li>",this.data.length!==this.strategy.maxCount));c++);this.$el.append(b),this.data.length?this.activateIndexedItem():this.deactivate()},clear:function(){return this.data=[],this.$el.html(""),this.index=0,this},activateIndexedItem:function(){this.$el.find(".active").removeClass("active"),this.getActiveItem().addClass("active")},getActiveItem:function(){return a(this.$el.children().get(this.index))},activate:function(){return this.shown||(this.$el.show(),this.shown=!0),this},deactivate:function(){return this.shown&&(this.$el.hide(),this.shown=!1,this.data=this.index=null),this},setPosition:function(a){return this.$el.css(a),this},select:function(a){this.completer.onSelect(this.data[a]),this.deactivate()},onKeydown:function(a){this.shown&&(27===a.keyCode?this.deactivate():38===a.keyCode?(a.preventDefault(),0===this.index?this.index=this.data.length-1:this.index-=1,this.activateIndexedItem()):40===a.keyCode?(a.preventDefault(),this.index===this.data.length-1?this.index=0:this.index+=1,this.activateIndexedItem()):(13===a.keyCode||9===a.keyCode)&&(a.preventDefault(),this.select(parseInt(this.getActiveItem().data("index")))))},onClick:function(b){var c=a(b.target);b.originalEvent.keepTextCompleteDropdown=!0,c.hasClass("textcomplete-item")||(c=c.parents("li.textcomplete-item")),this.select(parseInt(c.data("index")))}}),b}();a.fn.textcomplete=function(a){var b,c,d;for(b=0,c=a.length;c>b;b++)d=a[b],d.template||(d.template=f),null==d.index&&(d.index=2),d.cache&&(d.search=g(d.search)),d.maxCount||(d.maxCount=10);return new i(this,a),this}}(window.jQuery||window.Zepto);
/*! jQuery UI - v1.8.20 - 2012-04-30
* https://github.com/jquery/jquery-ui
* Includes: jquery.ui.core.js
* Copyright (c) 2012 AUTHORS.txt; Licensed MIT, GPL */
(function(a,b){function c(b,c){var e=b.nodeName.toLowerCase();if("area"===e){var f=b.parentNode,g=f.name,h;return!b.href||!g||f.nodeName.toLowerCase()!=="map"?!1:(h=a("img[usemap=#"+g+"]")[0],!!h&&d(h))}return(/input|select|textarea|button|object/.test(e)?!b.disabled:"a"==e?b.href||c:c)&&d(b)}function d(b){return!a(b).parents().andSelf().filter(function(){return a.curCSS(this,"visibility")==="hidden"||a.expr.filters.hidden(this)}).length}a.ui=a.ui||{};if(a.ui.version)return;a.extend(a.ui,{version:"1.8.20",keyCode:{ALT:18,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND:91,COMMAND_LEFT:91,COMMAND_RIGHT:93,CONTROL:17,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,INSERT:45,LEFT:37,MENU:93,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SHIFT:16,SPACE:32,TAB:9,UP:38,WINDOWS:91}}),a.fn.extend({propAttr:a.fn.prop||a.fn.attr,_focus:a.fn.focus,focus:function(b,c){return typeof b=="number"?this.each(function(){var d=this;setTimeout(function(){a(d).focus(),c&&c.call(d)},b)}):this._focus.apply(this,arguments)},scrollParent:function(){var b;return a.browser.msie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?b=this.parents().filter(function(){return/(relative|absolute|fixed)/.test(a.curCSS(this,"position",1))&&/(auto|scroll)/.test(a.curCSS(this,"overflow",1)+a.curCSS(this,"overflow-y",1)+a.curCSS(this,"overflow-x",1))}).eq(0):b=this.parents().filter(function(){return/(auto|scroll)/.test(a.curCSS(this,"overflow",1)+a.curCSS(this,"overflow-y",1)+a.curCSS(this,"overflow-x",1))}).eq(0),/fixed/.test(this.css("position"))||!b.length?a(document):b},zIndex:function(c){if(c!==b)return this.css("zIndex",c);if(this.length){var d=a(this[0]),e,f;while(d.length&&d[0]!==document){e=d.css("position");if(e==="absolute"||e==="relative"||e==="fixed"){f=parseInt(d.css("zIndex"),10);if(!isNaN(f)&&f!==0)return f}d=d.parent()}}return 0},disableSelection:function(){return this.bind((a.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(a){a.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}}),a.each(["Width","Height"],function(c,d){function h(b,c,d,f){return a.each(e,function(){c-=parseFloat(a.curCSS(b,"padding"+this,!0))||0,d&&(c-=parseFloat(a.curCSS(b,"border"+this+"Width",!0))||0),f&&(c-=parseFloat(a.curCSS(b,"margin"+this,!0))||0)}),c}var e=d==="Width"?["Left","Right"]:["Top","Bottom"],f=d.toLowerCase(),g={innerWidth:a.fn.innerWidth,innerHeight:a.fn.innerHeight,outerWidth:a.fn.outerWidth,outerHeight:a.fn.outerHeight};a.fn["inner"+d]=function(c){return c===b?g["inner"+d].call(this):this.each(function(){a(this).css(f,h(this,c)+"px")})},a.fn["outer"+d]=function(b,c){return typeof b!="number"?g["outer"+d].call(this,b):this.each(function(){a(this).css(f,h(this,b,!0,c)+"px")})}}),a.extend(a.expr[":"],{data:function(b,c,d){return!!a.data(b,d[3])},focusable:function(b){return c(b,!isNaN(a.attr(b,"tabindex")))},tabbable:function(b){var d=a.attr(b,"tabindex"),e=isNaN(d);return(e||d>=0)&&c(b,!e)}}),a(function(){var b=document.body,c=b.appendChild(c=document.createElement("div"));c.offsetHeight,a.extend(c.style,{minHeight:"100px",height:"auto",padding:0,borderWidth:0}),a.support.minHeight=c.offsetHeight===100,a.support.selectstart="onselectstart"in c,b.removeChild(c).style.display="none"}),a.extend(a.ui,{plugin:{add:function(b,c,d){var e=a.ui[b].prototype;for(var f in d)e.plugins[f]=e.plugins[f]||[],e.plugins[f].push([c,d[f]])},call:function(a,b,c){var d=a.plugins[b];if(!d||!a.element[0].parentNode)return;for(var e=0;e<d.length;e++)a.options[d[e][0]]&&d[e][1].apply(a.element,c)}},contains:function(a,b){return document.compareDocumentPosition?a.compareDocumentPosition(b)&16:a!==b&&a.contains(b)},hasScroll:function(b,c){if(a(b).css("overflow")==="hidden")return!1;var d=c&&c==="left"?"scrollLeft":"scrollTop",e=!1;return b[d]>0?!0:(b[d]=1,e=b[d]>0,b[d]=0,e)},isOverAxis:function(a,b,c){return a>b&&a<b+c},isOver:function(b,c,d,e,f,g){return a.ui.isOverAxis(b,d,f)&&a.ui.isOverAxis(c,e,g)}})})(jQuery);;/*! jQuery UI - v1.8.20 - 2012-04-30
* https://github.com/jquery/jquery-ui
* Includes: jquery.ui.widget.js
* Copyright (c) 2012 AUTHORS.txt; Licensed MIT, GPL */
(function(a,b){if(a.cleanData){var c=a.cleanData;a.cleanData=function(b){for(var d=0,e;(e=b[d])!=null;d++)try{a(e).triggerHandler("remove")}catch(f){}c(b)}}else{var d=a.fn.remove;a.fn.remove=function(b,c){return this.each(function(){return c||(!b||a.filter(b,[this]).length)&&a("*",this).add([this]).each(function(){try{a(this).triggerHandler("remove")}catch(b){}}),d.call(a(this),b,c)})}}a.widget=function(b,c,d){var e=b.split(".")[0],f;b=b.split(".")[1],f=e+"-"+b,d||(d=c,c=a.Widget),a.expr[":"][f]=function(c){return!!a.data(c,b)},a[e]=a[e]||{},a[e][b]=function(a,b){arguments.length&&this._createWidget(a,b)};var g=new c;g.options=a.extend(!0,{},g.options),a[e][b].prototype=a.extend(!0,g,{namespace:e,widgetName:b,widgetEventPrefix:a[e][b].prototype.widgetEventPrefix||b,widgetBaseClass:f},d),a.widget.bridge(b,a[e][b])},a.widget.bridge=function(c,d){a.fn[c]=function(e){var f=typeof e=="string",g=Array.prototype.slice.call(arguments,1),h=this;return e=!f&&g.length?a.extend.apply(null,[!0,e].concat(g)):e,f&&e.charAt(0)==="_"?h:(f?this.each(function(){var d=a.data(this,c),f=d&&a.isFunction(d[e])?d[e].apply(d,g):d;if(f!==d&&f!==b)return h=f,!1}):this.each(function(){var b=a.data(this,c);b?b.option(e||{})._init():a.data(this,c,new d(e,this))}),h)}},a.Widget=function(a,b){arguments.length&&this._createWidget(a,b)},a.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",options:{disabled:!1},_createWidget:function(b,c){a.data(c,this.widgetName,this),this.element=a(c),this.options=a.extend(!0,{},this.options,this._getCreateOptions(),b);var d=this;this.element.bind("remove."+this.widgetName,function(){d.destroy()}),this._create(),this._trigger("create"),this._init()},_getCreateOptions:function(){return a.metadata&&a.metadata.get(this.element[0])[this.widgetName]},_create:function(){},_init:function(){},destroy:function(){this.element.unbind("."+this.widgetName).removeData(this.widgetName),this.widget().unbind("."+this.widgetName).removeAttr("aria-disabled").removeClass(this.widgetBaseClass+"-disabled "+"ui-state-disabled")},widget:function(){return this.element},option:function(c,d){var e=c;if(arguments.length===0)return a.extend({},this.options);if(typeof c=="string"){if(d===b)return this.options[c];e={},e[c]=d}return this._setOptions(e),this},_setOptions:function(b){var c=this;return a.each(b,function(a,b){c._setOption(a,b)}),this},_setOption:function(a,b){return this.options[a]=b,a==="disabled"&&this.widget()[b?"addClass":"removeClass"](this.widgetBaseClass+"-disabled"+" "+"ui-state-disabled").attr("aria-disabled",b),this},enable:function(){return this._setOption("disabled",!1)},disable:function(){return this._setOption("disabled",!0)},_trigger:function(b,c,d){var e,f,g=this.options[b];d=d||{},c=a.Event(c),c.type=(b===this.widgetEventPrefix?b:this.widgetEventPrefix+b).toLowerCase(),c.target=this.element[0],f=c.originalEvent;if(f)for(e in f)e in c||(c[e]=f[e]);return this.element.trigger(c,d),!(a.isFunction(g)&&g.call(this.element[0],c,d)===!1||c.isDefaultPrevented())}}})(jQuery);;/*! jQuery UI - v1.8.20 - 2012-04-30
* https://github.com/jquery/jquery-ui
* Includes: jquery.ui.mouse.js
* Copyright (c) 2012 AUTHORS.txt; Licensed MIT, GPL */
(function(a,b){var c=!1;a(document).mouseup(function(a){c=!1}),a.widget("ui.mouse",{options:{cancel:":input,option",distance:1,delay:0},_mouseInit:function(){var b=this;this.element.bind("mousedown."+this.widgetName,function(a){return b._mouseDown(a)}).bind("click."+this.widgetName,function(c){if(!0===a.data(c.target,b.widgetName+".preventClickEvent"))return a.removeData(c.target,b.widgetName+".preventClickEvent"),c.stopImmediatePropagation(),!1}),this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName),a(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(b){if(c)return;this._mouseStarted&&this._mouseUp(b),this._mouseDownEvent=b;var d=this,e=b.which==1,f=typeof this.options.cancel=="string"&&b.target.nodeName?a(b.target).closest(this.options.cancel).length:!1;if(!e||f||!this._mouseCapture(b))return!0;this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){d.mouseDelayMet=!0},this.options.delay));if(this._mouseDistanceMet(b)&&this._mouseDelayMet(b)){this._mouseStarted=this._mouseStart(b)!==!1;if(!this._mouseStarted)return b.preventDefault(),!0}return!0===a.data(b.target,this.widgetName+".preventClickEvent")&&a.removeData(b.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(a){return d._mouseMove(a)},this._mouseUpDelegate=function(a){return d._mouseUp(a)},a(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),b.preventDefault(),c=!0,!0},_mouseMove:function(b){return!a.browser.msie||document.documentMode>=9||!!b.button?this._mouseStarted?(this._mouseDrag(b),b.preventDefault()):(this._mouseDistanceMet(b)&&this._mouseDelayMet(b)&&(this._mouseStarted=this._mouseStart(this._mouseDownEvent,b)!==!1,this._mouseStarted?this._mouseDrag(b):this._mouseUp(b)),!this._mouseStarted):this._mouseUp(b)},_mouseUp:function(b){return a(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,b.target==this._mouseDownEvent.target&&a.data(b.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(b)),!1},_mouseDistanceMet:function(a){return Math.max(Math.abs(this._mouseDownEvent.pageX-a.pageX),Math.abs(this._mouseDownEvent.pageY-a.pageY))>=this.options.distance},_mouseDelayMet:function(a){return this.mouseDelayMet},_mouseStart:function(a){},_mouseDrag:function(a){},_mouseStop:function(a){},_mouseCapture:function(a){return!0}})})(jQuery);;/*! jQuery UI - v1.8.20 - 2012-04-30
* https://github.com/jquery/jquery-ui
* Includes: jquery.ui.sortable.js
* Copyright (c) 2012 AUTHORS.txt; Licensed MIT, GPL */
(function(a,b){a.widget("ui.sortable",a.ui.mouse,{widgetEventPrefix:"sort",ready:!1,options:{appendTo:"parent",axis:!1,connectWith:!1,containment:!1,cursor:"auto",cursorAt:!1,dropOnEmpty:!0,forcePlaceholderSize:!1,forceHelperSize:!1,grid:!1,handle:!1,helper:"original",items:"> *",opacity:!1,placeholder:!1,revert:!1,scroll:!0,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1e3},_create:function(){var a=this.options;this.containerCache={},this.element.addClass("ui-sortable"),this.refresh(),this.floating=this.items.length?a.axis==="x"||/left|right/.test(this.items[0].item.css("float"))||/inline|table-cell/.test(this.items[0].item.css("display")):!1,this.offset=this.element.offset(),this._mouseInit(),this.ready=!0},destroy:function(){a.Widget.prototype.destroy.call(this),this.element.removeClass("ui-sortable ui-sortable-disabled"),this._mouseDestroy();for(var b=this.items.length-1;b>=0;b--)this.items[b].item.removeData(this.widgetName+"-item");return this},_setOption:function(b,c){b==="disabled"?(this.options[b]=c,this.widget()[c?"addClass":"removeClass"]("ui-sortable-disabled")):a.Widget.prototype._setOption.apply(this,arguments)},_mouseCapture:function(b,c){var d=this;if(this.reverting)return!1;if(this.options.disabled||this.options.type=="static")return!1;this._refreshItems(b);var e=null,f=this,g=a(b.target).parents().each(function(){if(a.data(this,d.widgetName+"-item")==f)return e=a(this),!1});a.data(b.target,d.widgetName+"-item")==f&&(e=a(b.target));if(!e)return!1;if(this.options.handle&&!c){var h=!1;a(this.options.handle,e).find("*").andSelf().each(function(){this==b.target&&(h=!0)});if(!h)return!1}return this.currentItem=e,this._removeCurrentsFromItems(),!0},_mouseStart:function(b,c,d){var e=this.options,f=this;this.currentContainer=this,this.refreshPositions(),this.helper=this._createHelper(b),this._cacheHelperProportions(),this._cacheMargins(),this.scrollParent=this.helper.scrollParent(),this.offset=this.currentItem.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},this.helper.css("position","absolute"),this.cssPosition=this.helper.css("position"),a.extend(this.offset,{click:{left:b.pageX-this.offset.left,top:b.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.originalPosition=this._generatePosition(b),this.originalPageX=b.pageX,this.originalPageY=b.pageY,e.cursorAt&&this._adjustOffsetFromHelper(e.cursorAt),this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]},this.helper[0]!=this.currentItem[0]&&this.currentItem.hide(),this._createPlaceholder(),e.containment&&this._setContainment(),e.cursor&&(a("body").css("cursor")&&(this._storedCursor=a("body").css("cursor")),a("body").css("cursor",e.cursor)),e.opacity&&(this.helper.css("opacity")&&(this._storedOpacity=this.helper.css("opacity")),this.helper.css("opacity",e.opacity)),e.zIndex&&(this.helper.css("zIndex")&&(this._storedZIndex=this.helper.css("zIndex")),this.helper.css("zIndex",e.zIndex)),this.scrollParent[0]!=document&&this.scrollParent[0].tagName!="HTML"&&(this.overflowOffset=this.scrollParent.offset()),this._trigger("start",b,this._uiHash()),this._preserveHelperProportions||this._cacheHelperProportions();if(!d)for(var g=this.containers.length-1;g>=0;g--)this.containers[g]._trigger("activate",b,f._uiHash(this));return a.ui.ddmanager&&(a.ui.ddmanager.current=this),a.ui.ddmanager&&!e.dropBehaviour&&a.ui.ddmanager.prepareOffsets(this,b),this.dragging=!0,this.helper.addClass("ui-sortable-helper"),this._mouseDrag(b),!0},_mouseDrag:function(b){this.position=this._generatePosition(b),this.positionAbs=this._convertPositionTo("absolute"),this.lastPositionAbs||(this.lastPositionAbs=this.positionAbs);if(this.options.scroll){var c=this.options,d=!1;this.scrollParent[0]!=document&&this.scrollParent[0].tagName!="HTML"?(this.overflowOffset.top+this.scrollParent[0].offsetHeight-b.pageY<c.scrollSensitivity?this.scrollParent[0].scrollTop=d=this.scrollParent[0].scrollTop+c.scrollSpeed:b.pageY-this.overflowOffset.top<c.scrollSensitivity&&(this.scrollParent[0].scrollTop=d=this.scrollParent[0].scrollTop-c.scrollSpeed),this.overflowOffset.left+this.scrollParent[0].offsetWidth-b.pageX<c.scrollSensitivity?this.scrollParent[0].scrollLeft=d=this.scrollParent[0].scrollLeft+c.scrollSpeed:b.pageX-this.overflowOffset.left<c.scrollSensitivity&&(this.scrollParent[0].scrollLeft=d=this.scrollParent[0].scrollLeft-c.scrollSpeed)):(b.pageY-a(document).scrollTop()<c.scrollSensitivity?d=a(document).scrollTop(a(document).scrollTop()-c.scrollSpeed):a(window).height()-(b.pageY-a(document).scrollTop())<c.scrollSensitivity&&(d=a(document).scrollTop(a(document).scrollTop()+c.scrollSpeed)),b.pageX-a(document).scrollLeft()<c.scrollSensitivity?d=a(document).scrollLeft(a(document).scrollLeft()-c.scrollSpeed):a(window).width()-(b.pageX-a(document).scrollLeft())<c.scrollSensitivity&&(d=a(document).scrollLeft(a(document).scrollLeft()+c.scrollSpeed))),d!==!1&&a.ui.ddmanager&&!c.dropBehaviour&&a.ui.ddmanager.prepareOffsets(this,b)}this.positionAbs=this._convertPositionTo("absolute");if(!this.options.axis||this.options.axis!="y")this.helper[0].style.left=this.position.left+"px";if(!this.options.axis||this.options.axis!="x")this.helper[0].style.top=this.position.top+"px";for(var e=this.items.length-1;e>=0;e--){var f=this.items[e],g=f.item[0],h=this._intersectsWithPointer(f);if(!h)continue;if(g!=this.currentItem[0]&&this.placeholder[h==1?"next":"prev"]()[0]!=g&&!a.ui.contains(this.placeholder[0],g)&&(this.options.type=="semi-dynamic"?!a.ui.contains(this.element[0],g):!0)){this.direction=h==1?"down":"up";if(this.options.tolerance=="pointer"||this._intersectsWithSides(f))this._rearrange(b,f);else break;this._trigger("change",b,this._uiHash());break}}return this._contactContainers(b),a.ui.ddmanager&&a.ui.ddmanager.drag(this,b),this._trigger("sort",b,this._uiHash()),this.lastPositionAbs=this.positionAbs,!1},_mouseStop:function(b,c){if(!b)return;a.ui.ddmanager&&!this.options.dropBehaviour&&a.ui.ddmanager.drop(this,b);if(this.options.revert){var d=this,e=d.placeholder.offset();d.reverting=!0,a(this.helper).animate({left:e.left-this.offset.parent.left-d.margins.left+(this.offsetParent[0]==document.body?0:this.offsetParent[0].scrollLeft),top:e.top-this.offset.parent.top-d.margins.top+(this.offsetParent[0]==document.body?0:this.offsetParent[0].scrollTop)},parseInt(this.options.revert,10)||500,function(){d._clear(b)})}else this._clear(b,c);return!1},cancel:function(){var b=this;if(this.dragging){this._mouseUp({target:null}),this.options.helper=="original"?this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper"):this.currentItem.show();for(var c=this.containers.length-1;c>=0;c--)this.containers[c]._trigger("deactivate",null,b._uiHash(this)),this.containers[c].containerCache.over&&(this.containers[c]._trigger("out",null,b._uiHash(this)),this.containers[c].containerCache.over=0)}return this.placeholder&&(this.placeholder[0].parentNode&&this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.options.helper!="original"&&this.helper&&this.helper[0].parentNode&&this.helper.remove(),a.extend(this,{helper:null,dragging:!1,reverting:!1,_noFinalSort:null}),this.domPosition.prev?a(this.domPosition.prev).after(this.currentItem):a(this.domPosition.parent).prepend(this.currentItem)),this},serialize:function(b){var c=this._getItemsAsjQuery(b&&b.connected),d=[];return b=b||{},a(c).each(function(){var c=(a(b.item||this).attr(b.attribute||"id")||"").match(b.expression||/(.+)[-=_](.+)/);c&&d.push((b.key||c[1]+"[]")+"="+(b.key&&b.expression?c[1]:c[2]))}),!d.length&&b.key&&d.push(b.key+"="),d.join("&")},toArray:function(b){var c=this._getItemsAsjQuery(b&&b.connected),d=[];return b=b||{},c.each(function(){d.push(a(b.item||this).attr(b.attribute||"id")||"")}),d},_intersectsWith:function(a){var b=this.positionAbs.left,c=b+this.helperProportions.width,d=this.positionAbs.top,e=d+this.helperProportions.height,f=a.left,g=f+a.width,h=a.top,i=h+a.height,j=this.offset.click.top,k=this.offset.click.left,l=d+j>h&&d+j<i&&b+k>f&&b+k<g;return this.options.tolerance=="pointer"||this.options.forcePointerForContainers||this.options.tolerance!="pointer"&&this.helperProportions[this.floating?"width":"height"]>a[this.floating?"width":"height"]?l:f<b+this.helperProportions.width/2&&c-this.helperProportions.width/2<g&&h<d+this.helperProportions.height/2&&e-this.helperProportions.height/2<i},_intersectsWithPointer:function(b){var c=this.options.axis==="x"||a.ui.isOverAxis(this.positionAbs.top+this.offset.click.top,b.top,b.height),d=this.options.axis==="y"||a.ui.isOverAxis(this.positionAbs.left+this.offset.click.left,b.left,b.width),e=c&&d,f=this._getDragVerticalDirection(),g=this._getDragHorizontalDirection();return e?this.floating?g&&g=="right"||f=="down"?2:1:f&&(f=="down"?2:1):!1},_intersectsWithSides:function(b){var c=a.ui.isOverAxis(this.positionAbs.top+this.offset.click.top,b.top+b.height/2,b.height),d=a.ui.isOverAxis(this.positionAbs.left+this.offset.click.left,b.left+b.width/2,b.width),e=this._getDragVerticalDirection(),f=this._getDragHorizontalDirection();return this.floating&&f?f=="right"&&d||f=="left"&&!d:e&&(e=="down"&&c||e=="up"&&!c)},_getDragVerticalDirection:function(){var a=this.positionAbs.top-this.lastPositionAbs.top;return a!=0&&(a>0?"down":"up")},_getDragHorizontalDirection:function(){var a=this.positionAbs.left-this.lastPositionAbs.left;return a!=0&&(a>0?"right":"left")},refresh:function(a){return this._refreshItems(a),this.refreshPositions(),this},_connectWith:function(){var a=this.options;return a.connectWith.constructor==String?[a.connectWith]:a.connectWith},_getItemsAsjQuery:function(b){var c=this,d=[],e=[],f=this._connectWith();if(f&&b)for(var g=f.length-1;g>=0;g--){var h=a(f[g]);for(var i=h.length-1;i>=0;i--){var j=a.data(h[i],this.widgetName);j&&j!=this&&!j.options.disabled&&e.push([a.isFunction(j.options.items)?j.options.items.call(j.element):a(j.options.items,j.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),j])}}e.push([a.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):a(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]);for(var g=e.length-1;g>=0;g--)e[g][0].each(function(){d.push(this)});return a(d)},_removeCurrentsFromItems:function(){var a=this.currentItem.find(":data("+this.widgetName+"-item)");for(var b=0;b<this.items.length;b++)for(var c=0;c<a.length;c++)a[c]==this.items[b].item[0]&&this.items.splice(b,1)},_refreshItems:function(b){this.items=[],this.containers=[this];var c=this.items,d=this,e=[[a.isFunction(this.options.items)?this.options.items.call(this.element[0],b,{item:this.currentItem}):a(this.options.items,this.element),this]],f=this._connectWith();if(f&&this.ready)for(var g=f.length-1;g>=0;g--){var h=a(f[g]);for(var i=h.length-1;i>=0;i--){var j=a.data(h[i],this.widgetName);j&&j!=this&&!j.options.disabled&&(e.push([a.isFunction(j.options.items)?j.options.items.call(j.element[0],b,{item:this.currentItem}):a(j.options.items,j.element),j]),this.containers.push(j))}}for(var g=e.length-1;g>=0;g--){var k=e[g][1],l=e[g][0];for(var i=0,m=l.length;i<m;i++){var n=a(l[i]);n.data(this.widgetName+"-item",k),c.push({item:n,instance:k,width:0,height:0,left:0,top:0})}}},refreshPositions:function(b){this.offsetParent&&this.helper&&(this.offset.parent=this._getParentOffset());for(var c=this.items.length-1;c>=0;c--){var d=this.items[c];if(d.instance!=this.currentContainer&&this.currentContainer&&d.item[0]!=this.currentItem[0])continue;var e=this.options.toleranceElement?a(this.options.toleranceElement,d.item):d.item;b||(d.width=e.outerWidth(),d.height=e.outerHeight());var f=e.offset();d.left=f.left,d.top=f.top}if(this.options.custom&&this.options.custom.refreshContainers)this.options.custom.refreshContainers.call(this);else for(var c=this.containers.length-1;c>=0;c--){var f=this.containers[c].element.offset();this.containers[c].containerCache.left=f.left,this.containers[c].containerCache.top=f.top,this.containers[c].containerCache.width=this.containers[c].element.outerWidth(),this.containers[c].containerCache.height=this.containers[c].element.outerHeight()}return this},_createPlaceholder:function(b){var c=b||this,d=c.options;if(!d.placeholder||d.placeholder.constructor==String){var e=d.placeholder;d.placeholder={element:function(){var b=a(document.createElement(c.currentItem[0].nodeName)).addClass(e||c.currentItem[0].className+" ui-sortable-placeholder").removeClass("ui-sortable-helper")[0];return e||(b.style.visibility="hidden"),b},update:function(a,b){if(e&&!d.forcePlaceholderSize)return;b.height()||b.height(c.currentItem.innerHeight()-parseInt(c.currentItem.css("paddingTop")||0,10)-parseInt(c.currentItem.css("paddingBottom")||0,10)),b.width()||b.width(c.currentItem.innerWidth()-parseInt(c.currentItem.css("paddingLeft")||0,10)-parseInt(c.currentItem.css("paddingRight")||0,10))}}}c.placeholder=a(d.placeholder.element.call(c.element,c.currentItem)),c.currentItem.after(c.placeholder),d.placeholder.update(c,c.placeholder)},_contactContainers:function(b){var c=null,d=null;for(var e=this.containers.length-1;e>=0;e--){if(a.ui.contains(this.currentItem[0],this.containers[e].element[0]))continue;if(this._intersectsWith(this.containers[e].containerCache)){if(c&&a.ui.contains(this.containers[e].element[0],c.element[0]))continue;c=this.containers[e],d=e}else this.containers[e].containerCache.over&&(this.containers[e]._trigger("out",b,this._uiHash(this)),this.containers[e].containerCache.over=0)}if(!c)return;if(this.containers.length===1)this.containers[d]._trigger("over",b,this._uiHash(this)),this.containers[d].containerCache.over=1;else if(this.currentContainer!=this.containers[d]){var f=1e4,g=null,h=this.positionAbs[this.containers[d].floating?"left":"top"];for(var i=this.items.length-1;i>=0;i--){if(!a.ui.contains(this.containers[d].element[0],this.items[i].item[0]))continue;var j=this.items[i][this.containers[d].floating?"left":"top"];Math.abs(j-h)<f&&(f=Math.abs(j-h),g=this.items[i])}if(!g&&!this.options.dropOnEmpty)return;this.currentContainer=this.containers[d],g?this._rearrange(b,g,null,!0):this._rearrange(b,null,this.containers[d].element,!0),this._trigger("change",b,this._uiHash()),this.containers[d]._trigger("change",b,this._uiHash(this)),this.options.placeholder.update(this.currentContainer,this.placeholder),this.containers[d]._trigger("over",b,this._uiHash(this)),this.containers[d].containerCache.over=1}},_createHelper:function(b){var c=this.options,d=a.isFunction(c.helper)?a(c.helper.apply(this.element[0],[b,this.currentItem])):c.helper=="clone"?this.currentItem.clone():this.currentItem;return d.parents("body").length||a(c.appendTo!="parent"?c.appendTo:this.currentItem[0].parentNode)[0].appendChild(d[0]),d[0]==this.currentItem[0]&&(this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")}),(d[0].style.width==""||c.forceHelperSize)&&d.width(this.currentItem.width()),(d[0].style.height==""||c.forceHelperSize)&&d.height(this.currentItem.height()),d},_adjustOffsetFromHelper:function(b){typeof b=="string"&&(b=b.split(" ")),a.isArray(b)&&(b={left:+b[0],top:+b[1]||0}),"left"in b&&(this.offset.click.left=b.left+this.margins.left),"right"in b&&(this.offset.click.left=this.helperProportions.width-b.right+this.margins.left),"top"in b&&(this.offset.click.top=b.top+this.margins.top),"bottom"in b&&(this.offset.click.top=this.helperProportions.height-b.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var b=this.offsetParent.offset();this.cssPosition=="absolute"&&this.scrollParent[0]!=document&&a.ui.contains(this.scrollParent[0],this.offsetParent[0])&&(b.left+=this.scrollParent.scrollLeft(),b.top+=this.scrollParent.scrollTop());if(this.offsetParent[0]==document.body||this.offsetParent[0].tagName&&this.offsetParent[0].tagName.toLowerCase()=="html"&&a.browser.msie)b={top:0,left:0};return{top:b.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:b.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if(this.cssPosition=="relative"){var a=this.currentItem.position();return{top:a.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:a.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css("marginLeft"),10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var b=this.options;b.containment=="parent"&&(b.containment=this.helper[0].parentNode);if(b.containment=="document"||b.containment=="window")this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,a(b.containment=="document"?document:window).width()-this.helperProportions.width-this.margins.left,(a(b.containment=="document"?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top];if(!/^(document|window|parent)$/.test(b.containment)){var c=a(b.containment)[0],d=a(b.containment).offset(),e=a(c).css("overflow")!="hidden";this.containment=[d.left+(parseInt(a(c).css("borderLeftWidth"),10)||0)+(parseInt(a(c).css("paddingLeft"),10)||0)-this.margins.left,d.top+(parseInt(a(c).css("borderTopWidth"),10)||0)+(parseInt(a(c).css("paddingTop"),10)||0)-this.margins.top,d.left+(e?Math.max(c.scrollWidth,c.offsetWidth):c.offsetWidth)-(parseInt(a(c).css("borderLeftWidth"),10)||0)-(parseInt(a(c).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,d.top+(e?Math.max(c.scrollHeight,c.offsetHeight):c.offsetHeight)-(parseInt(a(c).css("borderTopWidth"),10)||0)-(parseInt(a(c).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top]}},_convertPositionTo:function(b,c){c||(c=this.position);var d=b=="absolute"?1:-1,e=this.options,f=this.cssPosition=="absolute"&&(this.scrollParent[0]==document||!a.ui.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,g=/(html|body)/i.test(f[0].tagName);return{top:c.top+this.offset.relative.top*d+this.offset.parent.top*d-(a.browser.safari&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollTop():g?0:f.scrollTop())*d),left:c.left+this.offset.relative.left*d+this.offset.parent.left*d-(a.browser.safari&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():g?0:f.scrollLeft())*d)}},_generatePosition:function(b){var c=this.options,d=this.cssPosition=="absolute"&&(this.scrollParent[0]==document||!a.ui.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,e=/(html|body)/i.test(d[0].tagName);this.cssPosition=="relative"&&(this.scrollParent[0]==document||this.scrollParent[0]==this.offsetParent[0])&&(this.offset.relative=this._getRelativeOffset());var f=b.pageX,g=b.pageY;if(this.originalPosition){this.containment&&(b.pageX-this.offset.click.left<this.containment[0]&&(f=this.containment[0]+this.offset.click.left),b.pageY-this.offset.click.top<this.containment[1]&&(g=this.containment[1]+this.offset.click.top),b.pageX-this.offset.click.left>this.containment[2]&&(f=this.containment[2]+this.offset.click.left),b.pageY-this.offset.click.top>this.containment[3]&&(g=this.containment[3]+this.offset.click.top));if(c.grid){var h=this.originalPageY+Math.round((g-this.originalPageY)/c.grid[1])*c.grid[1];g=this.containment?h-this.offset.click.top<this.containment[1]||h-this.offset.click.top>this.containment[3]?h-this.offset.click.top<this.containment[1]?h+c.grid[1]:h-c.grid[1]:h:h;var i=this.originalPageX+Math.round((f-this.originalPageX)/c.grid[0])*c.grid[0];f=this.containment?i-this.offset.click.left<this.containment[0]||i-this.offset.click.left>this.containment[2]?i-this.offset.click.left<this.containment[0]?i+c.grid[0]:i-c.grid[0]:i:i}}return{top:g-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+(a.browser.safari&&this.cssPosition=="fixed"?0:this.cssPosition=="fixed"?-this.scrollParent.scrollTop():e?0:d.scrollTop()),left:f-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+(a.browser.safari&&this.cssPosition=="fixed"?0:this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():e?0:d.scrollLeft())}},_rearrange:function(a,b,c,d){c?c[0].appendChild(this.placeholder[0]):b.item[0].parentNode.insertBefore(this.placeholder[0],this.direction=="down"?b.item[0]:b.item[0].nextSibling),this.counter=this.counter?++this.counter:1;var e=this,f=this.counter;window.setTimeout(function(){f==e.counter&&e.refreshPositions(!d)},0)},_clear:function(b,c){this.reverting=!1;var d=[],e=this;!this._noFinalSort&&this.currentItem.parent().length&&this.placeholder.before(this.currentItem),this._noFinalSort=null;if(this.helper[0]==this.currentItem[0]){for(var f in this._storedCSS)if(this._storedCSS[f]=="auto"||this._storedCSS[f]=="static")this._storedCSS[f]="";this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")}else this.currentItem.show();this.fromOutside&&!c&&d.push(function(a){this._trigger("receive",a,this._uiHash(this.fromOutside))}),(this.fromOutside||this.domPosition.prev!=this.currentItem.prev().not(".ui-sortable-helper")[0]||this.domPosition.parent!=this.currentItem.parent()[0])&&!c&&d.push(function(a){this._trigger("update",a,this._uiHash())});if(!a.ui.contains(this.element[0],this.currentItem[0])){c||d.push(function(a){this._trigger("remove",a,this._uiHash())});for(var f=this.containers.length-1;f>=0;f--)a.ui.contains(this.containers[f].element[0],this.currentItem[0])&&!c&&(d.push(function(a){return function(b){a._trigger("receive",b,this._uiHash(this))}}.call(this,this.containers[f])),d.push(function(a){return function(b){a._trigger("update",b,this._uiHash(this))}}.call(this,this.containers[f])))}for(var f=this.containers.length-1;f>=0;f--)c||d.push(function(a){return function(b){a._trigger("deactivate",b,this._uiHash(this))}}.call(this,this.containers[f])),this.containers[f].containerCache.over&&(d.push(function(a){return function(b){a._trigger("out",b,this._uiHash(this))}}.call(this,this.containers[f])),this.containers[f].containerCache.over=0);this._storedCursor&&a("body").css("cursor",this._storedCursor),this._storedOpacity&&this.helper.css("opacity",this._storedOpacity),this._storedZIndex&&this.helper.css("zIndex",this._storedZIndex=="auto"?"":this._storedZIndex),this.dragging=!1;if(this.cancelHelperRemoval){if(!c){this._trigger("beforeStop",b,this._uiHash());for(var f=0;f<d.length;f++)d[f].call(this,b);this._trigger("stop",b,this._uiHash())}return!1}c||this._trigger("beforeStop",b,this._uiHash()),this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.helper[0]!=this.currentItem[0]&&this.helper.remove(),this.helper=null;if(!c){for(var f=0;f<d.length;f++)d[f].call(this,b);this._trigger("stop",b,this._uiHash())}return this.fromOutside=!1,!0},_trigger:function(){a.Widget.prototype._trigger.apply(this,arguments)===!1&&this.cancel()},_uiHash:function(b){var c=b||this;return{helper:c.helper,placeholder:c.placeholder||a([]),position:c.position,originalPosition:c.originalPosition,offset:c.positionAbs,item:c.currentItem,sender:b?b.element:null}}}),a.extend(a.ui.sortable,{version:"1.8.20"})})(jQuery);;/*! jQuery UI - v1.8.20 - 2012-04-30
* https://github.com/jquery/jquery-ui
* Includes: jquery.ui.position.js
* Copyright (c) 2012 AUTHORS.txt; Licensed MIT, GPL */
(function(a,b){a.ui=a.ui||{};var c=/left|center|right/,d=/top|center|bottom/,e="center",f={},g=a.fn.position,h=a.fn.offset;a.fn.position=function(b){if(!b||!b.of)return g.apply(this,arguments);b=a.extend({},b);var h=a(b.of),i=h[0],j=(b.collision||"flip").split(" "),k=b.offset?b.offset.split(" "):[0,0],l,m,n;return i.nodeType===9?(l=h.width(),m=h.height(),n={top:0,left:0}):i.setTimeout?(l=h.width(),m=h.height(),n={top:h.scrollTop(),left:h.scrollLeft()}):i.preventDefault?(b.at="left top",l=m=0,n={top:b.of.pageY,left:b.of.pageX}):(l=h.outerWidth(),m=h.outerHeight(),n=h.offset()),a.each(["my","at"],function(){var a=(b[this]||"").split(" ");a.length===1&&(a=c.test(a[0])?a.concat([e]):d.test(a[0])?[e].concat(a):[e,e]),a[0]=c.test(a[0])?a[0]:e,a[1]=d.test(a[1])?a[1]:e,b[this]=a}),j.length===1&&(j[1]=j[0]),k[0]=parseInt(k[0],10)||0,k.length===1&&(k[1]=k[0]),k[1]=parseInt(k[1],10)||0,b.at[0]==="right"?n.left+=l:b.at[0]===e&&(n.left+=l/2),b.at[1]==="bottom"?n.top+=m:b.at[1]===e&&(n.top+=m/2),n.left+=k[0],n.top+=k[1],this.each(function(){var c=a(this),d=c.outerWidth(),g=c.outerHeight(),h=parseInt(a.curCSS(this,"marginLeft",!0))||0,i=parseInt(a.curCSS(this,"marginTop",!0))||0,o=d+h+(parseInt(a.curCSS(this,"marginRight",!0))||0),p=g+i+(parseInt(a.curCSS(this,"marginBottom",!0))||0),q=a.extend({},n),r;b.my[0]==="right"?q.left-=d:b.my[0]===e&&(q.left-=d/2),b.my[1]==="bottom"?q.top-=g:b.my[1]===e&&(q.top-=g/2),f.fractions||(q.left=Math.round(q.left),q.top=Math.round(q.top)),r={left:q.left-h,top:q.top-i},a.each(["left","top"],function(c,e){a.ui.position[j[c]]&&a.ui.position[j[c]][e](q,{targetWidth:l,targetHeight:m,elemWidth:d,elemHeight:g,collisionPosition:r,collisionWidth:o,collisionHeight:p,offset:k,my:b.my,at:b.at})}),a.fn.bgiframe&&c.bgiframe(),c.offset(a.extend(q,{using:b.using}))})},a.ui.position={fit:{left:function(b,c){var d=a(window),e=c.collisionPosition.left+c.collisionWidth-d.width()-d.scrollLeft();b.left=e>0?b.left-e:Math.max(b.left-c.collisionPosition.left,b.left)},top:function(b,c){var d=a(window),e=c.collisionPosition.top+c.collisionHeight-d.height()-d.scrollTop();b.top=e>0?b.top-e:Math.max(b.top-c.collisionPosition.top,b.top)}},flip:{left:function(b,c){if(c.at[0]===e)return;var d=a(window),f=c.collisionPosition.left+c.collisionWidth-d.width()-d.scrollLeft(),g=c.my[0]==="left"?-c.elemWidth:c.my[0]==="right"?c.elemWidth:0,h=c.at[0]==="left"?c.targetWidth:-c.targetWidth,i=-2*c.offset[0];b.left+=c.collisionPosition.left<0?g+h+i:f>0?g+h+i:0},top:function(b,c){if(c.at[1]===e)return;var d=a(window),f=c.collisionPosition.top+c.collisionHeight-d.height()-d.scrollTop(),g=c.my[1]==="top"?-c.elemHeight:c.my[1]==="bottom"?c.elemHeight:0,h=c.at[1]==="top"?c.targetHeight:-c.targetHeight,i=-2*c.offset[1];b.top+=c.collisionPosition.top<0?g+h+i:f>0?g+h+i:0}}},a.offset.setOffset||(a.offset.setOffset=function(b,c){/static/.test(a.curCSS(b,"position"))&&(b.style.position="relative");var d=a(b),e=d.offset(),f=parseInt(a.curCSS(b,"top",!0),10)||0,g=parseInt(a.curCSS(b,"left",!0),10)||0,h={top:c.top-e.top+f,left:c.left-e.left+g};"using"in c?c.using.call(b,h):d.css(h)},a.fn.offset=function(b){var c=this[0];return!c||!c.ownerDocument?null:b?this.each(function(){a.offset.setOffset(this,b)}):h.call(this)}),function(){var b=document.getElementsByTagName("body")[0],c=document.createElement("div"),d,e,g,h,i;d=document.createElement(b?"div":"body"),g={visibility:"hidden",width:0,height:0,border:0,margin:0,background:"none"},b&&a.extend(g,{position:"absolute",left:"-1000px",top:"-1000px"});for(var j in g)d.style[j]=g[j];d.appendChild(c),e=b||document.documentElement,e.insertBefore(d,e.firstChild),c.style.cssText="position: absolute; left: 10.7432222px; top: 10.432325px; height: 30px; width: 201px;",h=a(c).offset(function(a,b){return b}).offset(),d.innerHTML="",e.removeChild(d),i=h.top+h.left+(b?2e3:0),f.fractions=i>21&&i<22}()})(jQuery);;/*! jQuery UI - v1.8.20 - 2012-04-30
* https://github.com/jquery/jquery-ui
* Includes: jquery.ui.draggable.js
* Copyright (c) 2012 AUTHORS.txt; Licensed MIT, GPL */
(function(a,b){a.widget("ui.draggable",a.ui.mouse,{widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1},_create:function(){this.options.helper=="original"&&!/^(?:r|a|f)/.test(this.element.css("position"))&&(this.element[0].style.position="relative"),this.options.addClasses&&this.element.addClass("ui-draggable"),this.options.disabled&&this.element.addClass("ui-draggable-disabled"),this._mouseInit()},destroy:function(){if(!this.element.data("draggable"))return;return this.element.removeData("draggable").unbind(".draggable").removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"),this._mouseDestroy(),this},_mouseCapture:function(b){var c=this.options;return this.helper||c.disabled||a(b.target).is(".ui-resizable-handle")?!1:(this.handle=this._getHandle(b),this.handle?(c.iframeFix&&a(c.iframeFix===!0?"iframe":c.iframeFix).each(function(){a('<div class="ui-draggable-iframeFix" style="background: #fff;"></div>').css({width:this.offsetWidth+"px",height:this.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1e3}).css(a(this).offset()).appendTo("body")}),!0):!1)},_mouseStart:function(b){var c=this.options;return this.helper=this._createHelper(b),this._cacheHelperProportions(),a.ui.ddmanager&&(a.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(),this.offset=this.positionAbs=this.element.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},a.extend(this.offset,{click:{left:b.pageX-this.offset.left,top:b.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.originalPosition=this.position=this._generatePosition(b),this.originalPageX=b.pageX,this.originalPageY=b.pageY,c.cursorAt&&this._adjustOffsetFromHelper(c.cursorAt),c.containment&&this._setContainment(),this._trigger("start",b)===!1?(this._clear(),!1):(this._cacheHelperProportions(),a.ui.ddmanager&&!c.dropBehaviour&&a.ui.ddmanager.prepareOffsets(this,b),this.helper.addClass("ui-draggable-dragging"),this._mouseDrag(b,!0),a.ui.ddmanager&&a.ui.ddmanager.dragStart(this,b),!0)},_mouseDrag:function(b,c){this.position=this._generatePosition(b),this.positionAbs=this._convertPositionTo("absolute");if(!c){var d=this._uiHash();if(this._trigger("drag",b,d)===!1)return this._mouseUp({}),!1;this.position=d.position}if(!this.options.axis||this.options.axis!="y")this.helper[0].style.left=this.position.left+"px";if(!this.options.axis||this.options.axis!="x")this.helper[0].style.top=this.position.top+"px";return a.ui.ddmanager&&a.ui.ddmanager.drag(this,b),!1},_mouseStop:function(b){var c=!1;a.ui.ddmanager&&!this.options.dropBehaviour&&(c=a.ui.ddmanager.drop(this,b)),this.dropped&&(c=this.dropped,this.dropped=!1);var d=this.element[0],e=!1;while(d&&(d=d.parentNode))d==document&&(e=!0);if(!e&&this.options.helper==="original")return!1;if(this.options.revert=="invalid"&&!c||this.options.revert=="valid"&&c||this.options.revert===!0||a.isFunction(this.options.revert)&&this.options.revert.call(this.element,c)){var f=this;a(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){f._trigger("stop",b)!==!1&&f._clear()})}else this._trigger("stop",b)!==!1&&this._clear();return!1},_mouseUp:function(b){return this.options.iframeFix===!0&&a("div.ui-draggable-iframeFix").each(function(){this.parentNode.removeChild(this)}),a.ui.ddmanager&&a.ui.ddmanager.dragStop(this,b),a.ui.mouse.prototype._mouseUp.call(this,b)},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear(),this},_getHandle:function(b){var c=!this.options.handle||!a(this.options.handle,this.element).length?!0:!1;return a(this.options.handle,this.element).find("*").andSelf().each(function(){this==b.target&&(c=!0)}),c},_createHelper:function(b){var c=this.options,d=a.isFunction(c.helper)?a(c.helper.apply(this.element[0],[b])):c.helper=="clone"?this.element.clone().removeAttr("id"):this.element;return d.parents("body").length||d.appendTo(c.appendTo=="parent"?this.element[0].parentNode:c.appendTo),d[0]!=this.element[0]&&!/(fixed|absolute)/.test(d.css("position"))&&d.css("position","absolute"),d},_adjustOffsetFromHelper:function(b){typeof b=="string"&&(b=b.split(" ")),a.isArray(b)&&(b={left:+b[0],top:+b[1]||0}),"left"in b&&(this.offset.click.left=b.left+this.margins.left),"right"in b&&(this.offset.click.left=this.helperProportions.width-b.right+this.margins.left),"top"in b&&(this.offset.click.top=b.top+this.margins.top),"bottom"in b&&(this.offset.click.top=this.helperProportions.height-b.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var b=this.offsetParent.offset();this.cssPosition=="absolute"&&this.scrollParent[0]!=document&&a.ui.contains(this.scrollParent[0],this.offsetParent[0])&&(b.left+=this.scrollParent.scrollLeft(),b.top+=this.scrollParent.scrollTop());if(this.offsetParent[0]==document.body||this.offsetParent[0].tagName&&this.offsetParent[0].tagName.toLowerCase()=="html"&&a.browser.msie)b={top:0,left:0};return{top:b.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:b.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if(this.cssPosition=="relative"){var a=this.element.position();return{top:a.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:a.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var b=this.options;b.containment=="parent"&&(b.containment=this.helper[0].parentNode);if(b.containment=="document"||b.containment=="window")this.containment=[b.containment=="document"?0:a(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,b.containment=="document"?0:a(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,(b.containment=="document"?0:a(window).scrollLeft())+a(b.containment=="document"?document:window).width()-this.helperProportions.width-this.margins.left,(b.containment=="document"?0:a(window).scrollTop())+(a(b.containment=="document"?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top];if(!/^(document|window|parent)$/.test(b.containment)&&b.containment.constructor!=Array){var c=a(b.containment),d=c[0];if(!d)return;var e=c.offset(),f=a(d).css("overflow")!="hidden";this.containment=[(parseInt(a(d).css("borderLeftWidth"),10)||0)+(parseInt(a(d).css("paddingLeft"),10)||0),(parseInt(a(d).css("borderTopWidth"),10)||0)+(parseInt(a(d).css("paddingTop"),10)||0),(f?Math.max(d.scrollWidth,d.offsetWidth):d.offsetWidth)-(parseInt(a(d).css("borderLeftWidth"),10)||0)-(parseInt(a(d).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(f?Math.max(d.scrollHeight,d.offsetHeight):d.offsetHeight)-(parseInt(a(d).css("borderTopWidth"),10)||0)-(parseInt(a(d).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],this.relative_container=c}else b.containment.constructor==Array&&(this.containment=b.containment)},_convertPositionTo:function(b,c){c||(c=this.position);var d=b=="absolute"?1:-1,e=this.options,f=this.cssPosition=="absolute"&&(this.scrollParent[0]==document||!a.ui.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,g=/(html|body)/i.test(f[0].tagName);return{top:c.top+this.offset.relative.top*d+this.offset.parent.top*d-(a.browser.safari&&a.browser.version<526&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollTop():g?0:f.scrollTop())*d),left:c.left+this.offset.relative.left*d+this.offset.parent.left*d-(a.browser.safari&&a.browser.version<526&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():g?0:f.scrollLeft())*d)}},_generatePosition:function(b){var c=this.options,d=this.cssPosition=="absolute"&&(this.scrollParent[0]==document||!a.ui.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,e=/(html|body)/i.test(d[0].tagName),f=b.pageX,g=b.pageY;if(this.originalPosition){var h;if(this.containment){if(this.relative_container){var i=this.relative_container.offset();h=[this.containment[0]+i.left,this.containment[1]+i.top,this.containment[2]+i.left,this.containment[3]+i.top]}else h=this.containment;b.pageX-this.offset.click.left<h[0]&&(f=h[0]+this.offset.click.left),b.pageY-this.offset.click.top<h[1]&&(g=h[1]+this.offset.click.top),b.pageX-this.offset.click.left>h[2]&&(f=h[2]+this.offset.click.left),b.pageY-this.offset.click.top>h[3]&&(g=h[3]+this.offset.click.top)}if(c.grid){var j=c.grid[1]?this.originalPageY+Math.round((g-this.originalPageY)/c.grid[1])*c.grid[1]:this.originalPageY;g=h?j-this.offset.click.top<h[1]||j-this.offset.click.top>h[3]?j-this.offset.click.top<h[1]?j+c.grid[1]:j-c.grid[1]:j:j;var k=c.grid[0]?this.originalPageX+Math.round((f-this.originalPageX)/c.grid[0])*c.grid[0]:this.originalPageX;f=h?k-this.offset.click.left<h[0]||k-this.offset.click.left>h[2]?k-this.offset.click.left<h[0]?k+c.grid[0]:k-c.grid[0]:k:k}}return{top:g-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+(a.browser.safari&&a.browser.version<526&&this.cssPosition=="fixed"?0:this.cssPosition=="fixed"?-this.scrollParent.scrollTop():e?0:d.scrollTop()),left:f-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+(a.browser.safari&&a.browser.version<526&&this.cssPosition=="fixed"?0:this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():e?0:d.scrollLeft())}},_clear:function(){this.helper.removeClass("ui-draggable-dragging"),this.helper[0]!=this.element[0]&&!this.cancelHelperRemoval&&this.helper.remove(),this.helper=null,this.cancelHelperRemoval=!1},_trigger:function(b,c,d){return d=d||this._uiHash(),a.ui.plugin.call(this,b,[c,d]),b=="drag"&&(this.positionAbs=this._convertPositionTo("absolute")),a.Widget.prototype._trigger.call(this,b,c,d)},plugins:{},_uiHash:function(a){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}}),a.extend(a.ui.draggable,{version:"1.8.20"}),a.ui.plugin.add("draggable","connectToSortable",{start:function(b,c){var d=a(this).data("draggable"),e=d.options,f=a.extend({},c,{item:d.element});d.sortables=[],a(e.connectToSortable).each(function(){var c=a.data(this,"sortable");c&&!c.options.disabled&&(d.sortables.push({instance:c,shouldRevert:c.options.revert}),c.refreshPositions(),c._trigger("activate",b,f))})},stop:function(b,c){var d=a(this).data("draggable"),e=a.extend({},c,{item:d.element});a.each(d.sortables,function(){this.instance.isOver?(this.instance.isOver=0,d.cancelHelperRemoval=!0,this.instance.cancelHelperRemoval=!1,this.shouldRevert&&(this.instance.options.revert=!0),this.instance._mouseStop(b),this.instance.options.helper=this.instance.options._helper,d.options.helper=="original"&&this.instance.currentItem.css({top:"auto",left:"auto"})):(this.instance.cancelHelperRemoval=!1,this.instance._trigger("deactivate",b,e))})},drag:function(b,c){var d=a(this).data("draggable"),e=this,f=function(b){var c=this.offset.click.top,d=this.offset.click.left,e=this.positionAbs.top,f=this.positionAbs.left,g=b.height,h=b.width,i=b.top,j=b.left;return a.ui.isOver(e+c,f+d,i,j,g,h)};a.each(d.sortables,function(f){this.instance.positionAbs=d.positionAbs,this.instance.helperProportions=d.helperProportions,this.instance.offset.click=d.offset.click,this.instance._intersectsWith(this.instance.containerCache)?(this.instance.isOver||(this.instance.isOver=1,this.instance.currentItem=a(e).clone().removeAttr("id").appendTo(this.instance.element).data("sortable-item",!0),this.instance.options._helper=this.instance.options.helper,this.instance.options.helper=function(){return c.helper[0]},b.target=this.instance.currentItem[0],this.instance._mouseCapture(b,!0),this.instance._mouseStart(b,!0,!0),this.instance.offset.click.top=d.offset.click.top,this.instance.offset.click.left=d.offset.click.left,this.instance.offset.parent.left-=d.offset.parent.left-this.instance.offset.parent.left,this.instance.offset.parent.top-=d.offset.parent.top-this.instance.offset.parent.top,d._trigger("toSortable",b),d.dropped=this.instance.element,d.currentItem=d.element,this.instance.fromOutside=d),this.instance.currentItem&&this.instance._mouseDrag(b)):this.instance.isOver&&(this.instance.isOver=0,this.instance.cancelHelperRemoval=!0,this.instance.options.revert=!1,this.instance._trigger("out",b,this.instance._uiHash(this.instance)),this.instance._mouseStop(b,!0),this.instance.options.helper=this.instance.options._helper,this.instance.currentItem.remove(),this.instance.placeholder&&this.instance.placeholder.remove(),d._trigger("fromSortable",b),d.dropped=!1)})}}),a.ui.plugin.add("draggable","cursor",{start:function(b,c){var d=a("body"),e=a(this).data("draggable").options;d.css("cursor")&&(e._cursor=d.css("cursor")),d.css("cursor",e.cursor)},stop:function(b,c){var d=a(this).data("draggable").options;d._cursor&&a("body").css("cursor",d._cursor)}}),a.ui.plugin.add("draggable","opacity",{start:function(b,c){var d=a(c.helper),e=a(this).data("draggable").options;d.css("opacity")&&(e._opacity=d.css("opacity")),d.css("opacity",e.opacity)},stop:function(b,c){var d=a(this).data("draggable").options;d._opacity&&a(c.helper).css("opacity",d._opacity)}}),a.ui.plugin.add("draggable","scroll",{start:function(b,c){var d=a(this).data("draggable");d.scrollParent[0]!=document&&d.scrollParent[0].tagName!="HTML"&&(d.overflowOffset=d.scrollParent.offset())},drag:function(b,c){var d=a(this).data("draggable"),e=d.options,f=!1;if(d.scrollParent[0]!=document&&d.scrollParent[0].tagName!="HTML"){if(!e.axis||e.axis!="x")d.overflowOffset.top+d.scrollParent[0].offsetHeight-b.pageY<e.scrollSensitivity?d.scrollParent[0].scrollTop=f=d.scrollParent[0].scrollTop+e.scrollSpeed:b.pageY-d.overflowOffset.top<e.scrollSensitivity&&(d.scrollParent[0].scrollTop=f=d.scrollParent[0].scrollTop-e.scrollSpeed);if(!e.axis||e.axis!="y")d.overflowOffset.left+d.scrollParent[0].offsetWidth-b.pageX<e.scrollSensitivity?d.scrollParent[0].scrollLeft=f=d.scrollParent[0].scrollLeft+e.scrollSpeed:b.pageX-d.overflowOffset.left<e.scrollSensitivity&&(d.scrollParent[0].scrollLeft=f=d.scrollParent[0].scrollLeft-e.scrollSpeed)}else{if(!e.axis||e.axis!="x")b.pageY-a(document).scrollTop()<e.scrollSensitivity?f=a(document).scrollTop(a(document).scrollTop()-e.scrollSpeed):a(window).height()-(b.pageY-a(document).scrollTop())<e.scrollSensitivity&&(f=a(document).scrollTop(a(document).scrollTop()+e.scrollSpeed));if(!e.axis||e.axis!="y")b.pageX-a(document).scrollLeft()<e.scrollSensitivity?f=a(document).scrollLeft(a(document).scrollLeft()-e.scrollSpeed):a(window).width()-(b.pageX-a(document).scrollLeft())<e.scrollSensitivity&&(f=a(document).scrollLeft(a(document).scrollLeft()+e.scrollSpeed))}f!==!1&&a.ui.ddmanager&&!e.dropBehaviour&&a.ui.ddmanager.prepareOffsets(d,b)}}),a.ui.plugin.add("draggable","snap",{start:function(b,c){var d=a(this).data("draggable"),e=d.options;d.snapElements=[],a(e.snap.constructor!=String?e.snap.items||":data(draggable)":e.snap).each(function(){var b=a(this),c=b.offset();this!=d.element[0]&&d.snapElements.push({item:this,width:b.outerWidth(),height:b.outerHeight(),top:c.top,left:c.left})})},drag:function(b,c){var d=a(this).data("draggable"),e=d.options,f=e.snapTolerance,g=c.offset.left,h=g+d.helperProportions.width,i=c.offset.top,j=i+d.helperProportions.height;for(var k=d.snapElements.length-1;k>=0;k--){var l=d.snapElements[k].left,m=l+d.snapElements[k].width,n=d.snapElements[k].top,o=n+d.snapElements[k].height;if(!(l-f<g&&g<m+f&&n-f<i&&i<o+f||l-f<g&&g<m+f&&n-f<j&&j<o+f||l-f<h&&h<m+f&&n-f<i&&i<o+f||l-f<h&&h<m+f&&n-f<j&&j<o+f)){d.snapElements[k].snapping&&d.options.snap.release&&d.options.snap.release.call(d.element,b,a.extend(d._uiHash(),{snapItem:d.snapElements[k].item})),d.snapElements[k].snapping=!1;continue}if(e.snapMode!="inner"){var p=Math.abs(n-j)<=f,q=Math.abs(o-i)<=f,r=Math.abs(l-h)<=f,s=Math.abs(m-g)<=f;p&&(c.position.top=d._convertPositionTo("relative",{top:n-d.helperProportions.height,left:0}).top-d.margins.top),q&&(c.position.top=d._convertPositionTo("relative",{top:o,left:0}).top-d.margins.top),r&&(c.position.left=d._convertPositionTo("relative",{top:0,left:l-d.helperProportions.width}).left-d.margins.left),s&&(c.position.left=d._convertPositionTo("relative",{top:0,left:m}).left-d.margins.left)}var t=p||q||r||s;if(e.snapMode!="outer"){var p=Math.abs(n-i)<=f,q=Math.abs(o-j)<=f,r=Math.abs(l-g)<=f,s=Math.abs(m-h)<=f;p&&(c.position.top=d._convertPositionTo("relative",{top:n,left:0}).top-d.margins.top),q&&(c.position.top=d._convertPositionTo("relative",{top:o-d.helperProportions.height,left:0}).top-d.margins.top),r&&(c.position.left=d._convertPositionTo("relative",{top:0,left:l}).left-d.margins.left),s&&(c.position.left=d._convertPositionTo("relative",{top:0,left:m-d.helperProportions.width}).left-d.margins.left)}!d.snapElements[k].snapping&&(p||q||r||s||t)&&d.options.snap.snap&&d.options.snap.snap.call(d.element,b,a.extend(d._uiHash(),{snapItem:d.snapElements[k].item})),d.snapElements[k].snapping=p||q||r||s||t}}}),a.ui.plugin.add("draggable","stack",{start:function(b,c){var d=a(this).data("draggable").options,e=a.makeArray(a(d.stack)).sort(function(b,c){return(parseInt(a(b).css("zIndex"),10)||0)-(parseInt(a(c).css("zIndex"),10)||0)});if(!e.length)return;var f=parseInt(e[0].style.zIndex)||0;a(e).each(function(a){this.style.zIndex=f+a}),this[0].style.zIndex=f+e.length}}),a.ui.plugin.add("draggable","zIndex",{start:function(b,c){var d=a(c.helper),e=a(this).data("draggable").options;d.css("zIndex")&&(e._zIndex=d.css("zIndex")),d.css("zIndex",e.zIndex)},stop:function(b,c){var d=a(this).data("draggable").options;d._zIndex&&a(c.helper).css("zIndex",d._zIndex)}})})(jQuery);;/*! jQuery UI - v1.8.20 - 2012-04-30
* https://github.com/jquery/jquery-ui
* Includes: jquery.ui.droppable.js
* Copyright (c) 2012 AUTHORS.txt; Licensed MIT, GPL */
(function(a,b){a.widget("ui.droppable",{widgetEventPrefix:"drop",options:{accept:"*",activeClass:!1,addClasses:!0,greedy:!1,hoverClass:!1,scope:"default",tolerance:"intersect"},_create:function(){var b=this.options,c=b.accept;this.isover=0,this.isout=1,this.accept=a.isFunction(c)?c:function(a){return a.is(c)},this.proportions={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight},a.ui.ddmanager.droppables[b.scope]=a.ui.ddmanager.droppables[b.scope]||[],a.ui.ddmanager.droppables[b.scope].push(this),b.addClasses&&this.element.addClass("ui-droppable")},destroy:function(){var b=a.ui.ddmanager.droppables[this.options.scope];for(var c=0;c<b.length;c++)b[c]==this&&b.splice(c,1);return this.element.removeClass("ui-droppable ui-droppable-disabled").removeData("droppable").unbind(".droppable"),this},_setOption:function(b,c){b=="accept"&&(this.accept=a.isFunction(c)?c:function(a){return a.is(c)}),a.Widget.prototype._setOption.apply(this,arguments)},_activate:function(b){var c=a.ui.ddmanager.current;this.options.activeClass&&this.element.addClass(this.options.activeClass),c&&this._trigger("activate",b,this.ui(c))},_deactivate:function(b){var c=a.ui.ddmanager.current;this.options.activeClass&&this.element.removeClass(this.options.activeClass),c&&this._trigger("deactivate",b,this.ui(c))},_over:function(b){var c=a.ui.ddmanager.current;if(!c||(c.currentItem||c.element)[0]==this.element[0])return;this.accept.call(this.element[0],c.currentItem||c.element)&&(this.options.hoverClass&&this.element.addClass(this.options.hoverClass),this._trigger("over",b,this.ui(c)))},_out:function(b){var c=a.ui.ddmanager.current;if(!c||(c.currentItem||c.element)[0]==this.element[0])return;this.accept.call(this.element[0],c.currentItem||c.element)&&(this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("out",b,this.ui(c)))},_drop:function(b,c){var d=c||a.ui.ddmanager.current;if(!d||(d.currentItem||d.element)[0]==this.element[0])return!1;var e=!1;return this.element.find(":data(droppable)").not(".ui-draggable-dragging").each(function(){var b=a.data(this,"droppable");if(b.options.greedy&&!b.options.disabled&&b.options.scope==d.options.scope&&b.accept.call(b.element[0],d.currentItem||d.element)&&a.ui.intersect(d,a.extend(b,{offset:b.element.offset()}),b.options.tolerance))return e=!0,!1}),e?!1:this.accept.call(this.element[0],d.currentItem||d.element)?(this.options.activeClass&&this.element.removeClass(this.options.activeClass),this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("drop",b,this.ui(d)),this.element):!1},ui:function(a){return{draggable:a.currentItem||a.element,helper:a.helper,position:a.position,offset:a.positionAbs}}}),a.extend(a.ui.droppable,{version:"1.8.20"}),a.ui.intersect=function(b,c,d){if(!c.offset)return!1;var e=(b.positionAbs||b.position.absolute).left,f=e+b.helperProportions.width,g=(b.positionAbs||b.position.absolute).top,h=g+b.helperProportions.height,i=c.offset.left,j=i+c.proportions.width,k=c.offset.top,l=k+c.proportions.height;switch(d){case"fit":return i<=e&&f<=j&&k<=g&&h<=l;case"intersect":return i<e+b.helperProportions.width/2&&f-b.helperProportions.width/2<j&&k<g+b.helperProportions.height/2&&h-b.helperProportions.height/2<l;case"pointer":var m=(b.positionAbs||b.position.absolute).left+(b.clickOffset||b.offset.click).left,n=(b.positionAbs||b.position.absolute).top+(b.clickOffset||b.offset.click).top,o=a.ui.isOver(n,m,k,i,c.proportions.height,c.proportions.width);return o;case"touch":return(g>=k&&g<=l||h>=k&&h<=l||g<k&&h>l)&&(e>=i&&e<=j||f>=i&&f<=j||e<i&&f>j);default:return!1}},a.ui.ddmanager={current:null,droppables:{"default":[]},prepareOffsets:function(b,c){var d=a.ui.ddmanager.droppables[b.options.scope]||[],e=c?c.type:null,f=(b.currentItem||b.element).find(":data(droppable)").andSelf();g:for(var h=0;h<d.length;h++){if(d[h].options.disabled||b&&!d[h].accept.call(d[h].element[0],b.currentItem||b.element))continue;for(var i=0;i<f.length;i++)if(f[i]==d[h].element[0]){d[h].proportions.height=0;continue g}d[h].visible=d[h].element.css("display")!="none";if(!d[h].visible)continue;e=="mousedown"&&d[h]._activate.call(d[h],c),d[h].offset=d[h].element.offset(),d[h].proportions={width:d[h].element[0].offsetWidth,height:d[h].element[0].offsetHeight}}},drop:function(b,c){var d=!1;return a.each(a.ui.ddmanager.droppables[b.options.scope]||[],function(){if(!this.options)return;!this.options.disabled&&this.visible&&a.ui.intersect(b,this,this.options.tolerance)&&(d=this._drop.call(this,c)||d),!this.options.disabled&&this.visible&&this.accept.call(this.element[0],b.currentItem||b.element)&&(this.isout=1,this.isover=0,this._deactivate.call(this,c))}),d},dragStart:function(b,c){b.element.parents(":not(body,html)").bind("scroll.droppable",function(){b.options.refreshPositions||a.ui.ddmanager.prepareOffsets(b,c)})},drag:function(b,c){b.options.refreshPositions&&a.ui.ddmanager.prepareOffsets(b,c),a.each(a.ui.ddmanager.droppables[b.options.scope]||[],function(){if(this.options.disabled||this.greedyChild||!this.visible)return;var d=a.ui.intersect(b,this,this.options.tolerance),e=!d&&this.isover==1?"isout":d&&this.isover==0?"isover":null;if(!e)return;var f;if(this.options.greedy){var g=this.element.parents(":data(droppable):eq(0)");g.length&&(f=a.data(g[0],"droppable"),f.greedyChild=e=="isover"?1:0)}f&&e=="isover"&&(f.isover=0,f.isout=1,f._out.call(f,c)),this[e]=1,this[e=="isout"?"isover":"isout"]=0,this[e=="isover"?"_over":"_out"].call(this,c),f&&e=="isout"&&(f.isout=0,f.isover=1,f._over.call(f,c))})},dragStop:function(b,c){b.element.parents(":not(body,html)").unbind("scroll.droppable"),b.options.refreshPositions||a.ui.ddmanager.prepareOffsets(b,c)}}})(jQuery);;/*! jQuery UI - v1.8.20 - 2012-04-30
* https://github.com/jquery/jquery-ui
* Includes: jquery.effects.core.js
* Copyright (c) 2012 AUTHORS.txt; Licensed MIT, GPL */
jQuery.effects||function(a,b){function c(b){var c;return b&&b.constructor==Array&&b.length==3?b:(c=/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/.exec(b))?[parseInt(c[1],10),parseInt(c[2],10),parseInt(c[3],10)]:(c=/rgb\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*\)/.exec(b))?[parseFloat(c[1])*2.55,parseFloat(c[2])*2.55,parseFloat(c[3])*2.55]:(c=/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/.exec(b))?[parseInt(c[1],16),parseInt(c[2],16),parseInt(c[3],16)]:(c=/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/.exec(b))?[parseInt(c[1]+c[1],16),parseInt(c[2]+c[2],16),parseInt(c[3]+c[3],16)]:(c=/rgba\(0, 0, 0, 0\)/.exec(b))?e.transparent:e[a.trim(b).toLowerCase()]}function d(b,d){var e;do{e=a.curCSS(b,d);if(e!=""&&e!="transparent"||a.nodeName(b,"body"))break;d="backgroundColor"}while(b=b.parentNode);return c(e)}function h(){var a=document.defaultView?document.defaultView.getComputedStyle(this,null):this.currentStyle,b={},c,d;if(a&&a.length&&a[0]&&a[a[0]]){var e=a.length;while(e--)c=a[e],typeof a[c]=="string"&&(d=c.replace(/\-(\w)/g,function(a,b){return b.toUpperCase()}),b[d]=a[c])}else for(c in a)typeof a[c]=="string"&&(b[c]=a[c]);return b}function i(b){var c,d;for(c in b)d=b[c],(d==null||a.isFunction(d)||c in g||/scrollbar/.test(c)||!/color/i.test(c)&&isNaN(parseFloat(d)))&&delete b[c];return b}function j(a,b){var c={_:0},d;for(d in b)a[d]!=b[d]&&(c[d]=b[d]);return c}function k(b,c,d,e){typeof b=="object"&&(e=c,d=null,c=b,b=c.effect),a.isFunction(c)&&(e=c,d=null,c={});if(typeof c=="number"||a.fx.speeds[c])e=d,d=c,c={};return a.isFunction(d)&&(e=d,d=null),c=c||{},d=d||c.duration,d=a.fx.off?0:typeof d=="number"?d:d in a.fx.speeds?a.fx.speeds[d]:a.fx.speeds._default,e=e||c.complete,[b,c,d,e]}function l(b){return!b||typeof b=="number"||a.fx.speeds[b]?!0:typeof b=="string"&&!a.effects[b]?!0:!1}a.effects={},a.each(["backgroundColor","borderBottomColor","borderLeftColor","borderRightColor","borderTopColor","borderColor","color","outlineColor"],function(b,e){a.fx.step[e]=function(a){a.colorInit||(a.start=d(a.elem,e),a.end=c(a.end),a.colorInit=!0),a.elem.style[e]="rgb("+Math.max(Math.min(parseInt(a.pos*(a.end[0]-a.start[0])+a.start[0],10),255),0)+","+Math.max(Math.min(parseInt(a.pos*(a.end[1]-a.start[1])+a.start[1],10),255),0)+","+Math.max(Math.min(parseInt(a.pos*(a.end[2]-a.start[2])+a.start[2],10),255),0)+")"}});var e={aqua:[0,255,255],azure:[240,255,255],beige:[245,245,220],black:[0,0,0],blue:[0,0,255],brown:[165,42,42],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgrey:[169,169,169],darkgreen:[0,100,0],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkviolet:[148,0,211],fuchsia:[255,0,255],gold:[255,215,0],green:[0,128,0],indigo:[75,0,130],khaki:[240,230,140],lightblue:[173,216,230],lightcyan:[224,255,255],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightyellow:[255,255,224],lime:[0,255,0],magenta:[255,0,255],maroon:[128,0,0],navy:[0,0,128],olive:[128,128,0],orange:[255,165,0],pink:[255,192,203],purple:[128,0,128],violet:[128,0,128],red:[255,0,0],silver:[192,192,192],white:[255,255,255],yellow:[255,255,0],transparent:[255,255,255]},f=["add","remove","toggle"],g={border:1,borderBottom:1,borderColor:1,borderLeft:1,borderRight:1,borderTop:1,borderWidth:1,margin:1,padding:1};a.effects.animateClass=function(b,c,d,e){return a.isFunction(d)&&(e=d,d=null),this.queue(function(){var g=a(this),k=g.attr("style")||" ",l=i(h.call(this)),m,n=g.attr("class")||"";a.each(f,function(a,c){b[c]&&g[c+"Class"](b[c])}),m=i(h.call(this)),g.attr("class",n),g.animate(j(l,m),{queue:!1,duration:c,easing:d,complete:function(){a.each(f,function(a,c){b[c]&&g[c+"Class"](b[c])}),typeof g.attr("style")=="object"?(g.attr("style").cssText="",g.attr("style").cssText=k):g.attr("style",k),e&&e.apply(this,arguments),a.dequeue(this)}})})},a.fn.extend({_addClass:a.fn.addClass,addClass:function(b,c,d,e){return c?a.effects.animateClass.apply(this,[{add:b},c,d,e]):this._addClass(b)},_removeClass:a.fn.removeClass,removeClass:function(b,c,d,e){return c?a.effects.animateClass.apply(this,[{remove:b},c,d,e]):this._removeClass(b)},_toggleClass:a.fn.toggleClass,toggleClass:function(c,d,e,f,g){return typeof d=="boolean"||d===b?e?a.effects.animateClass.apply(this,[d?{add:c}:{remove:c},e,f,g]):this._toggleClass(c,d):a.effects.animateClass.apply(this,[{toggle:c},d,e,f])},switchClass:function(b,c,d,e,f){return a.effects.animateClass.apply(this,[{add:c,remove:b},d,e,f])}}),a.extend(a.effects,{version:"1.8.20",save:function(a,b){for(var c=0;c<b.length;c++)b[c]!==null&&a.data("ec.storage."+b[c],a[0].style[b[c]])},restore:function(a,b){for(var c=0;c<b.length;c++)b[c]!==null&&a.css(b[c],a.data("ec.storage."+b[c]))},setMode:function(a,b){return b=="toggle"&&(b=a.is(":hidden")?"show":"hide"),b},getBaseline:function(a,b){var c,d;switch(a[0]){case"top":c=0;break;case"middle":c=.5;break;case"bottom":c=1;break;default:c=a[0]/b.height}switch(a[1]){case"left":d=0;break;case"center":d=.5;break;case"right":d=1;break;default:d=a[1]/b.width}return{x:d,y:c}},createWrapper:function(b){if(b.parent().is(".ui-effects-wrapper"))return b.parent();var c={width:b.outerWidth(!0),height:b.outerHeight(!0),"float":b.css("float")},d=a("<div></div>").addClass("ui-effects-wrapper").css({fontSize:"100%",background:"transparent",border:"none",margin:0,padding:0}),e=document.activeElement;return b.wrap(d),(b[0]===e||a.contains(b[0],e))&&a(e).focus(),d=b.parent(),b.css("position")=="static"?(d.css({position:"relative"}),b.css({position:"relative"})):(a.extend(c,{position:b.css("position"),zIndex:b.css("z-index")}),a.each(["top","left","bottom","right"],function(a,d){c[d]=b.css(d),isNaN(parseInt(c[d],10))&&(c[d]="auto")}),b.css({position:"relative",top:0,left:0,right:"auto",bottom:"auto"})),d.css(c).show()},removeWrapper:function(b){var c,d=document.activeElement;return b.parent().is(".ui-effects-wrapper")?(c=b.parent().replaceWith(b),(b[0]===d||a.contains(b[0],d))&&a(d).focus(),c):b},setTransition:function(b,c,d,e){return e=e||{},a.each(c,function(a,c){var f=b.cssUnit(c);f[0]>0&&(e[c]=f[0]*d+f[1])}),e}}),a.fn.extend({effect:function(b,c,d,e){var f=k.apply(this,arguments),g={options:f[1],duration:f[2],callback:f[3]},h=g.options.mode,i=a.effects[b];return a.fx.off||!i?h?this[h](g.duration,g.callback):this.each(function(){g.callback&&g.callback.call(this)}):i.call(this,g)},_show:a.fn.show,show:function(a){if(l(a))return this._show.apply(this,arguments);var b=k.apply(this,arguments);return b[1].mode="show",this.effect.apply(this,b)},_hide:a.fn.hide,hide:function(a){if(l(a))return this._hide.apply(this,arguments);var b=k.apply(this,arguments);return b[1].mode="hide",this.effect.apply(this,b)},__toggle:a.fn.toggle,toggle:function(b){if(l(b)||typeof b=="boolean"||a.isFunction(b))return this.__toggle.apply(this,arguments);var c=k.apply(this,arguments);return c[1].mode="toggle",this.effect.apply(this,c)},cssUnit:function(b){var c=this.css(b),d=[];return a.each(["em","px","%","pt"],function(a,b){c.indexOf(b)>0&&(d=[parseFloat(c),b])}),d}}),a.easing.jswing=a.easing.swing,a.extend(a.easing,{def:"easeOutQuad",swing:function(b,c,d,e,f){return a.easing[a.easing.def](b,c,d,e,f)},easeInQuad:function(a,b,c,d,e){return d*(b/=e)*b+c},easeOutQuad:function(a,b,c,d,e){return-d*(b/=e)*(b-2)+c},easeInOutQuad:function(a,b,c,d,e){return(b/=e/2)<1?d/2*b*b+c:-d/2*(--b*(b-2)-1)+c},easeInCubic:function(a,b,c,d,e){return d*(b/=e)*b*b+c},easeOutCubic:function(a,b,c,d,e){return d*((b=b/e-1)*b*b+1)+c},easeInOutCubic:function(a,b,c,d,e){return(b/=e/2)<1?d/2*b*b*b+c:d/2*((b-=2)*b*b+2)+c},easeInQuart:function(a,b,c,d,e){return d*(b/=e)*b*b*b+c},easeOutQuart:function(a,b,c,d,e){return-d*((b=b/e-1)*b*b*b-1)+c},easeInOutQuart:function(a,b,c,d,e){return(b/=e/2)<1?d/2*b*b*b*b+c:-d/2*((b-=2)*b*b*b-2)+c},easeInQuint:function(a,b,c,d,e){return d*(b/=e)*b*b*b*b+c},easeOutQuint:function(a,b,c,d,e){return d*((b=b/e-1)*b*b*b*b+1)+c},easeInOutQuint:function(a,b,c,d,e){return(b/=e/2)<1?d/2*b*b*b*b*b+c:d/2*((b-=2)*b*b*b*b+2)+c},easeInSine:function(a,b,c,d,e){return-d*Math.cos(b/e*(Math.PI/2))+d+c},easeOutSine:function(a,b,c,d,e){return d*Math.sin(b/e*(Math.PI/2))+c},easeInOutSine:function(a,b,c,d,e){return-d/2*(Math.cos(Math.PI*b/e)-1)+c},easeInExpo:function(a,b,c,d,e){return b==0?c:d*Math.pow(2,10*(b/e-1))+c},easeOutExpo:function(a,b,c,d,e){return b==e?c+d:d*(-Math.pow(2,-10*b/e)+1)+c},easeInOutExpo:function(a,b,c,d,e){return b==0?c:b==e?c+d:(b/=e/2)<1?d/2*Math.pow(2,10*(b-1))+c:d/2*(-Math.pow(2,-10*--b)+2)+c},easeInCirc:function(a,b,c,d,e){return-d*(Math.sqrt(1-(b/=e)*b)-1)+c},easeOutCirc:function(a,b,c,d,e){return d*Math.sqrt(1-(b=b/e-1)*b)+c},easeInOutCirc:function(a,b,c,d,e){return(b/=e/2)<1?-d/2*(Math.sqrt(1-b*b)-1)+c:d/2*(Math.sqrt(1-(b-=2)*b)+1)+c},easeInElastic:function(a,b,c,d,e){var f=1.70158,g=0,h=d;if(b==0)return c;if((b/=e)==1)return c+d;g||(g=e*.3);if(h<Math.abs(d)){h=d;var f=g/4}else var f=g/(2*Math.PI)*Math.asin(d/h);return-(h*Math.pow(2,10*(b-=1))*Math.sin((b*e-f)*2*Math.PI/g))+c},easeOutElastic:function(a,b,c,d,e){var f=1.70158,g=0,h=d;if(b==0)return c;if((b/=e)==1)return c+d;g||(g=e*.3);if(h<Math.abs(d)){h=d;var f=g/4}else var f=g/(2*Math.PI)*Math.asin(d/h);return h*Math.pow(2,-10*b)*Math.sin((b*e-f)*2*Math.PI/g)+d+c},easeInOutElastic:function(a,b,c,d,e){var f=1.70158,g=0,h=d;if(b==0)return c;if((b/=e/2)==2)return c+d;g||(g=e*.3*1.5);if(h<Math.abs(d)){h=d;var f=g/4}else var f=g/(2*Math.PI)*Math.asin(d/h);return b<1?-0.5*h*Math.pow(2,10*(b-=1))*Math.sin((b*e-f)*2*Math.PI/g)+c:h*Math.pow(2,-10*(b-=1))*Math.sin((b*e-f)*2*Math.PI/g)*.5+d+c},easeInBack:function(a,c,d,e,f,g){return g==b&&(g=1.70158),e*(c/=f)*c*((g+1)*c-g)+d},easeOutBack:function(a,c,d,e,f,g){return g==b&&(g=1.70158),e*((c=c/f-1)*c*((g+1)*c+g)+1)+d},easeInOutBack:function(a,c,d,e,f,g){return g==b&&(g=1.70158),(c/=f/2)<1?e/2*c*c*(((g*=1.525)+1)*c-g)+d:e/2*((c-=2)*c*(((g*=1.525)+1)*c+g)+2)+d},easeInBounce:function(b,c,d,e,f){return e-a.easing.easeOutBounce(b,f-c,0,e,f)+d},easeOutBounce:function(a,b,c,d,e){return(b/=e)<1/2.75?d*7.5625*b*b+c:b<2/2.75?d*(7.5625*(b-=1.5/2.75)*b+.75)+c:b<2.5/2.75?d*(7.5625*(b-=2.25/2.75)*b+.9375)+c:d*(7.5625*(b-=2.625/2.75)*b+.984375)+c},easeInOutBounce:function(b,c,d,e,f){return c<f/2?a.easing.easeInBounce(b,c*2,0,e,f)*.5+d:a.easing.easeOutBounce(b,c*2-f,0,e,f)*.5+e*.5+d}})}(jQuery);;/*! jQuery UI - v1.8.20 - 2012-04-30
* https://github.com/jquery/jquery-ui
* Includes: jquery.effects.pulsate.js
* Copyright (c) 2012 AUTHORS.txt; Licensed MIT, GPL */
(function(a,b){a.effects.pulsate=function(b){return this.queue(function(){var c=a(this),d=a.effects.setMode(c,b.options.mode||"show"),e=(b.options.times||5)*2-1,f=b.duration?b.duration/2:a.fx.speeds._default/2,g=c.is(":visible"),h=0;g||(c.css("opacity",0).show(),h=1),(d=="hide"&&g||d=="show"&&!g)&&e--;for(var i=0;i<e;i++)c.animate({opacity:h},f,b.options.easing),h=(h+1)%2;c.animate({opacity:h},f,b.options.easing,function(){h==0&&c.hide(),b.callback&&b.callback.apply(this,arguments)}),c.queue("fx",function(){c.dequeue()}).dequeue()})}})(jQuery);
/*!
 * jQuery UI Touch Punch 0.2.2
 *
 * Copyright 2011, Dave Furfero
 * Dual licensed under the MIT or GPL Version 2 licenses.
 *
 * Depends:
 *  jquery.ui.widget.js
 *  jquery.ui.mouse.js
 */
(function(b){b.support.touch="ontouchend" in document;if(!b.support.touch){return;}var c=b.ui.mouse.prototype,e=c._mouseInit,a;function d(g,h){if(g.originalEvent.touches.length>1){return;}g.preventDefault();var i=g.originalEvent.changedTouches[0],f=document.createEvent("MouseEvents");f.initMouseEvent(h,true,true,window,1,i.screenX,i.screenY,i.clientX,i.clientY,false,false,false,false,0,null);g.target.dispatchEvent(f);}c._touchStart=function(g){var f=this;if(a||!f._mouseCapture(g.originalEvent.changedTouches[0])){return;}a=true;f._touchMoved=false;d(g,"mouseover");d(g,"mousemove");d(g,"mousedown");};c._touchMove=function(f){if(!a){return;}this._touchMoved=true;d(f,"mousemove");};c._touchEnd=function(f){if(!a){return;}d(f,"mouseup");d(f,"mouseout");if(!this._touchMoved){d(f,"click");}a=false;};c._mouseInit=function(){var f=this;f.element.bind("touchstart",b.proxy(f,"_touchStart")).bind("touchmove",b.proxy(f,"_touchMove")).bind("touchend",b.proxy(f,"_touchEnd"));e.call(f);};})(jQuery);
/*!
 * clipboard.js v1.6.0
 * https://zenorocha.github.io/clipboard.js
 *
 * Licensed MIT © Zeno Rocha
 */
!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.Clipboard=e()}}(function(){var e,t,n;return function e(t,n,o){function i(a,c){if(!n[a]){if(!t[a]){var l="function"==typeof require&&require;if(!c&&l)return l(a,!0);if(r)return r(a,!0);var u=new Error("Cannot find module '"+a+"'");throw u.code="MODULE_NOT_FOUND",u}var s=n[a]={exports:{}};t[a][0].call(s.exports,function(e){var n=t[a][1][e];return i(n?n:e)},s,s.exports,e,t,n,o)}return n[a].exports}for(var r="function"==typeof require&&require,a=0;a<o.length;a++)i(o[a]);return i}({1:[function(e,t,n){function o(e,t){for(;e&&e.nodeType!==i;){if(e.matches(t))return e;e=e.parentNode}}var i=9;if(Element&&!Element.prototype.matches){var r=Element.prototype;r.matches=r.matchesSelector||r.mozMatchesSelector||r.msMatchesSelector||r.oMatchesSelector||r.webkitMatchesSelector}t.exports=o},{}],2:[function(e,t,n){function o(e,t,n,o,r){var a=i.apply(this,arguments);return e.addEventListener(n,a,r),{destroy:function(){e.removeEventListener(n,a,r)}}}function i(e,t,n,o){return function(n){n.delegateTarget=r(n.target,t),n.delegateTarget&&o.call(e,n)}}var r=e("./closest");t.exports=o},{"./closest":1}],3:[function(e,t,n){n.node=function(e){return void 0!==e&&e instanceof HTMLElement&&1===e.nodeType},n.nodeList=function(e){var t=Object.prototype.toString.call(e);return void 0!==e&&("[object NodeList]"===t||"[object HTMLCollection]"===t)&&"length"in e&&(0===e.length||n.node(e[0]))},n.string=function(e){return"string"==typeof e||e instanceof String},n.fn=function(e){var t=Object.prototype.toString.call(e);return"[object Function]"===t}},{}],4:[function(e,t,n){function o(e,t,n){if(!e&&!t&&!n)throw new Error("Missing required arguments");if(!c.string(t))throw new TypeError("Second argument must be a String");if(!c.fn(n))throw new TypeError("Third argument must be a Function");if(c.node(e))return i(e,t,n);if(c.nodeList(e))return r(e,t,n);if(c.string(e))return a(e,t,n);throw new TypeError("First argument must be a String, HTMLElement, HTMLCollection, or NodeList")}function i(e,t,n){return e.addEventListener(t,n),{destroy:function(){e.removeEventListener(t,n)}}}function r(e,t,n){return Array.prototype.forEach.call(e,function(e){e.addEventListener(t,n)}),{destroy:function(){Array.prototype.forEach.call(e,function(e){e.removeEventListener(t,n)})}}}function a(e,t,n){return l(document.body,e,t,n)}var c=e("./is"),l=e("delegate");t.exports=o},{"./is":3,delegate:2}],5:[function(e,t,n){function o(e){var t;if("SELECT"===e.nodeName)e.focus(),t=e.value;else if("INPUT"===e.nodeName||"TEXTAREA"===e.nodeName){var n=e.hasAttribute("readonly");n||e.setAttribute("readonly",""),e.select(),e.setSelectionRange(0,e.value.length),n||e.removeAttribute("readonly"),t=e.value}else{e.hasAttribute("contenteditable")&&e.focus();var o=window.getSelection(),i=document.createRange();i.selectNodeContents(e),o.removeAllRanges(),o.addRange(i),t=o.toString()}return t}t.exports=o},{}],6:[function(e,t,n){function o(){}o.prototype={on:function(e,t,n){var o=this.e||(this.e={});return(o[e]||(o[e]=[])).push({fn:t,ctx:n}),this},once:function(e,t,n){function o(){i.off(e,o),t.apply(n,arguments)}var i=this;return o._=t,this.on(e,o,n)},emit:function(e){var t=[].slice.call(arguments,1),n=((this.e||(this.e={}))[e]||[]).slice(),o=0,i=n.length;for(o;o<i;o++)n[o].fn.apply(n[o].ctx,t);return this},off:function(e,t){var n=this.e||(this.e={}),o=n[e],i=[];if(o&&t)for(var r=0,a=o.length;r<a;r++)o[r].fn!==t&&o[r].fn._!==t&&i.push(o[r]);return i.length?n[e]=i:delete n[e],this}},t.exports=o},{}],7:[function(t,n,o){!function(i,r){if("function"==typeof e&&e.amd)e(["module","select"],r);else if("undefined"!=typeof o)r(n,t("select"));else{var a={exports:{}};r(a,i.select),i.clipboardAction=a.exports}}(this,function(e,t){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var i=n(t),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),c=function(){function e(t){o(this,e),this.resolveOptions(t),this.initSelection()}return a(e,[{key:"resolveOptions",value:function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.action=t.action,this.emitter=t.emitter,this.target=t.target,this.text=t.text,this.trigger=t.trigger,this.selectedText=""}},{key:"initSelection",value:function e(){this.text?this.selectFake():this.target&&this.selectTarget()}},{key:"selectFake",value:function e(){var t=this,n="rtl"==document.documentElement.getAttribute("dir");this.removeFake(),this.fakeHandlerCallback=function(){return t.removeFake()},this.fakeHandler=document.body.addEventListener("click",this.fakeHandlerCallback)||!0,this.fakeElem=document.createElement("textarea"),this.fakeElem.style.fontSize="12pt",this.fakeElem.style.border="0",this.fakeElem.style.padding="0",this.fakeElem.style.margin="0",this.fakeElem.style.position="absolute",this.fakeElem.style[n?"right":"left"]="-9999px";var o=window.pageYOffset||document.documentElement.scrollTop;this.fakeElem.style.top=o+"px",this.fakeElem.setAttribute("readonly",""),this.fakeElem.value=this.text,document.body.appendChild(this.fakeElem),this.selectedText=(0,i.default)(this.fakeElem),this.copyText()}},{key:"removeFake",value:function e(){this.fakeHandler&&(document.body.removeEventListener("click",this.fakeHandlerCallback),this.fakeHandler=null,this.fakeHandlerCallback=null),this.fakeElem&&(document.body.removeChild(this.fakeElem),this.fakeElem=null)}},{key:"selectTarget",value:function e(){this.selectedText=(0,i.default)(this.target),this.copyText()}},{key:"copyText",value:function e(){var t=void 0;try{t=document.execCommand(this.action)}catch(e){t=!1}this.handleResult(t)}},{key:"handleResult",value:function e(t){this.emitter.emit(t?"success":"error",{action:this.action,text:this.selectedText,trigger:this.trigger,clearSelection:this.clearSelection.bind(this)})}},{key:"clearSelection",value:function e(){this.target&&this.target.blur(),window.getSelection().removeAllRanges()}},{key:"destroy",value:function e(){this.removeFake()}},{key:"action",set:function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"copy";if(this._action=t,"copy"!==this._action&&"cut"!==this._action)throw new Error('Invalid "action" value, use either "copy" or "cut"')},get:function e(){return this._action}},{key:"target",set:function e(t){if(void 0!==t){if(!t||"object"!==("undefined"==typeof t?"undefined":r(t))||1!==t.nodeType)throw new Error('Invalid "target" value, use a valid Element');if("copy"===this.action&&t.hasAttribute("disabled"))throw new Error('Invalid "target" attribute. Please use "readonly" instead of "disabled" attribute');if("cut"===this.action&&(t.hasAttribute("readonly")||t.hasAttribute("disabled")))throw new Error('Invalid "target" attribute. You can\'t cut text from elements with "readonly" or "disabled" attributes');this._target=t}},get:function e(){return this._target}}]),e}();e.exports=c})},{select:5}],8:[function(t,n,o){!function(i,r){if("function"==typeof e&&e.amd)e(["module","./clipboard-action","tiny-emitter","good-listener"],r);else if("undefined"!=typeof o)r(n,t("./clipboard-action"),t("tiny-emitter"),t("good-listener"));else{var a={exports:{}};r(a,i.clipboardAction,i.tinyEmitter,i.goodListener),i.clipboard=a.exports}}(this,function(e,t,n,o){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function c(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function l(e,t){var n="data-clipboard-"+e;if(t.hasAttribute(n))return t.getAttribute(n)}var u=i(t),s=i(n),f=i(o),d=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),h=function(e){function t(e,n){r(this,t);var o=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return o.resolveOptions(n),o.listenClick(e),o}return c(t,e),d(t,[{key:"resolveOptions",value:function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.action="function"==typeof t.action?t.action:this.defaultAction,this.target="function"==typeof t.target?t.target:this.defaultTarget,this.text="function"==typeof t.text?t.text:this.defaultText}},{key:"listenClick",value:function e(t){var n=this;this.listener=(0,f.default)(t,"click",function(e){return n.onClick(e)})}},{key:"onClick",value:function e(t){var n=t.delegateTarget||t.currentTarget;this.clipboardAction&&(this.clipboardAction=null),this.clipboardAction=new u.default({action:this.action(n),target:this.target(n),text:this.text(n),trigger:n,emitter:this})}},{key:"defaultAction",value:function e(t){return l("action",t)}},{key:"defaultTarget",value:function e(t){var n=l("target",t);if(n)return document.querySelector(n)}},{key:"defaultText",value:function e(t){return l("text",t)}},{key:"destroy",value:function e(){this.listener.destroy(),this.clipboardAction&&(this.clipboardAction.destroy(),this.clipboardAction=null)}}],[{key:"isSupported",value:function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:["copy","cut"],n="string"==typeof t?[t]:t,o=!!document.queryCommandSupported;return n.forEach(function(e){o=o&&!!document.queryCommandSupported(e)}),o}}]),t}(s.default);e.exports=h})},{"./clipboard-action":7,"good-listener":4,"tiny-emitter":6}]},{},[8])(8)});/*!
 * jQuery doTimeout: Like setTimeout, but better! - v1.0 - 3/3/2010
 * http://benalman.com/projects/jquery-dotimeout-plugin/
 * 
 * Copyright (c) 2010 "Cowboy" Ben Alman
 * Dual licensed under the MIT and GPL licenses.
 * http://benalman.com/about/license/
 */
(function($){var a={},c="doTimeout",d=Array.prototype.slice;$[c]=function(){return b.apply(window,[0].concat(d.call(arguments)))};$.fn[c]=function(){var f=d.call(arguments),e=b.apply(this,[c+f[0]].concat(f));return typeof f[0]==="number"||typeof f[1]==="number"?this:e};function b(l){var m=this,h,k={},g=l?$.fn:$,n=arguments,i=4,f=n[1],j=n[2],p=n[3];if(typeof f!=="string"){i--;f=l=0;j=n[1];p=n[2]}if(l){h=m.eq(0);h.data(l,k=h.data(l)||{})}else{if(f){k=a[f]||(a[f]={})}}k.id&&clearTimeout(k.id);delete k.id;function e(){if(l){h.removeData(l)}else{if(f){delete a[f]}}}function o(){k.id=setTimeout(function(){k.fn()},j)}if(p){k.fn=function(q){if(typeof p==="string"){p=g[p]}p.apply(m,d.call(n,i))===true&&!q?o():e()};o()}else{if(k.fn){j===undefined?e():k.fn(j===false);return true}else{e()}}}})(jQuery);
